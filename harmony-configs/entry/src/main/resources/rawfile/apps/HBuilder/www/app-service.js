var __defProp = Object.defineProperty;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __publicField = (obj, key, value) => {
  __defNormalProp(obj, typeof key !== "symbol" ? key + "" : key, value);
  return value;
};
if (typeof Promise !== "undefined" && !Promise.prototype.finally) {
  Promise.prototype.finally = function(callback) {
    const promise = this.constructor;
    return this.then(
      (value) => promise.resolve(callback()).then(() => value),
      (reason) => promise.resolve(callback()).then(() => {
        throw reason;
      })
    );
  };
}
;
if (typeof uni !== "undefined" && uni && uni.requireGlobal) {
  const global2 = uni.requireGlobal();
  ArrayBuffer = global2.ArrayBuffer;
  Int8Array = global2.Int8Array;
  Uint8Array = global2.Uint8Array;
  Uint8ClampedArray = global2.Uint8ClampedArray;
  Int16Array = global2.Int16Array;
  Uint16Array = global2.Uint16Array;
  Int32Array = global2.Int32Array;
  Uint32Array = global2.Uint32Array;
  Float32Array = global2.Float32Array;
  Float64Array = global2.Float64Array;
  BigInt64Array = global2.BigInt64Array;
  BigUint64Array = global2.BigUint64Array;
}
;
if (uni.restoreGlobal) {
  uni.restoreGlobal(Vue, weex, plus, setTimeout, clearTimeout, setInterval, clearInterval);
}
(function(vue) {
  "use strict";
  function requireNativePlugin(name) {
    return weex.requireModule(name);
  }
  function formatAppLog(type, filename, ...args) {
    if (uni.__log__) {
      uni.__log__(type, filename, ...args);
    } else {
      console[type].apply(console, [...args, filename]);
    }
  }
  function resolveEasycom(component, easycom) {
    return typeof component === "string" ? easycom : component;
  }
  function getItem(key) {
    return uni.getStorageSync(key);
  }
  function setItem(key, value) {
    uni.setStorageSync(key, value);
  }
  function clear() {
    uni.clearStorageSync();
  }
  var commonjsGlobal = typeof globalThis !== "undefined" ? globalThis : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : {};
  var events = { exports: {} };
  var R = typeof Reflect === "object" ? Reflect : null;
  var ReflectApply = R && typeof R.apply === "function" ? R.apply : function ReflectApply2(target, receiver, args) {
    return Function.prototype.apply.call(target, receiver, args);
  };
  var ReflectOwnKeys;
  if (R && typeof R.ownKeys === "function") {
    ReflectOwnKeys = R.ownKeys;
  } else if (Object.getOwnPropertySymbols) {
    ReflectOwnKeys = function ReflectOwnKeys2(target) {
      return Object.getOwnPropertyNames(target).concat(Object.getOwnPropertySymbols(target));
    };
  } else {
    ReflectOwnKeys = function ReflectOwnKeys2(target) {
      return Object.getOwnPropertyNames(target);
    };
  }
  function ProcessEmitWarning(warning) {
    if (console && console.warn)
      formatAppLog("warn", "at node_modules/events/events.js:46", warning);
  }
  var NumberIsNaN = Number.isNaN || function NumberIsNaN2(value) {
    return value !== value;
  };
  function EventEmitter() {
    EventEmitter.init.call(this);
  }
  events.exports = EventEmitter;
  events.exports.once = once;
  EventEmitter.EventEmitter = EventEmitter;
  EventEmitter.prototype._events = void 0;
  EventEmitter.prototype._eventsCount = 0;
  EventEmitter.prototype._maxListeners = void 0;
  var defaultMaxListeners = 10;
  function checkListener(listener) {
    if (typeof listener !== "function") {
      throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof listener);
    }
  }
  Object.defineProperty(EventEmitter, "defaultMaxListeners", {
    enumerable: true,
    get: function() {
      return defaultMaxListeners;
    },
    set: function(arg) {
      if (typeof arg !== "number" || arg < 0 || NumberIsNaN(arg)) {
        throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received ' + arg + ".");
      }
      defaultMaxListeners = arg;
    }
  });
  EventEmitter.init = function() {
    if (this._events === void 0 || this._events === Object.getPrototypeOf(this)._events) {
      this._events = /* @__PURE__ */ Object.create(null);
      this._eventsCount = 0;
    }
    this._maxListeners = this._maxListeners || void 0;
  };
  EventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {
    if (typeof n !== "number" || n < 0 || NumberIsNaN(n)) {
      throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received ' + n + ".");
    }
    this._maxListeners = n;
    return this;
  };
  function _getMaxListeners(that) {
    if (that._maxListeners === void 0)
      return EventEmitter.defaultMaxListeners;
    return that._maxListeners;
  }
  EventEmitter.prototype.getMaxListeners = function getMaxListeners() {
    return _getMaxListeners(this);
  };
  EventEmitter.prototype.emit = function emit(type) {
    var args = [];
    for (var i2 = 1; i2 < arguments.length; i2++)
      args.push(arguments[i2]);
    var doError = type === "error";
    var events2 = this._events;
    if (events2 !== void 0)
      doError = doError && events2.error === void 0;
    else if (!doError)
      return false;
    if (doError) {
      var er;
      if (args.length > 0)
        er = args[0];
      if (er instanceof Error) {
        throw er;
      }
      var err = new Error("Unhandled error." + (er ? " (" + er.message + ")" : ""));
      err.context = er;
      throw err;
    }
    var handler = events2[type];
    if (handler === void 0)
      return false;
    if (typeof handler === "function") {
      ReflectApply(handler, this, args);
    } else {
      var len = handler.length;
      var listeners = arrayClone(handler, len);
      for (var i2 = 0; i2 < len; ++i2)
        ReflectApply(listeners[i2], this, args);
    }
    return true;
  };
  function _addListener(target, type, listener, prepend) {
    var m;
    var events2;
    var existing;
    checkListener(listener);
    events2 = target._events;
    if (events2 === void 0) {
      events2 = target._events = /* @__PURE__ */ Object.create(null);
      target._eventsCount = 0;
    } else {
      if (events2.newListener !== void 0) {
        target.emit(
          "newListener",
          type,
          listener.listener ? listener.listener : listener
        );
        events2 = target._events;
      }
      existing = events2[type];
    }
    if (existing === void 0) {
      existing = events2[type] = listener;
      ++target._eventsCount;
    } else {
      if (typeof existing === "function") {
        existing = events2[type] = prepend ? [listener, existing] : [existing, listener];
      } else if (prepend) {
        existing.unshift(listener);
      } else {
        existing.push(listener);
      }
      m = _getMaxListeners(target);
      if (m > 0 && existing.length > m && !existing.warned) {
        existing.warned = true;
        var w = new Error("Possible EventEmitter memory leak detected. " + existing.length + " " + String(type) + " listeners added. Use emitter.setMaxListeners() to increase limit");
        w.name = "MaxListenersExceededWarning";
        w.emitter = target;
        w.type = type;
        w.count = existing.length;
        ProcessEmitWarning(w);
      }
    }
    return target;
  }
  EventEmitter.prototype.addListener = function addListener(type, listener) {
    return _addListener(this, type, listener, false);
  };
  EventEmitter.prototype.on = EventEmitter.prototype.addListener;
  EventEmitter.prototype.prependListener = function prependListener(type, listener) {
    return _addListener(this, type, listener, true);
  };
  function onceWrapper() {
    if (!this.fired) {
      this.target.removeListener(this.type, this.wrapFn);
      this.fired = true;
      if (arguments.length === 0)
        return this.listener.call(this.target);
      return this.listener.apply(this.target, arguments);
    }
  }
  function _onceWrap(target, type, listener) {
    var state = { fired: false, wrapFn: void 0, target, type, listener };
    var wrapped = onceWrapper.bind(state);
    wrapped.listener = listener;
    state.wrapFn = wrapped;
    return wrapped;
  }
  EventEmitter.prototype.once = function once2(type, listener) {
    checkListener(listener);
    this.on(type, _onceWrap(this, type, listener));
    return this;
  };
  EventEmitter.prototype.prependOnceListener = function prependOnceListener(type, listener) {
    checkListener(listener);
    this.prependListener(type, _onceWrap(this, type, listener));
    return this;
  };
  EventEmitter.prototype.removeListener = function removeListener(type, listener) {
    var list2, events2, position, i2, originalListener;
    checkListener(listener);
    events2 = this._events;
    if (events2 === void 0)
      return this;
    list2 = events2[type];
    if (list2 === void 0)
      return this;
    if (list2 === listener || list2.listener === listener) {
      if (--this._eventsCount === 0)
        this._events = /* @__PURE__ */ Object.create(null);
      else {
        delete events2[type];
        if (events2.removeListener)
          this.emit("removeListener", type, list2.listener || listener);
      }
    } else if (typeof list2 !== "function") {
      position = -1;
      for (i2 = list2.length - 1; i2 >= 0; i2--) {
        if (list2[i2] === listener || list2[i2].listener === listener) {
          originalListener = list2[i2].listener;
          position = i2;
          break;
        }
      }
      if (position < 0)
        return this;
      if (position === 0)
        list2.shift();
      else {
        spliceOne(list2, position);
      }
      if (list2.length === 1)
        events2[type] = list2[0];
      if (events2.removeListener !== void 0)
        this.emit("removeListener", type, originalListener || listener);
    }
    return this;
  };
  EventEmitter.prototype.off = EventEmitter.prototype.removeListener;
  EventEmitter.prototype.removeAllListeners = function removeAllListeners(type) {
    var listeners, events2, i2;
    events2 = this._events;
    if (events2 === void 0)
      return this;
    if (events2.removeListener === void 0) {
      if (arguments.length === 0) {
        this._events = /* @__PURE__ */ Object.create(null);
        this._eventsCount = 0;
      } else if (events2[type] !== void 0) {
        if (--this._eventsCount === 0)
          this._events = /* @__PURE__ */ Object.create(null);
        else
          delete events2[type];
      }
      return this;
    }
    if (arguments.length === 0) {
      var keys = Object.keys(events2);
      var key;
      for (i2 = 0; i2 < keys.length; ++i2) {
        key = keys[i2];
        if (key === "removeListener")
          continue;
        this.removeAllListeners(key);
      }
      this.removeAllListeners("removeListener");
      this._events = /* @__PURE__ */ Object.create(null);
      this._eventsCount = 0;
      return this;
    }
    listeners = events2[type];
    if (typeof listeners === "function") {
      this.removeListener(type, listeners);
    } else if (listeners !== void 0) {
      for (i2 = listeners.length - 1; i2 >= 0; i2--) {
        this.removeListener(type, listeners[i2]);
      }
    }
    return this;
  };
  function _listeners(target, type, unwrap) {
    var events2 = target._events;
    if (events2 === void 0)
      return [];
    var evlistener = events2[type];
    if (evlistener === void 0)
      return [];
    if (typeof evlistener === "function")
      return unwrap ? [evlistener.listener || evlistener] : [evlistener];
    return unwrap ? unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);
  }
  EventEmitter.prototype.listeners = function listeners(type) {
    return _listeners(this, type, true);
  };
  EventEmitter.prototype.rawListeners = function rawListeners(type) {
    return _listeners(this, type, false);
  };
  EventEmitter.listenerCount = function(emitter, type) {
    if (typeof emitter.listenerCount === "function") {
      return emitter.listenerCount(type);
    } else {
      return listenerCount.call(emitter, type);
    }
  };
  EventEmitter.prototype.listenerCount = listenerCount;
  function listenerCount(type) {
    var events2 = this._events;
    if (events2 !== void 0) {
      var evlistener = events2[type];
      if (typeof evlistener === "function") {
        return 1;
      } else if (evlistener !== void 0) {
        return evlistener.length;
      }
    }
    return 0;
  }
  EventEmitter.prototype.eventNames = function eventNames() {
    return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];
  };
  function arrayClone(arr, n) {
    var copy = new Array(n);
    for (var i2 = 0; i2 < n; ++i2)
      copy[i2] = arr[i2];
    return copy;
  }
  function spliceOne(list2, index) {
    for (; index + 1 < list2.length; index++)
      list2[index] = list2[index + 1];
    list2.pop();
  }
  function unwrapListeners(arr) {
    var ret = new Array(arr.length);
    for (var i2 = 0; i2 < ret.length; ++i2) {
      ret[i2] = arr[i2].listener || arr[i2];
    }
    return ret;
  }
  function once(emitter, name) {
    return new Promise(function(resolve, reject) {
      function errorListener(err) {
        emitter.removeListener(name, resolver);
        reject(err);
      }
      function resolver() {
        if (typeof emitter.removeListener === "function") {
          emitter.removeListener("error", errorListener);
        }
        resolve([].slice.call(arguments));
      }
      eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });
      if (name !== "error") {
        addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });
      }
    });
  }
  function addErrorHandlerIfEventEmitter(emitter, handler, flags) {
    if (typeof emitter.on === "function") {
      eventTargetAgnosticAddListener(emitter, "error", handler, flags);
    }
  }
  function eventTargetAgnosticAddListener(emitter, name, listener, flags) {
    if (typeof emitter.on === "function") {
      if (flags.once) {
        emitter.once(name, listener);
      } else {
        emitter.on(name, listener);
      }
    } else if (typeof emitter.addEventListener === "function") {
      emitter.addEventListener(name, function wrapListener(arg) {
        if (flags.once) {
          emitter.removeEventListener(name, wrapListener);
        }
        listener(arg);
      });
    } else {
      throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type ' + typeof emitter);
    }
  }
  var eventsExports = events.exports;
  const c = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
  function btoa(e) {
    for (var t2, r, o = String(e), n = 0, a = c, i2 = ""; o.charAt(0 | n) || (a = "=", n % 1); i2 += a.charAt(63 & t2 >> 8 - n % 1 * 8)) {
      if (255 < (r = o.charCodeAt(n += 0.75)))
        throw new Error(
          "'btoa' failed: The string to be encoded contains characters outside of the Latin1 range."
        );
      t2 = t2 << 8 | r;
    }
    return i2;
  }
  function atob(e) {
    var t2 = String(e).replace(/[=]+$/, "");
    if (t2.length % 4 == 1)
      throw new Error(
        "'atob' failed: The string to be decoded is not correctly encoded."
      );
    for (var r, o, n = 0, a = 0, i2 = ""; o = t2.charAt(a++); ~o && (r = n % 4 ? 64 * r + o : o, n++ % 4) ? i2 += String.fromCharCode(255 & r >> (-2 * n & 6)) : 0)
      o = c.indexOf(o);
    return i2;
  }
  /**
   * @license
   * Copyright 2009 The Closure Library Authors
   * Copyright 2020 Daniel Wirtz / The long.js Authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   * SPDX-License-Identifier: Apache-2.0
   */
  var wasm = null;
  try {
    wasm = new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([
      0,
      97,
      115,
      109,
      1,
      0,
      0,
      0,
      1,
      13,
      2,
      96,
      0,
      1,
      127,
      96,
      4,
      127,
      127,
      127,
      127,
      1,
      127,
      3,
      7,
      6,
      0,
      1,
      1,
      1,
      1,
      1,
      6,
      6,
      1,
      127,
      1,
      65,
      0,
      11,
      7,
      50,
      6,
      3,
      109,
      117,
      108,
      0,
      1,
      5,
      100,
      105,
      118,
      95,
      115,
      0,
      2,
      5,
      100,
      105,
      118,
      95,
      117,
      0,
      3,
      5,
      114,
      101,
      109,
      95,
      115,
      0,
      4,
      5,
      114,
      101,
      109,
      95,
      117,
      0,
      5,
      8,
      103,
      101,
      116,
      95,
      104,
      105,
      103,
      104,
      0,
      0,
      10,
      191,
      1,
      6,
      4,
      0,
      35,
      0,
      11,
      36,
      1,
      1,
      126,
      32,
      0,
      173,
      32,
      1,
      173,
      66,
      32,
      134,
      132,
      32,
      2,
      173,
      32,
      3,
      173,
      66,
      32,
      134,
      132,
      126,
      34,
      4,
      66,
      32,
      135,
      167,
      36,
      0,
      32,
      4,
      167,
      11,
      36,
      1,
      1,
      126,
      32,
      0,
      173,
      32,
      1,
      173,
      66,
      32,
      134,
      132,
      32,
      2,
      173,
      32,
      3,
      173,
      66,
      32,
      134,
      132,
      127,
      34,
      4,
      66,
      32,
      135,
      167,
      36,
      0,
      32,
      4,
      167,
      11,
      36,
      1,
      1,
      126,
      32,
      0,
      173,
      32,
      1,
      173,
      66,
      32,
      134,
      132,
      32,
      2,
      173,
      32,
      3,
      173,
      66,
      32,
      134,
      132,
      128,
      34,
      4,
      66,
      32,
      135,
      167,
      36,
      0,
      32,
      4,
      167,
      11,
      36,
      1,
      1,
      126,
      32,
      0,
      173,
      32,
      1,
      173,
      66,
      32,
      134,
      132,
      32,
      2,
      173,
      32,
      3,
      173,
      66,
      32,
      134,
      132,
      129,
      34,
      4,
      66,
      32,
      135,
      167,
      36,
      0,
      32,
      4,
      167,
      11,
      36,
      1,
      1,
      126,
      32,
      0,
      173,
      32,
      1,
      173,
      66,
      32,
      134,
      132,
      32,
      2,
      173,
      32,
      3,
      173,
      66,
      32,
      134,
      132,
      130,
      34,
      4,
      66,
      32,
      135,
      167,
      36,
      0,
      32,
      4,
      167,
      11
    ])), {}).exports;
  } catch (e) {
  }
  function Long(low, high, unsigned) {
    this.low = low | 0;
    this.high = high | 0;
    this.unsigned = !!unsigned;
  }
  Long.prototype.__isLong__;
  Object.defineProperty(Long.prototype, "__isLong__", { value: true });
  function isLong(obj) {
    return (obj && obj["__isLong__"]) === true;
  }
  function ctz32(value) {
    var c2 = Math.clz32(value & -value);
    return value ? 31 - c2 : c2;
  }
  Long.isLong = isLong;
  var INT_CACHE = {};
  var UINT_CACHE = {};
  function fromInt(value, unsigned) {
    var obj, cachedObj, cache2;
    if (unsigned) {
      value >>>= 0;
      if (cache2 = 0 <= value && value < 256) {
        cachedObj = UINT_CACHE[value];
        if (cachedObj)
          return cachedObj;
      }
      obj = fromBits(value, 0, true);
      if (cache2)
        UINT_CACHE[value] = obj;
      return obj;
    } else {
      value |= 0;
      if (cache2 = -128 <= value && value < 128) {
        cachedObj = INT_CACHE[value];
        if (cachedObj)
          return cachedObj;
      }
      obj = fromBits(value, value < 0 ? -1 : 0, false);
      if (cache2)
        INT_CACHE[value] = obj;
      return obj;
    }
  }
  Long.fromInt = fromInt;
  function fromNumber(value, unsigned) {
    if (isNaN(value))
      return unsigned ? UZERO : ZERO;
    if (unsigned) {
      if (value < 0)
        return UZERO;
      if (value >= TWO_PWR_64_DBL)
        return MAX_UNSIGNED_VALUE;
    } else {
      if (value <= -TWO_PWR_63_DBL)
        return MIN_VALUE;
      if (value + 1 >= TWO_PWR_63_DBL)
        return MAX_VALUE;
    }
    if (value < 0)
      return fromNumber(-value, unsigned).neg();
    return fromBits(value % TWO_PWR_32_DBL | 0, value / TWO_PWR_32_DBL | 0, unsigned);
  }
  Long.fromNumber = fromNumber;
  function fromBits(lowBits, highBits, unsigned) {
    return new Long(lowBits, highBits, unsigned);
  }
  Long.fromBits = fromBits;
  var pow_dbl = Math.pow;
  function fromString(str, unsigned, radix) {
    if (str.length === 0)
      throw Error("empty string");
    if (typeof unsigned === "number") {
      radix = unsigned;
      unsigned = false;
    } else {
      unsigned = !!unsigned;
    }
    if (str === "NaN" || str === "Infinity" || str === "+Infinity" || str === "-Infinity")
      return unsigned ? UZERO : ZERO;
    radix = radix || 10;
    if (radix < 2 || 36 < radix)
      throw RangeError("radix");
    var p;
    if ((p = str.indexOf("-")) > 0)
      throw Error("interior hyphen");
    else if (p === 0) {
      return fromString(str.substring(1), unsigned, radix).neg();
    }
    var radixToPower = fromNumber(pow_dbl(radix, 8));
    var result = ZERO;
    for (var i2 = 0; i2 < str.length; i2 += 8) {
      var size = Math.min(8, str.length - i2), value = parseInt(str.substring(i2, i2 + size), radix);
      if (size < 8) {
        var power = fromNumber(pow_dbl(radix, size));
        result = result.mul(power).add(fromNumber(value));
      } else {
        result = result.mul(radixToPower);
        result = result.add(fromNumber(value));
      }
    }
    result.unsigned = unsigned;
    return result;
  }
  Long.fromString = fromString;
  function fromValue(val, unsigned) {
    if (typeof val === "number")
      return fromNumber(val, unsigned);
    if (typeof val === "string")
      return fromString(val, unsigned);
    return fromBits(val.low, val.high, typeof unsigned === "boolean" ? unsigned : val.unsigned);
  }
  Long.fromValue = fromValue;
  var TWO_PWR_16_DBL = 1 << 16;
  var TWO_PWR_24_DBL = 1 << 24;
  var TWO_PWR_32_DBL = TWO_PWR_16_DBL * TWO_PWR_16_DBL;
  var TWO_PWR_64_DBL = TWO_PWR_32_DBL * TWO_PWR_32_DBL;
  var TWO_PWR_63_DBL = TWO_PWR_64_DBL / 2;
  var TWO_PWR_24 = fromInt(TWO_PWR_24_DBL);
  var ZERO = fromInt(0);
  Long.ZERO = ZERO;
  var UZERO = fromInt(0, true);
  Long.UZERO = UZERO;
  var ONE = fromInt(1);
  Long.ONE = ONE;
  var UONE = fromInt(1, true);
  Long.UONE = UONE;
  var NEG_ONE = fromInt(-1);
  Long.NEG_ONE = NEG_ONE;
  var MAX_VALUE = fromBits(4294967295 | 0, 2147483647 | 0, false);
  Long.MAX_VALUE = MAX_VALUE;
  var MAX_UNSIGNED_VALUE = fromBits(4294967295 | 0, 4294967295 | 0, true);
  Long.MAX_UNSIGNED_VALUE = MAX_UNSIGNED_VALUE;
  var MIN_VALUE = fromBits(0, 2147483648 | 0, false);
  Long.MIN_VALUE = MIN_VALUE;
  var LongPrototype = Long.prototype;
  LongPrototype.toInt = function toInt() {
    return this.unsigned ? this.low >>> 0 : this.low;
  };
  LongPrototype.toNumber = function toNumber() {
    if (this.unsigned)
      return (this.high >>> 0) * TWO_PWR_32_DBL + (this.low >>> 0);
    return this.high * TWO_PWR_32_DBL + (this.low >>> 0);
  };
  LongPrototype.toString = function toString(radix) {
    radix = radix || 10;
    if (radix < 2 || 36 < radix)
      throw RangeError("radix");
    if (this.isZero())
      return "0";
    if (this.isNegative()) {
      if (this.eq(MIN_VALUE)) {
        var radixLong = fromNumber(radix), div = this.div(radixLong), rem1 = div.mul(radixLong).sub(this);
        return div.toString(radix) + rem1.toInt().toString(radix);
      } else
        return "-" + this.neg().toString(radix);
    }
    var radixToPower = fromNumber(pow_dbl(radix, 6), this.unsigned), rem = this;
    var result = "";
    while (true) {
      var remDiv = rem.div(radixToPower), intval = rem.sub(remDiv.mul(radixToPower)).toInt() >>> 0, digits = intval.toString(radix);
      rem = remDiv;
      if (rem.isZero())
        return digits + result;
      else {
        while (digits.length < 6)
          digits = "0" + digits;
        result = "" + digits + result;
      }
    }
  };
  LongPrototype.getHighBits = function getHighBits() {
    return this.high;
  };
  LongPrototype.getHighBitsUnsigned = function getHighBitsUnsigned() {
    return this.high >>> 0;
  };
  LongPrototype.getLowBits = function getLowBits() {
    return this.low;
  };
  LongPrototype.getLowBitsUnsigned = function getLowBitsUnsigned() {
    return this.low >>> 0;
  };
  LongPrototype.getNumBitsAbs = function getNumBitsAbs() {
    if (this.isNegative())
      return this.eq(MIN_VALUE) ? 64 : this.neg().getNumBitsAbs();
    var val = this.high != 0 ? this.high : this.low;
    for (var bit = 31; bit > 0; bit--)
      if ((val & 1 << bit) != 0)
        break;
    return this.high != 0 ? bit + 33 : bit + 1;
  };
  LongPrototype.isZero = function isZero() {
    return this.high === 0 && this.low === 0;
  };
  LongPrototype.eqz = LongPrototype.isZero;
  LongPrototype.isNegative = function isNegative() {
    return !this.unsigned && this.high < 0;
  };
  LongPrototype.isPositive = function isPositive() {
    return this.unsigned || this.high >= 0;
  };
  LongPrototype.isOdd = function isOdd() {
    return (this.low & 1) === 1;
  };
  LongPrototype.isEven = function isEven() {
    return (this.low & 1) === 0;
  };
  LongPrototype.equals = function equals(other) {
    if (!isLong(other))
      other = fromValue(other);
    if (this.unsigned !== other.unsigned && this.high >>> 31 === 1 && other.high >>> 31 === 1)
      return false;
    return this.high === other.high && this.low === other.low;
  };
  LongPrototype.eq = LongPrototype.equals;
  LongPrototype.notEquals = function notEquals(other) {
    return !this.eq(
      /* validates */
      other
    );
  };
  LongPrototype.neq = LongPrototype.notEquals;
  LongPrototype.ne = LongPrototype.notEquals;
  LongPrototype.lessThan = function lessThan(other) {
    return this.comp(
      /* validates */
      other
    ) < 0;
  };
  LongPrototype.lt = LongPrototype.lessThan;
  LongPrototype.lessThanOrEqual = function lessThanOrEqual(other) {
    return this.comp(
      /* validates */
      other
    ) <= 0;
  };
  LongPrototype.lte = LongPrototype.lessThanOrEqual;
  LongPrototype.le = LongPrototype.lessThanOrEqual;
  LongPrototype.greaterThan = function greaterThan(other) {
    return this.comp(
      /* validates */
      other
    ) > 0;
  };
  LongPrototype.gt = LongPrototype.greaterThan;
  LongPrototype.greaterThanOrEqual = function greaterThanOrEqual(other) {
    return this.comp(
      /* validates */
      other
    ) >= 0;
  };
  LongPrototype.gte = LongPrototype.greaterThanOrEqual;
  LongPrototype.ge = LongPrototype.greaterThanOrEqual;
  LongPrototype.compare = function compare2(other) {
    if (!isLong(other))
      other = fromValue(other);
    if (this.eq(other))
      return 0;
    var thisNeg = this.isNegative(), otherNeg = other.isNegative();
    if (thisNeg && !otherNeg)
      return -1;
    if (!thisNeg && otherNeg)
      return 1;
    if (!this.unsigned)
      return this.sub(other).isNegative() ? -1 : 1;
    return other.high >>> 0 > this.high >>> 0 || other.high === this.high && other.low >>> 0 > this.low >>> 0 ? -1 : 1;
  };
  LongPrototype.comp = LongPrototype.compare;
  LongPrototype.negate = function negate() {
    if (!this.unsigned && this.eq(MIN_VALUE))
      return MIN_VALUE;
    return this.not().add(ONE);
  };
  LongPrototype.neg = LongPrototype.negate;
  LongPrototype.add = function add(addend) {
    if (!isLong(addend))
      addend = fromValue(addend);
    var a48 = this.high >>> 16;
    var a32 = this.high & 65535;
    var a16 = this.low >>> 16;
    var a00 = this.low & 65535;
    var b48 = addend.high >>> 16;
    var b32 = addend.high & 65535;
    var b16 = addend.low >>> 16;
    var b00 = addend.low & 65535;
    var c48 = 0, c32 = 0, c16 = 0, c00 = 0;
    c00 += a00 + b00;
    c16 += c00 >>> 16;
    c00 &= 65535;
    c16 += a16 + b16;
    c32 += c16 >>> 16;
    c16 &= 65535;
    c32 += a32 + b32;
    c48 += c32 >>> 16;
    c32 &= 65535;
    c48 += a48 + b48;
    c48 &= 65535;
    return fromBits(c16 << 16 | c00, c48 << 16 | c32, this.unsigned);
  };
  LongPrototype.subtract = function subtract(subtrahend) {
    if (!isLong(subtrahend))
      subtrahend = fromValue(subtrahend);
    return this.add(subtrahend.neg());
  };
  LongPrototype.sub = LongPrototype.subtract;
  LongPrototype.multiply = function multiply(multiplier) {
    if (this.isZero())
      return this;
    if (!isLong(multiplier))
      multiplier = fromValue(multiplier);
    if (wasm) {
      var low = wasm["mul"](
        this.low,
        this.high,
        multiplier.low,
        multiplier.high
      );
      return fromBits(low, wasm["get_high"](), this.unsigned);
    }
    if (multiplier.isZero())
      return this.unsigned ? UZERO : ZERO;
    if (this.eq(MIN_VALUE))
      return multiplier.isOdd() ? MIN_VALUE : ZERO;
    if (multiplier.eq(MIN_VALUE))
      return this.isOdd() ? MIN_VALUE : ZERO;
    if (this.isNegative()) {
      if (multiplier.isNegative())
        return this.neg().mul(multiplier.neg());
      else
        return this.neg().mul(multiplier).neg();
    } else if (multiplier.isNegative())
      return this.mul(multiplier.neg()).neg();
    if (this.lt(TWO_PWR_24) && multiplier.lt(TWO_PWR_24))
      return fromNumber(this.toNumber() * multiplier.toNumber(), this.unsigned);
    var a48 = this.high >>> 16;
    var a32 = this.high & 65535;
    var a16 = this.low >>> 16;
    var a00 = this.low & 65535;
    var b48 = multiplier.high >>> 16;
    var b32 = multiplier.high & 65535;
    var b16 = multiplier.low >>> 16;
    var b00 = multiplier.low & 65535;
    var c48 = 0, c32 = 0, c16 = 0, c00 = 0;
    c00 += a00 * b00;
    c16 += c00 >>> 16;
    c00 &= 65535;
    c16 += a16 * b00;
    c32 += c16 >>> 16;
    c16 &= 65535;
    c16 += a00 * b16;
    c32 += c16 >>> 16;
    c16 &= 65535;
    c32 += a32 * b00;
    c48 += c32 >>> 16;
    c32 &= 65535;
    c32 += a16 * b16;
    c48 += c32 >>> 16;
    c32 &= 65535;
    c32 += a00 * b32;
    c48 += c32 >>> 16;
    c32 &= 65535;
    c48 += a48 * b00 + a32 * b16 + a16 * b32 + a00 * b48;
    c48 &= 65535;
    return fromBits(c16 << 16 | c00, c48 << 16 | c32, this.unsigned);
  };
  LongPrototype.mul = LongPrototype.multiply;
  LongPrototype.divide = function divide(divisor) {
    if (!isLong(divisor))
      divisor = fromValue(divisor);
    if (divisor.isZero())
      throw Error("division by zero");
    if (wasm) {
      if (!this.unsigned && this.high === -2147483648 && divisor.low === -1 && divisor.high === -1) {
        return this;
      }
      var low = (this.unsigned ? wasm["div_u"] : wasm["div_s"])(
        this.low,
        this.high,
        divisor.low,
        divisor.high
      );
      return fromBits(low, wasm["get_high"](), this.unsigned);
    }
    if (this.isZero())
      return this.unsigned ? UZERO : ZERO;
    var approx, rem, res;
    if (!this.unsigned) {
      if (this.eq(MIN_VALUE)) {
        if (divisor.eq(ONE) || divisor.eq(NEG_ONE))
          return MIN_VALUE;
        else if (divisor.eq(MIN_VALUE))
          return ONE;
        else {
          var halfThis = this.shr(1);
          approx = halfThis.div(divisor).shl(1);
          if (approx.eq(ZERO)) {
            return divisor.isNegative() ? ONE : NEG_ONE;
          } else {
            rem = this.sub(divisor.mul(approx));
            res = approx.add(rem.div(divisor));
            return res;
          }
        }
      } else if (divisor.eq(MIN_VALUE))
        return this.unsigned ? UZERO : ZERO;
      if (this.isNegative()) {
        if (divisor.isNegative())
          return this.neg().div(divisor.neg());
        return this.neg().div(divisor).neg();
      } else if (divisor.isNegative())
        return this.div(divisor.neg()).neg();
      res = ZERO;
    } else {
      if (!divisor.unsigned)
        divisor = divisor.toUnsigned();
      if (divisor.gt(this))
        return UZERO;
      if (divisor.gt(this.shru(1)))
        return UONE;
      res = UZERO;
    }
    rem = this;
    while (rem.gte(divisor)) {
      approx = Math.max(1, Math.floor(rem.toNumber() / divisor.toNumber()));
      var log2 = Math.ceil(Math.log(approx) / Math.LN2), delta = log2 <= 48 ? 1 : pow_dbl(2, log2 - 48), approxRes = fromNumber(approx), approxRem = approxRes.mul(divisor);
      while (approxRem.isNegative() || approxRem.gt(rem)) {
        approx -= delta;
        approxRes = fromNumber(approx, this.unsigned);
        approxRem = approxRes.mul(divisor);
      }
      if (approxRes.isZero())
        approxRes = ONE;
      res = res.add(approxRes);
      rem = rem.sub(approxRem);
    }
    return res;
  };
  LongPrototype.div = LongPrototype.divide;
  LongPrototype.modulo = function modulo(divisor) {
    if (!isLong(divisor))
      divisor = fromValue(divisor);
    if (wasm) {
      var low = (this.unsigned ? wasm["rem_u"] : wasm["rem_s"])(
        this.low,
        this.high,
        divisor.low,
        divisor.high
      );
      return fromBits(low, wasm["get_high"](), this.unsigned);
    }
    return this.sub(this.div(divisor).mul(divisor));
  };
  LongPrototype.mod = LongPrototype.modulo;
  LongPrototype.rem = LongPrototype.modulo;
  LongPrototype.not = function not() {
    return fromBits(~this.low, ~this.high, this.unsigned);
  };
  LongPrototype.countLeadingZeros = function countLeadingZeros() {
    return this.high ? Math.clz32(this.high) : Math.clz32(this.low) + 32;
  };
  LongPrototype.clz = LongPrototype.countLeadingZeros;
  LongPrototype.countTrailingZeros = function countTrailingZeros() {
    return this.low ? ctz32(this.low) : ctz32(this.high) + 32;
  };
  LongPrototype.ctz = LongPrototype.countTrailingZeros;
  LongPrototype.and = function and(other) {
    if (!isLong(other))
      other = fromValue(other);
    return fromBits(this.low & other.low, this.high & other.high, this.unsigned);
  };
  LongPrototype.or = function or(other) {
    if (!isLong(other))
      other = fromValue(other);
    return fromBits(this.low | other.low, this.high | other.high, this.unsigned);
  };
  LongPrototype.xor = function xor(other) {
    if (!isLong(other))
      other = fromValue(other);
    return fromBits(this.low ^ other.low, this.high ^ other.high, this.unsigned);
  };
  LongPrototype.shiftLeft = function shiftLeft(numBits) {
    if (isLong(numBits))
      numBits = numBits.toInt();
    if ((numBits &= 63) === 0)
      return this;
    else if (numBits < 32)
      return fromBits(this.low << numBits, this.high << numBits | this.low >>> 32 - numBits, this.unsigned);
    else
      return fromBits(0, this.low << numBits - 32, this.unsigned);
  };
  LongPrototype.shl = LongPrototype.shiftLeft;
  LongPrototype.shiftRight = function shiftRight(numBits) {
    if (isLong(numBits))
      numBits = numBits.toInt();
    if ((numBits &= 63) === 0)
      return this;
    else if (numBits < 32)
      return fromBits(this.low >>> numBits | this.high << 32 - numBits, this.high >> numBits, this.unsigned);
    else
      return fromBits(this.high >> numBits - 32, this.high >= 0 ? 0 : -1, this.unsigned);
  };
  LongPrototype.shr = LongPrototype.shiftRight;
  LongPrototype.shiftRightUnsigned = function shiftRightUnsigned(numBits) {
    if (isLong(numBits))
      numBits = numBits.toInt();
    if ((numBits &= 63) === 0)
      return this;
    if (numBits < 32)
      return fromBits(this.low >>> numBits | this.high << 32 - numBits, this.high >>> numBits, this.unsigned);
    if (numBits === 32)
      return fromBits(this.high, 0, this.unsigned);
    return fromBits(this.high >>> numBits - 32, 0, this.unsigned);
  };
  LongPrototype.shru = LongPrototype.shiftRightUnsigned;
  LongPrototype.shr_u = LongPrototype.shiftRightUnsigned;
  LongPrototype.rotateLeft = function rotateLeft(numBits) {
    var b;
    if (isLong(numBits))
      numBits = numBits.toInt();
    if ((numBits &= 63) === 0)
      return this;
    if (numBits === 32)
      return fromBits(this.high, this.low, this.unsigned);
    if (numBits < 32) {
      b = 32 - numBits;
      return fromBits(this.low << numBits | this.high >>> b, this.high << numBits | this.low >>> b, this.unsigned);
    }
    numBits -= 32;
    b = 32 - numBits;
    return fromBits(this.high << numBits | this.low >>> b, this.low << numBits | this.high >>> b, this.unsigned);
  };
  LongPrototype.rotl = LongPrototype.rotateLeft;
  LongPrototype.rotateRight = function rotateRight(numBits) {
    var b;
    if (isLong(numBits))
      numBits = numBits.toInt();
    if ((numBits &= 63) === 0)
      return this;
    if (numBits === 32)
      return fromBits(this.high, this.low, this.unsigned);
    if (numBits < 32) {
      b = 32 - numBits;
      return fromBits(this.high << b | this.low >>> numBits, this.low << b | this.high >>> numBits, this.unsigned);
    }
    numBits -= 32;
    b = 32 - numBits;
    return fromBits(this.low << b | this.high >>> numBits, this.high << b | this.low >>> numBits, this.unsigned);
  };
  LongPrototype.rotr = LongPrototype.rotateRight;
  LongPrototype.toSigned = function toSigned() {
    if (!this.unsigned)
      return this;
    return fromBits(this.low, this.high, false);
  };
  LongPrototype.toUnsigned = function toUnsigned() {
    if (this.unsigned)
      return this;
    return fromBits(this.low, this.high, true);
  };
  LongPrototype.toBytes = function toBytes(le) {
    return le ? this.toBytesLE() : this.toBytesBE();
  };
  LongPrototype.toBytesLE = function toBytesLE() {
    var hi = this.high, lo = this.low;
    return [
      lo & 255,
      lo >>> 8 & 255,
      lo >>> 16 & 255,
      lo >>> 24,
      hi & 255,
      hi >>> 8 & 255,
      hi >>> 16 & 255,
      hi >>> 24
    ];
  };
  LongPrototype.toBytesBE = function toBytesBE() {
    var hi = this.high, lo = this.low;
    return [
      hi >>> 24,
      hi >>> 16 & 255,
      hi >>> 8 & 255,
      hi & 255,
      lo >>> 24,
      lo >>> 16 & 255,
      lo >>> 8 & 255,
      lo & 255
    ];
  };
  Long.fromBytes = function fromBytes(bytes, unsigned, le) {
    return le ? Long.fromBytesLE(bytes, unsigned) : Long.fromBytesBE(bytes, unsigned);
  };
  Long.fromBytesLE = function fromBytesLE(bytes, unsigned) {
    return new Long(
      bytes[0] | bytes[1] << 8 | bytes[2] << 16 | bytes[3] << 24,
      bytes[4] | bytes[5] << 8 | bytes[6] << 16 | bytes[7] << 24,
      unsigned
    );
  };
  Long.fromBytesBE = function fromBytesBE(bytes, unsigned) {
    return new Long(
      bytes[4] << 24 | bytes[5] << 16 | bytes[6] << 8 | bytes[7],
      bytes[0] << 24 | bytes[1] << 16 | bytes[2] << 8 | bytes[3],
      unsigned
    );
  };
  class ConversationType {
  }
  __publicField(ConversationType, "Single", 0);
  __publicField(ConversationType, "Group", 1);
  __publicField(ConversationType, "ChatRoom", 2);
  __publicField(ConversationType, "Channel", 3);
  __publicField(ConversationType, "SecretChat", 5);
  class Conversation {
    constructor(type, target, line = 0) {
      __publicField(this, "type", ConversationType.Single);
      __publicField(this, "conversationType", this.type);
      // 这行是为了做一个兼容处理
      __publicField(this, "target", "");
      __publicField(this, "line", 0);
      this.type = type;
      this.conversationType = type;
      this.target = target;
      this.line = line;
    }
    equal(conversation2) {
      if (!conversation2) {
        return false;
      }
      return this.type === conversation2.type && this.target === conversation2.target && this.line === conversation2.line;
    }
  }
  class MessagePayload {
    constructor() {
      __publicField(this, "type");
      __publicField(this, "searchableContent");
      __publicField(this, "pushContent");
      __publicField(this, "pushData");
      __publicField(this, "content");
      __publicField(this, "binaryContent");
      // base64 string, 图片时，不包含头部信息:data:image/png;base64,
      __publicField(this, "localContent");
      __publicField(this, "mediaType");
      __publicField(this, "remoteMediaUrl");
      __publicField(this, "localMediaPath");
      __publicField(this, "mentionedType", 0);
      __publicField(this, "mentionedTargets", []);
      __publicField(this, "extra");
    }
  }
  class MessageContent {
    constructor(type, mentionedType = 0, mentionedTargets = []) {
      __publicField(this, "type");
      //0 普通消息, 1 部分提醒, 2 提醒全部
      __publicField(this, "mentionedType", 0);
      //提醒对象，mentionedType 1时有效
      __publicField(this, "mentionedTargets", []);
      __publicField(this, "extra");
      __publicField(this, "pushContent");
      this.type = type;
      this.mentionedType = mentionedType;
      this.mentionedTargets = mentionedTargets;
    }
    digest(message2) {
      return "...digest...";
    }
    /**
     * return MessagePayload in json format
     */
    encode() {
      let payload = new MessagePayload();
      payload.type = this.type;
      payload.mentionedType = this.mentionedType;
      payload.mentionedTargets = this.mentionedTargets;
      payload.extra = this.extra;
      return payload;
    }
    /**
     *
     * @param {object} payload object json.parse from message#content
     */
    decode(payload) {
      this.type = payload.type;
      this.mentionedType = payload.mentionedType;
      if (payload.hasOwnProperty("mentionedTarget")) {
        this.mentionedTargets = payload.mentionedTarget;
      } else {
        this.mentionedTargets = payload.mentionedTargets;
      }
      this.extra = payload.extra;
      this.pushContent = payload.pushContent;
    }
  }
  class NotificationMessageContent extends MessageContent {
    constructor(type) {
      super(type);
      // message#protoMessageToMessage时设置
      __publicField(this, "fromSelf", false);
    }
    digest(message2) {
      var desc = "";
      try {
        desc = this.formatNotification(message2);
      } catch (error) {
        formatAppLog("log", "at wfc/messages/notification/notificationMessageContent.js:20", "disgest", error);
      }
      return desc;
    }
    formatNotification(message2) {
      return "..nofication..";
    }
  }
  class MessageContentType {
  }
  // 基本消息类型
  __publicField(MessageContentType, "Unknown", 0);
  __publicField(MessageContentType, "Text", 1);
  __publicField(MessageContentType, "Voice", 2);
  __publicField(MessageContentType, "Image", 3);
  __publicField(MessageContentType, "Location", 4);
  __publicField(MessageContentType, "File", 5);
  __publicField(MessageContentType, "Video", 6);
  __publicField(MessageContentType, "Sticker", 7);
  __publicField(MessageContentType, "Link", 8);
  __publicField(MessageContentType, "P_Text", 9);
  __publicField(MessageContentType, "UserCard", 10);
  __publicField(MessageContentType, "Composite_Message", 11);
  __publicField(MessageContentType, "Rich_Notification", 12);
  __publicField(MessageContentType, "Articles", 13);
  //流式文本正在生成消息
  __publicField(MessageContentType, "Streaming_Text_Generating", 14);
  //流式文本消息
  __publicField(MessageContentType, "Streaming_Text_Generated", 15);
  __publicField(MessageContentType, "Mark_Unread_Sync", 31);
  __publicField(MessageContentType, "StartSecretChat_Notification", 40);
  //频道进出消息
  __publicField(MessageContentType, "Enter_Channel_Chat", 71);
  __publicField(MessageContentType, "Leave_Channel_Chat", 72);
  __publicField(MessageContentType, "Channel_Menu_Event", 73);
  // 提醒消息
  __publicField(MessageContentType, "RecallMessage_Notification", 80);
  __publicField(MessageContentType, "DeleteMessage_Notification", 81);
  //不存储的
  __publicField(MessageContentType, "Tip_Notification", 90);
  __publicField(MessageContentType, "Typing", 91);
  // //以上是打招呼的内容
  // int ContentType_Friend_Greeting = 92;
  // //您已经添加XXX为好友了，可以愉快地聊天了
  // int ContentType_Friend_Added = 93;
  //
  // int ContentType_PC_LOGIN_REQUSET = 94;
  __publicField(MessageContentType, "Friend_Greeting", 92);
  __publicField(MessageContentType, "Friend_Added", 93);
  __publicField(MessageContentType, "PC_Login_Request", 94);
  // 群相关消息
  __publicField(MessageContentType, "CreateGroup_Notification", 104);
  __publicField(MessageContentType, "AddGroupMember_Notification", 105);
  __publicField(MessageContentType, "KickOffGroupMember_Notification", 106);
  __publicField(MessageContentType, "QuitGroup_Notification", 107);
  __publicField(MessageContentType, "DismissGroup_Notification", 108);
  __publicField(MessageContentType, "TransferGroupOwner_Notification", 109);
  __publicField(MessageContentType, "ChangeGroupName_Notification", 110);
  __publicField(MessageContentType, "ModifyGroupAlias_Notification", 111);
  __publicField(MessageContentType, "ChangeGroupPortrait_Notification", 112);
  __publicField(MessageContentType, "MuteGroup_Notification", 113);
  __publicField(MessageContentType, "ChangeJoinType_Notification", 114);
  __publicField(MessageContentType, "ChangePrivateChat_Notification", 115);
  __publicField(MessageContentType, "ChangeSearchable_Notification", 116);
  __publicField(MessageContentType, "SetGroupManager_Notification", 117);
  //禁言/取消禁言群成员的通知消息
  __publicField(MessageContentType, "MuteGroupMember_Notification", 118);
  // 全局禁言之后，允许群成员发言的通知消息
  __publicField(MessageContentType, "AllowGroupMember_Notification", 119);
  //踢出群成员的可见通知消息
  __publicField(MessageContentType, "KickOffGroupMember_Visible_Notification", 120);
  //退群的可见通知消息
  __publicField(MessageContentType, "QuitGroup_Visible_Notification", 121);
  __publicField(MessageContentType, "ModifyGroupExtra_Notification", 122);
  __publicField(MessageContentType, "ModifyGroupMemberExtra_Notification", 123);
  __publicField(MessageContentType, "VOIP_CONTENT_TYPE_START", 400);
  __publicField(MessageContentType, "VOIP_CONTENT_TYPE_END", 402);
  __publicField(MessageContentType, "VOIP_CONTENT_TYPE_ACCEPT", 401);
  __publicField(MessageContentType, "VOIP_CONTENT_TYPE_SIGNAL", 403);
  __publicField(MessageContentType, "VOIP_CONTENT_TYPE_MODIFY", 404);
  __publicField(MessageContentType, "VOIP_CONTENT_TYPE_ACCEPT_T", 405);
  __publicField(MessageContentType, "VOIP_CONTENT_TYPE_ADD_PARTICIPANT", 406);
  __publicField(MessageContentType, "VOIP_CONTENT_TYPE_MUTE_VIDEO", 407);
  __publicField(MessageContentType, "CONFERENCE_CONTENT_TYPE_INVITE", 408);
  __publicField(MessageContentType, "CONFERENCE_CONTENT_TYPE_CHANGE_MODE", 410);
  __publicField(MessageContentType, "CONFERENCE_CONTENT_TYPE_KICKOFF_MEMBER", 411);
  __publicField(MessageContentType, "CONFERENCE_CONTENT_TYPE_COMMAND", 412);
  __publicField(MessageContentType, "VOIP_Multi_Call_Ongoing", 416);
  __publicField(MessageContentType, "VOIP_Join_Call_Request", 417);
  __publicField(MessageContentType, "MESSAGE_CONTENT_TYPE_FEED", 501);
  __publicField(MessageContentType, "MESSAGE_CONTENT_TYPE_COMMENT", 502);
  function compare(a, b) {
    const longA = Long.fromValue(a);
    const longB = Long.fromValue(b);
    return longA.compare(longB);
  }
  function eq(a, b) {
    if (!_isLong(a) || !_isLong(b)) {
      return false;
    }
    return compare(a, b) === 0;
  }
  function gt(a, b) {
    if (!_isLong(a) || !_isLong(b)) {
      return false;
    }
    return compare(a, b) === 1;
  }
  function gte(a, b) {
    if (!_isLong(a) || !_isLong(b)) {
      return false;
    }
    return compare(a, b) >= 0;
  }
  function lte(a, b) {
    if (!_isLong(a) || !_isLong(b)) {
      return false;
    }
    return compare(a, b) <= 0;
  }
  function stringValue(l) {
    const longl = Long.fromValue(l);
    return longl.toString();
  }
  function longValue(value) {
    return Long.fromValue(value);
  }
  function numberValue(l) {
    if (lte(l, Number.MAX_SAFE_INTEGER)) {
      const longl = Long.fromValue(l);
      return longl.toNumber();
    } else {
      formatAppLog("log", "at wfc/util/longUtil.js:118", l, "is large than Number.MAX_SAFE_INTEGER, do nothing");
      return l;
    }
  }
  function _patchToJavaLong(jsonStr, key) {
    if (!jsonStr) {
      return jsonStr;
    }
    let reg = new RegExp(`"${key}":"([0-9]+)"`, "g");
    return jsonStr.replace(reg, `"${key}":$1`);
  }
  function _reverseToJsLongString(jsonStr, key) {
    if (!jsonStr) {
      return jsonStr;
    }
    let reg = new RegExp(`"${key}":([0-9]+)`, "g");
    return jsonStr.replace(reg, `"${key}":"$1"`);
  }
  function _isLong(val) {
    try {
      Long.fromValue(val);
      return true;
    } catch (e) {
      return false;
    }
  }
  class QuoteInfo {
    constructor() {
      __publicField(this, "messageUid");
      __publicField(this, "userId");
      __publicField(this, "userDisplayName");
      __publicField(this, "messageDigest");
    }
    static initWithMessage(message2) {
      let info = new QuoteInfo();
      if (message2) {
        info.messageUid = message2.messageUid;
        info.userId = message2.from;
        let userInfo = wfc.getUserInfo(message2.from, false);
        info.userDisplayName = userInfo.displayName;
        info.messageDigest = message2.messageContent.digest();
        if (info.messageDigest.length > 48) {
          info.messageDigest = info.messageDigest.substr(0, 48);
        }
      }
      return info;
    }
    encode() {
      let obj = {
        u: stringValue(this.messageUid),
        i: this.userId,
        n: this.userDisplayName,
        d: this.messageDigest
      };
      return obj;
    }
    decode(obj) {
      if (obj.messageUid) {
        this.messageUid = Long.fromValue(obj.messageUid);
        this.userId = obj.userId;
        this.userDisplayName = obj.userDisplayName;
        this.messageDigest = obj.messageDigest;
      } else {
        this.messageUid = Long.fromValue(obj.u || obj.messageUid);
        this.userId = obj.i;
        this.userDisplayName = obj.n;
        this.messageDigest = obj.d;
      }
    }
  }
  class TextMessageContent extends MessageContent {
    constructor(content, mentionedType = 0, mentionedTargets = []) {
      super(MessageContentType.Text, mentionedType, mentionedTargets);
      __publicField(this, "content");
      __publicField(this, "quoteInfo");
      this.content = content;
    }
    digest() {
      return this.content;
    }
    encode() {
      let payload = super.encode();
      payload.searchableContent = this.content;
      if (this.quoteInfo) {
        let obj = {
          "quote": this.quoteInfo.encode()
        };
        let orgStr = JSON.stringify(obj);
        let str = orgStr.replace(/"u":"([0-9]+)"/, '"u":$1');
        payload.binaryContent = wfc.utf8_to_b64(str);
      }
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.content = payload.searchableContent;
      if (payload.binaryContent && payload.binaryContent.length > 0) {
        let quoteInfoStr = wfc.b64_to_utf8(payload.binaryContent);
        quoteInfoStr = quoteInfoStr.substring(0, quoteInfoStr.lastIndexOf("}") + 1);
        quoteInfoStr = quoteInfoStr.replace(/"u":([0-9]+),/, '"u":"$1",');
        let obj = JSON.parse(quoteInfoStr).quote;
        this.quoteInfo = new QuoteInfo();
        this.quoteInfo.decode(obj);
      }
    }
    setQuoteInfo(quoteInfo) {
      this.quoteInfo = quoteInfo;
    }
  }
  class PTextMessageContent extends TextMessageContent {
    constructor(content, mentionedType = 0, mentionedTargets = []) {
      super(content, mentionedType, mentionedTargets);
      this.type = MessageContentType.P_Text;
    }
  }
  const _Config = class _Config {
    static getWFCPlatform() {
      if (_Config.platform > 0) {
        return _Config.platform;
      }
      let info = uni.getSystemInfoSync();
      formatAppLog("log", "at config.js:85", "systemInfo", JSON.stringify(info));
      if (info.osName === "ios" || info.platform === "ios") {
        _Config.platform = info.deviceType !== "phone" ? 8 : 1;
      } else if (info.osName === "android" || info.platform === "android") {
        _Config.platform = info.deviceType !== "phone" ? 9 : 2;
      } else {
        _Config.platform = 10;
      }
      return _Config.platform;
    }
    static config(options) {
      Object.keys(options).forEach((key) => {
        _Config[key] = options[key];
      });
    }
    /**
     * 网络地址重定向
     *
     * 仅当双网环境时，需要特殊处理，默认原样返回
     *
     * @param {string} url
     * @return {string} newUrl
     */
    static urlRedirect(url) {
      if (!url) {
        return url;
      }
      return url;
    }
    /**
     * 表情 base 路径
     * @return {string}
     */
    static emojiBaseUrl() {
      let emojiBaseUrl = "https://static.wildfirechat.net/twemoji/assets/";
      return emojiBaseUrl;
    }
    /**
     * 动态表情 base 路径
     * @return {string}
     */
    static stickerBaseUrl() {
      let stickerBaseUrl = "https://static.wildfirechat.net/sticker/";
      return stickerBaseUrl;
    }
  };
  // 调试用
  __publicField(_Config, "ENABLE_AUTO_LOGIN", true);
  // 是否支持多人音视频通话
  __publicField(_Config, "ENABLE_MULTI_VOIP_CALL", true);
  // 是否支持1对1音视频通话
  __publicField(_Config, "ENABLE_SINGLE_VOIP_CALL", true);
  __publicField(_Config, "DEFAULT_PORTRAIT_URL", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAFfgAABX4BPgLDIQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAWCSURBVHic7Z3/T9R1HMefn7vPHXfenXeAw0a4UHSVmptKzK0knVqr+MEfwpyuzdqarVqzWcu5WrOfWuZixZitn8TNctRqTdaKvqDpzAoGZKQQaAQUJhwHx32/+/SDc7NT2u58fz7vJ/J+/AHv1xsevL9+Xu8XmmEYBhQ02GR3QPFflBAylBAylBAylBAylBAylBAylBAylBAylBAylBAylBAylBAydNkdyJdo3MDgSAojY2mkUlcurHVdw23FdpSV6HAVaJJ7mB8zSsjEVAYtP0TQ2hZFd38SqfSNvxzodg3LKpxYt9qNTWvc8M2ZOROBNhO+h8STBo58MYmPvgojFs+tu64CDVsf9GL7wz44Hfyjhl7IuYsJvPFBEEOXUjfVzoL5Ol57ugh33uEQ1DNzoBZy7Psp1B0JIZkS00WHruHF7QE8ev8cIe2ZAa2QD78M4+DHIeHtahrwbK0fWzZ5hbctAsrVruVMBO9/Il4GABgG0NAUwjc/Rk1p/2ahE9I/lMTbh8dh5rg1DGB/YxAXhpPmBckTOiH1R0M576TyIRo3cMBk8flAJeR0Vwxtv8Uti/fL7wkcb+eauqiENDZPWh6zqSVsecz/g0bIxeEUuvsTlsc925fAnyM3d8YRCY2QU53ypo5THTFpsbOhEfJrn/Wj4ypnJcbOhkbIwN/ypo0//uLZ/tIIGQ2lJcbOSIudDY0QK84e0xGNKyHXkZF4QMvw+OARoriCEkKGEkKGEkKGEkKGEkKGEkKGEkIGjRC7xJ44dJ58LRohHonZhR63EnIdJYV2abHnF8mLnQ2NkEVl8jIKKxbwZDPSCFl1V4G02JV3u6TFzoZGyJrlLikLu0PXcO9SeX8M2dAIKZxrwwOr3ZbH3VDlxlwvza+BRwgAPLbBC83CDY/NBtRu5MrxpRKyrMKJ9ZXWjZJH7vNgMdGCDpAJAYBd2wIo9pu/DS0r0fH8437T4+QKnRC/14Y9OwKmLvAFDg17niyEm/AdIp0QAKha7sLepwphM6F3Dl3DvmeKcM9ip/jGBUD7YAcAunoTeLVhFKGwmCwEv9eGN18oxtKFnDIA0hFylRVLnKheJW6Rr17lppYBkAuZjSghZCghZCghZCghZCghZFALSaUN9A+Je7sxeClF9+o2G9qDYc9AEm8dCqJ3QOxjmrUrXdi1LYB5AZ7PttdCJ6RvMInG5kmcaIua9kTBXaChZq0HtRu9mF/MJYZGSO9AEoeOTeJkR9SyaUW3a1hf6cbWh7w01/BShSRTBk60x/BZaxhdvXIfXq5Y4sTm9V5Ur3RJzdOSIiQcyaDp6zA+/W5K2MWhKAI+Gzav82DLJi88buv3PJYKSaUNfH48gsbmCQQnuERkU+S3Y0eNDzXVHkuTLywTcrorhoamkNTnz/lQXqrjuVo/qpZbkypkupBwJIP9jeNobeMq8pIr6yrdePmJALwmp7yaKqR/KInXD47NuFExHeWlOvbtLEZ5qXnFXE0T0tETx976MUxFudeKXAn4bHhn9zwsut2cbbIpQs5fTGDXgcuIxCiOOMIJ+Gyo2z0PC02QInxCHAul8cq7o7esDAAYn8zgpTpx3/qvRbiQ946GEJy8taapG3F5PI36o+ILdQoV0nE+jm9/mtm7qVxoORMRfsMgVIiMEn0yMQzgsOCfWZiQkdE02s9ZV8CShZ+7Y/gnKK60lDAhJzutu6VlImMApzrFlQgUJqSrh6dMntV09oibGYQJYawSbRUXhsXdRAgTMkZUJs9qRJYnFCYkEpu9QiJRcYunMCHp2etj2n+9lA/Cri337SwS1dSshibJQXEF6kS52YgSQoYSQoYSQoYSQoYSQoYSQoYSQoYSQoYSQoYSQoYSQoYSQoYSQoYSQsa/0LPTp+EdzPEAAAAASUVORK5CYII=");
  __publicField(_Config, "DEFAULT_ORGANIZATION_PORTRAIT_URL", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAACXBIWXMAAAsTAAALEwEAmpwYAAABlUlEQVR4nO2aIW7DQBBFc409UJRD9AoFJr1DeUADSrogoDws8EslloKCLeUEOcDWEzWtii133d2xH/h0ZD/9Pzs72lVSMBRGM1gBL/zJQAAUAK1kinCgAGg4UH4nASIsABoOVPkoEmEtBGDcN5PodFgvA+Dm+WMSfUFcDMDm/WK79jObANgC0HAgETZ6oDhEjENEnMKMMWIONAbplkHauIlwlTPuwprhMuFhd74vFHJpccuEDeus6UHHfXMHXcJVVTswARCACQcGIpwqaDP0QAHQcKAYY4wxpkLFJQ3Sp8M6+1ONp5fX3ztublUHMP64xYuqBZgyfpiXmgAUAA0Higibh35FDxQADQc6jltkjAkATDjQb9wiEQ6+AY5dGqQZ1MwKcHu8DNLj23nwz9ZeMyvA7toP0vb4/W5lDjUBeAWg4UARYRf9KtIDewB2ONBv3CIR7gHY4UC/cYtEuAdghwP/Z00UndTMskwY+worzaBmFoAoADBlNgIOFACtZGvBgQKg4UD5PeGJsABoOFDlo0iEVQbgDWanvolAkB8PAAAAAElFTkSuQmCC");
  __publicField(_Config, "DEFAULT_DEPARTMENT_PORTRAIT_URL", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs4c6QAAAIRlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAAFCgAwAEAAAAAQAAAFAAAAAAwtohTAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KGV7hBwAAAjlJREFUeAHt28FOwkAQgOGt8UF4Cg0nOJjo1bfgEfRkPekj8BZeOGjigRuRcNeTJ30NsW0g2UzatTNTpE3+JiS7dGba/dgAW0oIbAgggAACCCCAAAIIIIAAAgMTyI59vlcPq2lxDuVDtT3fjnNVwoGCTw9UV1N2us3CnSZhF5sbcjpP6QNgNajri7NWg/v4/A7vxaMv20lfTmSo5wGg85UDEECngDOdGQigU8CZzgwE0CngTGcGAugUcKYzAwF0CjjTmYEAOgWc6b25nPX0unYO5TjpfQBcZtvawY9+QhgV7zHL2r08mRYoLvXnl4+retp06r/u5UPEyQ0ggE4BZzozEECngDOdGQigU8CZ3smtHdbbM1LnXnyJnmZZmBRfsu9TcZZ9Xd4W0tVKxHp7RuP496+s8baPxrq7HflfAW33dwVYHe/lZrwfd9vjN8aVK5ES7xA1Gw9q2MGHiAEtTgEw1jC0ATSgxSkAxhqGNoAGtDgFwFjD0AbQgBanABhrGNoAGtDiFNXKIbHmTf4AlFp7DqVmjBa3tUu5xjVv+UoUvwBN4uJRO4/asjmUmvK8q74WsEqaz85ri8knF5uvsNi0+0vCUGrKMfIeKEWUfQCVYDIcQCmi7AOoBJPhAEoRZR9AJZgMB1CKKPsAKsFkOIBSRNkHUAkmwwGUIso+gEowGQ6gFFH2AVSCyXDT5azZ/E3WcfeHUlMOVAvY9JcEWVfTH0pNzZiIRQABBBBAAAEEEEAAAQQQ6K/ALz1vZTdxNVa5AAAAAElFTkSuQmCC");
  // 视频消息发送完成之前，无法拿到缩略图，故显示一个占位图，256x256
  __publicField(_Config, "DEFAULT_VIDEO_POSTER", "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAY/klEQVR4nO3de6yV1ZnH8W9PTggxhBhCDEOIMYYSYgyxDOMwjsOsodYyahHvtVbrhdZ6q+NUShtCiGMYq9bqVNEW75eqY62ll1GGWnyGOMQSa40xxjiEEEIIYwhhDCGEkJP541n7uDnuc/btffd6L79PQjgczn7PI5732etd61nPAhEREamfz6UOQHpjZpOAk4DZwFzg8/HjE4CpwBRguOn3g8DRpkuMxM+NNP3dIeBI/PPh+Hvj4/+LHx9o+rU//toXQjic13+r5EcJoODMbAg4GVgA/BV+s8/Gb/5J6SL7jAPAbmAn8D7wJ2AbsDuEMJIwLpmAEkCBxJt9Fp/e7AuA+cC0lHH1aQ/wDvBH4G1gWwhhf9qQpEEJIKF4w88EFgNfAgKeAKrsCPAesBl4A9gaQvgkbUj1pQQwQPGGnwoswm/4xfiQfihlXIkdxh8VDHgNeCeEcCRpRDWiBJCzpmH9MuB84EyK9exeNLuAjcCvgC0hhEOJ46k0JYAcxJt+NrAUuAh/lh9OGlQ5HQA24clgYwjhQOJ4KkcJICPxpj8R+DpwAXAa9R7aZ+0AsAF4FnhTjwnZUALok5lNBpYA3wTOQsP7QdgBvAT8HPhAy4y9UwLoQdMQ/xr8Hb/qM/dFNQK8CTwC/C6EcDBxPKWjBNCFWH23BLgFX7LTc31x7AIeB55CxUcdUwLogJlNBS4GbgXmJQ5HJnYInytYhxcdHW3z9bWmBDABMzsBuBa4AZ/gk/IYwVcQ7sYnDZUIWlACaMHMTgRuA66i3GW44olgM3AfsFmrB8dSAmhiZtPxYf7NwPGJw5HsbQHuAl7XiMApAQBmNgUf6q/Ea/OluhqPBmuAt+s+WVjrBBDX8C8EVuM1+VIfR/BagjuB7XVNBLVMAHEdfyFwL3BG4nAkrYPAeuDeEMLe1MEMWu0SQJzZXw0sByYnDkeKYzf+CPhynSYKa5MAYhHPMnxZ6KS00UiB/QZYEUL4KHUgg1CLBGBmc/Ebf2nqWKQU9gNrgZ9WfTtypRNAnORbjk/0aFlPurUVuCGE8F7qQPJS2QQQi3n+DR/2i/TqAPAD4Kkqdj6uXAIws2HgPOBBtEtPsvMycFsIYXfqQLJUqQRgZtOAO4Bvo516kr1dwE14d6JKVBJWJgGY2TzgSbyNtkhejgA/AtZWYYKw9AkgDvmX4ds/T0gcjtTHq8D1ZX8kKHUCMLPjgFXA7agVlwzedrwr1NaylhKXNgGY2UzgZ/iEn0gqnwAr8FWC0lUQljIBmNlpwAtoA48UwwjwE2BV2eYFSpUA4iaexXhr6BmJwxEZ62V8XqA0Zx+Wpm99vPm/BvwS3fxSTBcDv45FaKVQigQQS3pvx5f5piYOR2QiZwK/j4+phVf4R4A4038X8J3UsYh0YS9wWQhhS+pAJlLoBBBbdd2Pb+gRKZt9wJUhhI2pAxlPYRNAvPnX4Z15RcrqAHAFXj5cuFqBQs4BxIM4Hkc3v5Tf8fiS9YVxIrtQCjcCiDf/k3izTpGqOAhch7ccK8xIoFAJIN78T6M9/FJNB/HS4VeKkgQKMySJs/3r0M0v1TUFf7RdkjqQhkIkgLjOfx9+1LZIlU0FnjWzkDoQKEACiN16G008ROpgGvCCmZ2eOpCkCSDu5f9e/CVSJzOAX5rZqSmDSDYJGJdErgIeRe27pL7eB74cQtiT4punHAEEvGuvbn6ps1OBJ+MK2MAlSQBmdgq+3KeNPSJwNnBXnA8bqIEngHg237OoZbdIsxuBmwddLTjQbxbX+h9FnXtFWlnLgI+vG1gCiJltJTqfT2Q8k4GfxUfkgRjkCOAc4PsD/H4iZXQC8LiZDeQsy4EkADObg3fwVetukfYWAmtjnUyuck8AcXnjUWBm3t9LpEK+jffAzFWuCSBmsDXAojy/j0gFDQH3591bMO8RwNnAzTl/D5GqmoZPCk7J6xvklgDMbAZe6afnfpHenQ6szKs+IJeLxqH/XcDsPK4vUjO3A2fkceG8RgDLUD8/kaxMBtblsTSYeQIws1n40D95rwGRCpkHrMn6USDTi8Wh/91oyU8kDzfiJw9lJut36bOASzO+ZtUcTR2AlNYk4L64pyYTmSWAWPBzL9rf386LwCagdGfJSyEsAL6V1cWyHAF8B29uIBN7A7gAuAnYjp8tL9KNVWZ2UhYXyiQBmNlcYEUW16qBkRDCoRDCY8DfAw8ApTlPXgphOhntFeg7AcQg1qLuPp062Pgg9oFbAfwjeiyQ7lyKt9XrSxYjgIAO8+jGMZOAIYSREMI24HzgBvRYIJ0ZxkcBk/u5SF8JIH7zO/q9To0cZZxVgBDC4RDCE8AXgfXAJ4MMTErpdODifi7Q7427jJxKFCtqhDbD/BDCLnyC8AJgS7uvl9pb3U9H4Z4TQNyhtKbX18v44mPBZuBc4LvATvRYIK3NAZb3+uJ+RgDXAnP7eL20EUI4GEJ4CPgS8AxNE4giTVbEbttd6ykBxE0JK3t5rXQvhLAd+CZwGbANVRPKsWYAt/bywl5HAFehev+BCiEcDSG8CnwZf/RKcpSUFNZyM5ve7Yu6TgDx2b+nbCOM0Oe7dwjhQAjhX/HagZeBQ1kEJqV3Aj3MBfQyArgUOLmH14nf/JnM6ocQ3gOuAK4B3kOThAK3dLsi0FUCiOv+KvktiBDCkRDCS/gk4T3AvsQhSVozgau7eUG3I4ClaOa/cEIIHwOr8GXDV4HDaSOShG7ppoloxwkg1vzf1lNIkrumkuJL8JLij9BjQR3NpovS/G5GAPPx0kMpsLjT8Cm8pPgh4EDaiCSB6zvdKdhNAri+y6+XhEIIu/ER2/nAZlRSXCdn4D0E2+roho5VRn1tOpDBi48FW/AkoJLi+hjCHwM7+sJOfA3t9y+tMSXFT6CdhnVwaSeFQW0TgJlNwstQpX9HSFi4E0uKb8BLit9CJcVVNhX4ersv6mQEsBA4pe9wpBBiSfFGvJJwNSoprrJr2k0GdpIArswoGCmQWFL8Q3xvwUuopLiK5tFmMnDCBBALCtTuq8JCCO/jSV4lxdV0xUR/2W4EsATvQCoV1lRS/GXgR6ikuEoujPN4LY2bAOIZZBNmD6mWEMJe4AfAV4CNqHagCk5iguPEJhoBTAfOzjoaKbZYO/AWcBFwC+pSXAWXj/cXEyWApUBmZ5BJucSS4vV47YC6FJfbsvHah0+UAM7NKRgpkRDCTnwkcBHwJqodKKPp+HL+Z7RMAPH00cV5RlRjpRtOx9qB1/G5gZXArsQhSfe+0uqT440AFqHS3zwcpcR79WPtwI/xIqLnUJfiMlkSJ/aPMV4CaJktpG+le/dvJYTwAXAdXj/wNnosKIO5eK+AY3wmAcTSwSWDiEjKK9YObMBHA3cCexOHJBMbAs5p9cmx5qKmn9KhEMK+EMK/4JPGGyjxI04NfGZiv1UCCPnHIVUTQngHX2++DviAijzuVMzCOME/qlUC+IcBBSMVE084fh4vKX4A2J84JDnWFGBB8yeOSQDx+X/cskGRTsR2ZCvwE45fRyXFRbKo+Q9jRwBz8BNGRPrS1I7sArw34Q70WFAEf9f8h7EJYBEiGYrtyB7GHwvUjiy9hc1lwWMTgJ7/JRdN7cguR+3IUpoKnNb4w9gE0LJeWCQLTSccn4ufcLw7cUh1dUbjg9EEEFt/z0oSTn2MoAkxQgj74wnH56J2ZCl8ofFB8wjgNHTwR976Ph68SuIJx99A7cgGbX7jg7EJQGSgYu2A2pEN1pzGAaLNCeAvEwUjonZkgzUMnArHJoD5rb9WZDCa2pFdAtyK2pHlaT7EBGBmU/HmgSLJxdqBn+I7DVU7kI8vwKcjgNn4sECkMMYcZbYVTaBmaS4cmwBECqfpKLOvAKtQ7UBWTgYlACmJWDtwD/5Y8CKqHejXDDOb0kgAn08aikiH4lFm1+D1A++iScJeDQGzGwngxJSRiHQj1g68jI8G7kG1A706sZEAtAVYSifWDqwCzke1A72Y3kgAM5KGIdKjWDuwFa8d0FFm3ZkxFLsATUsdiUg/Yu3Aeryk+DFUO9CJ4SF8+K9NQFIJIYQdwE34iEC1A20MAcenDkIkS7F2YBOqHWhrCO8UKlI5TbUDjb4DOrNgDCUAqbymvgPfAN5Hk4SjlACkFsb0HfgxOrMA8ASgU4ClNkIIe/Ajzs/Hzyyo9SThEFoBkJqJtQNvAhcB3wV2JQ4pmSFgUuogRFIIIXwSQvgJ/ljwHDXcYDQEHNf2q0QqLITwIX6o6ZXUrDmphv8iQAjhSAjhFXw0UJsNRkoAIk3GbDCq/CShEoDIGE0bjC7CTzmubCWhEoDIOOIk4QP4eYZ7UseTBzUCFRmHmQ3h5+itoaI9M4ZREwWRz4hnZd4GLAemJw4nN8PUcO1TZDxmNgk4B1hNDc7LHKZGa54iEzGzufjxZBdTk/qYYeBg6iBEUoonY12NlwXXqkGuEoDUVpzkC/hw/0xqOCmuBCC1ZGaz8DX+q6hxVywlAKkVM5sMLMOr/U6h4pN87Qyj7qlSE2Y2D7/xlwKTE4dTCMPUZNOD1JeZTQe+hXcLnpk4nEIZDiEcMrMD1Pg5SKopnnlxNj7Jt4AaTvK1MdL4B9mHEoBUiJmdjLf++hrqezmefY0EsAcdES4VYGZT8Jt+BXAyNZ/ka2NvcwIQKa24pr8QH+4vRq3uOrGnkQB2JA1DpA9mNhO4FbiWCm/cycH2RgL4n6RhiPQgrukvxZf2TkXD/W7sCyHsbySAj5KGItIlMzsVH+6fR0027mRsO3y6LLI9YSAiHTOz4/E1/VuAWYnDKbMd8GkC2If3PdM/qBRSXNNfjL/rL0Rr+v36M8RnphDCCPBu0nBExhHX9B8EfkFNd+3l4B049h/yXfx5SqQQ4pr+V/E1/dloki8rI/gBKMckgD+liUXkWHFN/3R8uH8WWtPP2q4Qwj44NgG8kygYkVFmNoNP1/Qr2Ym3AEbv9eYEsBv4GP2jSwKxGWdjTX8eGu7n6c+ND0b/keNE4NtJwpFai2v6TwJPU4NOvAXwVuODsbOpb+AtkSU/+uGO4pr+cnxNv1bNOBM6zAQJ4M3BxlI7w6gTTWNNP+An7mhNf7DeDSGMtgEc+w//Lt4ibOpAQ5LaiGv6K/DlPfWgGLwtzX84ZjgaQjhmeCCSFTObYmbLgdfwUl7d/Gn8V/MfWg293sDbKIn0TWv6hXIE2Nr8iVYJYEuLz4l0TWv6hfNuCOFA8ydaJYC3UT2A9KFpTX812qdfJBvHfuIz/2NCCEeA1wcSjlROXNN/Ov5SQU+x/HbsJ8Zbfvkt3lhRpCPap194u2ix43e8BLAJLxio/Zq1TKxpn/4afLJPa/rFtCmEcHTsJ8cbnh1gzGyhyFhxTX8dvk//DHTzF9l/tPpkywQQ9wW0fIFIXNP/FvCfeCmvCseK7SCwudVfTJSxXwHubvM10p1hSrwO3rSmfwdeylva/5aa2RhCaHkI8EQztLvQ3oCsDVHShBrX9O/CJ4jPRjd/mbww3l+MmwDiY8DPcwlHSsPMJpnZpfhw/3Z08EbZ7MMn9Vtqt0a7AX9+kBoys3nAs/hefa3pl9OG5t1/Y7Ubju7Hq4cuzjQkKTQzmwZ8G7gJmJk4HOnPuMN/aJPR9RhQL2Y2bGbn4CtAd6Cbv+x20mYer5MJqU3o0JDKM7M5wErgUmBK4nAkG8/H0v5xtX2mCyEcAp7JLCQplLimfzM+yXc1uvmr4gjweLsv6nRJ6kl8BlhLPxUR1/TPxIf6Z6D/t1XzKv4IMKFOZ3V3MMFSgpSLmc0C/g34NSroqapH4hzehDpKAPFCj/QdkiStBDSzyWZ2NfB74EbUlquqPgCsky/sZl13MzpGvF/JKgHNbAG+aecRYC5a06+yx9tN/jV0/EMQG4au6zkkScLMppvZHfjS3nloi3fV7aOLSftu342ewZeKZnT5OhmwuE//HHyf/jxKugdBuvZY4+DPTnQ1DAwh7EdzAYUX1/Qfx4u45qObvy4+octRei8/GD/FO71O6+G1kiMzm4Lvz78NL9zSc369PBNC2N3NC7r+AQkhfAw80e3rJD9mNmRmi/Hn/Hvxc/Z089fLYeD+bl/U6w/Jg/hwQxIzsxPxYd8vgUVouF9XL9JB4c9YPSWAEMIuYH0vr625zJYBzey42JbrDXTUVt0dBO7upPBnrH5+GO8DrkIHiHSj70KgWMK7EC/hXdTv9aQSngghfNjLC3t+Tgwh7MWfN2VAYluuu/G2XDpnT8DX/e/u9cX9DkfXA9cDs/u8jkwgHrV1MbAKVfHJse4PIezp9cV9/SDFTqNr+7mGTCy25fp3fF3/FHTzy6d2Ag/3c4EsJqRewltHLcjgWhLFtlw3Azegyktp7c6xp/12q+93k9gw5Lt4AwJpb8J/89iWaxm+Y281uvmltS3A8/1eJKvh5FbguYyuVWWTmGAzjpmdgnfhVQmvTOQwsDJu0OtLJgkgHjq4BtibxfXqxsymmtn3gD8AXwWOSxySFNt6YFsWF8psQinWIK/J6noVNnqOXhzuL8GH+2vRcF/a2wWs7aXop5WsZ5SfQceJtTMEozv2HsWbdOhYbenUqrgfJxOfy+pCDbHzzBuou+x4VuMTpreivvvSnQ3AZZ12++lEHglgCO8g3HN1UsUdxCcC9Y4v3dgL/E0IYWeWF808AYBvVMHLVRfncX2RmhkBrgghvJj1hXOpKou1AbfgZwuKSH+eB17J48K5lZWGED7Aa9dFpHc7gBVZPvc3y7uu/Cng5Zy/h0hVHQFuijtvc5FrAoiVSrcCH+X5fUQq6ofkfCJXLpOAY5nZmcBraGlQpFOvApfE+bTcDGpr6VY0HyDSqZ3ADXnf/DCgBBDLFteTwe4lkYo7DFwf+27mbmDNJeJ8wG3Ae4P6niIltAZ4fVDfbKDdZWIN8xVo16BIK48BP8lqo08nBjIJOJaZnQX8Ck0KijS8DlwU2+wNTKr+cpvx5cGjib6/SJF8AFwz6JsfEiWAOMR5Bl/nFKmzvcDl3Z7pl5UkjwANZjYZP2346pRxiCTyCb7Wn2uxz0SStphuqhT8Tco4RBI4DFzHAGf8W0k6AmiILbB/gbYPSz0cBb6JH+c9sBn/VgpxyEQIYT++PPhW6lhEcjaCt9FPfvNDQRIAjJ41eBnwfupYRHK0Bni4CDc/FCgBwOix4xfhyyIiVTKCr3rdE9voF0Ih5gDGMrMT8UKh+aljEcnACN4M9kd5NfboVaFGAA1xJHABvotQpMyOAiso4M0PBR0BNJjZDHx14MzUsYj04Ag+4ffTIg37mxU6AQCY2XT8vLwlqWMR6cJh/GTnQsz2j6eQjwDNQgj78NWBZ1LHItKh/cDlFPzmhxKMABpi2fBq4PuUIHFJbe3Ca/tLMX9VmgQAfpgmsBy4nwmO2RZJ5B385i9NE9xSJQAYPXpsKfA4MC1xOCING/EtvaVqdlO6BNAQDyF9GjgldSxSayPAQ8DqFPv5+1XaBACjy4TrgAtTxyK1dADvc/lcUZf52il1AoDRg0j/GZ8gnJQ4HKmPD4FvhBC2pQ6kH6VPADA6L3Ae8DNgRuJwpPo24H37S/W830olEkCDmc3FHwnUV0DycBC4E3hoEId2DEKlEgCMPhL8E34S0XGJw5HqeA+4HthW9OKeblQuAcDoI8EZ+COBVgmkH0fxU61Wx8Y1lVLJBNAQW43dBVwLDCcOR8pnN3AL8LuyzvK3U+kEAKPVg2cD9wFzE4cj5XAUeA5YFULYkzqYPFU+ATTE0cBK4GY0NyDjex/fwru5qu/6zWqTAGB0bmABPhpQjwFpdgh4ALg3hHAgdTCDUqsE0BBXCq7Ci4dmJg5H0hoBNgE/AN6r0gx/J2qZABrM7AS8lPNGYGricGTw3sG79G4qYruuQah1Amgws9n4aOCrqJy4DnbhBT3PV6Wgp1dKAFHT/MAafNVAy4bV8zHwIN6Xv3Jr+r1QAhgjLhuejj8TLkGJoAr24ofQPhxbzEmkBDCOOCKYjyeC89CjQRntwd/x1+sdvzUlgDZiIjgVXxu+EJiSNiLpwIf4O/5TZWzSMUhKAB2KiWAGcDV+rPPJSQOSsY7iR22vA16PR89LG0oAPYgdis/D+74H1KU4pf3A8/g7/od1W8fvlxJAH5oeD67AlxBPTBtRbRwF3sQPjNmg5/veKQFkxMwm4aOBK/GuxSosyt4HwAv4O/5Ovdv3TwkgB3Hj0VLgEjwpaPNR73YCv8Fv/LfrsEFnkJQAchQfEaYCZ+GnHZ8NTE8aVPGN4DvyfocfEf+ubvr8KAEMUNyEdCZwPt63cA6aQATfifcW8Br+br9dw/vBUAJIJI4OZuGPCF+Mv9dlEvEIvhFnM/AHvM/ewbQh1ZMSQEHEhDAHWAT8Lb4vYQ7VKEU+gN/w24D/Bt6s0577IlMCKDAzOx5PBKcDfx0/nkGxHxsO45V424A/xt8/1HN8MSkBlExcYZiNJ4JZwF8AJ+AHpR6PTzoeh5csT8FHEI3fu3UIH64fir8Oxl8H4q99wP/iNfd78CaaO+q6t15ERESkHP4fiYK9HbFef34AAAAASUVORK5CYII=");
  // APP SERVER的地址，不能省略http(s)前缀。
  // 默认的app server使用端口是8888，注意端口号别忘记了。
  // 上线建议使用https，使用https更安全。
  //static APP_SERVER = 'http://wildfirechat.net:8888';
  __publicField(_Config, "APP_SERVER", "https://app.wildfirechat.net");
  // 组织结构服务地址，如果没有部署组织结构服务，或者不需要组织结构的话，可置为 null
  // 组织结构项目：https://github.com/wildfirechat/organization-platform 或 https://gitee.com/wfchat/organization-platform
  __publicField(_Config, "ORGANIZATION_SERVER", "https://org.wildfirechat.cn");
  // 工作台地址，如果不需要工作台，请删除 pages.json 里面，WorkspacePage 相关配置
  __publicField(_Config, "WORKSPACE_URL", "https://open.wildfirechat.cn/work.html");
  // 请仔细看注释
  // 仅仅是 HOST，没有 http 前缀，后面也没有端口
  // IM SERVER 的 host 地址，一定要和 APP_SERVER 对应起来，即 APP_SERVER 上配置的 im-server 和下面所配置的im-server 是同一个
  __publicField(_Config, "IM_SERVER_HOST", "wildfirechat.net");
  __publicField(_Config, "QR_CODE_PREFIX_PC_SESSION", "wildfirechat://pcsession/");
  // 如果使用的是高级版音视频 SDK，则不需要配置 ICE_SERVER，否则需要配置。<br>
  // 请参考 src/wfc/av/internal/README.MD 切换音视频 SDK <br>
  // turn server 配置，可以添加多个<br>
  // 格式: [uri, 用户名, 密码]，可以添加多个<br>
  // Turn服务配置，用户音视频通话功能，详情参考 https://docs.wildfirechat.net/webrtc/ <br>
  // 我们提供的服务能力有限，总体带宽仅3Mbps，只能用于用户测试和体验，为了保证测试可用，我们会不定期的更改密码。<br>
  // 上线时请一定要切换成你们自己的服务。可以购买腾讯云或者阿里云的轻量服务器，价格很便宜，可以避免影响到您的用户体验。<br>
  __publicField(_Config, "ICE_SERVERS", [{ uri: "turn:turn.wildfirechat.net:3478", userName: "wfchat", password: "wfchat123" }]);
  __publicField(_Config, "LANGUAGE", "zh_CN");
  // 允许主动加入多人音视频通话
  __publicField(_Config, "ENABLE_MULTI_CALL_AUTO_JOIN", true);
  // 是否启用语音对讲功能，语音对讲是和对讲机类似的功能，不是和微信类似的，发送语音消息功能
  // 启用后，请联系官方获取对讲插件
  __publicField(_Config, "ENABLE_PTT", false);
  // 是否启用音视频通话功能
  __publicField(_Config, "ENABLE_VOIP", true);
  __publicField(_Config, "SDK_PLATFORM_WINDOWS", 3);
  __publicField(_Config, "SDK_PLATFORM_OSX", 4);
  __publicField(_Config, "SDK_PLATFORM_WEB", 5);
  __publicField(_Config, "SDK_PLATFORM_WX", 6);
  // uni-app 默认录音格式为mp3
  // 如果只有 uni-app 端，没有Android、iOS、Web、小程序 或者 PC 端时，录音可以直接播放，可将下面的AMR_TO_MP3_SERVER_ADDRESS置为""
  // html5 audio 标签不能播放amr格式的音频，需要将amr格式转换为mp3格式
  // 本服务传入amr音频文件的地址，将音频文件转换为mp3格式，并以application/octet-stream的格式返回
  // 如果语音消息很多，建议使用cdn
  __publicField(_Config, "AMR_TO_MP3_SERVER_ADDRESS", _Config.APP_SERVER + "/amr2mp3?path=");
  // 文件传输助手ID
  __publicField(_Config, "FILE_HELPER_ID", "wfc_file_transfer");
  /**
   * 允许重新编辑多长时间内的撤回消息，单位是秒
   */
  __publicField(_Config, "RECALL_REEDIT_TIME_LIMIT", 60);
  __publicField(_Config, "platform", -1);
  let Config = _Config;
  class MediaMessageContent extends MessageContent {
    /**
     *
     * @param {number} messageType 消息类型
     * @param {number} mediaType 媒体类型
     * @param {File | string} fileOrLocalPath File类型，或者dataUri或者本地路径，本地路径是必须是绝对路径
     * @param {string} remotePath 远端地址
     */
    constructor(messageType, mediaType = 0, fileOrLocalPath, remotePath) {
      super(messageType);
      __publicField(this, "file");
      __publicField(this, "remotePath", "");
      __publicField(this, "localPath", "");
      __publicField(this, "mediaType", 0);
      this.mediaType = mediaType;
      if (!fileOrLocalPath) {
        this.localPath = "";
        this.remotePath = remotePath;
      } else if (typeof fileOrLocalPath === "string" && !fileOrLocalPath.startsWith("http")) {
        this.localPath = fileOrLocalPath;
        this.remotePath = remotePath;
      } else {
        this.file = fileOrLocalPath;
        if (fileOrLocalPath && fileOrLocalPath.path) {
          this.localPath = fileOrLocalPath.path;
          if (this.localPath.indexOf(fileOrLocalPath.name) < 0) {
            this.localPath += fileOrLocalPath.name;
          }
        }
      }
    }
    encode() {
      let payload = super.encode();
      payload.localMediaPath = this.localPath;
      payload.remoteMediaUrl = this.remotePath ? this.remotePath : "";
      payload.mediaType = this.mediaType;
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.localPath = payload.localMediaPath;
      this.remotePath = payload.remoteMediaUrl;
      if (Config.urlRedirect) {
        this.remotePath = Config.urlRedirect(payload.remoteMediaUrl);
      }
      this.mediaType = payload.mediaType;
    }
  }
  class MessageContentMediaType {
  }
  __publicField(MessageContentMediaType, "General", 0);
  __publicField(MessageContentMediaType, "Image", 1);
  __publicField(MessageContentMediaType, "Voice", 2);
  __publicField(MessageContentMediaType, "Video", 3);
  __publicField(MessageContentMediaType, "File", 4);
  __publicField(MessageContentMediaType, "Portrait", 5);
  __publicField(MessageContentMediaType, "Favorite", 6);
  __publicField(MessageContentMediaType, "Sticker", 7);
  __publicField(MessageContentMediaType, "Moments", 8);
  class ImageMessageContent extends MediaMessageContent {
    constructor(fileOrLocalPath, remotePath, thumbnail) {
      super(MessageContentType.Image, MessageContentMediaType.Image, fileOrLocalPath, remotePath);
      // base64 encoded, 不包含头部:data:image/png;base64,
      __publicField(this, "thumbnail");
      __publicField(this, "imageWidth");
      __publicField(this, "imageHeight");
      this.thumbnail = thumbnail;
    }
    digest() {
      return "[图片]";
    }
    encode() {
      let payload = super.encode();
      payload.mediaType = MessageContentMediaType.Image;
      payload.binaryContent = this.thumbnail;
      if (this.imageWidth) {
        let obj = {
          w: this.imageWidth,
          h: this.imageHeight
        };
        payload.content = JSON.stringify(obj);
      }
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.thumbnail = payload.binaryContent;
      if (payload.content) {
        let obj = JSON.parse(payload.content);
        this.imageWidth = obj["w"];
        this.imageHeight = obj["h"];
      }
    }
  }
  class PersistFlag {
  }
  __publicField(PersistFlag, "No_Persist", 0);
  __publicField(PersistFlag, "Persist", 1);
  __publicField(PersistFlag, "Persist_And_Count", 3);
  __publicField(PersistFlag, "Transparent", 4);
  class TipNotificationMessageContent extends NotificationMessageContent {
    constructor(tip) {
      super(MessageContentType.Tip_Notification);
      __publicField(this, "tip", "");
      this.tip = tip;
    }
    formatNotification() {
      return this.tip;
    }
    digest() {
      return this.tip;
    }
    encode() {
      let payload = super.encode();
      payload.content = this.tip;
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.tip = payload.content;
    }
  }
  class UnknownMessageContent extends MessageContent {
    constructor(originalPayload) {
      super(MessageContentType.Unknown);
      __publicField(this, "originalPayload");
      this.originalPayload = originalPayload;
    }
    encode() {
      return this.originalPayload;
    }
    decode(paylaod) {
      this.originalPayload = paylaod;
    }
    digest() {
      return "未知类型消息";
    }
  }
  class UnsupportMessageContent extends MessageContent {
    digest() {
      return "尚不支持该类型消息, 请手机查看 : " + this.type;
    }
  }
  class GroupNotificationContent extends NotificationMessageContent {
    constructor(type) {
      super(type);
      __publicField(this, "groupId", "");
    }
  }
  class ChangeGroupNameNotification extends GroupNotificationContent {
    constructor(operator, name) {
      super(MessageContentType.ChangeGroupName_Notification);
      __publicField(this, "operator", "");
      __publicField(this, "name", "");
      this.operator = operator;
      this.name = name;
    }
    formatNotification() {
      if (this.fromSelf) {
        return "您修改群名称为：" + this.name;
      } else {
        return wfc.getGroupMemberDisplayName(this.groupId, this.operator) + "修改群名称为：" + this.name;
      }
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        n: this.name,
        o: this.operator
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.groupId = obj.g;
      this.operator = obj.o;
      this.name = obj.n;
    }
  }
  class KickoffGroupMemberNotification extends GroupNotificationContent {
    constructor(operator, kickedMembers) {
      super(MessageContentType.KickOffGroupMember_Notification);
      __publicField(this, "operator", "");
      __publicField(this, "kickedMembers", []);
      this.operator = operator;
      this.kickedMembers = kickedMembers;
    }
    formatNotification() {
      let notifyStr;
      if (this.fromSelf) {
        notifyStr = "您把 ";
      } else {
        notifyStr = wfc.getGroupMemberDisplayName(this.groupId, this.operator) + "把 ";
      }
      let kickedMembersStr = "";
      let userInfos = wfc.getUserInfos(this.kickedMembers, this.groupId);
      userInfos.forEach((userInfo) => {
        if (userInfo.uid === wfc.getUserId()) {
          kickedMembersStr += " 您";
        } else {
          kickedMembersStr += " " + userInfo.displayName;
        }
      });
      return notifyStr + kickedMembersStr + " 移除了群组";
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        ms: this.kickedMembers,
        o: this.operateUser
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.groupId = obj.g;
      this.operator = obj.o;
      this.kickedMembers = obj.ms;
    }
  }
  class KickoffGroupMemberVisiableNotification extends GroupNotificationContent {
    constructor(operator, kickedMembers) {
      super(MessageContentType.KickOffGroupMember_Visible_Notification);
      __publicField(this, "operator", "");
      __publicField(this, "kickedMembers", []);
      this.operator = operator;
      this.kickedMembers = kickedMembers;
    }
    formatNotification() {
      let notifyStr;
      if (this.fromSelf) {
        notifyStr = "您把 ";
      } else {
        notifyStr = wfc.getGroupMemberDisplayName(this.groupId, this.operator) + "把 ";
      }
      let kickedMembersStr = "";
      let userInfos = wfc.getUserInfos(this.kickedMembers, this.groupId);
      userInfos.forEach((userInfo) => {
        if (userInfo.uid === wfc.getUserId()) {
          kickedMembersStr += " 您";
        } else {
          kickedMembersStr += " " + userInfo.displayName;
        }
      });
      return notifyStr + kickedMembersStr + " 移除了群组";
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        ms: this.kickedMembers,
        o: this.operateUser
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.groupId = obj.g;
      this.operator = obj.o;
      this.kickedMembers = obj.ms;
    }
  }
  class AddGroupMemberNotification extends GroupNotificationContent {
    constructor(invitor, invitees) {
      super(MessageContentType.AddGroupMember_Notification);
      __publicField(this, "invitor", "");
      __publicField(this, "invitees", []);
      this.invitor = invitor;
      this.invitees = invitees;
    }
    formatNotification() {
      let notifyStr;
      if (this.invitees.length === 1 && this.invitees[0] === this.invitor) {
        if (this.fromSelf) {
          return "您加入了群组";
        } else {
          return wfc.getGroupMemberDisplayName(this.groupId, this.invitor) + " 加入了群组";
        }
      }
      if (this.fromSelf) {
        notifyStr = "您邀请:";
      } else {
        notifyStr = wfc.getGroupMemberDisplayName(this.groupId, this.invitor) + "邀请:";
      }
      let membersStr = "";
      let userInfos = wfc.getUserInfos(this.invitees, this.groupId);
      userInfos.forEach((m) => {
        membersStr += " " + m.displayName;
      });
      return notifyStr + membersStr + "加入了群组";
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        o: this.invitor,
        ms: this.invitees
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.groupId = obj.g;
      this.invitor = obj.o;
      this.invitees = obj.ms;
    }
  }
  class ChangeGroupPortraitNotification extends GroupNotificationContent {
    constructor(operator) {
      super(MessageContentType.ChangeGroupPortrait_Notification);
      __publicField(this, "operator", "");
      this.operator = operator;
    }
    formatNotification() {
      if (this.fromSelf) {
        return "您修改群头像";
      } else {
        return wfc.getGroupMemberDisplayName(this.groupId, this.operator) + "修改了群头像";
      }
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        n: this.name
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.groupId = obj.g;
      this.operator = obj.o;
    }
  }
  class CreateGroupNotification extends GroupNotificationContent {
    constructor(creator, groupName) {
      super(MessageContentType.CreateGroup_Notification);
      __publicField(this, "creator", "");
      __publicField(this, "groupName", "");
      this.creator = creator;
      this.groupName = groupName;
    }
    formatNotification() {
      if (this.fromSelf) {
        return "您创建了群组 " + this.groupName;
      } else {
        return wfc.getUserDisplayName(this.creator) + "创建了群组 " + this.groupName;
      }
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        n: this.groupName,
        o: this.creator
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.groupId = obj.g;
      this.creator = obj.o;
      this.groupName = obj.n;
    }
  }
  class DismissGroupNotification extends GroupNotificationContent {
    constructor(operator) {
      super(MessageContentType.DismissGroup_Notification);
      __publicField(this, "operator", "");
      this.operator = operator;
    }
    formatNotification() {
      if (this.fromSelf) {
        return "您解散了群组";
      } else {
        return wfc.getGroupMemberDisplayName(this.groupId, this.operator) + "解散了群组";
      }
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        o: this.operator
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.groupId = obj.g;
      this.operator = obj.o;
    }
  }
  class ModifyGroupAliasNotification extends GroupNotificationContent {
    constructor(creator, alias) {
      super(MessageContentType.ModifyGroupAlias_Notification);
      __publicField(this, "operator", "");
      __publicField(this, "alias", "");
      __publicField(this, "memberId", "");
      this.operator = creator;
      this.alias = alias;
    }
    formatNotification() {
      let notificationStr = "";
      if (this.fromSelf) {
        notificationStr += "你";
      } else {
        let userInfo = wfc.getUserInfo(this.operator, false, this.groupId);
        if (userInfo.friendAlias) {
          notificationStr += userInfo.friendAlias;
        } else if (userInfo.displayName) {
          notificationStr += userInfo.displayName;
        } else {
          notificationStr += this.operator;
        }
      }
      notificationStr += "修改";
      if (this.memberId) {
        let userInfo = wfc.getUserInfo(this.memberId, false);
        if (userInfo.friendAlias) {
          notificationStr += userInfo.friendAlias;
        } else if (userInfo.displayName) {
          notificationStr += userInfo.displayName;
        } else {
          notificationStr += this.memberId;
        }
        notificationStr += "的";
      }
      notificationStr += "群昵称为";
      notificationStr += this.alias;
      return notificationStr;
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        n: this.alias,
        o: this.operator,
        m: this.memberId
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.groupId = obj.g;
      this.operator = obj.o;
      this.alias = obj.n;
      this.memberId = obj.m;
    }
  }
  class ModifyGroupExtraNotification extends GroupNotificationContent {
    constructor(creator, groupExtra) {
      super(MessageContentType.ModifyGroupExtra_Notification);
      __publicField(this, "operator", "");
      __publicField(this, "groupExtra", "");
      this.operator = creator;
      this.groupExtra = groupExtra;
    }
    formatNotification() {
      let notificationStr = "";
      if (this.fromSelf) {
        notificationStr += "你";
      } else {
        let userInfo = wfc.getUserInfo(this.operator, false, this.groupId);
        if (userInfo.friendAlias) {
          notificationStr += userInfo.friendAlias;
        } else if (userInfo.displayName) {
          notificationStr += userInfo.displayName;
        } else {
          notificationStr += this.operator;
        }
      }
      notificationStr += "修改";
      notificationStr += "群附加信息为";
      notificationStr += this.groupExtra;
      return notificationStr;
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        n: this.groupExtra,
        o: this.operator
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.groupId = obj.g;
      this.operator = obj.o;
      this.groupExtra = obj.n;
    }
  }
  class ModifyGroupMemberExtraNotification extends GroupNotificationContent {
    constructor(creator, groupMemberExtra) {
      super(MessageContentType.ModifyGroupMemberExtra_Notification);
      __publicField(this, "operator", "");
      __publicField(this, "groupMemberExtra", "");
      __publicField(this, "memberId", "");
      this.operator = creator;
      this.groupMemberExtra = groupMemberExtra;
    }
    formatNotification() {
      let notificationStr = "";
      if (this.fromSelf) {
        notificationStr += "你";
      } else {
        let userInfo = wfc.getUserInfo(this.operator, false, this.groupId);
        if (userInfo.friendAlias) {
          notificationStr += userInfo.friendAlias;
        } else if (userInfo.displayName) {
          notificationStr += userInfo.displayName;
        } else {
          notificationStr += this.operator;
        }
      }
      notificationStr += "修改";
      if (this.memberId) {
        let userInfo = wfc.getUserInfo(this.memberId, false);
        if (userInfo.friendAlias) {
          notificationStr += userInfo.friendAlias;
        } else if (userInfo.displayName) {
          notificationStr += userInfo.displayName;
        } else {
          notificationStr += this.memberId;
        }
        notificationStr += "的";
      }
      notificationStr += "群成员信息为";
      notificationStr += this.groupMemberExtra;
      return notificationStr;
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        n: this.groupMemberExtra,
        o: this.operator,
        m: this.memberId
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.groupId = obj.g;
      this.operator = obj.o;
      this.groupMemberExtra = obj.n;
      this.memberId = obj.m;
    }
  }
  class QuitGroupNotification extends GroupNotificationContent {
    constructor(operator) {
      super(MessageContentType.QuitGroup_Notification);
      __publicField(this, "operator", "");
      this.operator = operator;
    }
    formatNotification() {
      if (this.fromSelf) {
        return "您退出了群组";
      } else {
        return wfc.getGroupMemberDisplayName(this.groupId, this.operator) + "退出了群组";
      }
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        o: this.operator
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.groupId = obj.g;
      this.operator = obj.o;
    }
  }
  class QuitVisiableGroupNotification extends GroupNotificationContent {
    constructor(operator) {
      super(MessageContentType.QuitGroup_Visible_Notification);
      __publicField(this, "operator", "");
      this.operator = operator;
    }
    formatNotification() {
      if (this.fromSelf) {
        return "您退出了群组";
      } else {
        return wfc.getGroupMemberDisplayName(this.groupId, this.operator) + "退出了群组";
      }
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        o: this.operator
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.groupId = obj.g;
      this.operator = obj.o;
    }
  }
  class TransferGroupOwnerNotification extends GroupNotificationContent {
    constructor(operator, newOwner) {
      super(MessageContentType.TransferGroupOwner_Notification);
      __publicField(this, "operator", "");
      __publicField(this, "newOwner", "");
      this.operator = operator;
      this.newOwner = newOwner;
    }
    formatNotification() {
      if (this.fromSelf) {
        return "您把群转让给了 " + wfc.getGroupMemberDisplayName(this.groupId, this.newOwner);
      } else {
        return wfc.getGroupMemberDisplayName(this.groupId, this.operator) + "把群转让给了 " + wfc.getGroupMemberDisplayName(this.groupId, this.newOwner);
      }
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        o: this.operator,
        m: this.newOwner
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.groupId = obj.g;
      this.operator = obj.o;
      this.newOwner = obj.m;
    }
  }
  class FileMessageContent extends MediaMessageContent {
    constructor(fileOrLocalPath, remotePath, name, size) {
      super(MessageContentType.File, MessageContentMediaType.File, fileOrLocalPath, remotePath);
      __publicField(this, "name", "");
      __publicField(this, "size", 0);
      if (fileOrLocalPath && fileOrLocalPath.name) {
        this.name = fileOrLocalPath.name;
        this.size = fileOrLocalPath.size;
      } else if (remotePath) {
        this.name = name ? name : remotePath.substring(remotePath.lastIndexOf("/") + 1);
        this.size = size ? size : 0;
      }
    }
    digest() {
      return "[文件]" + this.name;
    }
    encode() {
      let payload = super.encode();
      payload.searchableContent = this.name;
      payload.content = this.size + "";
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      if (payload.searchableContent) {
        this.name = payload.searchableContent;
        this.size = Number(payload.content);
      }
    }
  }
  class VideoMessageContent extends MediaMessageContent {
    constructor(fileOrLocalPath, remotePath, thumbnail, duration = 0) {
      super(MessageContentType.Video, MessageContentMediaType.Video, fileOrLocalPath, remotePath);
      // base64 encoded
      __publicField(this, "thumbnail");
      __publicField(this, "duration");
      this.thumbnail = thumbnail;
      this.duration = duration;
    }
    digest() {
      return "[视频]";
    }
    encode() {
      let payload = super.encode();
      payload.binaryContent = this.thumbnail;
      let obj = {
        d: this.duration,
        duration: this.duration
      };
      payload.content = JSON.stringify(obj);
      payload.mediaType = MessageContentMediaType.Video;
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.thumbnail = payload.binaryContent;
      if (payload.content) {
        let obj = JSON.parse(payload.content);
        this.duration = obj.d;
        if (this.duration === void 0) {
          this.duration = obj.duration;
        }
      }
    }
  }
  class StickerMessageContent extends MediaMessageContent {
    constructor(filerOrLocalPath, remotePath, width, height) {
      super(MessageContentType.Sticker, MessageContentMediaType.Sticker, filerOrLocalPath, remotePath);
      __publicField(this, "width", 200);
      __publicField(this, "height", 200);
      this.width = width;
      this.height = height;
    }
    digest() {
      return "[表情]";
    }
    encode() {
      let payload = super.encode();
      payload.mediaType = MessageContentMediaType.File;
      let obj = {
        x: this.width,
        y: this.height
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let obj = JSON.parse(wfc.b64_to_utf8(payload.binaryContent));
      this.width = obj.x;
      this.height = obj.y;
    }
  }
  class SoundMessageContent extends MediaMessageContent {
    constructor(fileOrLocalPath, remotePath, duration) {
      super(MessageContentType.Voice, MessageContentMediaType.Voice, fileOrLocalPath, remotePath);
      __publicField(this, "duration");
      this.duration = duration;
    }
    digest() {
      return "[语音]";
    }
    encode() {
      let payload = super.encode();
      payload.mediaType = MessageContentMediaType.Voice;
      let obj = {
        duration: this.duration
      };
      payload.content = JSON.stringify(obj);
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let obj = JSON.parse(payload.content);
      this.duration = obj.duration;
    }
  }
  const _TypingMessageContent = class _TypingMessageContent extends MessageContent {
    constructor(type) {
      super(MessageContentType.Typing);
      __publicField(this, "typingType", _TypingMessageContent.TYPING_TEXT);
      this.typingType = type;
    }
    digest() {
      return this.content;
    }
    encode() {
      let payload = super.encode();
      payload.content = this.typingType + "";
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.typingType = parseInt(payload.content);
    }
  };
  __publicField(_TypingMessageContent, "TYPING_TEXT", 0);
  __publicField(_TypingMessageContent, "TYPING_VOICE", 1);
  __publicField(_TypingMessageContent, "TYPING_CAMERA", 2);
  __publicField(_TypingMessageContent, "TYPING_LOCATION", 3);
  __publicField(_TypingMessageContent, "TYPING_FILE", 4);
  let TypingMessageContent = _TypingMessageContent;
  class RecallMessageNotification extends NotificationMessageContent {
    constructor(operatorId, messageUid) {
      super(MessageContentType.RecallMessage_Notification);
      __publicField(this, "operatorId", "");
      __publicField(this, "messageUid", new Long(0));
      __publicField(this, "originalSender");
      __publicField(this, "originalContentType");
      __publicField(this, "originalSearchableContent");
      __publicField(this, "originalContent");
      __publicField(this, "originalExtra");
      __publicField(this, "originalMessageTimestamp");
      this.operatorId = operatorId;
      this.messageUid = messageUid;
    }
    formatNotification(message2) {
      if (this.operatorId === wfc.getUserId()) {
        return "你撤回了一条消息";
      }
      if (message2.conversation.type === ConversationType.Group) {
        return wfc.getGroupMemberDisplayName(message2.conversation.target, this.operatorId) + "撤回了一条消息";
      } else {
        return wfc.getUserDisplayName(this.operatorId) + "撤回了一条消息";
      }
    }
    encode() {
      let payload = super.encode();
      payload.content = this.operatorId;
      payload.binaryContent = wfc.utf8_to_b64(this.messageUid.toString());
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.operatorId = payload.content;
      this.messageUid = Long.fromString(wfc.b64_to_utf8(payload.binaryContent));
      try {
        this.setExtra(payload.extra);
      } catch (e) {
        formatAppLog("error", "at wfc/messages/notification/recallMessageNotification.js:54", "decode recallMessage extra error", e);
      }
    }
    setExtra(extra) {
      if (extra) {
        extra = extra.replace(/\n/g, "\\n").replace(/\r/g, "\\r").replace(/\t/g, "\\t");
        let obj = JSON.parse(extra);
        this.originalSender = obj["s"];
        this.originalContentType = obj["t"];
        this.originalSearchableContent = obj["sc"];
        this.originalContent = obj["c"];
        this.originalExtra = obj["e"];
        this.originalMessageTimestamp = Long.fromValue(obj["ts"]);
      }
    }
  }
  class DeleteMessageContent extends MessageContent {
    constructor(operatorId, messageUid) {
      super(MessageContentType.DeleteMessage_Notification);
      __publicField(this, "operatorId", "");
      __publicField(this, "messageUid", new Long(0));
      this.operatorId = operatorId;
      this.messageUid = messageUid;
    }
    formatNotification(message2) {
      return "消息已删除";
    }
    encode() {
      let payload = super.encode();
      payload.content = this.operatorId;
      payload.binaryContent = wfc.utf8_to_b64(this.messageUid.toString());
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.operatorId = payload.content;
      this.messageUid = Long.fromString(wfc.b64_to_utf8(payload.binaryContent));
    }
  }
  class CallStartMessageContent extends MessageContent {
    constructor(mentionedType = 0, mentionedTargets = []) {
      super(MessageContentType.VOIP_CONTENT_TYPE_START, mentionedType, mentionedTargets);
      __publicField(this, "callId");
      __publicField(this, "targetIds", []);
      __publicField(this, "connectTime");
      __publicField(this, "endTime");
      /**
       * 0, UnKnown,
       * 1, Busy,
       * 2, SignalError,
       * 3, Hangup,
       * 4, MediaError,
       * 5, RemoteHangup,
       * 6, OpenCameraFailure,
       * 7, Timeout,
       * 8, AcceptByOtherClient
       */
      __publicField(this, "status", 0);
      __publicField(this, "audioOnly");
      __publicField(this, "pin");
      //  0，未知；1，多人版音视频；2，高级版音视频
      __publicField(this, "sdkType", 0);
    }
    digest() {
      if (this.audioOnly) {
        return "[语音通话]";
      } else {
        return "[视频通话]";
      }
    }
    encode() {
      let payload = super.encode();
      payload.content = this.callId;
      payload.pushContent = "音视频通话邀请";
      let obj = {
        c: this.connectTime,
        e: this.endTime,
        s: this.status,
        a: this.audioOnly ? 1 : 0,
        ts: this.targetIds,
        t: this.targetIds[0],
        p: this.pin,
        ty: this.sdkType
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      let pushData = {
        callId: this.callId,
        audioOnly: this.audioOnly,
        participants: this.targetIds
      };
      payload.pushData = JSON.stringify(pushData);
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.callId = payload.content;
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.connectTime = obj.c;
      this.endTime = obj.e;
      this.status = obj.s;
      this.audioOnly = obj.a === 1;
      this.targetIds = obj.ts;
      if (!this.targetIds) {
        this.targetIds = [obj.t];
      }
      this.pin = obj.p;
      this.sdkType = obj.ty;
    }
  }
  class CallAnswerMessageContent extends MessageContent {
    constructor(mentionedType = 0, mentionedTargets = []) {
      super(MessageContentType.VOIP_CONTENT_TYPE_ACCEPT, mentionedType, mentionedTargets);
      __publicField(this, "callId");
      __publicField(this, "audioOnly");
      __publicField(this, "inviteMessageUid");
    }
    digest() {
      return "";
    }
    encode() {
      let payload = super.encode();
      payload.content = this.callId;
      var obj;
      if (this.audioOnly) {
        obj = "1";
      } else {
        obj = "0";
      }
      payload.binaryContent = wfc.utf8_to_b64(obj);
      let obj2 = {
        u: stringValue(this.inviteMessageUid)
      };
      let str = JSON.stringify(obj2);
      str = _patchToJavaLong(str, "u");
      payload.extra = str;
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.callId = payload.content;
      let str = wfc.b64_to_utf8(payload.binaryContent);
      this.audioOnly = str === "1";
      str = payload.extra;
      if (str) {
        str = _reverseToJsLongString(str, "u");
        this.inviteMessageUid = longValue(JSON.parse(str).u);
      }
    }
  }
  class CallAnswerTMessageContent extends MessageContent {
    constructor(mentionedType = 0, mentionedTargets = []) {
      super(MessageContentType.VOIP_CONTENT_TYPE_ACCEPT_T, mentionedType, mentionedTargets);
      __publicField(this, "callId");
      __publicField(this, "audioOnly");
    }
    digest() {
      return "";
    }
    encode() {
      let payload = super.encode();
      payload.content = this.callId;
      var obj;
      if (this.audioOnly) {
        obj = "1";
      } else {
        obj = "0";
      }
      payload.binaryContent = wfc.utf8_to_b64(obj);
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.callId = payload.content;
      let str = wfc.b64_to_utf8(payload.binaryContent);
      this.audioOnly = str === "1";
    }
  }
  class CallByeMessageContent extends MessageContent {
    constructor(mentionedType = 0, mentionedTargets = []) {
      super(MessageContentType.VOIP_CONTENT_TYPE_END, mentionedType, mentionedTargets);
      __publicField(this, "callId");
      __publicField(this, "reason");
      __publicField(this, "inviteMsgUid");
    }
    digest() {
      return "";
    }
    encode() {
      let payload = super.encode();
      payload.content = this.callId;
      let obj = {
        r: this.reason,
        u: this.inviteMsgUid ? stringValue(this.inviteMsgUid) : void 0
      };
      let str = JSON.stringify(obj);
      str = _patchToJavaLong(str, "u");
      payload.binaryContent = wfc.utf8_to_b64(str);
      payload.pushData = str;
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.callId = payload.content;
      let str = wfc.b64_to_utf8(payload.binaryContent);
      str = _reverseToJsLongString(str, "u");
      let obj = JSON.parse(str);
      this.reason = obj.r;
      this.inviteMsgUid = obj.u ? longValue(obj.u) : void 0;
    }
  }
  class CallSignalMessageContent extends MessageContent {
    constructor(mentionedType = 0, mentionedTargets = []) {
      super(MessageContentType.VOIP_CONTENT_TYPE_SIGNAL, mentionedType, mentionedTargets);
      __publicField(this, "callId");
      __publicField(this, "payload");
    }
    digest() {
      return "";
    }
    encode() {
      let payload = super.encode();
      payload.content = this.callId;
      payload.binaryContent = wfc.utf8_to_b64(this.payload);
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.callId = payload.content;
      this.payload = wfc.b64_to_utf8(payload.binaryContent);
    }
  }
  class CallModifyMessageContent extends MessageContent {
    constructor(mentionedType = 0, mentionedTargets = []) {
      super(MessageContentType.VOIP_CONTENT_TYPE_MODIFY, mentionedType, mentionedTargets);
      __publicField(this, "callId");
      __publicField(this, "audioOnly");
    }
    digest() {
      return "";
    }
    encode() {
      let payload = super.encode();
      payload.content = this.callId;
      var obj;
      if (this.audioOnly) {
        obj = "1";
      } else {
        obj = "0";
      }
      payload.binaryContent = wfc.utf8_to_b64(obj);
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.callId = payload.content;
      let str = wfc.b64_to_utf8(payload.binaryContent);
      this.audioOnly = str === "1";
    }
  }
  class AddParticipantsMessageContent extends NotificationMessageContent {
    constructor() {
      super(MessageContentType.VOIP_CONTENT_TYPE_ADD_PARTICIPANT);
      __publicField(this, "callId");
      __publicField(this, "initiator");
      __publicField(this, "pin");
      __publicField(this, "participants");
      __publicField(this, "existParticipants");
      __publicField(this, "audioOnly");
      __publicField(this, "autoAnswer");
      __publicField(this, "clientId");
    }
    formatNotification(message2) {
      let desc = "";
      if (this.fromSelf) {
        desc = "您邀请";
      } else {
        desc = wfc.getGroupMemberDisplayName(message2.conversation.target, this.initiator);
        desc += "邀请";
      }
      if (this.participants) {
        this.participants.forEach((p) => {
          desc += " ";
          if (p === wfc.getUserId()) {
            desc += "您";
          } else {
            desc += wfc.getGroupMemberDisplayName(message2.conversation.target, p);
          }
        });
      }
      desc += " 加入了通话";
      return desc;
    }
    encode() {
      let payload = super.encode();
      payload.content = this.callId;
      let obj = {
        initiator: this.initiator,
        audioOnly: this.audioOnly ? 1 : 0,
        pin: this.pin,
        participants: this.participants,
        existParticipants: this.existParticipants,
        autoAnswer: this.autoAnswer,
        clientId: this.clientId
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      let epids = this.existParticipants.map((p) => p.userId);
      let pushData = {
        callId: this.callId,
        audioOnly: this.audioOnly,
        participants: this.participants,
        existParticipants: epids
      };
      payload.pushData = JSON.stringify(pushData);
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.callId = payload.content;
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.initiator = obj.initiator;
      this.audioOnly = obj.audioOnly === 1;
      this.pin = obj.pin;
      this.participants = obj.participants;
      this.existParticipants = obj.existParticipants;
      this.autoAnswer = obj.autoAnswer;
      this.clientId = obj.clientId;
    }
  }
  class MuteVideoMessageContent extends NotificationMessageContent {
    constructor(mentionedType = 0, mentionedTargets = []) {
      super(MessageContentType.VOIP_CONTENT_TYPE_MUTE_VIDEO, mentionedType, mentionedTargets);
      __publicField(this, "callId");
      __publicField(this, "videoMuted");
      __publicField(this, "existParticipants");
    }
    formatNotification(message2) {
      return "mute video";
    }
    encode() {
      let payload = super.encode();
      payload.content = this.callId;
      let obj = {
        existParticipants: this.existParticipants,
        videoMuted: this.videoMuted
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.callId = payload.content;
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.existParticipants = obj.existParticipants;
      this.videoMuted = obj.videoMuted;
    }
  }
  class GroupJoinTypeNotificationContent extends GroupNotificationContent {
    constructor(operator, joinType) {
      super(MessageContentType.ChangeJoinType_Notification);
      __publicField(this, "operator");
      //在group type为Restricted时，0 开放加入权限（群成员可以拉人，用户也可以主动加入）；1 只能群成员拉人入群；2 只能群管理拉人入群
      __publicField(this, "joinType");
      this.operator = operator;
      this.type = joinType;
    }
    formatNotification(message2) {
      let notifyStr;
      if (this.fromSelf) {
        notifyStr = "您";
      } else {
        notifyStr = wfc.getGroupMemberDisplayName(this.groupId, this.operator);
      }
      switch (this.joinType) {
        case 0:
          notifyStr += " 开放了加入群组功能";
          break;
        case 1:
          notifyStr += " 仅允许群成员邀请加入群组";
          break;
        case 2:
          notifyStr += " 关闭了加入群组功能";
          break;
      }
      return notifyStr;
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        o: this.operator,
        n: this.joinType + ""
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return super.encode();
    }
    decode(payload) {
      super.decode(payload);
      let obj = JSON.parse(wfc.b64_to_utf8(payload.binaryContent));
      this.groupId = obj.g;
      this.operator = obj.o;
      this.joinType = parseInt(obj.n);
    }
  }
  class GroupMuteNotificationContent extends GroupNotificationContent {
    constructor(operator, muteType) {
      super(MessageContentType.MuteGroup_Notification);
      __publicField(this, "operator");
      //0 正常；1 全局禁言
      __publicField(this, "muteType");
      this.operator = operator;
      this.muteType = muteType;
    }
    formatNotification(message2) {
      let notifyStr = this.fromSelf ? "您" : wfc.getGroupMemberDisplayName(this.groupId, this.operator);
      notifyStr += this.muteType === 0 ? " 关闭了全员禁言" : " 开启了全员禁言";
      return notifyStr;
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        o: this.operator,
        n: this.muteType + ""
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let obj = JSON.parse(wfc.b64_to_utf8(payload.binaryContent));
      this.groupId = obj.g;
      this.operator = obj.o;
      this.muteType = parseInt(obj.n);
    }
  }
  class GroupSetManagerNotificationContent extends GroupNotificationContent {
    constructor(operator, setManagerType, memberIds) {
      super(MessageContentType.SetGroupManager_Notification);
      __publicField(this, "operator");
      // 1, 设置为管理员；0，取消管理员
      __publicField(this, "setManagerType");
      __publicField(this, "memberIds", []);
      this.operator = operator;
      this.setManagerType = setManagerType;
      this.memberIds = memberIds;
    }
    formatNotification(message2) {
      let notifyStr = this.fromSelf ? "您" : wfc.getGroupMemberDisplayName(this.groupId, this.operator);
      notifyStr += "把 ";
      this.memberIds.forEach((memberId) => {
        notifyStr += " ";
        notifyStr += wfc.getGroupMemberDisplayName(this.groupId, memberId);
      });
      notifyStr += " ";
      notifyStr += this.setManagerType === 0 ? "取消了管理员" : "设置为了管理员";
      return notifyStr;
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        o: this.operator,
        n: this.setManagerType + "",
        ms: this.memberIds
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let obj = JSON.parse(wfc.b64_to_utf8(payload.binaryContent));
      this.groupId = obj.g;
      this.operator = obj.o;
      this.setManagerType = parseInt(obj.n);
      this.memberIds = obj.ms;
    }
  }
  class GroupPrivateChatNotificationContent extends GroupNotificationContent {
    constructor(operator, privateChatType) {
      super(MessageContentType.ChangePrivateChat_Notification);
      __publicField(this, "operator");
      //是否运行群中普通成员私聊。0 允许，1不允许
      __publicField(this, "privateChatType");
      this.operator = operator;
      this.privateChatType = privateChatType;
    }
    formatNotification(message2) {
      let notifyStr = this.fromSelf ? "您" : wfc.getGroupMemberDisplayName(this.groupId, this.operator);
      notifyStr += this.privateChatType === 0 ? " 开启了成员私聊" : " 关闭了成员私聊";
      return notifyStr;
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        o: this.operator,
        n: this.privateChatType + ""
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let obj = JSON.parse(wfc.b64_to_utf8(payload.binaryContent));
      this.groupId = obj.g;
      this.operator = obj.o;
      this.privateChatType = parseInt(obj.n);
    }
  }
  class LocationMessageContent extends MessageContent {
    constructor() {
      super(...arguments);
      __publicField(this, "title");
      // base64 encoded, 不包含头部:data:image/png;base64,
      __publicField(this, "thumbnail");
      __publicField(this, "lat");
      __publicField(this, "long");
    }
    digest() {
      return "位置";
    }
    encode() {
      let payload = super.encode();
      payload.searchableContent = this.title;
      payload.binaryContent = this.thumbnail;
      let location2 = {
        lat: this.lat,
        long: this.long
      };
      payload.content = JSON.stringify(location2);
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.title = payload.searchableContent;
      this.thumbnail = payload.binaryContent;
      let location2 = JSON.parse(payload.content);
      this.lat = location2.lat;
      this.long = location2.long;
    }
  }
  class MuteGroupMemberNotification extends GroupNotificationContent {
    constructor(operator, muteType, memberIds) {
      super(MessageContentType.MuteGroupMember_Notification);
      __publicField(this, "groupId");
      __publicField(this, "operator");
      // 操作类型，1禁言，0取消禁言
      __publicField(this, "muteType");
      __publicField(this, "memberIds");
      this.operator = operator;
      this.muteType = muteType;
      this.memberIds = memberIds;
    }
    formatNotification(message2) {
      let notifyStr = "";
      if (this.fromSelf) {
        notifyStr += "您";
      } else {
        notifyStr += wfc.getGroupMemberDisplayName(
          this.groupId,
          this.operator
        );
      }
      notifyStr += "把";
      if (this.memberIds) {
        this.memberIds.forEach((memberId) => {
          notifyStr += " ";
          notifyStr += wfc.getGroupMemberDisplayName(
            this.groupId,
            memberId
          );
        });
      }
      if (this.muteType === 1) {
        notifyStr += "设置了禁言";
      } else {
        notifyStr += "取消了禁言";
      }
      return notifyStr;
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        o: this.operator,
        n: this.muteType + "",
        ms: this.memberIds
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.groupId = obj.g;
      this.operator = obj.o;
      this.muteType = parseInt(obj.n);
      this.memberIds = obj.ms;
    }
  }
  class AllowGroupMemberNotification extends GroupNotificationContent {
    constructor(operator, type, memberIds) {
      super(MessageContentType.MuteGroupMember_Notification);
      __publicField(this, "groupId");
      __publicField(this, "operator");
      // 操作类型，1允许发言，0禁止发言
      __publicField(this, "type");
      __publicField(this, "memberIds");
      this.operator = operator;
      this.type = type;
      this.memberIds = memberIds;
    }
    formatNotification(message2) {
      let notifyStr = "";
      if (this.fromSelf) {
        notifyStr += "您";
      } else {
        notifyStr += wfc.getGroupMemberDisplayName(
          this.groupId,
          this.operator
        );
      }
      notifyStr += "把";
      if (this.memberIds) {
        this.memberIds.forEach((memberId) => {
          notifyStr += " ";
          notifyStr += wfc.getGroupMemberDisplayName(
            this.groupId,
            memberId
          );
        });
      }
      if (this.type === 0) {
        notifyStr += "取消群禁言时发言权限";
      } else {
        notifyStr += "允许群禁言时发言";
      }
      return notifyStr;
    }
    encode() {
      let payload = super.encode();
      let obj = {
        g: this.groupId,
        o: this.operator,
        n: this.type + "",
        ms: this.memberIds
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.groupId = obj.g;
      this.operator = obj.o;
      this.type = parseInt(obj.n);
      this.memberIds = obj.ms;
    }
  }
  class CardMessageContent extends MessageContent {
    constructor(cardType, target, displayName, portrait, from) {
      super(MessageContentType.UserCard);
      /**
       * 0，用户；1，群组；2，聊天室；3，频道
       */
      __publicField(this, "cardType");
      __publicField(this, "target");
      __publicField(this, "name");
      __publicField(this, "displayName");
      __publicField(this, "portrait");
      __publicField(this, "from");
      this.cardType = cardType;
      this.target = target;
      this.displayName = displayName;
      this.portrait = portrait;
      this.from = from;
    }
    encode() {
      let payload = super.encode();
      payload.content = this.target;
      let obj = {
        t: this.cardType,
        n: this.name,
        d: this.displayName,
        p: this.portrait,
        f: this.from
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.target = payload.content;
      let obj = JSON.parse(wfc.b64_to_utf8(payload.binaryContent));
      this.cardType = obj.t;
      this.name = obj.n;
      this.displayName = obj.d;
      this.portrait = obj.p;
      if (Config.urlRedirect) {
        this.portrait = Config.urlRedirect(obj.p);
      }
      this.from = obj.f;
    }
    digest() {
      let msg = "[名片]";
      switch (this.cardType) {
        case 0:
          msg = "[个人名片]";
          break;
        case 1:
          msg = "[群组名片]";
          break;
        case 2:
          msg = "[聊天室名]";
          break;
        case 3:
          msg = "[频道名片]";
          break;
      }
      return msg + this.displayName;
    }
  }
  class LinkMessageContent extends MessageContent {
    constructor() {
      super(MessageContentType.Link);
      __publicField(this, "title");
      __publicField(this, "contentDigest");
      __publicField(this, "url");
      __publicField(this, "thumbnail");
    }
    encode() {
      let payload = super.encode();
      let obj = {
        d: this.contentDigest,
        u: this.url,
        t: this.thumbnail
      };
      payload.searchableContent = this.title;
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.title = payload.searchableContent;
      let obj = JSON.parse(wfc.b64_to_utf8(payload.binaryContent));
      this.contentDigest = obj.d;
      this.url = obj.u;
      this.thumbnail = obj.t;
    }
    digest(message2) {
      let tmp = this.title ? this.title.trim() : this.contentDigest ? this.contentDigest.trim() : null;
      return tmp ? tmp : this.url;
    }
  }
  class ArticlesMessageContent extends MessageContent {
    constructor() {
      super(MessageContentType.Articles);
      __publicField(this, "topArticle");
      __publicField(this, "subArticles");
    }
    digest(message2) {
      return this.topArticle.title;
    }
    encode() {
      let payload = super.encode();
      let obj = {
        top: this.topArticle.toJson()
      };
      if (this.subArticles) {
        obj["subArticles"] = this.subArticles.map((article) => article.toJson());
      }
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let obj = JSON.parse(wfc.b64_to_utf8(payload.binaryContent));
      this.topArticle = new Article();
      this.topArticle.fromJson(obj.top);
      if (obj.subArticles) {
        this.subArticles = [];
        obj.subArticles.forEach((article) => {
          let tmp = new Article();
          tmp.fromJson(article);
          this.subArticles.push(tmp);
        });
      }
    }
    toLinkMessageContent() {
      let contents = [];
      contents.push(this.topArticle.toLinkMessageContent());
      if (this.subArticles) {
        this.subArticles.forEach((article) => {
          contents.push(article.toLinkMessageContent());
        });
      }
      return contents;
    }
  }
  class Article {
    constructor() {
      __publicField(this, "articleId");
      __publicField(this, "cover");
      __publicField(this, "title");
      __publicField(this, "digest");
      __publicField(this, "url");
      __publicField(this, "readReport");
    }
    toJson() {
      let obj = {
        id: this.articleId,
        cover: this.cover,
        title: this.title,
        url: this.url,
        digest: this.digest,
        rr: this.readReport
      };
      return obj;
    }
    fromJson(obj) {
      this.articleId = obj.id;
      this.cover = obj.cover;
      this.title = obj.title;
      this.digest = obj.digest;
      this.url = obj.url;
      this.readReport = obj.rr;
    }
    toLinkMessageContent() {
      let content = new LinkMessageContent();
      content.url = this.url;
      content.title = this.title;
      content.contentDigest = this.digest;
      content.thumbnail = this.cover;
      return content;
    }
  }
  class CompositeMessageContent extends MediaMessageContent {
    constructor() {
      super(MessageContentType.Composite_Message, MessageContentMediaType.General, "");
      __publicField(this, "title", "");
      __publicField(this, "messages", []);
      // web 端有效，仅仅是用来标识 mediaCompositeMessage 是否已加载
      __publicField(this, "loaded", false);
    }
    setMessages(msgs) {
      this.messages = [];
      msgs.forEach((m) => {
        if (m.messageContent instanceof ArticlesMessageContent) {
          let linkMessageContents = m.messageContent.toLinkMessageContent();
          linkMessageContents.forEach((lm) => {
            let msg = Object.assign(new Message(), m);
            msg.messageContent = lm;
            this.messages.push(msg);
          });
        } else {
          this.messages.push(m);
        }
      });
      this.messages = this.messages.sort((m1, m2) => {
        return compare(m1.messageUid, m2.messageUid);
      });
    }
    digest(message2) {
      return "[聊天记录]" + this.title;
    }
    encode() {
      let payload = super.encode();
      payload.content = this.title;
      let arr = [];
      let binArr;
      let size = 0;
      this.messages.forEach((msg) => {
        let msgPayload = msg.messageContent.encode();
        let o = {
          uid: stringValue(msg.messageUid),
          type: msg.conversation.type,
          target: msg.conversation.target,
          line: msg.conversation.line,
          from: msg.from,
          tos: msg.to,
          direction: msg.direction,
          status: msg.status,
          serverTime: stringValue(msg.timestamp),
          ctype: msgPayload.type,
          csc: msgPayload.searchableContent,
          cpc: msgPayload.pushContent,
          cpd: msgPayload.pushData,
          cc: msgPayload.content,
          cmt: msgPayload.mentionedType,
          cmts: msgPayload.mentionedTargets,
          ce: msgPayload.extra
        };
        if (msgPayload.searchableContent) {
          payload.searchableContent = payload.searchableContent + msgPayload.searchableContent + " ";
        }
        if (msgPayload.binaryContent) {
          o.cbc = msgPayload.binaryContent;
        }
        if (msg.messageContent instanceof MediaMessageContent) {
          o.mt = msg.messageContent.mediaType;
          o.mru = msg.messageContent.remotePath;
        }
        if (!binArr) {
          size += JSON.stringify(o).length;
          if (size > 20480 && arr.length > 0) {
            binArr = arr.map((value) => value);
          }
        }
        arr.push(o);
      });
      let obj;
      if (binArr && !this.file) {
        obj = {
          ms: arr
        };
        let str2 = JSON.stringify(obj);
        str2 = str2.replace(/"uid":"([0-9]+)"/, '"uid":$1');
        str2 = str2.replace(/"serverTime":"([0-9]+)"/, '"serverTime":$1');
        let blob = new Blob([str2]);
        let fileName = "wcf-" + (/* @__PURE__ */ new Date()).getTime() + ".data";
        this.file = new File([blob], fileName);
        obj = {
          ms: binArr
        };
      } else {
        if (binArr) {
          obj = {
            ms: binArr
          };
        } else {
          obj = {
            ms: arr
          };
        }
      }
      let str = JSON.stringify(obj);
      str = str.replace(/"uid":"([0-9]+)"/, '"uid":$1');
      str = str.replace(/"serverTime":"([0-9]+)"/, '"serverTime":$1');
      payload.binaryContent = wfc.utf8_to_b64(str);
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.title = payload.content;
      let str;
      if (this.file) {
        let fileReader = new FileReader();
        fileReader.onload((ev) => {
          this._decodeMessages(ev.target.result);
        });
        fileReader.readAsBinaryString(this.file);
      } else if (this.localPath)
        ;
      if (!str) {
        str = wfc.b64_to_utf8(payload.binaryContent);
        this._decodeMessages(str);
      }
    }
    _decodeMessages(str) {
      if (this.loaded) {
        return;
      }
      this.messages = [];
      str = str.substring(0, str.lastIndexOf("}") + 1);
      str = str.replace(/"uid":([0-9]+)/g, '"uid":"$1"');
      str = str.replace(/"serverTime":([0-9]+)/g, '"serverTime":"$1"');
      let obj = JSON.parse(str);
      obj.ms.forEach((o) => {
        let conv = new Conversation(o.type, o.target, o.line);
        let msg = new Message();
        msg.messageUid = Long.fromValue(o.uid);
        msg.conversation = conv;
        msg.from = o.from;
        msg.to = o.tos;
        msg.direction = o.direction;
        msg.status = o.status;
        msg.timestamp = Long.fromValue(o.serverTime);
        let payload = new MessagePayload();
        payload.type = o.ctype;
        payload.searchableContent = o.csc;
        payload.pushContent = o.cpc;
        payload.pushData = o.cpd;
        payload.content = o.cc;
        payload.mentionedType = o.cmt;
        payload.mentionedTargets = o.cmts;
        payload.extra = o.ce;
        payload.binaryContent = o.cbc;
        payload.mediaType = o.mt;
        payload.remoteMediaUrl = o.mru;
        msg.messageContent = Message.messageContentFromMessagePayload(payload, msg.from);
        this.messages.push(msg);
      });
      formatAppLog("log", "at wfc/messages/compositeMessageContent.js:191", "cp ms", this.messages);
    }
  }
  class ConferenceInviteMessageContent extends MessageContent {
    constructor(callId, host, title, desc, startTime, audioOnly, audience, advance, pin) {
      super(MessageContentType.CONFERENCE_CONTENT_TYPE_INVITE);
      __publicField(this, "callId");
      __publicField(this, "host");
      __publicField(this, "title");
      __publicField(this, "desc");
      __publicField(this, "startTime");
      __publicField(this, "audioOnly");
      __publicField(this, "audience");
      __publicField(this, "pin");
      __publicField(this, "advanced");
      this.callId = callId;
      this.host = host;
      this.title = title;
      this.desc = desc;
      this.startTime = startTime;
      this.audioOnly = audioOnly;
      this.audience = audience;
      this.advanced = advance;
      this.pin = pin;
    }
    digest(message2) {
      let str = "[会议邀请]";
      return str;
    }
    encode() {
      let payload = super.encode();
      payload.content = this.callId;
      payload.pushContent = "会议邀请";
      let obj = {
        h: this.host,
        s: this.startTime,
        t: this.title,
        d: this.desc,
        audience: this.audience ? 1 : 0,
        advanced: this.advanced ? 1 : 0,
        a: this.audioOnly ? 1 : 0,
        p: this.pin
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      if (payload.binaryContent) {
        let json = wfc.b64_to_utf8(payload.binaryContent);
        let obj = JSON.parse(json);
        this.host = obj.h;
        this.startTime = obj.s;
        this.title = obj.t;
        this.desc = obj.d;
        this.audience = obj.audience > 0;
        this.advanced = obj.advanced > 0;
        this.audioOnly = obj.a > 0;
        this.pin = obj.p;
      }
      this.callId = payload.content;
    }
  }
  class ConferenceChangeModeContent extends MessageContent {
    constructor(callId, audience) {
      super(MessageContentType.CONFERENCE_CONTENT_TYPE_CHANGE_MODE);
      __publicField(this, "callId");
      __publicField(this, "audience");
      this.callId = callId;
      this.audience = audience;
    }
    encode() {
      let payload = super.encode();
      payload.content = this.callId;
      let obj = { "a": this.audience };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.callId = payload.content;
      if (payload.binaryContent) {
        let json = wfc.b64_to_utf8(payload.binaryContent);
        let obj = JSON.parse(json);
        this.audience = !!obj.a;
      }
    }
  }
  class ConferenceKickoffMemberMessageContent extends MessageContent {
    constructor(callId) {
      super(MessageContentType.CONFERENCE_CONTENT_TYPE_KICKOFF_MEMBER);
      __publicField(this, "callId");
      this.callId = callId;
    }
    encode() {
      let payload = super.encode();
      payload.content = this.callId;
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.callId = payload.content;
    }
  }
  class MarkUnreadMessageContent extends MessageContent {
    constructor(messageUid) {
      super(MessageContentType.Mark_Unread_Sync);
      __publicField(this, "messageUid");
      __publicField(this, "timestamp");
      this.messageUid = messageUid;
    }
    encode() {
      let payload = super.encode();
      let obj = {
        u: stringValue(this.messageUid),
        t: stringValue(this.timestamp)
      };
      let str = JSON.stringify(obj);
      str = _patchToJavaLong(str, "u");
      str = _patchToJavaLong(str, "t");
      payload.binaryContent = wfc.utf8_to_b64(str);
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let str = wfc.b64_to_utf8(payload.binaryContent);
      str = _reverseToJsLongString(str, "u");
      str = _reverseToJsLongString(str, "t");
      let obj = JSON.parse(str);
      this.messageUid = obj.u ? longValue(obj.u) : void 0;
      this.timestamp = obj.t ? longValue(obj.t) : void 0;
    }
  }
  class FriendAddedNotification extends NotificationMessageContent {
    constructor() {
      super(MessageContentType.Friend_Added);
    }
    formatNotification() {
      return "你们已经是好友了，可以开始聊天了。";
    }
  }
  class FriendGreetingNotification extends NotificationMessageContent {
    constructor() {
      super(MessageContentType.Friend_Greeting);
    }
    formatNotification(message2) {
      return "以上是打招呼的内容";
    }
  }
  class PcLoginRequestMessageContent extends MessageContent {
    constructor() {
      super(MessageContentType.PC_Login_Request);
      __publicField(this, "platform");
      __publicField(this, "sessionId");
    }
    digest() {
      return "[PC请求登录]";
    }
    encode() {
      let payload = super.encode();
      payload.mediaType = MessageContentMediaType.File;
      let obj = {
        p: this.platform,
        t: this.sessionId
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      let obj = JSON.parse(wfc.b64_to_utf8(payload.binaryContent));
      this.platform = obj.p;
      this.sessionId = obj.t;
    }
  }
  class SecretChatState {
  }
  //密聊会话建立中
  __publicField(SecretChatState, "Starting", 0);
  //密聊会话接受中
  __publicField(SecretChatState, "Accepting", 1);
  //密聊会话已建立
  __publicField(SecretChatState, "Established", 2);
  //密聊会话已取消
  __publicField(SecretChatState, "Canceled", 3);
  class StartSecretChatNotification extends NotificationMessageContent {
    constructor() {
      super(MessageContentType.StartSecretChat_Notification);
    }
    formatNotification(message2) {
      let state = wfc.getSecretChatInfo(message2.conversation.target).state;
      if (state === SecretChatState.Starting) {
        return "等待对方响应";
      } else if (state === SecretChatState.Accepting) {
        return "密聊会话建立中";
      } else if (state === SecretChatState.Established) {
        return "密聊会话已建立";
      } else if (state === SecretChatState.Canceled) {
        return "密聊会话已取消";
      } else {
        return "密聊会话不可用";
      }
    }
    encode() {
      return super.encode();
    }
    decode(payload) {
      super.decode(payload);
    }
  }
  class MultiCallOngoingMessageContent extends MessageContent {
    constructor(callId, initiator, audioOnly, targets) {
      super(MessageContentType.VOIP_Multi_Call_Ongoing);
      __publicField(this, "callId");
      __publicField(this, "initiator");
      __publicField(this, "audioOnly");
      __publicField(this, "targets");
      this.callId = callId;
      this.initiator = initiator;
      this.audioOnly = audioOnly;
      this.targets = targets;
    }
    digest(message2) {
      let displayName = wfc.getGroupMemberDisplayName(message2.conversation.target, this.initiator);
      return displayName + " 发起的通话";
    }
    encode() {
      let payload = super.encode();
      payload.content = this.callId;
      let obj = {
        initiator: this.initiator,
        audioOnly: this.audioOnly ? 1 : 0,
        targets: this.targets
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.callId = payload.content;
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.initiator = obj.initiator;
      this.audioOnly = obj.audioOnly === 1;
      this.targets = obj.targets;
    }
  }
  class JoinCallRequestMessageContent extends MessageContent {
    constructor(callId, clientId) {
      super(MessageContentType.VOIP_Join_Call_Request);
      __publicField(this, "callId");
      __publicField(this, "clientId");
      this.callId = callId;
      this.clientId = clientId;
    }
    digest() {
      return "";
    }
    encode() {
      let payload = super.encode();
      payload.content = this.callId;
      let obj = {
        clientId: this.clientId
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.callId = payload.content;
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.clientId = obj.clientId;
    }
  }
  class RichNotificationMessageContent extends NotificationMessageContent {
    constructor() {
      super(MessageContentType.Rich_Notification);
      // 富通知消息
      __publicField(this, "title");
      __publicField(this, "desc");
      __publicField(this, "remark");
      // @[@{@"key":@"登陆账户", @"value":@"野火IM", @"color":@"#173155"}, @{@"key":@"登陆地点", @"value":@"北京", @"color":@"#173155"}]
      __publicField(this, "datas");
      // 附加信息
      __publicField(this, "exName");
      __publicField(this, "exPortrait");
      __publicField(this, "exUrl");
      // 应用信息
      __publicField(this, "appId");
    }
    formatNotification() {
      return this.title;
    }
    encode() {
      let payload = super.encode();
      payload.pushContent = this.title;
      payload.content = this.desc;
      let obj = {
        remark: this.remark,
        exName: this.exName,
        exPortrait: this.exPortrait,
        exUrl: this.exUrl,
        appId: this.appId,
        datas: this.datas
      };
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.title = payload.pushContent;
      this.desc = payload.content;
      let json = wfc.b64_to_utf8(payload.binaryContent);
      let obj = JSON.parse(json);
      this.remark = obj.remark;
      this.exName = obj.exName;
      this.exPortrait = obj.exPortrait;
      this.exUrl = obj.exUrl;
      this.appId = obj.appId;
      this.datas = obj.datas;
    }
  }
  class ChannelMenuEventMessageContent extends MessageContent {
    constructor(menu) {
      super(MessageContentType.Channel_Menu_Event);
      __publicField(this, "menu");
      this.menu = menu;
    }
    encode() {
      let payload = super.encode();
      payload.content = JSON.stringify(this.menu);
      return payload;
    }
  }
  class EnterChannelChatMessageContent extends MessageContent {
    constructor() {
      super(MessageContentType.Enter_Channel_Chat);
    }
  }
  class LeaveChannelChatMessageContent extends MessageContent {
    constructor() {
      super(MessageContentType.Leave_Channel_Chat);
    }
  }
  class ConferenceCommandMessageContent extends MessageContent {
    constructor(conferenceId, commandType, targetUserId, boolValue) {
      super(MessageContentType.CONFERENCE_CONTENT_TYPE_COMMAND);
      __publicField(this, "conferenceId");
      __publicField(this, "commandType");
      __publicField(this, "targetUserId");
      __publicField(this, "boolValue");
      this.conferenceId = conferenceId;
      this.commandType = commandType;
      this.targetUserId = targetUserId;
      this.boolValue = boolValue;
    }
    encode() {
      let payload = super.encode();
      payload.content = this.conferenceId;
      let obj = {
        t: this.commandType,
        u: this.targetUserId
      };
      if (this.boolValue) {
        obj["b"] = this.boolValue;
      }
      payload.binaryContent = wfc.utf8_to_b64(JSON.stringify(obj));
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      if (payload.binaryContent) {
        let json = wfc.b64_to_utf8(payload.binaryContent);
        let obj = JSON.parse(json);
        this.commandType = obj.t;
        this.boolValue = !!obj.b;
        this.targetUserId = obj.u;
      }
      this.conferenceId = payload.content;
    }
  }
  // TODO Object.freeze
  __publicField(ConferenceCommandMessageContent, "ConferenceCommandType", Object.freeze({
    //全体静音，只有主持人可以操作，结果写入conference profile中。带有参数是否允许成员自主解除静音。
    MUTE_ALL_AUDIO: 0,
    //取消全体静音，只有主持人可以操作，结果写入conference profile中。带有参数是否邀请成员解除静音。
    CANCEL_MUTE_ALL_AUDIO: 1,
    //要求某个用户更改静音状态，只有主持人可以操作。带有参数是否静音/解除静音。
    REQUEST_MUTE_AUDIO: 2,
    //拒绝UNMUTE要求。（如果同意不需要通知对方同意)
    REJECT_UNMUTE_AUDIO_REQUEST: 3,
    //普通用户申请解除静音，带有参数是请求，还是取消请求。
    APPLY_UNMUTE_AUDIO: 4,
    //管理员批准解除静音申请，带有参数是同意，还是拒绝申请。
    APPROVE_UNMUTE_AUDIO: 5,
    //管理员批准全部解除静音申请，带有参数是同意，还是拒绝申请。
    APPROVE_ALL_UNMUTE_AUDIO: 6,
    //举手，带有参数是举手还是放下举手
    HANDUP: 7,
    //主持人放下成员的举手
    PUT_HAND_DOWN: 8,
    //主持人放下全体成员的举手
    PUT_ALL_HAND_DOWN: 9,
    //录制，有参数是录制还是取消录制
    RECORDING: 10,
    // 设置焦点用户
    FOCUS: 11,
    // 取消设置焦点用户
    CANCEL_FOCUS: 12,
    //全体静音，只有主持人可以操作，结果写入conference profile中。带有参数是否允许成员自主解除静音。
    MUTE_ALL_VIDEO: 13,
    //取消全体静音，只有主持人可以操作，结果写入conference profile中。带有参数是否邀请成员解除静音。
    CANCEL_MUTE_ALL_VIDEO: 14,
    //要求某个用户更改静音状态，只有主持人可以操作。带有参数是否静音/解除静音。
    REQUEST_MUTE_VIDEO: 15,
    //拒绝UNMUTE要求。（如果同意不需要通知对方同意)
    REJECT_UNMUTE_VIDEO_REQUEST: 16,
    //普通用户申请解除静音，带有参数是请求，还是取消请求。
    APPLY_UNMUTE_VIDEO: 17,
    //管理员批准解除静音申请，带有参数是同意，还是拒绝申请。
    APPROVE_UNMUTE_VIDEO: 18,
    //管理员批准全部解除静音申请，带有参数是同意，还是拒绝申请。
    APPROVE_ALL_UNMUTE_VIDEO: 19
  }));
  class StreamingTextGeneratingMessageContent extends MessageContent {
    constructor() {
      super(MessageContentType.Streaming_Text_Generating);
      __publicField(this, "text", "");
      __publicField(this, "streamId", "");
    }
    digest(message2) {
      return this.text;
    }
    encode() {
      let payload = super.encode();
      payload.searchableContent = this.text;
      payload.content = this.streamId;
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.text = payload.searchableContent;
      this.streamId = payload.content;
    }
  }
  class StreamingTextGeneratedMessageContent extends MessageContent {
    constructor() {
      super(MessageContentType.Streaming_Text_Generated);
      __publicField(this, "text", "");
      __publicField(this, "streamId", "");
    }
    digest(message2) {
      return this.text;
    }
    encode() {
      let payload = super.encode();
      payload.searchableContent = this.text;
      payload.content = this.streamId;
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.text = payload.searchableContent;
      this.streamId = payload.content;
    }
  }
  const _MessageConfig = class _MessageConfig {
    static getMessageContentClazz(type) {
      for (const content of _MessageConfig.MessageContents) {
        if (content.type === type) {
          if (content.contentClazz) {
            return content.contentClazz;
          } else {
            return UnsupportMessageContent;
          }
        }
      }
      formatAppLog("error", "at wfc/client/messageConfig.js:85", `message type ${type} is unknown`);
      return UnknownMessageContent;
    }
    static getMessageContentFlag(type) {
      let flag = PersistFlag.No_Persist;
      for (const content of _MessageConfig.MessageContents) {
        if (content.type === type) {
          flag = content.flag;
        }
      }
      return flag;
    }
    static getMessageContentPersitFlag(type) {
      for (const content of _MessageConfig.MessageContents) {
        if (content.type === type) {
          return content.flag;
        }
      }
      return -1;
    }
    static getMessageContentType(messageContent) {
      for (const content of _MessageConfig.MessageContents) {
        if (content.contentClazz && messageContent instanceof content.contentClazz) {
          return content.type;
        }
      }
      return MessageContentType.Unknown;
    }
    static registerMessageContent(name, flag, type, clazz) {
      _MessageConfig.MessageContents.push(
        {
          name,
          flag,
          type,
          contentClazz: clazz
        }
      );
    }
  };
  __publicField(_MessageConfig, "MessageContents", [
    {
      name: "unknown",
      flag: PersistFlag.Persist,
      type: MessageContentType.Unknown,
      contentClazz: UnknownMessageContent
    },
    {
      name: "text",
      flag: PersistFlag.Persist_And_Count,
      type: MessageContentType.Text,
      contentClazz: TextMessageContent
    },
    {
      name: "ptext",
      flag: PersistFlag.Persist,
      type: MessageContentType.P_Text,
      contentClazz: PTextMessageContent
    },
    {
      name: "voice",
      flag: PersistFlag.Persist_And_Count,
      type: MessageContentType.Voice,
      contentClazz: SoundMessageContent
    },
    {
      name: "image",
      flag: PersistFlag.Persist_And_Count,
      type: MessageContentType.Image,
      contentClazz: ImageMessageContent
    },
    {
      name: "location",
      flag: PersistFlag.Persist_And_Count,
      type: MessageContentType.Location,
      contentClazz: LocationMessageContent
    },
    {
      name: "file",
      flag: PersistFlag.Persist_And_Count,
      type: MessageContentType.File,
      contentClazz: FileMessageContent
    },
    {
      name: "video",
      flag: PersistFlag.Persist_And_Count,
      type: MessageContentType.Video,
      contentClazz: VideoMessageContent
    },
    {
      name: "sticker",
      flag: PersistFlag.Persist_And_Count,
      type: MessageContentType.Sticker,
      contentClazz: StickerMessageContent
    },
    {
      name: "link",
      flag: PersistFlag.Persist_And_Count,
      type: MessageContentType.Link,
      contentClazz: LinkMessageContent
    },
    {
      name: "userCard",
      flag: PersistFlag.Persist_And_Count,
      type: MessageContentType.UserCard,
      contentClazz: CardMessageContent
    },
    {
      name: "compositeMessage",
      flag: PersistFlag.Persist_And_Count,
      type: MessageContentType.Composite_Message,
      contentClazz: CompositeMessageContent
    },
    {
      name: "tip",
      flag: PersistFlag.Persist,
      type: MessageContentType.Tip_Notification,
      contentClazz: TipNotificationMessageContent
    },
    {
      name: "typing",
      flag: PersistFlag.Transparent,
      type: MessageContentType.Typing,
      contentClazz: TypingMessageContent
    },
    {
      name: "friendGreeting",
      flag: PersistFlag.Persist,
      type: MessageContentType.Friend_Added,
      contentClazz: FriendGreetingNotification
    },
    {
      name: "friendAdded",
      flag: PersistFlag.Persist,
      type: MessageContentType.Friend_Greeting,
      contentClazz: FriendAddedNotification
    },
    {
      name: "addGroupMemberNotification",
      flag: PersistFlag.Persist,
      type: MessageContentType.AddGroupMember_Notification,
      contentClazz: AddGroupMemberNotification
    },
    {
      name: "changeGroupNameNotification",
      flag: PersistFlag.Persist,
      type: MessageContentType.ChangeGroupName_Notification,
      contentClazz: ChangeGroupNameNotification
    },
    {
      name: "changeGroupPortraitNotification",
      flag: PersistFlag.Persist,
      type: MessageContentType.ChangeGroupPortrait_Notification,
      contentClazz: ChangeGroupPortraitNotification
    },
    {
      name: "createGroupNotification",
      flag: PersistFlag.Persist,
      type: MessageContentType.CreateGroup_Notification,
      contentClazz: CreateGroupNotification
    },
    {
      name: "dismissGroupNotification",
      flag: PersistFlag.Persist,
      type: MessageContentType.DismissGroup_Notification,
      contentClazz: DismissGroupNotification
    },
    {
      name: "kickoffGroupMemberNotification",
      flag: PersistFlag.Persist,
      type: MessageContentType.KickOffGroupMember_Notification,
      contentClazz: KickoffGroupMemberNotification
    },
    {
      name: "kickoffGroupMemberVisiableNotification",
      flag: PersistFlag.Persist,
      type: MessageContentType.KickOffGroupMember_Visible_Notification,
      contentClazz: KickoffGroupMemberVisiableNotification
    },
    {
      name: "modifyGroupAliasNotification",
      flag: PersistFlag.Persist,
      type: MessageContentType.ModifyGroupAlias_Notification,
      contentClazz: ModifyGroupAliasNotification
    },
    {
      name: "modifyGroupExtraNotification",
      flag: PersistFlag.Persist,
      type: MessageContentType.ModifyGroupExtra_Notification,
      contentClazz: ModifyGroupExtraNotification
    },
    {
      name: "modifyGroupMemberExtraNotification",
      flag: PersistFlag.Persist,
      type: MessageContentType.ModifyGroupMemberExtra_Notification,
      contentClazz: ModifyGroupMemberExtraNotification
    },
    {
      name: "quitGroupNotification",
      flag: PersistFlag.Persist,
      type: MessageContentType.QuitGroup_Notification,
      contentClazz: QuitGroupNotification
    },
    {
      name: "quitGroupVisiableNotification",
      flag: PersistFlag.Persist,
      type: MessageContentType.QuitGroup_Visible_Notification,
      contentClazz: QuitVisiableGroupNotification
    },
    {
      name: "transferGroupOwnerNotification",
      flag: PersistFlag.Persist,
      type: MessageContentType.TransferGroupOwner_Notification,
      contentClazz: TransferGroupOwnerNotification
    },
    {
      name: "groupJoinTypeNotificationContent",
      flag: PersistFlag.Persist,
      type: MessageContentType.ChangeJoinType_Notification,
      contentClazz: GroupJoinTypeNotificationContent
    },
    {
      name: "groupMuteNotificationContent",
      flag: PersistFlag.Persist,
      type: MessageContentType.MuteGroup_Notification,
      contentClazz: GroupMuteNotificationContent
    },
    {
      name: "groupPrivateChatNotificationContent",
      flag: PersistFlag.Persist,
      type: MessageContentType.ChangePrivateChat_Notification,
      contentClazz: GroupPrivateChatNotificationContent
    },
    {
      name: "groupSetManagerNotificationContent",
      flag: PersistFlag.Persist,
      type: MessageContentType.SetGroupManager_Notification,
      contentClazz: GroupSetManagerNotificationContent
    },
    {
      name: "muteGroupMemberNotificationContent",
      flag: PersistFlag.Persist,
      type: MessageContentType.MuteGroupMember_Notification,
      contentClazz: MuteGroupMemberNotification
    },
    {
      name: "allowGroupMemberNotificationContent",
      flag: PersistFlag.Persist,
      type: MessageContentType.AllowGroupMember_Notification,
      contentClazz: AllowGroupMemberNotification
    },
    {
      name: "recall",
      flag: PersistFlag.Persist,
      type: MessageContentType.RecallMessage_Notification,
      contentClazz: RecallMessageNotification
    },
    {
      name: "delete",
      flag: PersistFlag.No_Persist,
      type: MessageContentType.DeleteMessage_Notification,
      contentClazz: DeleteMessageContent
    },
    {
      name: "streamingTextGenerating",
      flag: PersistFlag.Transparent,
      type: MessageContentType.Streaming_Text_Generating,
      contentClazz: StreamingTextGeneratingMessageContent
    },
    {
      name: "streamingTextGenerated",
      flag: PersistFlag.Persist_And_Count,
      type: MessageContentType.Streaming_Text_Generated,
      contentClazz: StreamingTextGeneratedMessageContent
    },
    {
      name: "callStartMessageContent",
      flag: PersistFlag.Persist,
      type: MessageContentType.VOIP_CONTENT_TYPE_START,
      contentClazz: CallStartMessageContent
    },
    {
      name: "callAnswerMessageContent",
      flag: PersistFlag.No_Persist,
      type: MessageContentType.VOIP_CONTENT_TYPE_ACCEPT,
      contentClazz: CallAnswerMessageContent
    },
    {
      name: "callAnswerTMessageContent",
      flag: PersistFlag.Transparent,
      type: MessageContentType.VOIP_CONTENT_TYPE_ACCEPT_T,
      contentClazz: CallAnswerTMessageContent
    },
    {
      name: "callByeMessageContent",
      flag: PersistFlag.No_Persist,
      type: MessageContentType.VOIP_CONTENT_TYPE_END,
      contentClazz: CallByeMessageContent
    },
    {
      name: "callSignalMessageContent",
      flag: PersistFlag.Transparent,
      type: MessageContentType.VOIP_CONTENT_TYPE_SIGNAL,
      contentClazz: CallSignalMessageContent
    },
    {
      name: "callModifyMessageContent",
      flag: PersistFlag.No_Persist,
      type: MessageContentType.VOIP_CONTENT_TYPE_MODIFY,
      contentClazz: CallModifyMessageContent
    },
    {
      name: "callAddParticipant",
      flag: PersistFlag.Persist,
      type: MessageContentType.VOIP_CONTENT_TYPE_ADD_PARTICIPANT,
      contentClazz: AddParticipantsMessageContent
    },
    {
      name: "callMuteVideo",
      flag: PersistFlag.No_Persist,
      type: MessageContentType.VOIP_CONTENT_TYPE_MUTE_VIDEO,
      contentClazz: MuteVideoMessageContent
    },
    {
      name: "conferenceInvite",
      flag: PersistFlag.Persist_And_Count,
      type: MessageContentType.CONFERENCE_CONTENT_TYPE_INVITE,
      contentClazz: ConferenceInviteMessageContent
    },
    {
      name: "conferenceChangeMode",
      flag: PersistFlag.Transparent,
      type: MessageContentType.CONFERENCE_CONTENT_TYPE_CHANGE_MODE,
      contentClazz: ConferenceChangeModeContent
    },
    {
      name: "conferenceKickoffMember",
      flag: PersistFlag.Transparent,
      type: MessageContentType.CONFERENCE_CONTENT_TYPE_KICKOFF_MEMBER,
      contentClazz: ConferenceKickoffMemberMessageContent
    },
    {
      name: "multiCallOngoing",
      flag: PersistFlag.Transparent,
      type: MessageContentType.VOIP_Multi_Call_Ongoing,
      contentClazz: MultiCallOngoingMessageContent
    },
    {
      name: "joinCallRequest",
      flag: PersistFlag.Transparent,
      type: MessageContentType.VOIP_Join_Call_Request,
      contentClazz: JoinCallRequestMessageContent
    },
    {
      name: "markUnreadMessage",
      flag: PersistFlag.No_Persist,
      type: MessageContentType.Mark_Unread_Sync,
      contentClazz: MarkUnreadMessageContent
    },
    {
      name: "pcLoginRequest",
      flag: PersistFlag.No_Persist,
      type: MessageContentType.PC_Login_Request,
      contentClazz: PcLoginRequestMessageContent
    },
    {
      name: "startSecretChat",
      flag: PersistFlag.Persist_And_Count,
      type: MessageContentType.StartSecretChat_Notification,
      contentClazz: StartSecretChatNotification
    },
    {
      name: "richNotification",
      flag: PersistFlag.Persist_And_Count,
      type: MessageContentType.Rich_Notification,
      contentClazz: RichNotificationMessageContent
    },
    {
      name: "articlesMessageContent",
      flag: PersistFlag.Persist_And_Count,
      type: MessageContentType.Articles,
      contentClazz: ArticlesMessageContent
    },
    {
      name: "channelMenuEventMessageContent",
      flag: PersistFlag.Transparent,
      type: MessageContentType.Channel_Menu_Event,
      contentClazz: ChannelMenuEventMessageContent
    },
    {
      name: "enterChannelChatMessageContent",
      flag: PersistFlag.Transparent,
      type: MessageContentType.Enter_Channel_Chat,
      contentClazz: EnterChannelChatMessageContent
    },
    {
      name: "leaveChannelChatMessageContent",
      flag: PersistFlag.Transparent,
      type: MessageContentType.Leave_Channel_Chat,
      contentClazz: LeaveChannelChatMessageContent
    },
    {
      name: "conferenceCommandMessageContent",
      flag: PersistFlag.Transparent,
      type: MessageContentType.CONFERENCE_CONTENT_TYPE_COMMAND,
      contentClazz: ConferenceCommandMessageContent
    }
  ]);
  let MessageConfig = _MessageConfig;
  class MessageStatus {
  }
  __publicField(MessageStatus, "All", -1);
  __publicField(MessageStatus, "Sending", 0);
  __publicField(MessageStatus, "Sent", 1);
  __publicField(MessageStatus, "SendFailure", 2);
  __publicField(MessageStatus, "Mentioned", 3);
  __publicField(MessageStatus, "AllMentioned", 4);
  __publicField(MessageStatus, "Unread", 5);
  __publicField(MessageStatus, "Readed", 6);
  __publicField(MessageStatus, "Played", 7);
  var chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
  var lookup = typeof Uint8Array === "undefined" ? [] : new Uint8Array(256);
  for (var i = 0; i < chars.length; i++) {
    lookup[chars.charCodeAt(i)] = i;
  }
  var encode = function(arraybuffer) {
    var bytes = new Uint8Array(arraybuffer), i2, len = bytes.length, base64 = "";
    for (i2 = 0; i2 < len; i2 += 3) {
      base64 += chars[bytes[i2] >> 2];
      base64 += chars[(bytes[i2] & 3) << 4 | bytes[i2 + 1] >> 4];
      base64 += chars[(bytes[i2 + 1] & 15) << 2 | bytes[i2 + 2] >> 6];
      base64 += chars[bytes[i2 + 2] & 63];
    }
    if (len % 3 === 2) {
      base64 = base64.substring(0, base64.length - 1) + "=";
    } else if (len % 3 === 1) {
      base64 = base64.substring(0, base64.length - 2) + "==";
    }
    return base64;
  };
  class Message {
    constructor(conversation2, messageContent) {
      __publicField(this, "conversation", {});
      __publicField(this, "from", "");
      __publicField(this, "content", {});
      // 实际是payload
      __publicField(this, "messageContent", {});
      __publicField(this, "messageId", 0);
      __publicField(this, "direction", 0);
      __publicField(this, "status", 0);
      __publicField(this, "messageUid", -1);
      __publicField(this, "timestamp", 0);
      __publicField(this, "to", "");
      __publicField(this, "localExtra", "");
      this.conversation = conversation2;
      this.messageContent = messageContent;
    }
    static fromProtoMessage(obj) {
      if (!obj) {
        return null;
      }
      if (!obj.conversation.target) {
        return null;
      }
      if ([1, 2, 3, 4, 7, 8, 9, 10, 11, 12].indexOf(Config.getWFCPlatform()) >= 0) {
        let msg = Object.assign(new Message(), obj);
        msg.messageId = Number(msg.messageId);
        if (msg.messageId === -1) {
          return null;
        }
        msg.messageUid = Long.fromValue(msg.messageUid);
        if (msg.timestamp) {
          msg.timestamp = Long.fromValue(msg.timestamp).toNumber();
        } else {
          msg.timestamp = Long.fromValue(msg.serverTime).toNumber();
        }
        msg.localExtra = obj.localExtra;
        if (!msg.from) {
          msg.from = obj.sender;
        }
        msg.conversation = new Conversation(obj.conversation.conversationType !== void 0 ? obj.conversation.conversationType : obj.conversation.type, obj.conversation.target, obj.conversation.line);
        let contentClazz = MessageConfig.getMessageContentClazz(msg.content.type !== void 0 ? msg.content.type : msg.content.messageContentType);
        if (contentClazz) {
          let content = new contentClazz();
          try {
            content.decode(msg.content);
            if (content instanceof NotificationMessageContent) {
              content.fromSelf = msg.from === wfc.getUserId();
            }
          } catch (error) {
            formatAppLog("error", "at wfc/messages/message.js:107", "decode message payload failed, fallback to unkownMessage", msg.content, error);
            let flag = MessageConfig.getMessageContentPersitFlag(msg.content.type);
            if (PersistFlag.Persist === flag || PersistFlag.Persist_And_Count === flag) {
              content = new UnknownMessageContent(msg.content);
            } else {
              return null;
            }
          }
          msg.messageContent = content;
          if (content instanceof UnknownMessageContent) {
            formatAppLog("log", "at wfc/messages/message.js:117", "unknownMessage Content", obj);
          }
        } else {
          formatAppLog("error", "at wfc/messages/message.js:121", "message content not register", obj);
        }
        return msg;
      } else {
        let msg = new Message();
        msg.from = obj.fromUser;
        msg.content = obj.content;
        msg.messageUid = obj.messageId;
        msg.localExtra = obj.localExtra;
        msg.timestamp = obj.serverTimestamp;
        let contentClazz = MessageConfig.getMessageContentClazz(obj.content.type);
        if (contentClazz) {
          let content = new contentClazz();
          try {
            if (obj.content.data && obj.content.data.length > 0) {
              obj.content.binaryContent = encode(obj.content.data);
            }
            content.decode(obj.content);
            content.extra = obj.content.extra;
            if (content instanceof NotificationMessageContent) {
              content.fromSelf = msg.from === wfc.getUserId();
            }
          } catch (error) {
            formatAppLog("error", "at wfc/messages/message.js:146", "decode message payload failed, fallback to unkownMessage", obj.content, error);
            let flag = MessageConfig.getMessageContentPersitFlag(obj.content.type);
            if (PersistFlag.Persist === flag || PersistFlag.Persist_And_Count === flag) {
              content = new UnknownMessageContent(obj.content);
            } else {
              return null;
            }
          }
          msg.messageContent = content;
          if (content instanceof UnknownMessageContent) {
            formatAppLog("log", "at wfc/messages/message.js:156", "unknownMessage Content", obj);
          }
        } else {
          formatAppLog("error", "at wfc/messages/message.js:159", "message content not register", obj);
        }
        if (msg.from === wfc.getUserId()) {
          msg.conversation = new Conversation(obj.conversation.type, obj.conversation.target, obj.conversation.line);
          msg.direction = 0;
          msg.status = MessageStatus.Sent;
        } else {
          if (obj.conversation.type === ConversationType.Single) {
            msg.conversation = new Conversation(obj.conversation.type, obj.fromUser, obj.conversation.line);
          } else {
            msg.conversation = new Conversation(obj.conversation.type, obj.conversation.target, obj.conversation.line);
          }
          msg.direction = 1;
          msg.status = MessageStatus.Unread;
          if (msg.content.mentionedType === 2) {
            msg.status = MessageStatus.AllMentioned;
          } else if (msg.content.mentionedType === 1) {
            for (const target of msg.content.mentionedTarget) {
              if (target === wfc.getUserId()) {
                msg.status = MessageStatus.Mentioned;
                break;
              }
            }
          }
        }
        return msg;
      }
    }
    static messageContentFromMessagePayload(payload, from) {
      let contentClazz = MessageConfig.getMessageContentClazz(payload.type);
      contentClazz = contentClazz ? contentClazz : UnsupportMessageContent;
      let content = new contentClazz();
      content.decode(payload);
      let selfUid = wfc.getUserId();
      if (content instanceof NotificationMessageContent) {
        if (content instanceof RecallMessageNotification) {
          if (content.operatorId === selfUid) {
            content.fromSelf = true;
          }
        } else if (from === selfUid) {
          content.fromSelf = true;
        }
      }
      return content;
    }
    static toMessagePayload(message2) {
      return message2.messageContent.encode();
    }
  }
  class ConversationInfo {
    constructor() {
      __publicField(this, "conversation", {});
      __publicField(this, "lastMessage", {});
      __publicField(this, "timestamp", 0);
      __publicField(this, "draft", "");
      __publicField(this, "unreadCount", {});
      __publicField(this, "top", 0);
      __publicField(this, "isSilent", false);
      // TODO cache, maybe userInfo, groupInfo
      __publicField(this, "target");
    }
    static protoConversationToConversationInfo(obj) {
      let conversationInfo = Object.assign(new ConversationInfo(), obj);
      conversationInfo.top = obj.isTop;
      delete conversationInfo.isTop;
      if (obj.conversation) {
        conversationInfo.conversation = new Conversation(obj.conversation.type, obj.conversation.target, obj.conversation.line);
      } else {
        conversationInfo.conversation = new Conversation(obj.conversationType, obj.target, obj.line);
      }
      conversationInfo.lastMessage = Message.fromProtoMessage(obj.lastMessage);
      if (!conversationInfo.timestamp) {
        conversationInfo.timestamp = 0;
      }
      return conversationInfo;
    }
    portrait() {
      let portrait = "";
      switch (this.conversation.type) {
        case ConversationType.Single:
          let u = wfc.getUserInfo(this.conversation.target, false);
          portrait = u.portrait;
          break;
        case ConversationType.Group:
          let g = wfc.getGroupInfo(this.conversation.target, false);
          portrait = g.portrait;
          break;
      }
      return portrait;
    }
    title() {
      let targetName = this.conversation.target;
      switch (this.conversation.type) {
        case ConversationType.Single:
          targetName = wfc.getUserDisplayName(this.conversation.target);
          break;
        case ConversationType.Group:
          let g = wfc.getGroupInfo(this.conversation.target, false);
          targetName = g.name;
          break;
      }
      return targetName;
    }
    static equals(info1, info2) {
      if (!info1 || !info2) {
        return false;
      }
      if (!info1.conversation.equal(info2.conversation)) {
        return false;
      }
      let unreadCount1 = info1.unreadCount;
      let unreadCount2 = info2.unreadCount;
      if (unreadCount1.unread !== unreadCount2.unread || unreadCount1.unreadMention !== unreadCount2.unreadMention || unreadCount1.unreadMentionAll !== unreadCount2.unreadMentionAll) {
        return false;
      }
      if (info1.lastMessage && !info2.lastMessage || !info1.lastMessage && info2.lastMessage) {
        return false;
      }
      if (info1.lastMessage && info2.lastMessage && info1.lastMessage.messageId !== info2.lastMessage.messageId) {
        return false;
      }
      return eq(info1.timestamp, info2.timestamp) && info1.draft === info2.draft;
    }
  }
  class EventType {
  }
  // function (message) {}
  __publicField(EventType, "SendMessage", "sendMsg");
  // function (message, hasMore) {}
  __publicField(EventType, "ReceiveMessage", "receiveMsg");
  // function (Map(userId, receiveTime)) {}
  __publicField(EventType, "MessageReceived", "msgReceived");
  // function ([readEntry]) {}
  __publicField(EventType, "MessageRead", "msgRead");
  // 主动调用recallMessage时，也会触发
  // function (operator, messageUid) {}
  __publicField(EventType, "RecallMessage", "recallMsg");
  // 远程删除消息时触发
  // function (messageUid) {}
  __publicField(EventType, "MessageDeleted", "msgDeleted");
  // function (messageId) {}
  // 本地主动删除消息时触发
  __publicField(EventType, "DeleteMessage", "deleteMsg");
  // function (message) {}
  __publicField(EventType, "MessageStatusUpdate", "msgStatusUpdate");
  // function (connectionStatus) {}
  __publicField(EventType, "ConnectionStatusChanged", "connectionStatusChanged");
  // function (host/ip/port) {}
  __publicField(EventType, "ConnectToServer", "connectToServer");
  // function (userInfos) {}
  __publicField(EventType, "UserInfosUpdate", "userInfosUpdate");
  // function (channelInfos) {}
  __publicField(EventType, "ChannelInfosUpdate", "channelInfosUpdate");
  // function (groupInfos) {}
  __publicField(EventType, "GroupInfosUpdate", "groupInfosUpdate");
  // function (updatedFriendIds) {}
  __publicField(EventType, "FriendListUpdate", "friendListUpdate");
  // function ([newFriendRequests]) {}
  __publicField(EventType, "FriendRequestUpdate", "friendRequestUpdate");
  // function (conversationInfo) {}
  __publicField(EventType, "ConversationInfoUpdate", "conversationInfoUpdate");
  // function () {}
  __publicField(EventType, "SettingUpdate", "settingUpdate");
  // function (groupId, GroupMember[]) {}
  __publicField(EventType, "GroupMembersUpdate", "groupMembersUpdate");
  // function (event) {}
  __publicField(EventType, "ConferenceEvent", "conferenceEvent");
  // function (UserOnlineState[]) {}
  __publicField(EventType, "UserOnlineEvent", "onlineEvent");
  // function (targetId, playedMessageId) {}
  __publicField(EventType, "SecretChatStartBurn", "secretChatStartBurn");
  // function ([messageId]) {}
  __publicField(EventType, "SecretChatMessageBurned", "secretChatMessageBurned");
  // function (targetId) {}
  __publicField(EventType, "SecretChatStateChange", "secretChatStateChange");
  class UserInfo {
    constructor() {
      __publicField(this, "uid", "");
      __publicField(this, "name", "");
      __publicField(this, "displayName", "");
      __publicField(this, "groupAlias", "");
      __publicField(this, "friendAlias", "");
      __publicField(this, "gender", 0);
      __publicField(this, "portrait", "");
      __publicField(this, "mobile", "");
      __publicField(this, "email", "");
      __publicField(this, "address", "");
      __publicField(this, "social", "");
      __publicField(this, "extra", "");
      __publicField(this, "type", 0);
      //0 normal; 1 robot; 2 thing;
      //0 normal; 1 deleted;
      __publicField(this, "deleted", 0);
      __publicField(this, "updateDt", 0);
    }
  }
  class NullUserInfo extends UserInfo {
    constructor(userId) {
      super();
      this.uid = userId;
      this.name = "用户";
      this.displayName = this.name;
      this.portrait = "";
    }
  }
  class GroupType {
  }
  __publicField(GroupType, "Normal", 0);
  __publicField(GroupType, "Free", 1);
  __publicField(GroupType, "Restricted", 2);
  __publicField(GroupType, "Organization", 3);
  class GroupInfo {
    constructor() {
      __publicField(this, "target", "");
      __publicField(this, "name", "");
      __publicField(this, "portrait", "");
      __publicField(this, "owner", "");
      __publicField(this, "type", GroupType.Normal);
      __publicField(this, "memberCount", 0);
      __publicField(this, "extra", "");
      __publicField(this, "remark", "");
      __publicField(this, "updateDt", 0);
      __publicField(this, "deleted", 0);
      __publicField(this, "memberDt", 0);
      //0 正常；1 全局禁言
      __publicField(this, "mute", 0);
      //在group type为Restricted时，0 开放加入权限（群成员可以拉人，用户也可以主动加入）；1 只能群成员拉人入群；2 只能群管理拉人入群
      __publicField(this, "joinType", 0);
      //是否运行群中普通成员私聊。0 允许，1不允许
      __publicField(this, "privateChat", 0);
      //是否是超级群组
      __publicField(this, "superGroup", 0);
      //是否可以搜索到该群，功能暂未实现
      __publicField(this, "searchable");
      //是否可以查看群历史消息, 0 不允许，1允许。仅专业版有效
      __publicField(this, "historyMessage");
      //群最大成员数。仅专业版有效
      __publicField(this, "maxMemberCount");
    }
  }
  class NullGroupInfo extends GroupInfo {
    constructor(groupId) {
      super();
      this.target = groupId;
      this.name = "群聊";
    }
  }
  class GroupMember {
    constructor() {
      __publicField(this, "groupId", "");
      __publicField(this, "memberId", "");
      __publicField(this, "alias", "");
      __publicField(this, "extra", "");
      __publicField(this, "type", 0);
      __publicField(this, "updateDt", 0);
      __publicField(this, "createDt", 0);
    }
    getName() {
      let u = wfc.getUserInfo(this.memberId);
      return u.displayName;
    }
    getPortrait() {
      let u = wfc.getUserInfo(this.memberId);
      return u.portrait;
    }
  }
  class UserSettingScope {
  }
  //不能直接使用，调用setConversation:silent:方法会使用到此值。
  __publicField(UserSettingScope, "ConversationSilent", 1);
  __publicField(UserSettingScope, "GlobalSilent", 2);
  //不能直接使用，调用setConversation:top:方法会使用到此值。
  __publicField(UserSettingScope, "ConversationTop", 3);
  __publicField(UserSettingScope, "HiddenNotificationDetail", 4);
  __publicField(UserSettingScope, "GroupHideNickname", 5);
  __publicField(UserSettingScope, "FavoriteGroup", 6);
  //不能直接使用，协议栈内会使用此值
  __publicField(UserSettingScope, "Conversation_Sync", 7);
  //不能直接使用，协议栈内会使用此值
  __publicField(UserSettingScope, "My_Channel", 8);
  //不能直接使用，协议栈内会使用此值
  __publicField(UserSettingScope, "Listened_Channel", 9);
  __publicField(UserSettingScope, "UserSettingPCOnline", 10);
  __publicField(UserSettingScope, "UserSettingConversationReaded", 11);
  __publicField(UserSettingScope, "WebOnline", 12);
  __publicField(UserSettingScope, "DisableReceipt", 13);
  __publicField(UserSettingScope, "FavoriteUser", 14);
  __publicField(UserSettingScope, "MuteWhenPCOnline", 15);
  __publicField(UserSettingScope, "LinesReaded", 16);
  __publicField(UserSettingScope, "NoDisturbing", 17);
  __publicField(UserSettingScope, "ConversationClearMessage", 18);
  __publicField(UserSettingScope, "ConversationDraft", 19);
  __publicField(UserSettingScope, "DisableSyncDraft", 20);
  __publicField(UserSettingScope, "VoipSilent", 21);
  __publicField(UserSettingScope, "PttReserved", 22);
  __publicField(UserSettingScope, "CustomState", 23);
  __publicField(UserSettingScope, "DisableSecretChat", 24);
  __publicField(UserSettingScope, "PttSilent", 25);
  __publicField(UserSettingScope, "GroupRemark", 26);
  // 用户自定义的scope需从1000开始，以防冲突
  __publicField(UserSettingScope, "kUserSettingCustomBegin", 1e3);
  let UnreadCount$1 = class UnreadCount {
    constructor() {
      // 单聊未读数
      __publicField(this, "unread", 0);
      // 群聊@数
      __publicField(this, "unreadMention", 0);
      // 群聊@All数
      __publicField(this, "unreadMentionAll", 0);
    }
  };
  class ConversationSearchResult {
    constructor() {
      __publicField(this, "conversation");
      //only matchCount == 1, load the message
      __publicField(this, "matchMessage");
      __publicField(this, "timestamp");
      __publicField(this, "matchCount");
    }
    static fromProtoConversationSearchResult(obj) {
      let conversationSearchResult = new ConversationSearchResult();
      if (obj.conversation) {
        conversationSearchResult.conversation = new Conversation(obj.conversation.conversationType !== void 0 ? obj.conversation.conversationType : obj.conversation.type, obj.conversation.target, obj.conversation.line);
      } else {
        conversationSearchResult.conversation = new Conversation(obj.conversationType, obj.target, obj.line);
      }
      conversationSearchResult.matchCount = obj.marchedCount;
      if (obj.marchedCount === 1) {
        conversationSearchResult.matchMessage = Message.fromProtoMessage(obj.marchedMessage);
      }
      conversationSearchResult.timestamp = Number(obj.timestamp);
      return conversationSearchResult;
    }
  }
  class GroupSearchResult {
    constructor() {
      __publicField(this, "groupInfo");
      //0 march group name, 1 march group member name, 2 both
      __publicField(this, "matchType");
      __publicField(this, "matchMembers", []);
    }
    static fromProtoGroupSearchResult(obj) {
      let groupSearchResult = new GroupSearchResult();
      groupSearchResult.groupInfo = Object.assign(new GroupInfo(), obj.groupInfo);
      groupSearchResult.matchType = obj.marchedType;
      groupSearchResult.matchMembers = obj.marchedMemberNames;
      return groupSearchResult;
    }
  }
  class FriendRequest {
    constructor() {
      __publicField(this, "direction");
      __publicField(this, "target");
      __publicField(this, "reason");
      __publicField(this, "extra");
      //    RequestStatus_Sent = 0,
      //    RequestStatus_Accepted = 1,
      //    RequestStatus_Rejected = 3
      __publicField(this, "status");
      __publicField(this, "readStatus");
      __publicField(this, "timestamp");
    }
  }
  class ChatRoomMemberInfo {
    constructor() {
      __publicField(this, "memberCount");
      __publicField(this, "members");
    }
  }
  class ChannelInfo {
    constructor() {
      __publicField(this, "channelId");
      __publicField(this, "name");
      __publicField(this, "portrait");
      __publicField(this, "desc");
      __publicField(this, "owner");
      // 0, public; 1, private; 2, destoryed
      __publicField(this, "status");
      __publicField(this, "extra");
      __publicField(this, "updateDt");
      __publicField(this, "menus");
    }
  }
  //第0位表示是否允许查看用户所有信息，还是只允许看用户id，用户名称，用户昵称和用户头像
  __publicField(ChannelInfo, "StatusMaskFullInfo", 1);
  //第1位表示是否允许查看非订阅用户信息
  __publicField(ChannelInfo, "StatusMaskUnsubscribedUserAccess", 2);
  //第2位表示是否允许主动添加用户订阅关系
  __publicField(ChannelInfo, "StatusMaskActiveSubscribe", 4);
  //第3位表示是否允许给非订阅用户发送消息
  __publicField(ChannelInfo, "StatusMaskMessageUnsubscribed", 8);
  //第4位表示是否私有
  __publicField(ChannelInfo, "StatusMaskPrivate", 16);
  //第6位表示是否删除
  __publicField(ChannelInfo, "StatusMaskDeleted", 64);
  //第8位表示是否全局频道，全局平道发送消息时，会广播给系统所有人
  __publicField(ChannelInfo, "StatusMaskGlobal", 128);
  class ConnectionStatus {
    static desc(status) {
      const desc = {
        "-9": "客户端和IM 服务端时间不同步，请进行时钟同步",
        "-8": "IM 服务未授权或已过期，专业版IM-Server 是绑定域名或者 ip 的，只能通过所绑定的域名去连接",
        "-7": "被踢下线",
        "-6": "会话密钥错误，请参考 https://docs.wildfirechat.cn/faq/general.html 第12个问题排查",
        "-5": "token错误",
        "-4": "IM Server服务无法连通，请检查服务器是否宕机或者网络出现问题",
        "-3": "连接被服务器拒绝，一般是用户被封禁",
        "-2": "退出登录",
        "-1": "连接失败",
        "0": "连接中",
        "1": "连接成功，正常状态，所有业务可用",
        "2": "正在同步信息，登录以后要先同步消息，可能同步数据量比较大，这时可以选择等待连接状态变为1时来统一更新UI"
      };
      return desc[status];
    }
  }
  __publicField(ConnectionStatus, "ConnectionStatusTimeInconsistent", -9);
  __publicField(ConnectionStatus, "ConnectionStatusNotLicensed", -8);
  __publicField(ConnectionStatus, "ConnectionStatusKickedOff", -7);
  __publicField(ConnectionStatus, "ConnectionStatusSecretKeyMismatch", -6);
  __publicField(ConnectionStatus, "ConnectionStatusTokenIncorrect", -5);
  __publicField(ConnectionStatus, "ConnectionStatusServerDown", -4);
  __publicField(ConnectionStatus, "ConnectionStatusRejected", -3);
  __publicField(ConnectionStatus, "ConnectionStatusLogout", -2);
  __publicField(ConnectionStatus, "ConnectionStatusUnconnected", -1);
  __publicField(ConnectionStatus, "ConnectionStatusConnecting", 0);
  __publicField(ConnectionStatus, "ConnectionStatusConnected", 1);
  __publicField(ConnectionStatus, "ConnectionStatusReceiveing", 2);
  class ChatRoomInfo {
    constructor() {
      __publicField(this, "chatRoomId");
      __publicField(this, "title");
      __publicField(this, "desc");
      __publicField(this, "portrait");
      __publicField(this, "extra");
      // 0, normal; 1, not start; 2, end
      __publicField(this, "state");
      __publicField(this, "memberCount");
      __publicField(this, "createDt");
      __publicField(this, "updateDt");
    }
  }
  class ReadEntry {
    constructor() {
      __publicField(this, "userId");
      __publicField(this, "conversation");
      __publicField(this, "readTime");
    }
  }
  class FileRecord {
    constructor() {
      __publicField(this, "userId");
      __publicField(this, "conversation");
      __publicField(this, "messageUid");
      __publicField(this, "name");
      __publicField(this, "url");
      __publicField(this, "size");
      __publicField(this, "downloadCount");
      __publicField(this, "timestamp");
    }
  }
  class NullChannelInfo extends ChannelInfo {
    constructor(channelId) {
      super();
      this.channelId = channelId;
      this.name = `<${channelId}>`;
    }
  }
  class UserOnlineState {
    constructor() {
      __publicField(this, "userId");
      __publicField(this, "customState");
      __publicField(this, "clientStates");
    }
    // 手机在线、web在线、pc在线
    desc() {
      if (this.customState.state > 0) {
        let cs = ["未设置", "忙碌", "离开(主动离开)", "离开(长时间未操作)", "隐身"];
        return this.customState.text + cs[this.customState.state];
      }
      let onlineClientDesc = "";
      let lastSeenDesc = "";
      this.clientStates.forEach((s) => {
        let ps = ["", "iOS", "Android", "Windows", "mac", "Web", "小程序", "Linux", "iPad", "Android-Pad"];
        if (s.state === 0) {
          onlineClientDesc += ps[s.platform] + " ";
        } else if ([1, 2, 8, 9].indexOf(s.platform) >= 0) {
          lastSeenDesc += ps[s.platform] + " ";
        }
      });
      if (onlineClientDesc.trim()) {
        return onlineClientDesc + "在线";
      } else if (lastSeenDesc.trim()) {
        return lastSeenDesc + "不久前在线";
      }
      return "";
    }
  }
  class UserCustomState {
    constructor() {
      //0，未设置，1 忙碌，2 离开（主动设置），3 离开（长时间不操作），4 隐身，其它可以自主扩展。
      __publicField(this, "state");
      __publicField(this, "text");
    }
  }
  class UserClientState {
    constructor() {
      /**
       Platform_UNSET = 0;
       Platform_iOS = 1;
       Platform_Android = 2;
       Platform_Windows = 3;
       Platform_OSX = 4;
       Platform_WEB = 5;
       Platform_WX = 6;
       Platform_LINUX = 7;
       Platform_iPad = 8;
       Platform_APad = 9;
       */
      __publicField(this, "platform");
      //设备的在线状态，0是在线，1是有session但不在线，其它不在线。
      __publicField(this, "state");
      //最后可见
      __publicField(this, "lastSeen");
    }
  }
  const wfcClient_utsProxy = uni.requireUTSPlugin("uni_modules/wfc-client");
  class UtsWfcClient {
    constructor() {
      __publicField(this, "initProto", wfcClient_utsProxy.initProto);
      __publicField(this, "connect", wfcClient_utsProxy.connect);
      __publicField(this, "getConnectionStatus", wfcClient_utsProxy.getConnectionStatus);
      __publicField(this, "getClientId", wfcClient_utsProxy.getClientId);
      __publicField(this, "getConversationInfos", wfcClient_utsProxy.getConversationInfos);
      __publicField(this, "registerMessageFlag", wfcClient_utsProxy.registerMessageFlag);
      __publicField(this, "getUserSettings", wfcClient_utsProxy.getUserSettings);
      __publicField(this, "setWfcEventListener", wfcClient_utsProxy.setWfcEventListener);
      __publicField(this, "getGroupInfo", wfcClient_utsProxy.getGroupInfo);
      __publicField(this, "getUserInfo", wfcClient_utsProxy.getUserInfo);
      __publicField(this, "getGroupMembers", wfcClient_utsProxy.getGroupMembers);
      __publicField(this, "getUserInfos", wfcClient_utsProxy.getUserInfos);
      __publicField(this, "getConversationInfo", wfcClient_utsProxy.getConversationInfo);
      __publicField(this, "getListenedChannels", wfcClient_utsProxy.getListenedChannels);
      __publicField(this, "getChannelInfo", wfcClient_utsProxy.getChannelInfo);
      __publicField(this, "getMyFriendList", wfcClient_utsProxy.getMyFriendList);
      __publicField(this, "getFavGroups", wfcClient_utsProxy.getFavGroups);
      __publicField(this, "getFavUsers", wfcClient_utsProxy.getFavUsers);
      __publicField(this, "getIncommingFriendRequest", wfcClient_utsProxy.getIncommingFriendRequest);
      __publicField(this, "getGroupInfos", wfcClient_utsProxy.getGroupInfos);
      __publicField(this, "getUnreadFriendRequestStatus", wfcClient_utsProxy.getUnreadFriendRequestStatus);
      __publicField(this, "isFavGroup", wfcClient_utsProxy.isFavGroup);
      __publicField(this, "getAuthCode", wfcClient_utsProxy.getAuthCode);
      __publicField(this, "isMyFriend", wfcClient_utsProxy.isMyFriend);
      __publicField(this, "isReceiptEnabled", wfcClient_utsProxy.isReceiptEnabled);
      __publicField(this, "watchOnlineState", wfcClient_utsProxy.watchOnlineState);
      __publicField(this, "isUserReceiptEnabled", wfcClient_utsProxy.isUserReceiptEnabled);
      __publicField(this, "isSupportBigFilesUpload", wfcClient_utsProxy.isSupportBigFilesUpload);
      __publicField(this, "allowGroupMember", wfcClient_utsProxy.allowGroupMember);
      __publicField(this, "clearAllNotification", wfcClient_utsProxy.clearAllNotification);
      __publicField(this, "clearAllUnreadStatus", wfcClient_utsProxy.clearAllUnreadStatus);
      __publicField(this, "clearMessages", wfcClient_utsProxy.clearMessages);
      __publicField(this, "clearMessagesByTime", wfcClient_utsProxy.clearMessagesByTime);
      __publicField(this, "clearRemoteConversationMessages", wfcClient_utsProxy.clearRemoteConversationMessages);
      __publicField(this, "clearUnreadFriendRequestStatus", wfcClient_utsProxy.clearUnreadFriendRequestStatus);
      __publicField(this, "clearUnreadStatus", wfcClient_utsProxy.clearUnreadStatus);
      __publicField(this, "configApplication", wfcClient_utsProxy.configApplication);
      __publicField(this, "createChannel", wfcClient_utsProxy.createChannel);
      __publicField(this, "createGroup", wfcClient_utsProxy.createGroup);
      __publicField(this, "deleteFileRecord", wfcClient_utsProxy.deleteFileRecord);
      __publicField(this, "getMessagesV2", wfcClient_utsProxy.getMessagesV2);
      __publicField(this, "getConversationRead", wfcClient_utsProxy.getConversationRead);
      __publicField(this, "deleteFriend", wfcClient_utsProxy.deleteFriend);
      __publicField(this, "deleteMessage", wfcClient_utsProxy.deleteMessage);
      __publicField(this, "deleteRemoteMessage", wfcClient_utsProxy.deleteRemoteMessage);
      __publicField(this, "destoryChannel", wfcClient_utsProxy.destoryChannel);
      __publicField(this, "dismissGroup", wfcClient_utsProxy.dismissGroup);
      __publicField(this, "getAuthorizedMediaUrl", wfcClient_utsProxy.getAuthorizedMediaUrl);
      __publicField(this, "getBlackList", wfcClient_utsProxy.getBlackList);
      __publicField(this, "getChatroomInfo", wfcClient_utsProxy.getChatroomInfo);
      __publicField(this, "getChatroomMemberInfo", wfcClient_utsProxy.getChatroomMemberInfo);
      __publicField(this, "getConversationFiles", wfcClient_utsProxy.getConversationFiles);
      __publicField(this, "getConversationFirstUnreadMessageId", wfcClient_utsProxy.getConversationFirstUnreadMessageId);
      __publicField(this, "getConversationUnreadCount", wfcClient_utsProxy.getConversationUnreadCount);
      __publicField(this, "getFriendAlias", wfcClient_utsProxy.getFriendAlias);
      __publicField(this, "getFriendList", wfcClient_utsProxy.getFriendList);
      __publicField(this, "getFriendList", wfcClient_utsProxy.getFriendList);
      __publicField(this, "getMyFiles", wfcClient_utsProxy.getMyFiles);
      __publicField(this, "getOutgoingFriendRequest", wfcClient_utsProxy.getOutgoingFriendRequest);
      __publicField(this, "getRemoteMessage", wfcClient_utsProxy.getRemoteMessage);
      __publicField(this, "getRemoteMessages", wfcClient_utsProxy.getRemoteMessages);
      __publicField(this, "getServerDeltaTime", wfcClient_utsProxy.getServerDeltaTime);
      __publicField(this, "getUnreadCount", wfcClient_utsProxy.getUnreadCount);
      __publicField(this, "getUploadMediaUrl", wfcClient_utsProxy.getUploadMediaUrl);
      __publicField(this, "getUserInfoEx", wfcClient_utsProxy.getUserInfoEx);
      __publicField(this, "getUserMessages", wfcClient_utsProxy.getUserMessages);
      __publicField(this, "getUserMessagesEx", wfcClient_utsProxy.getUserMessagesEx);
      __publicField(this, "getUserMessagesExV2", wfcClient_utsProxy.getUserMessagesExV2);
      __publicField(this, "getUserMessagesV2", wfcClient_utsProxy.getUserMessagesV2);
      __publicField(this, "getUserSetting", wfcClient_utsProxy.getUserSetting);
      __publicField(this, "handleFriendRequest", wfcClient_utsProxy.handleFriendRequest);
      __publicField(this, "insertMessage", wfcClient_utsProxy.insertMessage);
      __publicField(this, "isBlackListed", wfcClient_utsProxy.isBlackListed);
      __publicField(this, "isCommercialServer", wfcClient_utsProxy.isCommercialServer);
      __publicField(this, "isEnableUserOnlineState", wfcClient_utsProxy.isEnableUserOnlineState);
      __publicField(this, "isFavUser", wfcClient_utsProxy.isFavUser);
      __publicField(this, "isGlobalDisableSyncDraft", wfcClient_utsProxy.isGlobalDisableSyncDraft);
      __publicField(this, "isGlobalSlient", wfcClient_utsProxy.isGlobalSlient);
      __publicField(this, "isHiddenNotificationDetail", wfcClient_utsProxy.isHiddenNotificationDetail);
      __publicField(this, "isListenedChannel", wfcClient_utsProxy.isListenedChannel);
      __publicField(this, "joinChatroom", wfcClient_utsProxy.joinChatroom);
      __publicField(this, "kickoffMembers", wfcClient_utsProxy.kickoffMembers);
      __publicField(this, "listenChannel", wfcClient_utsProxy.listenChannel);
      __publicField(this, "loadFriendRequestFromRemote", wfcClient_utsProxy.loadFriendRequestFromRemote);
      __publicField(this, "modifyChannelInfo", wfcClient_utsProxy.modifyChannelInfo);
      __publicField(this, "modifyGroupAlias", wfcClient_utsProxy.modifyGroupAlias);
      __publicField(this, "modifyGroupInfo", wfcClient_utsProxy.modifyGroupInfo);
      __publicField(this, "modifyGroupMemberAlias", wfcClient_utsProxy.modifyGroupMemberAlias);
      __publicField(this, "modifyGroupMemberExtra", wfcClient_utsProxy.modifyGroupMemberExtra);
      __publicField(this, "modifyMyInfo", wfcClient_utsProxy.modifyMyInfo);
      __publicField(this, "muteGroupMember", wfcClient_utsProxy.muteGroupMember);
      __publicField(this, "quitChatroom", wfcClient_utsProxy.quitChatroom);
      __publicField(this, "quitGroup", wfcClient_utsProxy.quitGroup);
      __publicField(this, "quitGroupEx", wfcClient_utsProxy.quitGroupEx);
      __publicField(this, "recall", wfcClient_utsProxy.recall);
      __publicField(this, "removeConversation", wfcClient_utsProxy.removeConversation);
      __publicField(this, "searchChannel", wfcClient_utsProxy.searchChannel);
      __publicField(this, "searchConversation", wfcClient_utsProxy.searchConversation);
      __publicField(this, "searchFiles", wfcClient_utsProxy.searchFiles);
      __publicField(this, "searchFriends", wfcClient_utsProxy.searchFriends);
      __publicField(this, "searchGroups", wfcClient_utsProxy.searchGroups);
      __publicField(this, "searchMessage", wfcClient_utsProxy.searchMessage);
      __publicField(this, "searchMessageByTypes", wfcClient_utsProxy.searchMessageByTypes);
      __publicField(this, "searchMessageByTypesAndTimes", wfcClient_utsProxy.searchMessageByTypesAndTimes);
      __publicField(this, "searchMessageEx", wfcClient_utsProxy.searchMessageEx);
      __publicField(this, "searchMessageEx2", wfcClient_utsProxy.searchMessageEx2);
      __publicField(this, "searchMyFiles", wfcClient_utsProxy.searchMyFiles);
      __publicField(this, "searchUser", wfcClient_utsProxy.searchUser);
      __publicField(this, "sendConferenceRequest", wfcClient_utsProxy.sendConferenceRequest);
      __publicField(this, "sendFriendRequest", wfcClient_utsProxy.sendFriendRequest);
      __publicField(this, "sendMessage", wfcClient_utsProxy.sendMessage);
      __publicField(this, "setBackupAddress", wfcClient_utsProxy.setBackupAddress);
      __publicField(this, "setBackupAddressStrategy", wfcClient_utsProxy.setBackupAddressStrategy);
      __publicField(this, "setBlackList", wfcClient_utsProxy.setBlackList);
      __publicField(this, "setConversationDraft", wfcClient_utsProxy.setConversationDraft);
      __publicField(this, "setConversationSlient", wfcClient_utsProxy.setConversationSlient);
      __publicField(this, "setConversationTimestamp", wfcClient_utsProxy.setConversationTimestamp);
      __publicField(this, "setConversationTop", wfcClient_utsProxy.setConversationTop);
      __publicField(this, "setDeviceToken", wfcClient_utsProxy.setDeviceToken);
      __publicField(this, "setFavGroup", wfcClient_utsProxy.setFavGroup);
      __publicField(this, "setFavUser", wfcClient_utsProxy.setFavUser);
      __publicField(this, "setFriendAlias", wfcClient_utsProxy.setFriendAlias);
      __publicField(this, "setGlobalSlient", wfcClient_utsProxy.setGlobalSlient);
      __publicField(this, "setGroupManager", wfcClient_utsProxy.setGroupManager);
      __publicField(this, "setHiddenNotificationDetail", wfcClient_utsProxy.setHiddenNotificationDetail);
      __publicField(this, "setLastReceivedMessageUnRead", wfcClient_utsProxy.setLastReceivedMessageUnRead);
      __publicField(this, "setMediaMessagePlayed", wfcClient_utsProxy.setMediaMessagePlayed);
      __publicField(this, "setMessageLocalExtra", wfcClient_utsProxy.setMessageLocalExtra);
      __publicField(this, "setProxyInfo", wfcClient_utsProxy.setProxyInfo);
      __publicField(this, "setUserAgent", wfcClient_utsProxy.setUserAgent);
      __publicField(this, "setUserReceiptEnable", wfcClient_utsProxy.setUserReceiptEnable);
      __publicField(this, "setUserSetting", wfcClient_utsProxy.setUserSetting);
      __publicField(this, "transferGroup", wfcClient_utsProxy.transferGroup);
      __publicField(this, "unwatchOnlineState", wfcClient_utsProxy.unwatchOnlineState);
      __publicField(this, "updateMessage", wfcClient_utsProxy.updateMessage);
      __publicField(this, "updateMessageStatus", wfcClient_utsProxy.updateMessageStatus);
      __publicField(this, "updateRemoteMessageContent", wfcClient_utsProxy.updateRemoteMessageContent);
      __publicField(this, "uploadMedia", wfcClient_utsProxy.uploadMedia);
      __publicField(this, "useSM4", wfcClient_utsProxy.useSM4);
      __publicField(this, "getMessageByUid", wfcClient_utsProxy.getMessageByUid);
      __publicField(this, "getGroupMember", wfcClient_utsProxy.getGroupMember);
      __publicField(this, "addMembers", wfcClient_utsProxy.addMembers);
      __publicField(this, "getMessage", wfcClient_utsProxy.getMessage);
      __publicField(this, "disconnect", wfcClient_utsProxy.disconnect);
    }
  }
  const utsWfcClient = new UtsWfcClient();
  class WfcImpl {
    constructor() {
      __publicField(this, "connectionStatus", 0);
      __publicField(this, "userId", "");
      __publicField(this, "token", "");
      __publicField(this, "isLogined", false);
      __publicField(this, "firstSync", true);
      // TODO 移除吧，全都走EventEmitter
      // onReceiveMessageListeners = [];
      __publicField(this, "messageContentList", []);
      __publicField(this, "eventEmitter", null);
      __publicField(this, "needPreloadDefaultData", false);
      __publicField(this, "_nativeEvent2WfcEvent", {
        // 'onChannelInfoUpdate': EventType.ChannelInfosUpdate,
        // 'onClearMessage': null,
        // 'onConferenceEvent': EventType.ConferenceEvent,
        // 'onConnectToServer': EventType.ConnectToServer,
        // 'onConnectionStatusChange': EventType.ConnectionStatusChanged,
        // 'onConversationDraftUpdate': null,
        // 'onDeleteMessage': EventType.DeleteMessage,
        // 'onFriendListUpdate': EventType.FriendListUpdate,
        // 'onGroupInfoUpdate': EventType.GroupInfosUpdate,
        // 'onGroupMembersUpdate': EventType.GroupMembersUpdate,
        // 'onServiceConnected': null,
        // 'onMessageDelivered': EventType.MessageReceived,
        // 'onMessageRead': EventType.MessageRead,
        // 'onMessageUpdate': EventType.MessageStatusUpdate,
        // 'onReceiveMessage': EventType.ReceiveMessage,
        // 'onRecallMessage': EventType.RecallMessage,
        // 'onConversationRemove': null,
        // 'onMediaUpload': null,
        // 'onSettingUpdate': EventType.SettingUpdate,
        // 'onTrafficData': null,
        // 'onUserInfoUpdate': EventType.UserInfosUpdate,
        // 'onUserOnlineEvent': EventType.UserOnlineEvent,
        "onChannelInfoUpdate": this.onChannelInfoUpdate,
        "onClearMessage": null,
        "onConferenceEvent": this.onConferenceEvent,
        "onConnectToServer": this.onConnectToServer,
        "onConnectionStatusChange": this.onConnectionChanged,
        "onConversationDraftUpdate": null,
        "onDeleteMessage": this.onDeleteRemoteMessage,
        "onFriendListUpdate": this.onFriendListUpdate,
        "onFriendRequestUpdate": this.onFriendRequestUpdate,
        "onGroupInfoUpdate": this.onGroupInfoUpdate,
        "onGroupMembersUpdate": this.onGroupMemberUpdateListener,
        "onServiceConnected": null,
        "onMessageDelivered": this.onUserReceivedMessage,
        "onMessageRead": this.onUserReadedMessage,
        "onMessageUpdate": this.onMessageUpdate,
        "onReceiveMessage": this.onReceiveMessage,
        "onRecallMessage": this.onRecallMessage,
        "onConversationRemove": null,
        "onSettingUpdate": this.onSettingUpdate,
        "onTrafficData": null,
        "onUserInfoUpdate": this.onUserInfoUpdate,
        "onUserOnlineEvent": this.onOnlineEvent,
        // sendMessageListener
        "onSendSuccess": this.onSendSuccess,
        "onSendFail": this.onSendFail,
        "onSendPrepare": this.onSendPrepare,
        "onProgress": this.onProgress,
        "onMediaUpload": this.onMediaUpload
      });
    }
    onConnectionChanged(status) {
      status = Number(status);
      if (!self$6.isLogined && status == ConnectionStatus.ConnectionStatusConnected) {
        self$6.isLogined = true;
      }
      if (status === ConnectionStatus.ConnectionStatusConnected) {
        if (self$6.needPreloadDefaultData) {
          let estimatedTime = self$6._preloadDefaultData();
          formatAppLog("log", "at wfc/proto/proto.min.js:90", "to load default data", estimatedTime);
          setTimeout(() => {
            self$6.connectionStatus = status;
            self$6.eventEmitter.emit(EventType.ConnectionStatusChanged, status);
          }, estimatedTime);
        } else {
          self$6.connectionStatus = status;
          self$6.eventEmitter.emit(EventType.ConnectionStatusChanged, status);
        }
      } else {
        self$6.connectionStatus = status;
        self$6.eventEmitter.emit(EventType.ConnectionStatusChanged, status);
      }
      formatAppLog("log", "at wfc/proto/proto.min.js:103", "connection status changed", status);
      if (self$6.isLogined && (status == ConnectionStatus.ConnectionStatusSecretKeyMismatch || status === ConnectionStatus.ConnectionStatusRejected)) {
        self$6.disconnect();
      }
    }
    onConnectToServer(host, ip, port) {
      formatAppLog("log", "at wfc/proto/proto.min.js:110", "connect to server", host, ip, port);
      self$6.eventEmitter.emit(EventType.ConnectToServer, host);
    }
    // /**
    //  *
    //  * @param {function} listener
    //  */
    // setOnReceiveMessageListener(listener) {
    //     if (typeof listener !== 'function') {
    //         __f__('log','at wfc/proto/proto.min.js:120','listener should be a function');
    //         return;
    //     }
    //     self.onReceiveMessageListeners.forEach(l => {
    //         l === listener
    //         return
    //     });
    //     self.onReceiveMessageListeners.push(listener);
    // }
    // removeOnReceiMessageListener(listener) {
    //     if (typeof listener !== 'function') {
    //         __f__('log','at wfc/proto/proto.min.js:132','listener should be a function');
    //         return;
    //     }
    //     self.onReceiveMessageListeners.splice(self.onReceiveMessageListeners.indexOf(listener), 1);
    // }
    onReceiveMessage(messages2, hasMore) {
      if (!self$6.isLogined) {
        return;
      }
      if (self$6.connectionStatus === 2 && self$6.firstSync) {
        return;
      }
      if (self$6.connectionStatus === 1) {
        self$6.firstSync = false;
      }
      var msgs = JSON.parse(messages2);
      msgs.forEach((m) => {
        let msg = Message.fromProtoMessage(m);
        if (msg.messageContent instanceof MarkUnreadMessageContent && msg.from === self$6.userId) {
          let markMsg = msg.messageContent;
          let conversation2 = msg.conversation;
          utsWfcClient.setLastReceivedMessageUnRead(JSON.stringify(conversation2), stringValue(markMsg.messageUid), stringValue(markMsg.timestamp));
        }
        if (msg) {
          self$6.eventEmitter.emit(EventType.ReceiveMessage, msg, hasMore);
        }
      });
    }
    onConferenceEvent(event) {
      self$6.eventEmitter.emit(EventType.ConferenceEvent, event);
    }
    onOnlineEvent(event) {
      let userOnlineStates = self$6._parseUserOnlineState(event);
      self$6.eventEmitter.emit(EventType.UserOnlineEvent, userOnlineStates);
    }
    onSendSuccess(message2) {
      let msg = Message.fromProtoMessage(JSON.parse(message2));
      self$6.eventEmitter.emit(EventType.MessageStatusUpdate, msg);
    }
    onSendFail(message2, errorCode) {
      let msg = Message.fromProtoMessage(JSON.parse(message2));
      self$6.eventEmitter.emit(EventType.MessageStatusUpdate, msg);
    }
    onSendPrepare(message2, savedTime) {
      let msg = Message.fromProtoMessage(JSON.parse(message2));
      self$6.eventEmitter.emit(EventType.SendMessage, msg);
    }
    onProgress(message2, uploaded, total) {
    }
    onMediaUpload(message2, remoteUrl) {
      let msg = Message.fromProtoMessage(JSON.parse(message2));
      self$6.eventEmitter.emit(EventType.MessageStatusUpdate, msg);
    }
    onMessageUpdate(message2) {
      let msg = Message.fromProtoMessage(JSON.parse(message2));
      self$6.eventEmitter.emit(EventType.MessageStatusUpdate, msg);
    }
    _parseUserOnlineState(userOnlineStateStr) {
      let userOnlineStates = [];
      let states = JSON.parse(userOnlineStateStr);
      states.forEach((s) => {
        let userOnlineState = new UserOnlineState();
        userOnlineState.userId = s.userId;
        userOnlineState.customState = new UserCustomState();
        userOnlineState.customState.state = s.customState;
        userOnlineState.customState.text = s.customText;
        userOnlineState.clientStates = [];
        let clientStates = s.states ? s.states : s.clientStates;
        if (clientStates) {
          clientStates.forEach((ss) => {
            let clientState = new UserClientState();
            clientState.state = ss.state;
            clientState.platform = ss.platform;
            clientState.lastSeen = Long.fromValue(ss.lastSeen);
            userOnlineState.clientStates.push(clientState);
          });
        }
        userOnlineStates.push(userOnlineState);
      });
      return userOnlineStates;
    }
    onGroupInfoUpdate(groupInfosStr) {
      if (!self$6.isLogined) {
        return;
      }
      let groupInfoArray = JSON.parse(groupInfosStr);
      let groupInfos = [];
      groupInfoArray.forEach((groupInfo) => {
        groupInfos.push(Object.assign(new GroupInfo(), groupInfo));
      });
      self$6.eventEmitter.emit(EventType.GroupInfosUpdate, groupInfos);
    }
    onChannelInfoUpdate(channelListIds) {
      if (!self$6.isLogined) {
        return;
      }
      let channelInfoArray = JSON.parse(channelListIds);
      let channelInfos = [];
      channelInfoArray.forEach((info) => {
        channelInfos.push(Object.assign(new ChannelInfo(), info));
      });
      self$6.eventEmitter.emit(EventType.ChannelInfosUpdate, channelInfos);
    }
    onGroupMemberUpdateListener(groupId, groupMembersStr) {
      if (!self$6.isLogined) {
        return;
      }
      let members = [];
      let memberIds = [];
      let arr = JSON.parse(groupMembersStr);
      arr.forEach((e) => {
        members.push(Object.assign(new GroupMember(), e));
        memberIds.push(e.memberId);
      });
      self$6._preloadGroupMemberUserInfos(memberIds);
      self$6.eventEmitter.emit(EventType.GroupMembersUpdate, groupId, members);
    }
    onSettingUpdate() {
      if (!self$6.isLogined) {
        return;
      }
      self$6.eventEmitter.emit(EventType.SettingUpdate);
    }
    onRecallMessage(operatorUid, messageUid) {
      if (!self$6.isLogined) {
        return;
      }
      self$6.eventEmitter.emit(EventType.RecallMessage, operatorUid, Long.fromValue(messageUid));
    }
    onDeleteRemoteMessage(messageUid) {
      if (!self$6.isLogined) {
        return;
      }
      self$6.eventEmitter.emit(EventType.MessageDeleted, Long.fromValue(messageUid));
    }
    onUserReceivedMessage(receivedMapStr) {
      if (!self$6.isLogined) {
        return;
      }
      let deliveries = JSON.parse(receivedMapStr);
      let deliveryMap = /* @__PURE__ */ new Map();
      deliveries.forEach((e) => {
        deliveryMap.set(e.key, e.value);
      });
      self$6.eventEmitter.emit(EventType.MessageReceived, deliveryMap);
      formatAppLog("log", "at wfc/proto/proto.min.js:306", "onreceive", deliveryMap);
    }
    onUserReadedMessage(readedMapStr) {
      if (!self$6.isLogined) {
        return;
      }
      let arr = JSON.parse(readedMapStr);
      let readEntries = [];
      arr.forEach((e) => {
        let entry = new ReadEntry();
        entry.userId = e.userId;
        if (e.conversation) {
          entry.conversation = Object.assign(new Conversation(), e.conversation);
        } else {
          entry.conversation = new Conversation(e.conversationType, e.target, e.line);
        }
        entry.readTime = e.readDt;
        readEntries.push(entry);
      });
      self$6.eventEmitter.emit(EventType.MessageRead, readEntries);
    }
    onMessageDeleted(messageId) {
      if (!self$6.isLogined) {
        return;
      }
      self$6.eventEmitter.emit(EventType.DeleteMessage, messageId);
    }
    onUserInfoUpdate(userInfosStr) {
      if (!self$6.isLogined) {
        return;
      }
      let userInfoArray = JSON.parse(userInfosStr);
      let userInfos = userInfoArray.map((info) => Object.assign(new UserInfo(), info));
      self$6.eventEmitter.emit(EventType.UserInfosUpdate, userInfos);
    }
    onFriendListUpdate(friendListIds) {
      if (!self$6.isLogined) {
        return;
      }
      formatAppLog("log", "at wfc/proto/proto.min.js:352", "friendList update, ids", friendListIds);
      let ids = JSON.parse(friendListIds);
      self$6.eventEmitter.emit(EventType.FriendListUpdate, ids);
    }
    onFriendRequestUpdate(newRequests = "[]") {
      if (!self$6.isLogined) {
        return;
      }
      formatAppLog("log", "at wfc/proto/proto.min.js:361", "friend request list update, new incomming requests", newRequests);
      let ids = JSON.parse(newRequests);
      self$6.eventEmitter.emit(EventType.FriendRequestUpdate, ids);
    }
    init(args = []) {
      formatAppLog("log", "at wfc/proto/proto.min.js:368", "proto init");
      utsWfcClient.initProto();
      utsWfcClient.setWfcEventListener((value) => {
        self$6._handleNativeEvent(value);
      });
      self$6.connectionStatus = self$6.getConnectionStatus();
      self$6.isLogined = self$6.connectionStatus === ConnectionStatus.ConnectionStatusConnected;
      formatAppLog("log", "at wfc/proto/proto.min.js:388", "proto init end");
      self$6.registerDefaultMessageContents();
    }
    registerMessageContent(name, flag, type, clazz) {
      MessageConfig.MessageContents.push({
        name,
        flag,
        type,
        contentClazz: clazz
      });
      utsWfcClient.registerMessageFlag(type, flag);
    }
    useSM4() {
      utsWfcClient.useSM4();
    }
    connect(userId, token) {
      userId = userId + "";
      self$6.userId = userId;
      let lastActiveTime = utsWfcClient.connect(Config.IM_SERVER_HOST, userId, token);
      formatAppLog("log", "at wfc/proto/proto.min.js:415", "connect", userId, Config.IM_SERVER_HOST);
      if ((/* @__PURE__ */ new Date()).getTime() / 1e3 - lastActiveTime > 7 * 24 * 60 * 60) {
        self$6.needPreloadDefaultData = true;
      }
      return lastActiveTime;
    }
    setProxyInfo(host, ip, port, username, password) {
      utsWfcClient.setProxyInfo(host, ip, port, username, password);
    }
    setPackageName(packageName) {
    }
    disconnect(disablePush, clearSession) {
      self$6.userId = "";
      utsWfcClient.disconnect(disablePush, clearSession);
      var now2 = /* @__PURE__ */ new Date();
      var exitTime = now2.getTime() + 1e3;
      while (true) {
        now2 = /* @__PURE__ */ new Date();
        if (now2.getTime() > exitTime)
          return;
      }
    }
    registerDefaultMessageContents() {
      MessageConfig.MessageContents.map((e) => {
        utsWfcClient.registerMessageFlag(e.type, e.flag);
      });
    }
    getClientId() {
      return utsWfcClient.getClientId();
    }
    getUserId() {
      return self$6.userId;
    }
    getServerDeltaTime() {
      return utsWfcClient.getServerDeltaTime();
    }
    screenShot() {
    }
    isLogin() {
      return self$6.isLogined;
    }
    getConnectionStatus() {
      return utsWfcClient.getConnectionStatus();
    }
    setBackupAddressStrategy(strategy) {
      utsWfcClient.setBackupAddressStrategy(strategy);
    }
    setBackupAddress(backupHost, backupPort) {
      utsWfcClient.setBackupAddress(backupHost, backupPort);
    }
    setProtoUserAgent(userAgent) {
      if (typeof userAgent !== "string") {
        formatAppLog("error", "at wfc/proto/proto.min.js:496", "setProtoUserAgent userAgent must be string");
        return;
      }
      utsWfcClient.setUserAgent(userAgent);
    }
    addHttpHeader(header, value) {
      if (typeof header !== "string" || typeof value !== "string") {
        formatAppLog("error", "at wfc/proto/proto.min.js:504", "addHttpHeader header, value must be string");
        return;
      }
      utsWfcClient.addHttpHeader(header, value);
    }
    onAppResume() {
    }
    onAppSuspend() {
    }
    // setLanguage(language) {
    //     proto.setLanguage(language);
    // }
    getMyGroupList() {
      let settings = this.getUserSettings(UserSettingScope.FavoriteGroup);
      let groupInfos = settings.filter((setting2) => setting2.value === "1").map((setting2) => this.getGroupInfo(setting2.key, false));
      return groupInfos;
    }
    /**
     * @param {string} userId
     * @param {boolean} fresh
     */
    getUserInfo(userId, fresh = false, groupId = "") {
      if (!userId || userId === "") {
        return new NullUserInfo("");
      }
      let userInfo;
      let userInfoStr = utsWfcClient.getUserInfo(userId, fresh, groupId);
      if (userInfoStr === "") {
        userInfo = new NullUserInfo(userId);
      } else {
        userInfo = Object.assign(new UserInfo(), JSON.parse(userInfoStr));
      }
      return userInfo;
    }
    getUserInfos(userIds, groupId = "") {
      if (!userIds || userIds.length === 0) {
        return [];
      }
      let users = [];
      let userInfoStrs = utsWfcClient.getUserInfos(userIds, groupId);
      if (userInfoStrs && userInfoStrs !== "") {
        let tmp = JSON.parse(userInfoStrs);
        tmp.forEach((u) => {
          let userInfo = Object.assign(new UserInfo(), u);
          users.push(userInfo);
        });
      }
      return users;
    }
    async getUserInfoEx(userId, refresh, successCB, failCB) {
      utsWfcClient.getUserInfoEx(userId, refresh, (userInfoStr) => {
        let userInfo = Object.assign(new UserInfo(), JSON.parse(userInfoStr));
        if (successCB) {
          successCB(userInfo);
        }
      }, (errorCode) => {
        if (errorCode) {
          failCB(errorCode);
        }
      });
    }
    async searchUser(keyword, searchType, page, successCB, failCB) {
      utsWfcClient.searchUser(keyword, searchType, page, (result) => {
        let userListStr = JSON.parse(result);
        let userList = [];
        if (userListStr && userListStr.length > 0) {
          userListStr.forEach((u) => {
            userList.push(Object.assign(new UserInfo(), u));
          });
        }
        if (successCB) {
          successCB(keyword, userList);
        }
      }, (errorCode) => {
        if (errorCode) {
          failCB(errorCode);
        }
      });
    }
    searchFriends(keyword) {
      let result = utsWfcClient.searchFriends(keyword);
      let userListStr = JSON.parse(result);
      let userList = [];
      if (userListStr && userListStr.length > 0) {
        userListStr.forEach((u) => {
          userList.push(Object.assign(new UserInfo(), u));
        });
      }
      return userList;
    }
    searchGroups(keyword) {
      let result = utsWfcClient.searchGroups(keyword);
      let groupSearchResultListStr = JSON.parse(result);
      let groupSearchResultList = [];
      if (groupSearchResultListStr && groupSearchResultListStr.length > 0) {
        groupSearchResultListStr.forEach((g) => {
          groupSearchResultList.push(GroupSearchResult.fromProtoGroupSearchResult(g));
        });
      }
      return groupSearchResultList;
    }
    getIncommingFriendRequest() {
      let result = utsWfcClient.getIncommingFriendRequest();
      let friendRequestListStr = JSON.parse(result);
      let firendRequestList = [];
      if (friendRequestListStr && friendRequestListStr.length > 0) {
        friendRequestListStr.forEach((r) => {
          firendRequestList.push(Object.assign(new FriendRequest(), r));
        });
      }
      return firendRequestList;
    }
    getOutgoingFriendRequest() {
      let result = utsWfcClient.getOutgoingFriendRequest();
      let friendRequestListStr = JSON.parse(result);
      let firendRequestList = [];
      if (friendRequestListStr && friendRequestListStr.length > 0) {
        friendRequestListStr.forEach((r) => {
          firendRequestList.push(Object.assign(new FriendRequest(), r));
        });
      }
      return firendRequestList;
    }
    getFriendRequest(userId, incomming) {
      let result = utsWfcClient.getFriendRequest(userId, incomming);
      return JSON.parse(result);
    }
    loadFriendRequestFromRemote() {
      utsWfcClient.loadFriendRequestFromRemote();
    }
    getFavUsers() {
      let result = utsWfcClient.getFavUsers();
      return JSON.parse(result);
    }
    isFavUser(groupId) {
      return utsWfcClient.isFavUser(groupId);
    }
    setFavUser(userId, fav2, successCB, failCB) {
      utsWfcClient.setFavUser(userId, fav2, () => {
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    loadRemoteMessages(conversation2, contentTypes, beforeUid, count, successCB, failCB) {
      if (!contentTypes) {
        contentTypes = [];
      }
      utsWfcClient.getRemoteMessages(JSON.stringify(conversation2), beforeUid + "", count, (protoMsgsStr) => {
        var protoMsgs = JSON.parse(protoMsgsStr);
        let msgs = [];
        protoMsgs.map((m) => {
          let msg = Message.fromProtoMessage(m);
          if (msg) {
            msgs.push(msg);
          }
        });
        formatAppLog("log", "at wfc/proto/proto.min.js:689", "loadRemoteMessages", msgs.length);
        successCB && successCB(msgs);
      }, (errorCode) => {
        formatAppLog("log", "at wfc/proto/proto.min.js:692", "loadRemoteMessages failure:", errorCode);
        failCB && failCB(errorCode);
      }, contentTypes);
    }
    loadRemoteMessage(messageUid, successCB, failCB) {
      utsWfcClient.getRemoteMessage(stringValue(messageUid), (protoMsgsStr) => {
        var protoMsgs = JSON.parse(protoMsgsStr);
        let msgs = [];
        protoMsgs.map((m) => {
          let msg = Message.fromProtoMessage(m);
          if (msg) {
            msgs.push(msg);
          }
        });
        formatAppLog("log", "at wfc/proto/proto.min.js:707", "loadRemoteMessage", msgs.length);
        successCB && successCB(msgs);
      }, (errorCode) => {
        formatAppLog("log", "at wfc/proto/proto.min.js:710", "loadRemoteMessage failure:", errorCode);
        failCB && failCB(errorCode);
      });
    }
    getUnreadFriendRequestCount() {
      return utsWfcClient.getUnreadFriendRequestStatus();
    }
    clearUnreadFriendRequestStatus() {
      utsWfcClient.clearUnreadFriendRequestStatus();
    }
    async deleteFriend(userId, successCB, failCB) {
      utsWfcClient.deleteFriend(userId, () => {
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        failCB(errorCode);
      });
    }
    async handleFriendRequest(userId, accept, extra, successCB, failCB) {
      utsWfcClient.handleFriendRequest(userId, accept, () => {
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      }, extra);
    }
    isBlackListed(userId) {
      return utsWfcClient.isBlackListed(userId);
    }
    getBlackList() {
      let result = utsWfcClient.getBlackList();
      return JSON.parse(result);
    }
    setBlackList(userId, block, successCB, failCB) {
      utsWfcClient.setBlackList(userId, block, () => {
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    getMyFriendList(fresh = false) {
      let idsStr = utsWfcClient.getMyFriendList(fresh);
      if (idsStr !== "") {
        return JSON.parse(idsStr);
      }
      return [];
    }
    getFriendList(fresh = false) {
      let result = utsWfcClient.getFriendList(fresh);
      return JSON.parse(result);
    }
    getFriendAlias(userId) {
      return utsWfcClient.getFriendAlias(userId);
    }
    async setFriendAlias(userId, alias, successCB, failCB) {
      utsWfcClient.setFriendAlias(userId, alias, successCB, failCB);
    }
    async createGroup(groupId, groupType, name, portrait, groupExtra = "", memberIds = [], memberExtra = "", lines = [0], notifyContent, successCB, failCB) {
      groupId = !groupId ? "" : groupId;
      groupExtra = !groupExtra ? "" : groupExtra;
      memberExtra = !memberExtra ? "" : memberExtra;
      let myUid = self$6.getUserId();
      if (!memberIds.includes(myUid)) {
        memberIds.push(myUid);
      }
      let payload = notifyContent ? notifyContent.encode() : "";
      let notifyContentStr = JSON.stringify(payload);
      utsWfcClient.createGroup(
        groupId,
        groupType,
        name,
        portrait,
        groupExtra,
        memberIds,
        memberExtra,
        lines,
        notifyContentStr,
        (groupId2) => {
          if (successCB) {
            successCB(groupId2);
          }
        },
        (errorCode) => {
          if (failCB) {
            failCB(errorCode);
          }
        }
      );
    }
    async setGroupManager(groupId, isSet, memberIds = [], lines = [0], notifyContent, successCB, failCB) {
      let payload = notifyContent ? notifyContent.encode() : "";
      let notifyContentStr = JSON.stringify(payload);
      utsWfcClient.setGroupManager(groupId, isSet, memberIds, lines, notifyContentStr, successCB, failCB);
    }
    async muteOrAllowGroupMembers(groupId, isSet, isAllow, memberIds, notifyLines = [0], notifyContent, successCB, failCB) {
      if (isAllow) {
        let payload = notifyContent ? notifyContent.encode() : "";
        let notifyContentStr = JSON.stringify(payload);
        utsWfcClient.allowGroupMember(groupId, isSet, memberIds, notifyLines, notifyContentStr, () => {
          successCB && successCB();
        }, (errorCode) => {
          failCB && failCB();
        });
      } else {
        let payload = notifyContent ? notifyContent.encode() : "";
        let notifyContentStr = JSON.stringify(payload);
        utsWfcClient.muteGroupMember(groupId, isSet, memberIds, notifyLines, notifyContentStr, () => {
          successCB && successCB();
        }, (errorCode) => {
          failCB && failCB(errorCode);
        });
      }
    }
    getGroupInfo(groupId, fresh = false) {
      let groupInfo;
      let groupInfoStr = utsWfcClient.getGroupInfo(groupId, fresh);
      if (groupInfoStr === "") {
        return new NullGroupInfo(groupId);
      } else {
        groupInfo = Object.assign(new GroupInfo(), JSON.parse(groupInfoStr));
        return groupInfo;
      }
    }
    getGroupInfos(groupIds, fresh = false) {
      formatAppLog("log", "at wfc/proto/proto.min.js:854", "get groupInfos", groupIds.length, fresh);
      let groupInfosStr = utsWfcClient.getGroupInfos(groupIds, fresh);
      if (groupInfosStr === "") {
        return [];
      } else {
        let arr = JSON.parse(groupInfosStr);
        let groupInfos = [];
        arr.forEach((e) => {
          groupInfos.push(Object.assign(new GroupInfo(), e));
        });
        return groupInfos;
      }
    }
    async getGroupInfoEx(groupId, refresh, successCB, failCB) {
      utsWfcClient.getGroupInfoEx(groupId, refresh, (groupInfoStr) => {
        let groupInfo = Object.assign(new GroupInfo(), JSON.parse(groupInfoStr));
        if (successCB) {
          successCB(groupInfo);
        }
      }, (errorCode) => {
        if (errorCode) {
          failCB(errorCode);
        }
      });
    }
    addGroupMembers(groupId, memberIds, extra, notifyLines, notifyMessageContent, successCB, failCB) {
      if (!notifyMessageContent) {
        notifyMessageContent = new AddGroupMemberNotification(self$6.getUserId(), memberIds);
      }
      let payload = notifyMessageContent.encode();
      let notifyContentStr = JSON.stringify(payload);
      extra = !extra ? "" : extra;
      utsWfcClient.addMembers(
        groupId,
        memberIds,
        extra,
        notifyLines,
        notifyContentStr,
        () => {
          if (successCB) {
            successCB();
          }
        },
        (errorCode) => {
          if (failCB) {
            failCB(errorCode);
          }
        }
      );
    }
    getGroupMemberIds(groupId, fresh = false) {
      let groupMembers = self$6.getGroupMembers(groupId, fresh);
      var groupMemberIds = [];
      groupMembers.forEach((e) => {
        groupMemberIds.push(e.memberId);
      });
      return groupMemberIds;
    }
    getGroupMembers(groupId, fresh = false) {
      let memberIdsStr = utsWfcClient.getGroupMembers(groupId, fresh);
      var members = [];
      let arr = JSON.parse(memberIdsStr);
      arr.forEach((e) => {
        members.push(Object.assign(new GroupMember(), e));
      });
      return members;
    }
    getGroupMembersByType(groupId, memberType) {
      let memberIdsStr = utsWfcClient.getGroupMembersByType(groupId, memberType);
      var members = [];
      let arr = JSON.parse(memberIdsStr);
      arr.forEach((e) => {
        members.push(Object.assign(new GroupMember(), e));
      });
      return members;
    }
    getGroupMember(groupId, memberId) {
      let result = utsWfcClient.getGroupMember(groupId, memberId);
      return Object.assign(new GroupMember(), JSON.parse(result));
    }
    async getGroupMembersEx(groupId, refresh, successCB, failCB) {
      utsWfcClient.getGroupMembersEx(groupId, refresh, (memberIdsStr) => {
        var members = [];
        let arr = JSON.parse(memberIdsStr);
        arr.forEach((e) => {
          members.push(Object.assign(new GroupMember(), e));
        });
        if (successCB) {
          successCB(members);
        }
      }, (errorCode) => {
        if (errorCode) {
          failCB(errorCode);
        }
      });
    }
    kickoffGroupMembers(groupId, memberIds, notifyLines, notifyMsg, successCB, failCB) {
      let payload = notifyMsg ? notifyMsg.encode() : "";
      let strCont = JSON.stringify(payload);
      utsWfcClient.kickoffMembers(
        groupId,
        memberIds,
        notifyLines,
        strCont,
        () => {
          if (successCB) {
            successCB();
          }
        },
        (errorCode) => {
          if (failCB) {
            failCB(errorCode);
          }
        }
      );
    }
    async quitGroup(groupId, lines = [0], notifyMessageContent, successCB, failCB) {
      let payload = notifyMessageContent ? notifyMessageContent.encode() : "";
      utsWfcClient.quitGroup(groupId, lines, JSON.stringify(payload), () => {
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        failCB(errorCode);
      });
    }
    async quitGroupEx(groupId, keepMessage, lines = [0], notifyMessageContent, successCB, failCB) {
      let payload = notifyMessageContent ? notifyMessageContent.encode() : "";
      utsWfcClient.quitGroupEx(groupId, keepMessage, lines, JSON.stringify(payload), () => {
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        failCB(errorCode);
      });
    }
    async dismissGroup(groupId, lines = [0], notifyMessageContent, successCB, failCB) {
      let payload = notifyMessageContent ? notifyMessageContent.encode() : "";
      utsWfcClient.dismissGroup(groupId, lines, JSON.stringify(payload), () => {
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        failCB(errorCode);
      });
    }
    async modifyGroupInfo(groupId, type, newValue, lines = [0], notifyMessageContent, successCB, failCB) {
      let payload = notifyMessageContent ? notifyMessageContent.encode() : "";
      utsWfcClient.modifyGroupInfo(
        groupId,
        type,
        newValue,
        lines,
        JSON.stringify(payload),
        () => {
          if (successCB) {
            successCB();
          }
        },
        (errorCode) => {
          if (failCB) {
            failCB(errorCode);
          }
        }
      );
    }
    async modifyGroupAlias(groupId, alias, lines = [0], notifyMessageContent, successCB, failCB) {
      let payload = notifyMessageContent ? notifyMessageContent.encode() : "";
      utsWfcClient.modifyGroupAlias(groupId, alias, lines, JSON.stringify(payload), () => {
        successCB();
      }, (errorCode) => {
        failCB(errorCode);
      });
    }
    async modifyGroupMemberAlias(groupId, memberId, alias, lines = [0], notifyMessageContent, successCB, failCB) {
      let payload = notifyMessageContent ? notifyMessageContent.encode() : "";
      utsWfcClient.modifyGroupMemberAlias(groupId, memberId, alias, lines, JSON.stringify(payload), () => {
        successCB();
      }, (errorCode) => {
        failCB(errorCode);
      });
    }
    async modifyGroupMemberExtra(groupId, memberId, extra, lines = [0], notifyMessageContent, successCB, failCB) {
      let payload = notifyMessageContent ? notifyMessageContent.encode() : "";
      utsWfcClient.modifyGroupMemberExtra(groupId, memberId, extra, lines, JSON.stringify(payload), () => {
        successCB();
      }, (errorCode) => {
        failCB(errorCode);
      });
    }
    transferGroup(groupId, newOwner, lines = [0], notifyMessageContent, successCB, failCB) {
      let payload = notifyMessageContent ? notifyMessageContent.encode() : "";
      utsWfcClient.transferGroup(groupId, newOwner, lines, JSON.stringify(payload), () => {
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    getFavGroups() {
      let result = utsWfcClient.getFavGroups();
      return JSON.parse(result);
    }
    isFavGroup(groupId) {
      return utsWfcClient.isFavGroup(groupId);
    }
    async setFavGroup(groupId, fav2, successCB, failCB) {
      utsWfcClient.setFavGroup(groupId, fav2, () => {
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    getUserSetting(scope, key) {
      return utsWfcClient.getUserSetting(scope, key);
    }
    getUserSettings(scope) {
      let result = utsWfcClient.getUserSettings(scope);
      return JSON.parse(result);
    }
    async setUserSetting(scope, key, value, successCB, failCB) {
      utsWfcClient.setUserSetting(scope, key, value, () => {
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    modifyMyInfo(modifyMyInfoEntries, successCB, failCB) {
      utsWfcClient.modifyMyInfo(modifyMyInfoEntries[0].type, modifyMyInfoEntries[0].value, () => {
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    isGlobalSlient() {
      return utsWfcClient.isGlobalSlient();
    }
    setGlobalSlient(silent, successCB, failCB) {
      utsWfcClient.setGlobalSlient(silent, () => {
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    isHiddenNotificationDetail() {
      return utsWfcClient.isHiddenNotificationDetail();
    }
    async setHiddenNotificationDetail(hide, successCB, failCB) {
      utsWfcClient.setHiddenNotificationDetail(hide, () => {
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    isHiddenGroupMemberName(groupId) {
      const setting2 = utsWfcClient.getUserSetting(UserSettingScope.GroupHideNickname, groupId);
      return "1" === setting2;
    }
    async setHiddenGroupMemberName(groupId, hide, successCB, failCB) {
      utsWfcClient.setUserSetting(UserSettingScope.GroupHideNickname, groupId, hide ? "1" : "0", () => {
        successCB();
      }, (errorCode) => {
        failCB(errorCode);
      });
    }
    isUserReceiptEnabled() {
      return utsWfcClient.isUserReceiptEnabled();
    }
    async setUserEnableReceipt(enable, successCB, failCB) {
      utsWfcClient.setUserReceiptEnable(enable, () => {
        successCB && successCB();
      }, (errorCode) => {
        failCB && failCB(errorCode);
      });
    }
    async joinChatroom(chatroomId, successCB, failCB) {
      utsWfcClient.joinChatroom(chatroomId, () => {
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    async quitChatroom(chatroomId, successCB, failCB) {
      utsWfcClient.quitChatroom(chatroomId, () => {
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    async getChatroomInfo(chatroomId, updateDt, successCB, failCB) {
      utsWfcClient.getChatroomInfo(chatroomId, updateDt, (info) => {
        if (successCB) {
          successCB(Object.assign(new ChatRoomInfo(), JSON.parse(info)));
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    async getChatroomMemberInfo(chatroomId, maxCount, successCB, failCB) {
      utsWfcClient.getChatroomMemberInfo(chatroomId, maxCount, (info) => {
        if (successCB) {
          successCB(Object.assign(new ChatRoomMemberInfo(), JSON.parse(info)));
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    createChannel(name, portrait, desc, extra, successCB, failCB) {
      utsWfcClient.createChannel(name, portrait, 0, desc, extra, (info) => {
        if (successCB) {
          successCB(Object.assign(new ChannelInfo(), JSON.parse(info)));
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    getChannelInfo(channelId, refresh) {
      let result = utsWfcClient.getChannelInfo(channelId, refresh);
      if (result === "") {
        return new NullChannelInfo(channelId);
      }
      return Object.assign(new ChannelInfo(), JSON.parse(result));
    }
    async modifyChannelInfo(channelId, type, newValue, successCB, failCB) {
      utsWfcClient.modifyChannelInfo(channelId, type, newValue, () => {
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    searchChannel(keyword, successCB, failCB) {
      utsWfcClient.searchChannel(keyword, (result) => {
        if (successCB) {
          let channels = [];
          let tmp = JSON.parse(result);
          tmp.forEach((channel) => {
            channels.push(Object.assign(new ChannelInfo(), channel));
          });
          successCB(channels);
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    isListenedChannel(channelId) {
      return utsWfcClient.isListenedChannel(channelId);
    }
    async listenChannel(channelId, listen, successCB, failCB) {
      utsWfcClient.listenChannel(channelId, listen, () => {
        successCB();
      }, (errorCode) => {
        failCB(errorCode);
      });
    }
    // return channelIds
    getMyChannels() {
      let result = utsWfcClient.getMyChannels();
      return JSON.parse(result);
    }
    getListenedChannels() {
      let result = utsWfcClient.getListenedChannels();
      return result ? JSON.parse(result) : null;
    }
    async destoryChannel(channelId, successCB, failCB) {
      utsWfcClient.destoryChannel(channelId, () => {
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    getConversationList(types, lines) {
      var conversationListStr = utsWfcClient.getConversationInfos(types, lines);
      if (!conversationListStr) {
        formatAppLog("log", "at wfc/proto/proto.min.js:1306", "getConversationInfos return null");
        return [];
      }
      let conversationInfoList = [];
      let tmp = JSON.parse(conversationListStr);
      tmp.forEach((c2) => {
        conversationInfoList.push(ConversationInfo.protoConversationToConversationInfo(c2));
      });
      return conversationInfoList;
    }
    getConversationInfo(conversation2) {
      let convStr = utsWfcClient.getConversationInfo(JSON.stringify(conversation2));
      return ConversationInfo.protoConversationToConversationInfo(JSON.parse(convStr));
    }
    searchConversation(keyword, types = [], lines = []) {
      let result = utsWfcClient.searchConversation(keyword, types, lines);
      let resultList = JSON.parse(result);
      var conversationSearchResult = [];
      if (resultList && resultList.length > 0) {
        resultList.forEach((r) => {
          conversationSearchResult.push(ConversationSearchResult.fromProtoConversationSearchResult(r));
        });
      }
      return conversationSearchResult;
    }
    async removeConversation(conversation2, clearMsg = false) {
      utsWfcClient.removeConversation(JSON.stringify(conversation2), clearMsg);
    }
    setConversationTop(conversation2, top, successCB, failCB) {
      utsWfcClient.setConversationTop(JSON.stringify(conversation2), top, () => {
        let conversationInfo = self$6.getConversationInfo(conversation2);
        self$6.eventEmitter.emit(EventType.ConversationInfoUpdate, conversationInfo);
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    setConversationSlient(conversation2, silent, successCB, failCB) {
      utsWfcClient.setConversationSlient(JSON.stringify(conversation2), silent, () => {
        let conversationInfo = self$6.getConversationInfo(conversation2);
        self$6.eventEmitter.emit(EventType.ConversationInfoUpdate, conversationInfo);
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    setConversationDraft(conversation2, draft = "") {
      let conversationInfo = self$6.getConversationInfo(conversation2);
      if (conversationInfo.draft === draft) {
        return;
      }
      utsWfcClient.setConversationDraft(JSON.stringify(conversation2), draft);
      conversationInfo = self$6.getConversationInfo(conversation2);
      self$6.eventEmitter.emit(EventType.ConversationInfoUpdate, conversationInfo);
    }
    //timestamp 为毫秒，字符串类型
    setConversationTimestamp(conversation2, timestamp) {
      timestamp = timestamp + "";
      utsWfcClient.setConversationTimestamp(JSON.stringify(conversation2), timestamp);
      let conversationInfo = self$6.getConversationInfo(conversation2);
      self$6.eventEmitter.emit(EventType.ConversationInfoUpdate, conversationInfo);
    }
    getUnreadCount(types = [], lines = [0]) {
      let unreadCountStr = utsWfcClient.getUnreadCount(types, lines);
      return Object.assign(new UnreadCount$1(), JSON.parse(unreadCountStr));
    }
    getConversationUnreadCount(conversation2) {
      let unreadCountStr = utsWfcClient.getConversationUnreadCount(JSON.stringify(conversation2));
      return Object.assign(new UnreadCount$1(), JSON.parse(unreadCountStr));
    }
    clearConversationUnreadStatus(conversation2) {
      formatAppLog("log", "at wfc/proto/proto.min.js:1399", "clearConversationUnreadStatus", JSON.stringify(conversation2));
      utsWfcClient.clearUnreadStatus(JSON.stringify(conversation2));
      let conversationInfo = self$6.getConversationInfo(conversation2);
      self$6.eventEmitter.emit(EventType.ConversationInfoUpdate, conversationInfo);
    }
    markConversationAsUnread(conversation2, syncToOtherClient) {
      let result = utsWfcClient.setLastReceivedMessageUnRead(JSON.stringify(conversation2), "0", "0");
      if (result) {
        let conversationInfo = self$6.getConversationInfo(conversation2);
        self$6.eventEmitter.emit(EventType.ConversationInfoUpdate, conversationInfo);
      }
      return result;
    }
    getConversationRead(conversation2) {
      let readedStr = utsWfcClient.getConversationRead(JSON.stringify(conversation2));
      let readedArr = JSON.parse(readedStr);
      let result = /* @__PURE__ */ new Map();
      if (readedArr) {
        readedArr.forEach((e) => {
          result.set(e.key, e.value);
        });
      }
      return result;
    }
    clearAllUnreadStatus() {
      utsWfcClient.clearAllUnreadStatus();
    }
    getConversationFirstUnreadMessageId(conversation2) {
      let messageId = utsWfcClient.getConversationFirstUnreadMessageId(JSON.stringify(conversation2));
      return messageId;
    }
    setMediaMessagePlayed(messageId) {
      utsWfcClient.setMediaMessagePlayed(messageId);
    }
    setMessageLocalExtra(messageId, extra) {
      utsWfcClient.setMessageLocalExtra(messageId, extra);
    }
    isMyFriend(userId) {
      return utsWfcClient.isMyFriend(userId);
    }
    async sendFriendRequest(userId, reason, extra, successCB, failCB) {
      extra = !extra ? "" : extra;
      utsWfcClient.sendFriendRequest(userId, reason, extra, () => {
        if (successCB) {
          successCB();
        }
      }, (errorCode) => {
        if (failCB) {
          failCB(errorCode);
        }
      });
    }
    /**
     *
     * @param {Conversation} conversation
     * @param {number} fromIndex
     * @param {boolean} before
     * @param {number} count
     * @param {string} withUser
     * @param {array} contentTypes
     */
    getMessages(conversation2, fromIndex, before = true, count = 20, withUser = "", contentTypes = []) {
      let protoMsgsStr = utsWfcClient.getMessages(JSON.stringify(conversation2), contentTypes, fromIndex, before, count, withUser);
      var protoMsgs = JSON.parse(protoMsgsStr);
      let msgs = [];
      protoMsgs.map((m) => {
        let msg = Message.fromProtoMessage(m);
        if (msg) {
          msgs.push(msg);
        }
      });
      formatAppLog("log", "at wfc/proto/proto.min.js:1483", "getMessages", msgs.length);
      return msgs;
    }
    getMessagesEx(conversationTypes, lines, contentTypes, fromIndex, before = true, count = 20, withUser = "") {
      let protoMsgsStr = utsWfcClient.getMessagesEx(conversationTypes, lines, contentTypes, fromIndex, before, count, withUser);
      var protoMsgs = JSON.parse(protoMsgsStr);
      let msgs = [];
      protoMsgs.map((m) => {
        let msg = Message.fromProtoMessage(m);
        if (msg) {
          msgs.push(msg);
        }
      });
      formatAppLog("log", "at wfc/proto/proto.min.js:1500", "getMessages", msgs.length);
      return msgs;
    }
    getUserMessages(userId, conversation2, fromIndex, before = true, count = 20, contentTypes = []) {
      let protoMsgsStr = utsWfcClient.getUserMessages(userId, JSON.stringify(conversation2), contentTypes, fromIndex, before, count);
      var protoMsgs = JSON.parse(protoMsgsStr);
      let msgs = [];
      protoMsgs.map((m) => {
        let msg = Message.fromProtoMessage(m);
        if (msg) {
          msgs.push(msg);
        }
      });
      formatAppLog("log", "at wfc/proto/proto.min.js:1515", "getMessages", msgs.length);
      return msgs;
    }
    getUserMessagesEx(userId, conversationTypes, lines, fromIndex, before = true, count = 20, contentTypes = []) {
      let protoMsgsStr = utsWfcClient.getUserMessagesEx(userId, conversationTypes, lines, contentTypes, fromIndex, before, count);
      var protoMsgs = JSON.parse(protoMsgsStr);
      let msgs = [];
      protoMsgs.map((m) => {
        let msg = Message.fromProtoMessage(m);
        if (msg) {
          msgs.push(msg);
        }
      });
      formatAppLog("log", "at wfc/proto/proto.min.js:1531", "getMessages", msgs.length);
      return msgs;
    }
    getMessagesV2(conversation2, fromIndex, before, count, withUser, successCB, failCB) {
      utsWfcClient.getMessagesV2(JSON.stringify(conversation2), fromIndex, before, count, withUser, ...this._wrapperGetMessageCallbacks(successCB, failCB));
    }
    getMessagesExV2(conversationTypes, lines, fromIndex, before, count, withUser, contentTypes, successCB, failCB) {
      utsWfcClient.getMessagesExV2(conversationTypes, lines, fromIndex, before, count, withUser, contentTypes, ...this._wrapperGetMessageCallbacks(successCB, failCB));
    }
    getMessagesEx2V2(conversationTypes, lines, messageStatuses, fromIndex, before, count, withUser, successCB, failCB) {
      utsWfcClient.getMessagesEx2V2(conversationTypes, lines, messageStatuses, fromIndex, before, count, withUser, ...this._wrapperGetMessageCallbacks(successCB, failCB));
    }
    getMessagesByTimestampV2(conversation2, contentTypes, timestamp, before, count, withUser, successCB, failCB) {
      utsWfcClient.getMessagesByTimestampV2(JSON.stringify(conversation2), contentTypes, numberValue(timestamp), before, count, withUser, ...this._wrapperGetMessageCallbacks(successCB, failCB));
    }
    getUserMessagesV2(userId, conversation2, fromIndex, before, count, successCB, failCB) {
      utsWfcClient.getUserMessagesV2(userId, JSON.stringify(conversation2), fromIndex, before, count, ...this._wrapperGetMessageCallbacks(successCB, failCB));
    }
    getUserMessagesExV2(userId, conversationTypes, lines, fromIndex, before, count, contentTypes, successCB, failCB) {
      utsWfcClient.getUserMessagesExV2(userId, conversationTypes, lines, fromIndex, before, count, contentTypes, ...this._wrapperGetMessageCallbacks(successCB, failCB));
    }
    _wrapperGetMessageCallbacks(successCB, failCB) {
      let cbs = [
        (protoMsgsStr) => {
          var protoMsgs = JSON.parse(protoMsgsStr);
          let msgs = [];
          protoMsgs.map((m) => {
            let msg = Message.fromProtoMessage(m);
            if (msg) {
              msgs.push(msg);
            }
          });
          successCB && successCB(msgs);
        },
        (err) => {
          failCB && failCB(err);
        }
      ];
      return cbs;
    }
    getMessageById(messageId) {
      let mStr = utsWfcClient.getMessage(messageId);
      return Message.fromProtoMessage(JSON.parse(mStr));
    }
    getMessageByUid(messageUid) {
      formatAppLog("log", "at wfc/proto/proto.min.js:1586", "getMesssageByUid", Long.fromValue(messageUid).toString());
      let mStr = utsWfcClient.getMessageByUid(Long.fromValue(messageUid).toString());
      formatAppLog("log", "at wfc/proto/proto.min.js:1588", "getMesssageByUid----", mStr);
      return Message.fromProtoMessage(JSON.parse(mStr));
    }
    searchMessage(conversation2, keyword, withUser = "") {
      let result = utsWfcClient.searchMessage(JSON.stringify(conversation2), keyword, withUser);
      let msgs = JSON.parse(result);
      let matchMsgs = [];
      if (msgs && msgs.length > 0) {
        msgs.forEach((m) => {
          matchMsgs.push(Message.fromProtoMessage(m));
        });
      }
      return matchMsgs;
    }
    searchMessageEx(conversation2, keyword, desc, limit, offset, withUser) {
      let result = utsWfcClient.searchMessageEx(JSON.stringify(conversation2), keyword, desc, limit, offset, withUser);
      let msgs = JSON.parse(result);
      let matchMsgs = [];
      if (msgs && msgs.length > 0) {
        msgs.forEach((m) => {
          matchMsgs.push(Message.fromProtoMessage(m));
        });
      }
      return matchMsgs;
    }
    searchMessageByTypes(conversation2, keyword, contentTypes, desc, limit, offset, withUser = "") {
      if (!contentTypes) {
        contentTypes = [];
      }
      let result = utsWfcClient.searchMessageByTypes(JSON.stringify(conversation2), keyword, contentTypes, desc, limit, offset, withUser);
      let msgs = JSON.parse(result);
      let matchMsgs = [];
      if (msgs && msgs.length > 0) {
        msgs.forEach((m) => {
          matchMsgs.push(Message.fromProtoMessage(m));
        });
      }
      return matchMsgs;
    }
    searchMessageByTypesAndTimes(conversation2, keyword, contentTypes, startTime, endTime, desc, limit, offset, withUser) {
      if (!contentTypes) {
        contentTypes = [];
      }
      let result = utsWfcClient.searchMessageByTypesAndTimes(JSON.stringify(conversation2), keyword, contentTypes, startTime.toString(), endTime.toString(), desc, limit, offset, withUser);
      let msgs = JSON.parse(result);
      let matchMsgs = [];
      if (msgs && msgs.length > 0) {
        msgs.forEach((m) => {
          matchMsgs.push(Message.fromProtoMessage(m));
        });
      }
      return matchMsgs;
    }
    searchMessageEx2(conversationTypes, lines, contentTypes, keyword, fromIndex, desc, count) {
      if (!contentTypes) {
        contentTypes = [];
      }
      let result = utsWfcClient.searchMessageEx2(conversationTypes, lines, contentTypes, keyword, fromIndex, desc, count);
      let msgs = JSON.parse(result);
      let matchMsgs = [];
      if (msgs && msgs.length > 0) {
        msgs.forEach((m) => {
          matchMsgs.push(Message.fromProtoMessage(m));
        });
      }
      return matchMsgs;
    }
    async sendConversationMessage(conversation2, messageContent, toUsers = [], preparedCB, progressCB, successCB, failCB) {
      let message2 = new Message();
      message2.conversation = conversation2;
      message2.messageContent = messageContent;
      self$6.sendMessageEx(message2, toUsers, preparedCB, progressCB, successCB, failCB);
    }
    async sendMessage(message2, preparedCB, progressCB, successCB, failCB) {
      self$6.sendMessageEx(message2, [], preparedCB, progressCB, successCB, failCB);
    }
    // toUsers 用来实现定向消息
    async sendMessageEx(message2, toUsers = [], preparedCB, progressCB, successCB, failCB) {
      let strConv = JSON.stringify(message2.conversation);
      message2.content = await message2.messageContent.encode();
      message2.from = this.userId;
      formatAppLog("log", "at wfc/proto/proto.min.js:1682", "--------------p", message2.content);
      let strCont = JSON.stringify(message2.content);
      utsWfcClient.sendMessage(
        strConv,
        strCont,
        toUsers,
        0,
        (args) => {
          let [messageId, timestamp] = args;
          message2.messageId = messageId;
          message2.timestamp = Long.fromValue(timestamp).toNumber();
          if (typeof preparedCB === "function") {
            preparedCB(messageId, Long.fromValue(timestamp).toNumber());
          }
          self$6.eventEmitter.emit(EventType.SendMessage, message2);
        },
        (args) => {
          let [uploaded, total] = args;
          if (typeof progressCB === "function") {
            progressCB(uploaded, total);
          }
        },
        (args) => {
          let [messageUid, timestamp] = args;
          message2.status = MessageStatus.Sent;
          message2.messageUid = Long.fromValue(messageUid);
          message2.timestamp = Long.fromValue(timestamp).toNumber();
          if (message2.messageContent instanceof MediaMessageContent) {
            let msg = self$6.getMessageById(message2.messageId);
            message2.messageContent = msg.messageContent;
          }
          if (typeof successCB === "function") {
            successCB(Long.fromValue(messageUid), Long.fromValue(timestamp).toNumber());
          }
          self$6.eventEmitter.emit(EventType.MessageStatusUpdate, message2);
        },
        (errorCode) => {
          message2.status = MessageStatus.SendFailure;
          if (typeof failCB === "function") {
            failCB(errorCode);
          }
          self$6.eventEmitter.emit(EventType.MessageStatusUpdate, message2);
        }
      );
    }
    // 更新了原始消息的内容
    async recallMessage(messageUid, successCB, failCB) {
      formatAppLog("log", "at wfc/proto/proto.min.js:1740", "recall", messageUid);
      utsWfcClient.recall(
        messageUid.toString(),
        () => {
          formatAppLog("log", "at wfc/proto/proto.min.js:1743", "recall, s", messageUid);
          if (successCB) {
            successCB();
          }
          this.onRecallMessage(this.getUserId(), messageUid);
        },
        (errorCode) => {
          formatAppLog("log", "at wfc/proto/proto.min.js:1750", "recall, f", messageUid, errorCode);
          if (failCB) {
            failCB();
          }
        }
      );
    }
    async deleteRemoteMessage(messageUid, successCB, failCB) {
      formatAppLog("log", "at wfc/proto/proto.min.js:1758", "deleteRemoteMessageByUid", messageUid);
      utsWfcClient.deleteRemoteMessage(
        messageUid.toString(),
        () => {
          if (successCB) {
            successCB();
          }
          this.onDeleteRemoteMessage(messageUid);
        },
        (errorCode) => {
          if (failCB) {
            failCB();
          }
        }
      );
    }
    async updateRemoteMessageContent(messageUid, messageContent, distribute, updateLocal, successCB, failCB) {
      formatAppLog("log", "at wfc/proto/proto.min.js:1774", "updateRemoteMessageContent", messageUid);
      let protoMessageContent = messageContent.encode();
      utsWfcClient.updateRemoteMessageContent(
        messageUid.toString(),
        JSON.stringify(protoMessageContent),
        distribute,
        updateLocal,
        () => {
          if (successCB) {
            successCB();
          }
        },
        (errorCode) => {
          if (failCB) {
            failCB(errorCode);
          }
        }
      );
    }
    deleteMessageById(messageId) {
      let result = utsWfcClient.deleteMessage(messageId);
      this.onMessageDeleted(messageId);
      return result;
    }
    watchOnlineState(conversationType, targets, duration, successCB, failCB) {
      utsWfcClient.watchOnlineState(
        conversationType,
        targets,
        duration,
        (strStates) => {
          let userOnlineStates = self$6._parseUserOnlineState(strStates);
          successCB && successCB(userOnlineStates);
        },
        (errorCode) => {
          failCB && failCB(errorCode);
        }
      );
    }
    unwatchOnlineState(conversationType, targets, successCB, failCB) {
      utsWfcClient.unwatchOnlineState(
        conversationType,
        targets,
        () => {
          if (successCB) {
            successCB();
          }
        },
        (errorCode) => {
          if (failCB) {
            failCB();
          }
        }
      );
    }
    isCommercialServer() {
      return utsWfcClient.isCommercialServer();
    }
    isReceiptEnabled() {
      return utsWfcClient.isReceiptEnabled();
    }
    isGlobalDisableSyncDraft() {
      return utsWfcClient.isGlobalDisableSyncDraft();
    }
    isEnableUserOnlineState() {
      return utsWfcClient.isEnableUserOnlineState();
    }
    setDisableSyncDraft(disable, successCB, failCB) {
      this.setUserSetting(
        UserSettingScope.DisableSyncDraft,
        "",
        disable ? "1" : "0",
        () => successCB && successCB(),
        (err) => failCB && failCB(err)
      );
    }
    isDisableSyncDraft() {
      return this.getUserSetting(UserSettingScope.DisableSyncDraft, "") === "1";
    }
    getAuthorizedMediaUrl(messaggeUid, mediaType, mediaPath, successCB, failCB) {
      utsWfcClient.getAuthorizedMediaUrl(messaggeUid, mediaType, mediaPath, (args) => {
        let [url, backupUrl] = args;
        successCB && successCB(url, backupUrl);
      }, failCB);
    }
    isSupportBigFilesUpload() {
      return utsWfcClient.isSupportBigFilesUpload();
    }
    getUploadMediaUrl(fileName, mediaType, contentType, successCB, failCB) {
      utsWfcClient.getUploadMediaUrl(fileName, mediaType, contentType, (args) => {
        let [uploadUrl, remoteUrl, backUploadupUrl, serverType] = args;
        successCB && successCB(uploadUrl, remoteUrl, backUploadupUrl, serverType);
      }, failCB);
    }
    getConversationFileRecords(conversation2, fromUser, beforeUid, count, successCB, failCB) {
      utsWfcClient.getConversationFiles(JSON.stringify(conversation2), fromUser, Long.fromValue(beforeUid).toString(), count, (frsStr) => {
        let frs = JSON.parse(frsStr);
        let fileRecords = [];
        frs.forEach((fr) => {
          fileRecords.push(this._objStrToFileRecordObj(fr));
        });
        successCB && successCB(fileRecords);
      }, (errorCode) => {
        failCB && failCB(errorCode);
      });
    }
    _objStrToFileRecordObj(obj) {
      let fileRecord = new FileRecord();
      fileRecord.userId = obj.userId;
      if (obj.conversation) {
        fileRecord.conversation = Object.assign(new Conversation(), obj.conversation);
      } else {
        fileRecord.conversation = new Conversation(obj.conversationType, obj.target, obj.line);
      }
      fileRecord.messageUid = Long.fromValue(obj.messageUid);
      fileRecord.name = obj.name;
      fileRecord.url = obj.url;
      fileRecord.size = obj.size;
      fileRecord.downloadCount = obj.downloadCount;
      fileRecord.timestamp = obj.timestamp;
      return fileRecord;
    }
    getMyFileRecords(beforeUid, count, successCB, failCB) {
      utsWfcClient.getMyFiles(Long.fromValue(beforeUid).toString(), count, (frsStr) => {
        let frs = JSON.parse(frsStr);
        let fileRecords = [];
        frs.forEach((fr) => {
          fileRecords.push(this._objStrToFileRecordObj(fr));
        });
        successCB && successCB(fileRecords);
      }, (errorCode) => {
        failCB && failCB(errorCode);
      });
    }
    deleteFileRecord(messageUid, successCB, failCB) {
      utsWfcClient.deleteFileRecord(Long.fromValue(messageUid).toString(), () => {
        successCB && successCB();
      }, (errorCode) => {
        failCB && failCB(errorCode);
      });
    }
    async clearMessages(conversation2) {
      utsWfcClient.clearMessages(JSON.stringify(conversation2));
      let conversationInfo = this.getConversationInfo(conversation2);
      self$6.eventEmitter.emit(EventType.ConversationInfoUpdate, conversationInfo);
    }
    async clearRemoteConversationMessages(conversation2, successCB, failCB) {
      utsWfcClient.clearRemoteConversationMessages(
        JSON.stringify(conversation2),
        () => {
          successCB && successCB();
        },
        (errorCode) => {
          failCB && failCB(errorCode);
        }
      );
    }
    /**
     * 删除before时间之前的所有消息
     *
     * @param {Conversation} conversation
     * @param {String} before 时间精度到毫秒，字符串格式
     */
    async clearMessagesByTime(conversation2, before) {
      utsWfcClient.clearMessagesByTime(JSON.stringify(conversation2), before);
      let conversationInfo = this.getConversationInfo(conversation2);
      self$6.eventEmitter.emit(EventType.ConversationInfoUpdate, conversationInfo);
    }
    /**
     *
     * @param {Conversation} conversation
     * @param {MessageContent} messageContent
     * @param {MessageStatus} status
     * @param {boolean} notify 是否触发onReceiveMessage
     * @param {Number} serverTime 服务器时间，精度到毫秒
     */
    insertMessage(conversation2, messageContent, status, notify = false, toUsers = [], serverTime = 0) {
      let protoMessageContent = messageContent.encode();
      utsWfcClient.insertMessage(JSON.stringify(conversation2), self$6.userId, JSON.stringify(protoMessageContent), status, notify, toUsers, serverTime);
    }
    async updateMessageContent(messageId, messageContent) {
      let protoMessageContent = messageContent.encode();
      utsWfcClient.updateMessage(messageId, JSON.stringify(protoMessageContent));
    }
    async updateMessageStatus(messageId, status) {
      utsWfcClient.updateMessageStatus(messageId, status);
    }
    async uploadMedia(fileName, data, mediaType, successCB, failCB, progressCB) {
      if (data.indexOf("base64,") >= 0) {
        data = data.substring(data.indexOf(",") + 1);
      }
      utsWfcClient.uploadMedia(
        fileName,
        data,
        mediaType,
        (remoteUrl) => {
          if (successCB) {
            successCB(remoteUrl);
          }
        },
        (errorCode) => {
          if (failCB) {
            failCB(errorCode);
          }
        },
        (current, total) => {
          if (progressCB) {
            progressCB(current, total);
          }
        }
      );
    }
    sendConferenceRequest(sessionId, roomId, request, data, advance, callback) {
      utsWfcClient.sendConferenceRequest(
        "" + sessionId,
        roomId,
        request,
        data,
        (resp) => {
          callback && callback(0, resp);
        },
        (errorCode) => {
          callback && callback(errorCode, null);
        },
        advance === true
      );
    }
    searchFiles(keyword, conversation2, fromUser, beforeMessageId, count, successCB, failCB) {
      utsWfcClient.searchFiles(
        keyword,
        conversation2 ? JSON.stringify(conversation2) : "",
        fromUser,
        Long.fromValue(beforeMessageId).toString(),
        count,
        (files) => {
          let frs = JSON.parse(files);
          let fileRecords = [];
          frs.forEach((fr) => {
            fileRecords.push(this._objStrToFileRecordObj(fr));
          });
          successCB && successCB(fileRecords);
        },
        (errorCode) => {
          failCB && failCB(errorCode);
        }
      );
    }
    searchMyFiles(keyword, beforeMessageUid, count, successCB, failCB) {
      utsWfcClient.searchMyFiles(
        keyword,
        Long.fromValue(beforeMessageUid).toString(),
        count,
        (files) => {
          let frs = JSON.parse(files);
          let fileRecords = [];
          frs.forEach((fr) => {
            fileRecords.push(this._objStrToFileRecordObj(fr));
          });
          successCB && successCB(fileRecords);
        },
        (errorCode) => {
          failCB && failCB(errorCode);
        }
      );
    }
    getAuthCode(appId, appType, host, successCB, failCB) {
      utsWfcClient.getAuthCode(appId, appType, host, (authCode) => {
        successCB && successCB(authCode);
      }, (err) => {
        failCB && failCB(err);
      });
    }
    configApplication(appId, appType, timestamp, nonceStr, signature, successCB, failCB) {
      utsWfcClient.configApplication(appId, appType, timestamp, nonceStr, signature, () => {
        successCB && successCB();
      }, (err) => {
        failCB && failCB(err);
      });
    }
    notify(title, content) {
      utsWfcClient.notify(title, content);
    }
    clearAllNotification() {
      utsWfcClient.clearAllNotification();
    }
    setDeviceToken(type, token) {
      utsWfcClient.setDeviceToken(type, token);
    }
    chooseFile(type, successCB, failCB) {
      utsWfcClient.chooseFile(type, (res) => {
        successCB && successCB(res);
      }, (err) => {
        failCB && failCB(err);
      });
    }
    _handleNativeEvent(e) {
      let args = e.args;
      let func = this._nativeEvent2WfcEvent[args[0]];
      if (func) {
        func(...args.slice(1));
      }
    }
    _callNativeFunc(...args) {
    }
    // 预加载数据
    // 拉取会话相关用户、群信息
    // 自己的用户信息
    // 获取所有好友、好友请求的用户信息
    _preloadDefaultData() {
      let requests = self$6.getIncommingFriendRequest();
      let userIdSet = /* @__PURE__ */ new Set();
      requests.forEach((fr) => {
        userIdSet.add(fr.target);
      });
      requests = self$6.getOutgoingFriendRequest();
      requests.forEach((fr) => {
        userIdSet.add(fr.target);
      });
      let friendIds = self$6.getMyFriendList(false);
      friendIds.forEach((uid) => userIdSet.add(uid));
      let conversationInfoList = self$6.getConversationList([0, 1, 3], [0, 1, 2]);
      let groupIdIds = [];
      let channelIds = [];
      conversationInfoList.forEach((info) => {
        if (info.conversation.type === ConversationType.Single) {
          userIdSet.add(info.conversation.target);
        } else if (info.conversation.type === ConversationType.Group) {
          groupIdIds.push(info.conversation.target);
        } else if (info.conversation.type === ConversationType.Channel) {
          channelIds.push(info.conversation.target);
        }
        if (info.lastMessage && info.lastMessage.from) {
          userIdSet.add(info.lastMessage.from);
        }
      });
      let uids = Array.from(userIdSet);
      formatAppLog("log", "at wfc/proto/proto.min.js:2175", "to preload userIds", uids, userIdSet);
      for (let i2 = 0; i2 < uids.length / 2e3; i2++) {
        self$6.getUserInfos(uids.slice(2e3 * i2, (i2 + 1) * 2e3), "");
        formatAppLog("log", "at wfc/proto/proto.min.js:2178", "to preload", uids.slice(2e3 * i2, (i2 + 1) * 2e3));
      }
      formatAppLog("log", "at wfc/proto/proto.min.js:2181", "to preload groupIds", groupIdIds);
      self$6.getGroupInfos(groupIdIds, false);
      groupIdIds.forEach((groupId) => {
        self$6.getGroupMembers(groupId, false);
      });
      channelIds.forEach((channelId) => {
        self$6.getChannelInfo(channelId);
      });
      let estimatedTime = 0;
      estimatedTime += Math.round(uids.length / 2e3) * 4;
      estimatedTime += Math.round(groupIdIds.length / 10) * 2;
      return estimatedTime * 1e3;
    }
    _preloadGroupMemberUserInfos(memberIds) {
      for (let i2 = 0; i2 < memberIds.length / 2e3; i2++) {
        self$6.getUserInfos(memberIds.slice(2e3 * i2, (i2 + 1) * 2e3), "");
        formatAppLog("log", "at wfc/proto/proto.min.js:2202", "to preload", memberIds.slice(2e3 * i2, (i2 + 1) * 2e3));
      }
    }
  }
  const self$6 = new WfcImpl();
  class WfcManager {
    constructor() {
      /**
       * 事件通知，{@link EventType}中定义的事件，都会采用本{@link eventEmitter} 通知
       * @type {module:events.internal.EventEmitter}
       */
      __publicField(this, "eventEmitter", new eventsExports.EventEmitter());
      self$6.eventEmitter = {
        emit: (ev, ...args) => {
          if (ev === EventType.ConnectionStatusChanged || ev === EventType.UserOnlineEvent) {
            self$5.eventEmitter.emit(ev, ...args);
          } else {
            if (self$6.connectionStatus === ConnectionStatus.ConnectionStatusConnected) {
              self$5.eventEmitter.emit(ev, ...args);
            }
          }
        }
      };
    }
    /**
     * 初始化，请参考本demo的用法
     * @param {[]} args，pc 时，传入[node实例]; web 时，可以传入Config配置对象，配置项，请参考{@link Config}
     */
    init(args = []) {
      formatAppLog("log", "at wfc/client/wfc.js:47", "wfc init");
      self$6.init(args);
      formatAppLog("log", "at wfc/client/wfc.js:51", "wfc init end");
    }
    /**
     * 注册新的自定义消息
     *
     * @param {string} name
     * @param {number} flag 用来标识本消息是否需要存储、计数等，{@link PersistFlag}
     * @param {number} type 消息类型，{@link MessageContentType}
     * @param {class} clazz 消息对应的class
     */
    registerMessageContent(name, flag, type, clazz) {
      self$6.registerMessageContent(name, flag, type, clazz);
    }
    /**
     * 获取clientId，获取用户token时，一定要通过调用此方法获取clientId，否则会连接失败。
     * @returns {string} clientId
     */
    getClientId() {
      return self$6.getClientId();
    }
    /*
     * 启用国密加密。注意需要服务器端同步开启国密配置
     */
    useSM4() {
      self$6.useSM4();
    }
    /**
     * 连接服务器
     * @param {string} userId 用户id
     * @param {string} token 用户token，生成token时，所使用的clientId，一定要通过{@link getClientId}获取
     * @return {number} 返回上一次活动时间。如果间隔时间较长，可以加个第一次登录的等待提示界面，在等待时同步所有的用户信息/群组信息/频道信息等。
     */
    connect(userId, token) {
      return self$6.connect(userId, token);
    }
    /**
     * 设置代理，只支持socks5代理
     *
     * @param {String} host       代理host，host和ip必须至少有一个。
     * @param {String} ip         代理IP，host和ip必须至少有一个。
     * @param {number} port       代理端口
     * @param {String} username   username
     * @param {String} password   password
     */
    setProxyInfo(host, ip, port, username, password) {
      self$6.setProxyInfo(host, ip, port, username, password);
    }
    /**
     * 设置第三方推送设备token
     * @param {number} pushType 推送类型，0-5 移动端已经使用了。
     * @param {String} token 设备token
     */
    setDeviceToken(pushType, token) {
      self$6.setDeviceToken(pushType, token);
    }
    /**
     * 断开连接
     * @param {boolean} disablePush 是否禁用推送，在cleanSession为true时无意义
     * @param {boolean} clearSession 是否清除会话 session，清除之后，所有之前的会话信息会被删除
     */
    disconnect(disablePush = false, clearSession = false) {
      self$6.disconnect(disablePush, clearSession);
    }
    setPackageName(packageName) {
      self$6.setPackageName(packageName);
    }
    /**
     * 获取当前用户的id
     * @returns {string} 当前用户的id
     */
    getUserId() {
      return self$6.getUserId();
    }
    /**
     * 服务器时间和本地时间的差值
     * @returns {number} 服务器时间和本地时间的差值
     */
    getServerDeltaTime() {
      return self$6.getServerDeltaTime();
    }
    /**
     * 截图，
     * @returns {string} 成功返回'done'，同时，图片保存到了系统剪贴板
     */
    screenShot() {
      return self$6.screenShot();
    }
    /**
     * 是否成功登录
     * @returns {boolean}
     */
    isLogin() {
      return self$6.isLogin();
    }
    /**
     * 获取连接状态
     * @returns {number} 连接状态，参考{@link ConnectionStatus}
     */
    getConnectionStatus() {
      return self$6.getConnectionStatus();
    }
    /**
     * 设置网络策略，仅专业版支持
     * @param {int} strategy 网络策略。0 是自动选择；1 选择主网络；2选择备用网络
     *
     */
    setBackupAddressStrategy(strategy) {
      self$6.setBackupAddressStrategy(strategy);
    }
    /**
     * 设置备选网络信息，仅专业版支持
     * @param {String} backupHost 备选网络主机地址
     * @param {int} backupPort 备选网络主机端口
     */
    setBackupAddress(backupHost, backupPort) {
      self$6.setBackupAddress(backupHost, backupPort);
    }
    /**
     * 设置协议栈短连接UA。
     *
     * @param {string} userAgent 协议栈短连接使用的UA
     */
    setProtoUserAgent(userAgent) {
      self$6.setProtoUserAgent(userAgent);
    }
    /**
     * 添加协议栈短连接自定义Header
     *
     * @param {string} header 协议栈短连接使用的UA
     * @param {string} value 协议栈短连接使用的UA
     */
    addHttpHeader(header, value) {
      self$6.addHttpHeader(header, value);
    }
    /**
     * 设备从睡眠中恢复
     */
    onAppResume() {
      self$6.onAppResume();
    }
    /**
     * 设备进入睡眠状态
     */
    onAppSuspend() {
      self$6.onAppSuspend();
    }
    /**
     * 已废弃，请使用{@link getFavGroupList}
     * 获取我保存到通讯录的群组信息列表
     * @returns {[GroupInfo]} 参考{@link GroupInfo}
     */
    getMyGroupList() {
      return self$6.getMyGroupList();
    }
    /**
     * 获取我保存到通讯录的群组信息列表
     * @returns {[GroupInfo]} 参考{@link GroupInfo}
     */
    getFavGroupList() {
      let groupInfos = self$6.getMyGroupList();
      groupInfos.map((info) => {
        if (!info.portrait || info.portrait.startsWith(Config.APP_SERVER)) {
          info.portrait = this.defaultGroupPortrait(info);
        }
        return info;
      });
      return groupInfos;
    }
    /**
     * 获取用户的displayName
     * @param {string} userId 用户id
     * @returns {string} 用户displayName
     */
    getUserDisplayName(userId) {
      let userInfo = this.getUserInfo(userId, false);
      if (!userInfo) {
        return "<" + userId + ">";
      }
      return userInfo.friendAlias ? userInfo.friendAlias : userInfo.displayName ? userInfo.displayName : "<" + userId + ">";
    }
    /**
     * 获取用户在群里面的displayName
     * @param {string} groupId 群id
     * @param {string} userId 用户id
     * @returns {string} 用户在群里面的displayName
     */
    getGroupMemberDisplayName(groupId, userId) {
      let userInfo = this.getUserInfo(userId, false, groupId);
      if (!userInfo) {
        return "<" + userId + ">";
      }
      return userInfo.groupAlias ? userInfo.groupAlias : userInfo.friendAlias ? userInfo.friendAlias : userInfo.displayName ? userInfo.displayName : "<" + userId + ">";
    }
    getUserDisplayNameEx(userInfo) {
      return userInfo.friendAlias ? userInfo.friendAlias : userInfo.displayName ? userInfo.displayName : "<" + userInfo.uid + ">";
    }
    getGroupMemberDisplayNameEx(userInfo) {
      return userInfo.groupAlias ? userInfo.groupAlias : userInfo.friendAlias ? userInfo.friendAlias : userInfo.displayName ? userInfo.displayName : "<" + userInfo.uid + ">";
    }
    /**
     * 获取用户信息
     * @param {string} userId 用户id
     * @param {boolean} refresh 是否刷新用户信息，如果刷新的话，且用户信息有更新，会通过{@link eventEmitter}进行通知，事件的名字是{@link EventType.UserInfosUpdate }
     * @param {string} groupId
     * @returns {UserInfo}
     */
    getUserInfo(userId, refresh = false, groupId = "") {
      let userInfo = self$6.getUserInfo(userId, refresh, groupId);
      if (!userInfo.portrait || userInfo.portrait.startsWith(Config.APP_SERVER)) {
        userInfo.portrait = this.defaultUserPortrait(userInfo);
      }
      return userInfo;
    }
    /**
     * 获取用户信息
     * @param {string} userId 用户ID
     * @param {boolean} refresh 是否强制从服务器更新，如果本地没有或者强制，会从服务器刷新
     * @param {function (UserInfo)} success 成功回调，如果本地有该用户信息，则通过回调返回本地的用户信息；如果本地没有，则从服务端拉取该用户信息，并通过回调返回
     * @param {function (number)} fail 失败回调
     */
    getUserInfoEx(userId, refresh, success, fail) {
      self$6.getUserInfoEx(userId, refresh, success, fail);
    }
    /**
     * 批量从服务端拉取用户信息
     * @param {[string]} userIds 用户ids
     * @param {function ([UserInfo])} successCB 成功回调
     * @param {function (Number)} failCB 失败回调
     */
    getUserInfosEx(userIds, successCB, failCB) {
      self$6.getUserInfosEx(userIds, (userInfos) => {
        userInfos.forEach((u) => {
          if (!u.portrait || u.portrait.startsWith(Config.APP_SERVER)) {
            u.portrait = this.defaultUserPortrait(u);
          }
        });
        successCB && successCB(userInfos);
      }, (err) => {
        failCB && failCB(err);
      });
    }
    /**
     * 批量获取用户信息
     * @param {[string]} userIds 用户ids
     * @param {string} groupId 群组id
     * @returns {[UserInfo]}
     */
    getUserInfos(userIds, groupId) {
      let userInfos = self$6.getUserInfos(userIds, groupId);
      userInfos.forEach((u) => {
        if (!u.portrait || u.portrait.startsWith(Config.APP_SERVER)) {
          u.portrait = this.defaultUserPortrait(u);
        }
      });
      return userInfos;
    }
    /**
     * 服务端搜索用户
     * @param {string} keyword 搜索关键字
     * @param {number} searchType 搜索类型，可选值参考{@link SearchType}
     * @param {number} page 页数，如果searchType是0，每次搜索20个，可以指定page。如果searchType非0，只能搜索一个，page无意义
     * @param {function (keyword, [UserInfo])} successCB
     * @param {function (number)}failCB
     * @returns {Promise<void>}
     */
    async searchUser(keyword, searchType, page, successCB, failCB) {
      self$6.searchUser(keyword, searchType, page, (keyword2, userInfos) => {
        userInfos.forEach((u) => {
          if (!u.portrait || u.portrait.startsWith(Config.APP_SERVER)) {
            u.portrait = this.defaultUserPortrait(u);
          }
        });
        successCB && successCB(keyword2, userInfos);
      }, failCB);
    }
    /**
     * 本地搜索好友
     * @param keyword 搜索关键字
     * @returns {[UserInfo]}
     */
    searchFriends(keyword) {
      let userInfos = self$6.searchFriends(keyword);
      userInfos.forEach((u) => {
        if (!u.portrait || u.portrait.startsWith(Config.APP_SERVER)) {
          u.portrait = this.defaultUserPortrait(u);
        }
      });
      return userInfos;
    }
    /**
     * 本地搜索群组
     * @param keyword 搜索关键字
     * @returns {[GroupSearchResult]}
     */
    searchGroups(keyword) {
      let results = self$6.searchGroups(keyword);
      results.forEach((r) => {
        let info = r.groupInfo;
        if (!info.portrait || info.portrait.startsWith(Config.APP_SERVER)) {
          info.portrait = this.defaultGroupPortrait(info);
        }
      });
      return results;
    }
    /**
     * 获取收到的好友请求
     * @returns {[FriendRequest]}
     */
    getIncommingFriendRequest() {
      return self$6.getIncommingFriendRequest();
    }
    /**
     * 获取发送出去的好友请求
     * @returns {[FriendRequest]}
     */
    getOutgoingFriendRequest() {
      return self$6.getOutgoingFriendRequest();
    }
    /**
     * 获取单条好友请求
     * @param {string} userId 对方的用户id
     * @param {boolean} incoming 是否是收到的好友请求
     * @return {FriendRequest|null}
     */
    getOneFriendRequest(userId, incoming = true) {
      return self$6.getOneFriendRequest(userId, incoming);
    }
    /**
     * 从服务端加载好友请求，如果有更新，会通过{@link eventEmitter}通知
     */
    loadFriendRequestFromRemote() {
      self$6.loadFriendRequestFromRemote(Long.ZERO);
    }
    /**
     * 获取未读的好友请求数
     * @returns {number}
     */
    getUnreadFriendRequestCount() {
      return self$6.getUnreadFriendRequestCount();
    }
    /**
     * 清除好友请求未读状态
     */
    clearUnreadFriendRequestStatus() {
      self$6.clearUnreadFriendRequestStatus();
    }
    /**
     * 删除好友
     * @param {string} userId 好友id
     * @param {function ()} successCB
     * @param {function (number) }failCB
     * @returns {Promise<void>}
     */
    async deleteFriend(userId, successCB, failCB) {
      self$6.deleteFriend(userId, successCB, failCB);
    }
    /**
     * 处理好友请求
     * @param {string} userId 发送好友请求的用户的id
     * @param {boolean} accept true，接受好友请求；false，拒绝好友请求
     * @param {string} extra 一些额外信息，可用来实现好友来源等，推荐使用json格式
     * @param {function ()} successCB
     * @param {function (number)} failCB
     * @returns {Promise<void>}
     */
    async handleFriendRequest(userId, accept, extra, successCB, failCB) {
      self$6.handleFriendRequest(userId, accept, extra, successCB, failCB);
    }
    /**
     * 判断用户是否被加入了黑名单
     * @param userId
     * @returns {boolean}
     */
    isBlackListed(userId) {
      return self$6.isBlackListed(userId);
    }
    /**
     * 获取黑名单
     * @returns {[string]}
     */
    getBlackList() {
      return self$6.getBlackList();
    }
    /**
     * 设置黑名单
     * @param {string} userId 用户id
     * @param {boolean} block true，加入黑名单；false，移除黑名单
     * @param {function ()} successCB
     * @param {function (number)} failCB
     */
    setBlackList(userId, block, successCB, failCB) {
      self$6.setBlackList(userId, block, successCB, failCB);
    }
    /**
     * 获取好友列表，返回的时好友id数组
     * @param {boolean} fresh 是否刷新好友信息，如果刷新，且有更新的话，会通过{@link eventEmitter}通知
     * @returns {[string]}
     */
    getMyFriendList(fresh = false) {
      return self$6.getMyFriendList(fresh);
    }
    /**
     * 好友列表
     * @returns {[Friend]}
     */
    getFriendList(fresh = false) {
      return self$6.getFriendList(fresh);
    }
    /**
     * 获取好友别名
     * @param {string} userId
     * @returns {string}
     */
    getFriendAlias(userId) {
      return self$6.getFriendAlias(userId);
    }
    getFriendExtra(userId) {
      return self$6.getFriendExtra(userId);
    }
    /**
     * 设置好友别名
     * @param {string} userId 用户id
     * @param {string} alias 别名
     * @param {function ()} successCB
     * @param {function (number)} failCB
     * @returns {Promise<void>}
     */
    async setFriendAlias(userId, alias, successCB, failCB) {
      self$6.setFriendAlias(userId, alias, successCB, failCB);
    }
    /**
     * 创建群组
     * @param {string | null} groupId 群组id，一般情况下，传null；如果有自己的用户系统，自己维护群信息，那么可以传群id
     * @param {number} groupType 群类型，可参考 {@link GroupType }
     * @param {string} name 群名称
     * @param {string} portrait 群头像的链接
     * @param {string} groupExtra 群组扩展信息
     * @param {[string]} memberIds 群成员id列表
     * @param {string} memberExtra 群组成员扩展信息
     * @param {[number]} lines 会话线路，默认传[0]即可
     * @param {CreateGroupNotification} notifyContent 通知信息，默认传null，服务端会生成默认通知
     * @param {function (string)} successCB 回调通知群id
     * @param {function (number)} failCB
     * @returns {Promise<void>}
     */
    async createGroup(groupId, groupType, name, portrait, groupExtra, memberIds = [], memberExtra = "", lines = [0], notifyContent, successCB, failCB) {
      self$6.createGroup(groupId, groupType, name, portrait == null ? "" : portrait, groupExtra, memberIds, memberExtra, lines, notifyContent, successCB, failCB);
    }
    /**
     * 设置群管理员
     * @param {string} groupId 群id
     * @param {boolean} isSet true，设置；false，取消设置
     * @param {[string]} memberIds 将被设置为管理或取消管理远的群成员的用户id
     * @param {[number]} lines 默认传[0]即可
     * @param {Object} notifyContent 默认传null即可
     * @param {function ()} successCB
     * @param {function (number)} failCB
     * @returns {Promise<void>}
     */
    async setGroupManager(groupId, isSet, memberIds, lines, notifyContent, successCB, failCB) {
      self$6.setGroupManager(groupId, isSet, memberIds, lines, notifyContent, successCB, failCB);
    }
    /**
     * 获取群信息
     * @param {string} groupId 群id
     * @param {boolean} refresh 是否刷新，如果刷新，且有更新的话，会通过{@link eventEmitter}通知
     * @returns {GroupInfo}
     */
    getGroupInfo(groupId, refresh = false) {
      let info = self$6.getGroupInfo(groupId, refresh);
      if (!info.portrait || info.portrait.startsWith(Config.APP_SERVER)) {
        info.portrait = this.defaultGroupPortrait(info);
      }
      return info;
    }
    /**
     * 批量获取群信息
     * @param {[string]} groupIds 群id
     * @param {boolean} refresh 是否刷新，如果刷新，且有更新的话，会通过{@link eventEmitter}通知
     * @returns {[GroupInfo]}
     */
    getGroupInfos(groupIds, refresh = false) {
      let infos = self$6.getGroupInfos(groupIds, refresh);
      infos.forEach((info) => {
        if (!info.portrait || info.portrait.startsWith(Config.APP_SERVER)) {
          info.portrait = this.defaultGroupPortrait(info);
        }
      });
      return infos;
    }
    /**
     * 获取群信息
     * @param {string} groupId 群id
     * @param {boolean} refresh 是否刷新，如果刷新，且有更新的话，会通过{@link eventEmitter}通知
     * @param {function (GroupInfo)} successCB 成功回调
     * @param {function (number)} failCB 失败回调
     */
    getGroupInfoEx(groupId, refresh = false, successCB, failCB) {
      self$6.getGroupInfoEx(groupId, refresh, (info) => {
        if (!info.portrait || info.portrait.startsWith(Config.APP_SERVER)) {
          info.portrait = this.defaultGroupPortrait(info);
        }
        successCB && successCB(info);
      }, failCB);
    }
    /**
     * 添加群成员
     * @param  {string} groupId 群组id
     * @param {[string]} memberIds 新添加的群成员id
     * @param  {string} extra 群成员扩展信息
     * @param {[number]} notifyLines
     * @param {AddGroupMemberNotification} notifyMessageContent
     * @param successCB
     * @param failCB
     */
    addGroupMembers(groupId, memberIds, extra, notifyLines, notifyMessageContent, successCB, failCB) {
      self$6.addGroupMembers(groupId, memberIds, extra, notifyLines, notifyMessageContent, successCB, failCB);
    }
    /**
     * 获取群成员id列表
     * @param {string} groupId 群id
     * @param {boolean} fresh 是否刷新，刷新时，如果有更新，会通过{@link eventEmitter}通知
     * @returns {[string]} 群成员用户id列表
     */
    getGroupMemberIds(groupId, fresh = false) {
      return self$6.getGroupMemberIds(groupId, fresh);
    }
    /**
     * 获取群成员信息
     * @param {string} groupId 群id
     * @param {boolean} fresh 是否刷新
     * @returns {[GroupMember]} 群成员信息
     */
    getGroupMembers(groupId, fresh = false) {
      return self$6.getGroupMembers(groupId, fresh);
    }
    /**
     * 根据群成员类型获取群成员列表
     * @param {string} groupId
     * @param {number} memberType，可选值参考{@link GroupMemberType}
     * @return {[GroupMember]} 群成员列表
     */
    getGroupMembersByType(groupId, memberType) {
      return self$6.getGroupMembersByType(groupId, memberType);
    }
    /**
     * 获取群成员信息
     * @param {string} groupId 群id
     * @param {boolean} fresh 是否强制从服务器更新，如果不刷新则从本地缓存中读取
     * @param {function ([GroupMember])} successCB
     * @param {function (number)} failCB
     */
    getGroupMembersEx(groupId, fresh = false, successCB, failCB) {
      self$6.getGroupMembersEx(groupId, fresh, successCB, failCB);
    }
    /**
     * 获取单个群成员信息
     * @param {string} groupId 群id
     * @param {string} memberId 群成员id
     * @returns {GroupMember} 群成员信息
     */
    getGroupMember(groupId, memberId) {
      return self$6.getGroupMember(groupId, memberId);
    }
    /**
     * 将用户从群里移除
     * @param {string} groupId 群id
     * @param {[string]} memberIds 将要被移除的群成员id列表
     * @param {[]} notifyLines 默认传[0]即可
     * @param {KickoffGroupMemberNotification} notifyMsg 默认传null即可
     * @param {function ()} successCB
     * @param {function (number)} failCB
     */
    kickoffGroupMembers(groupId, memberIds, notifyLines, notifyMsg, successCB, failCB) {
      self$6.kickoffGroupMembers(groupId, memberIds, notifyLines, notifyMsg, successCB, failCB);
    }
    /**
     * 对群成员禁言
     * @param {string} groupId 群id
     * @param {boolean} isSet true，禁言；false，取消禁言
     * @param {[string]} memberIds 群成员id列表
     * @param {[number]} notifyLines 默认传[0]即可
     * @param {MessageContent} notifyMsg 默认传null即可
     * @param {function ()} successCB 成功回调
     * @param {function (number)} failCB 失败回调
     */
    muteGroupMembers(groupId, isSet, memberIds = [], notifyLines = [], notifyMsg, successCB, failCB) {
      self$6.muteOrAllowGroupMembers(groupId, isSet, false, memberIds, notifyLines, notifyMsg, successCB, failCB);
    }
    /**
     * 群全局禁言之后，允许白名单成员发言
     * @param {string} groupId 群id
     * @param {boolean} isSet true，加入白名单，允许发言；false，移除白名单，禁止发言
     * @param {[string]} memberIds 群成员id列表
     * @param {[number]} notifyLines 默认传[0]即可
     * @param {MessageContent} notifyMsg 默认传null即可
     * @param {function ()} successCB 成功回调
     * @param {function (number)} failCB 失败回调
     */
    allowGroupMembers(groupId, isSet, memberIds = [], notifyLines = [], notifyMsg, successCB, failCB) {
      self$6.muteOrAllowGroupMembers(groupId, isSet, true, memberIds, notifyLines, notifyMsg, successCB, failCB);
    }
    /**
     * 退出群组
     * @param groupId 群id
     * @param {[]} lines 默认传[0]即可
     * @param {KickoffGroupMemberNotification} notifyMessageContent 默认传null即可
     * @param successCB
     * @param failCB
     * @returns {Promise<void>}
     */
    async quitGroup(groupId, lines, notifyMessageContent, successCB, failCB) {
      self$6.quitGroup(groupId, lines, notifyMessageContent, successCB, failCB);
    }
    /**
       * 退出群组
       * @param groupId 群id
    * @param keepMessage 是否保留消息
       * @param {[]} lines 默认传[0]即可
       * @param {KickoffGroupMemberNotification} notifyMessageContent 默认传null即可
       * @param successCB
       * @param failCB
       * @returns {Promise<void>}
       */
    async quitGroupEx(groupId, keepMessage, lines, notifyMessageContent, successCB, failCB) {
      self$6.quitGroupEx(groupId, keepMessage, lines, notifyMessageContent, successCB, failCB);
    }
    /**
     * 解散群组
     * @param {string} groupId 群组id
     * @param {[]} lines 默认传[0]即可
     * @param {KickoffGroupMemberNotification} notifyMessageContent 默认传null即可
     * @param {function ()} successCB
     * @param {function (number)} failCB
     * @returns {Promise<void>}
     */
    async dismissGroup(groupId, lines, notifyMessageContent, successCB, failCB) {
      self$6.dismissGroup(groupId, lines, notifyMessageContent, successCB, failCB);
    }
    /**
     * 修改群信息
     * @param {string} groupId 群id
     * @param {number} type 修改信息所属类型，可选值参考{@link ModifyGroupInfoType}
     * @param {string} newValue 准备修改成什么
     * @param {[number]} lines
     * @param {GroupNotificationContent} notifyMessageContent
     * @param successCB
     * @param failCB
     * @returns {Promise<void>}
     */
    async modifyGroupInfo(groupId, type, newValue, lines, notifyMessageContent, successCB, failCB) {
      self$6.modifyGroupInfo(groupId, type, newValue, lines, notifyMessageContent, successCB, failCB);
    }
    /**
     * 修改我在群组的别名
     * @param {string} groupId 群id
     * @param {string} alias 别名
     * @param lines
     * @param notifyMessageContent
     * @param successCB
     * @param failCB
     * @returns {Promise<void>}
     */
    async modifyGroupAlias(groupId, alias, lines, notifyMessageContent, successCB, failCB) {
      self$6.modifyGroupAlias(groupId, alias, lines, notifyMessageContent, successCB, failCB);
    }
    /**
     * 修改群成员在群组的别名
     * @param {string} groupId 群id
     * @param {string} memberId 群成员id
     * @param {string} alias 别名
     * @param lines
     * @param notifyMessageContent
     * @param successCB
     * @param failCB
     * @returns {Promise<void>}
     */
    async modifyGroupMemberAlias(groupId, memberId, alias, lines, notifyMessageContent, successCB, failCB) {
      self$6.modifyGroupMemberAlias(groupId, memberId, alias, lines, notifyMessageContent, successCB, failCB);
    }
    /**
     * 修改群成员在群组的附加信息
     * @param {string} groupId 群id
     * @param {string} memberId 群成员id
     * @param {string} extra 群成员附加信息
     * @param lines
     * @param notifyMessageContent
     * @param successCB
     * @param failCB
     * @returns {Promise<void>}
     */
    async modifyGroupMemberExtra(groupId, memberId, extra, lines, notifyMessageContent, successCB, failCB) {
      self$6.modifyGroupMemberExtra(groupId, memberId, extra, lines, notifyMessageContent, successCB, failCB);
    }
    /**
     * 转移群主
     * @param {string} groupId 群id
     * @param {string} newOwner 新群主的id
     * @param lines
     * @param notifyMessageContent
     * @param successCB
     * @param failCB
     */
    transferGroup(groupId, newOwner, lines, notifyMessageContent, successCB, failCB) {
      self$6.transferGroup(groupId, newOwner, lines, notifyMessageContent, successCB, failCB);
    }
    /**
     * 获取保存到通讯录的群id列表
     * @returns {[string]}
     */
    getFavGroups() {
      return self$6.getFavGroups();
    }
    /**
     *  判断群是否保存到了通讯录
     * @param {string} groupId
     * @returns {boolean}
     */
    isFavGroup(groupId) {
      return self$6.isFavGroup(groupId);
    }
    /**
     * 将群保存到通讯录或移除通讯录
     * @param {string} groupId 群id
     * @param {boolean} fav true，保存到通讯录；false，从通讯录移除
     * @param {function ()} successCB
     * @param {function (number)} failCB
     * @returns {Promise<void>}
     */
    async setFavGroup(groupId, fav2, successCB, failCB) {
      self$6.setFavGroup(groupId, fav2, successCB, failCB);
    }
    /**
     * 获取用户设置，保存格式可以理解为：scope + key => value
     * @param {number} scope 命名空间，可选值参考{@link UserSettingScope}
     * @param {string} key key
     * @returns {string} 设置的key对应的value
     */
    getUserSetting(scope, key) {
      return self$6.getUserSetting(scope, key);
    }
    /**
     * 获取某个命名空间下的所有设置
     * @param scope 命名空间，可选值参考{@link UserSettingScope}
     * @returns {Map} key-value
     */
    getUserSettings(scope) {
      return self$6.getUserSettings(scope);
    }
    /**
     * 设置或更新用户设置
     * @param {number} scope 命名空间
     * @param {string} key 设置的key
     * @param {string} value 设置的value
     * @param {function ()} successCB 成功回调
     * @param {function (number)} failCB 失败回调
     * @returns {Promise<void>}
     */
    async setUserSetting(scope, key, value, successCB, failCB) {
      self$6.setUserSetting(scope, key, value, successCB, failCB);
    }
    /**
     * 修改个人信息
     * @param {[ModifyMyInfoEntry]} modifyMyInfoEntries 需要修改的信息列表，pc端，一次只允许修改一个项。
     * @param successCB
     * @param failCB
     */
    modifyMyInfo(modifyMyInfoEntries, successCB, failCB) {
      self$6.modifyMyInfo(modifyMyInfoEntries, successCB, failCB);
    }
    /**
     * 是否全局免打扰
     * @returns {boolean}
     */
    isGlobalSlient() {
      return self$6.isGlobalSlient();
    }
    /**
     * 设置全局免打扰
     * @param {boolean} silent
     * @param {function ()} successCB
     * @param failCB
     */
    setGlobalSlient(silent, successCB, failCB) {
      self$6.setGlobalSlient(silent, successCB, failCB);
    }
    /**
     * 是否隐藏通知详情
     * @returns {boolean}
     */
    isHiddenNotificationDetail() {
      return self$6.isHiddenNotificationDetail();
    }
    /**
     * 设置或取消设置隐藏通知详情
     * @param {boolean} hide 是否隐藏通知详情
     * @param {function ()} successCB
     * @param {function (number)} failCB
     * @returns {Promise<void>}
     */
    async setHiddenNotificationDetail(hide, successCB, failCB) {
      self$6.setHiddenNotificationDetail(hide, successCB, failCB);
    }
    /**
     * 是否隐藏群成员昵称
     * @param {string} groupId 群id
     * @returns {boolean}
     */
    isHiddenGroupMemberName(groupId) {
      return self$6.isHiddenGroupMemberName(groupId);
    }
    /**
     * 设置或取消设置隐藏群成员昵称
     * @param {string} groupId 群id
     * @param {boolean} hide 是否隐藏
     * @param {function ()} successCB
     * @param {function (number)} failCB
     * @returns {Promise<void>}
     */
    async setHiddenGroupMemberName(groupId, hide, successCB, failCB) {
      self$6.setHiddenGroupMemberName(groupId, hide, successCB, failCB);
    }
    /**
     * 加入聊天室
     * @param {string} chatroomId 聊天室id
     * @param {function ()} successCB
     * @param {function (number)} failCB
     * @returns {Promise<void>}
     */
    async joinChatroom(chatroomId, successCB, failCB) {
      self$6.joinChatroom(chatroomId, successCB, failCB);
    }
    /**
     * 退出聊天室
     * @param {string} chatroomId 聊天室id
     * @param {function ()} successCB
     * @param {function (number)} failCB
     * @returns {Promise<void>}
     */
    async quitChatroom(chatroomId, successCB, failCB) {
      self$6.quitChatroom(chatroomId, successCB, failCB);
    }
    /**
     * 获取聊天室信息
     * @param {string} chatroomId 聊天是id
     * @param {number} updateDt 传当前时间对应的毫秒数
     * @param {function (ChatRoomInfo)} successCB
     * @param failCB
     * @returns {Promise<void>}
     */
    async getChatroomInfo(chatroomId, updateDt, successCB, failCB) {
      return self$6.getChatroomInfo(chatroomId, updateDt, successCB, failCB);
    }
    /**
     * 获取聊天室成员信息
     * @param {string} chatroomId 聊天室id
     * @param {number} maxCount 最多获取多少个聊天室成员信息
     * @param {function (ChatRoomMemberInfo)} successCB
     * @param {function (number)} failCB
     * @returns {Promise<void>}
     */
    async getChatroomMemberInfo(chatroomId, maxCount, successCB, failCB) {
      self$6.getChatroomMemberInfo(chatroomId, maxCount, successCB, failCB);
    }
    /**
     * 创建频道
     * @param {string} name 频道名称
     * @param {string} portrait 频道头像的链接地址
     * @param {string} desc 描述
     * @param {string} extra 额外信息
     * @param {function (string)} successCB 创建成功，会回调通知channelId
     * @param {function (number)} failCB
     */
    createChannel(name, portrait, desc, extra, successCB, failCB) {
      self$6.createChannel(name, portrait, desc, extra, successCB, failCB);
    }
    /**
     * 获取频道信息
     * @param {string} channelId 频道id
     * @param {boolean} refresh 是否强制刷新
     * @returns {ChannelInfo|NullChannelInfo}
     */
    getChannelInfo(channelId, refresh) {
      return self$6.getChannelInfo(channelId, refresh);
    }
    /**
     * 修改频道信息
     * @param {string} channelId 频道id
     * @param {number} type 修改什么，可选值参考{@link ModifyChannelInfoType}
     * @param {string} newValue 修改后的值
     * @param {function ()} successCB
     * @param {function (number)} failCB
     * @returns {Promise<void>}
     */
    async modifyChannelInfo(channelId, type, newValue, successCB, failCB) {
      self$6.modifyChannelInfo(channelId, type, newValue, successCB, failCB);
    }
    /**
     * 搜索频道
     * @param {string} keyword 关键字
     * @param {boolean} fuzzy 是否模糊搜索
     * @param {function (keyword, [ChannelInfo])} successCB
     * @param {function (number)} failCB
     */
    searchChannel(keyword, fuzzy, successCB, failCB) {
      self$6.searchChannel(keyword, successCB, failCB);
    }
    /**
     * 是否已收听/关注某个频道
     * @param {string} channelId 频道id
     * @returns {boolean}
     */
    isListenedChannel(channelId) {
      return self$6.isListenedChannel(channelId);
    }
    /**
     * 收听或取消收听频道
     * @param {string} channelId 频道id
     * @param {boolean} listen true，收听；false，取消收听
     * @param {function ()} successCB
     * @param {function (number)} failCB
     * @returns {Promise<void>}
     */
    async listenChannel(channelId, listen, successCB, failCB) {
      self$6.listenChannel(channelId, listen, successCB, failCB);
    }
    /**
     * 获取自己创建的频道id列表
     * @returns {[string]}
     */
    getMyChannels() {
      return self$6.getMyChannels();
    }
    /**
     * 获取所收听的频道id列表
     * @returns {[string]}
     */
    getListenedChannels() {
      return self$6.getListenedChannels();
    }
    /**
     * 销毁频道
     * @param {string} channelId 频道id
     * @param {function ()} successCB
     * @param {function (number)} failCB
     * @returns {Promise<void>}
     */
    async destoryChannel(channelId, successCB, failCB) {
      self$6.destoryChannel(channelId, successCB, failCB);
    }
    /**
     * 获取会话列表
     * @param {[number]} types 想获取的会话类型，可选值参考{@link ConversationType}
     * @param {[0]} lines 想获取哪些会话线路的会话，默认传[0]即可
     * @returns {[ConversationInfo]}
     */
    getConversationList(types, lines) {
      return self$6.getConversationList(types, lines);
    }
    /**
     * 获取会话详情
     * @param {Conversation} conversation
     * @returns {ConversationInfo}
     */
    getConversationInfo(conversation2) {
      return self$6.getConversationInfo(conversation2);
    }
    /**
     * 搜索会话
     * @param {string} keyword 关键字
     * @param {[number]} types 从哪些类型的会话中进行搜索，可选值可参考{@link ConversationType}
     * @param {[number]} lines 从哪些会话线路进行搜索，默认传[0]即可
     * @returns {[ConversationSearchResult]}
     */
    searchConversation(keyword, types = [0, 1, 2], lines = [0, 1, 2]) {
      return self$6.searchConversation(keyword, types, lines);
    }
    /**
     * 删除会话
     * @param {Conversation} conversation 想删除的目标会话
     * @param {boolean} clearMsg 是否已删除的会话的消息
     * @returns {Promise<void>}
     */
    async removeConversation(conversation2, clearMsg) {
      self$6.removeConversation(conversation2, clearMsg);
    }
    /**
     * 会话置顶或取消置顶
     * @param {Conversation} conversation 需要置顶或取消置顶的会话
     * @param {number} top > 0, 置顶，可以根据这个值进行置顶排序；0，取消置顶
     * @param {function ()} successCB
     * @param {function (number)} failCB
     */
    setConversationTop(conversation2, top, successCB, failCB) {
      self$6.setConversationTop(conversation2, top, successCB, failCB);
    }
    /**
     * 会话免打扰或取消免打扰
     * @param {Conversation} conversation 目标会话
     * @param {boolean} silent true，设置为免打扰；false，取消免打扰
     * @param {function ()} successCB
     * @param {function (number)} failCB
     */
    setConversationSlient(conversation2, silent, successCB, failCB) {
      self$6.setConversationSlient(conversation2, silent, successCB, failCB);
    }
    /**
     * 保存会话草稿
     * @param {Conversation} conversation 目标会话
     * @param {string} draft 草稿，传''时，相当于清楚会话草稿
     */
    setConversationDraft(conversation2, draft = "") {
      self$6.setConversationDraft(conversation2, draft);
    }
    /**
     * 设置会话时间错，当会话不存在时，会创建一个新的会话。
     * @param {Conversation} conversation
     * @param {number} timestamp
     */
    setConversationTimestamp(conversation2, timestamp) {
      self$6.setConversationTimestamp(conversation2, timestamp);
    }
    /**
     * 获取未读消息数
     * @param {[number]} types 获取未读数时，包含哪些类型的会话，可选值参考{@link ConversationType}
     * @param {[number]} lines 获取未读数时，包含哪些会话线路，默认传[0]即可
     * @returns {UnreadCount}
     */
    getUnreadCount(types = [0, 1, 2], lines = [0]) {
      return self$6.getUnreadCount(types, lines);
    }
    /**
     * 获取某个会话的未读消息数
     * @param {Conversation} conversation 目标会话
     * @returns {UnreadCount}
     */
    getConversationUnreadCount(conversation2) {
      return self$6.getConversationUnreadCount(conversation2);
    }
    /**
     * 清楚会话消息未读状态
     * @param {Conversation} conversation 目标会话
     */
    clearConversationUnreadStatus(conversation2) {
      self$6.clearConversationUnreadStatus(conversation2);
    }
    /**
     * 将会话最后一条消息置为未读
     * @param {Conversation} conversation 会话
     * @param {boolean} syncToOtherClient 是否同步给其他端
     * @return {boolean} 是否操作成功
     */
    markConversationAsUnread(conversation2, syncToOtherClient) {
      return self$6.markConversationAsUnread(conversation2, syncToOtherClient);
    }
    /**
     * 清除单条消息的未读状态
     * @param messageId
     */
    clearMessageUnreadStatus(messageId) {
      self$6.clearMessageUnreadStatus(messageId);
    }
    /**
     * 清除所有消息的未读状态
     *
     * 特别注意1：本方法只清除了底层数据库中的未读状态，并未清理 UI 层会话列表中的未读状态，UI 层会话列表中的未读状态，需要手动重置。
     * 特别注意2：本方法不会触发{@link ConversationInfoUpdate} 事件
     */
    clearAllUnreadStatus() {
      self$6.clearAllUnreadStatus();
    }
    /**
     * 设置媒体消息的状态为已播放
     * @param {number} messageId 消息id，不是消息uid!
     */
    setMediaMessagePlayed(messageId) {
      self$6.setMediaMessagePlayed(messageId);
    }
    /**
     * 设置消息本地扩展信息
     * @param {number} messageId 消息id，不是消息uid!
     * @param {string} extra 扩展信息
     */
    setMessageLocalExtra(messageId, extra) {
      self$6.setMessageLocalExtra(messageId, extra);
    }
    /**
     * 判断是否是好友
     * @param {string} userId 用户id
     * @returns {boolean}
     */
    isMyFriend(userId) {
      return self$6.isMyFriend(userId);
    }
    /**
     * 获取星标用户id列表
     * @returns {[string]}
     */
    getFavUsers() {
      return self$6.getFavUsers();
    }
    /**
     *  判断用户是否是星标用户
     * @param {string} userId
     * @returns {boolean}
     */
    isFavUser(userId) {
      return self$6.isFavUser(userId);
    }
    /**
     * 设置或取消星标用户
     * @param {string} userId 用户id
     * @param {boolean} fav true，保存到通讯录；false，从通讯录移除
     * @param {function ()} successCB
     * @param {function (number)} failCB
     * @returns {Promise<void>}
     */
    async setFavUser(userId, fav2, successCB, failCB) {
      self$6.setFavUser(userId, fav2, successCB, failCB);
    }
    /**
     * 发送好友请求
     * @param {string} userId 目标用户id
     * @param {string} reason 发送好友请求的原因
     * @param {string} extra 请求的扩展信息
     * @param {function ()} successCB
     * @param {function (number)} failCB
     * @returns {Promise<void>}
     */
    async sendFriendRequest(userId, reason, extra, successCB, failCB) {
      self$6.sendFriendRequest(userId, reason, extra, successCB, failCB);
    }
    /**
     * 获取会话消息
     * @deprecated 请使用{@link getMessagesV2}
     * @param {Conversation} conversation 目标会话
     * @param {number} fromIndex messageId，表示从那一条消息开始获取
     * @param {boolean} before true, 获取fromIndex之前的消息，即更旧的消息；false，获取fromIndex之后的消息，即更新的消息。都不包含fromIndex对应的消息
     * @param {number} count 获取多少条消息
     * @param {string} withUser 只有会话类型为{@link ConversationType#Channel}时生效, channel主用来查询和某个用户的所有消息
     * @return {[Message]} 会话消息列表，参考{@link Message}
     */
    getMessages(conversation2, fromIndex = 0, before = true, count = 20, withUser = "") {
      return self$6.getMessages(conversation2, fromIndex, before, count, withUser);
    }
    /**
     * 获取消息
     * @deprecated 请使用{@link getMessagesExV2}
     * @param {[number]} conversationTypes 会话类型列表，可选值参考{@link  ConversationType}
     * @param {[number]} lines 会话线路列表
     * @param {number} fromIndex 本参数暂时无效! messageId，表示从那一条消息开始获取
     * @param {boolean} before 本参数暂时无效! true, 获取fromIndex之前的消息，即更旧的消息；false，获取fromIndex之后的消息，即更新的消息。都不包含fromIndex对应的消息
     * @param {number} count 本参数暂时无效! 获取多少条消息
     * @param {string} withUser 只有会话类型为{@link ConversationType#Channel}时生效, channel主用来查询和某个用户的所有消息
     * @param {[number]} contentTypes 消息类型列表，可选值参考{@link MessageContentType}
     * @return {[Message]} 会话消息列表，参考{@link Message}
     */
    getMessagesEx(conversationTypes, lines, fromIndex = 0, before = true, count = 20, withUser = "", contentTypes = []) {
      return self$6.getMessagesEx(conversationTypes, lines, contentTypes, fromIndex, before, count, withUser);
    }
    /**
     * 获取消息
     * @deprecated 请使用{@link getMessagesEx2V2}
     * @param {[number]} conversationTypes 会话类型列表，可选值参考{@link  ConversationType}
     * @param {[number]} lines 会话线路列表
     * @param {[number]} messageStatus 消息状态，可选值参考{@link MessageStatus}
     * @param {number} fromIndex 本参数暂时无效! messageId，表示从那一条消息开始获取
     * @param {boolean} before 本参数暂时无效! true, 获取fromIndex之前的消息，即更旧的消息；false，获取fromIndex之后的消息，即更新的消息。都不包含fromIndex对应的消息
     * @param {number} count 本参数暂时无效! 获取多少条消息
     * @param {string} withUser 只有会话类型为{@link ConversationType#Channel}时生效, channel主用来查询和某个用户的所有消息
     * @return {[Message]} 会话消息列表，参考{@link Message}
     */
    getMessagesEx2(conversationTypes, lines, messageStatus, fromIndex = 0, before = true, count = 20, withUser = "") {
      return self$6.getMessagesEx2(conversationTypes, lines, messageStatus, fromIndex, before, count, withUser);
    }
    /**
     * 获取会话消息
     * @deprecated 请使用{@link getMessagesByTimestampV2}
     * @param {Conversation} conversation 目标会话
     * @param {[number]} contentTypes 消息类型，可选值参考{@link MessageContentType}
     * @param {number} timestamp 时间戳
     * @param {boolean} before true, 获取timestamp之前的消息，即更旧的消息；false，获取timestamp之后的消息，即更新的消息。都不包含timestamp对应的消息
     * @param {number} count 获取多少条消息
     * @param {string} withUser 只有会话类型为{@link ConversationType#Channel}时生效, channel主用来查询和某个用户的所有消息
     * @return {[Message]} 会话消息列表，参考{@link Message}
     */
    getMessagesByTimestamp(conversation2, contentTypes, timestamp, before = true, count = 20, withUser = "") {
      return self$6.getMessagesByTimestamp(conversation2, contentTypes, timestamp, before, count, withUser);
    }
    /**
     * 获取用户会话消息
     * @deprecated 请使用{@link getUserMessagesV2}
     * @param {string} userId 用户id
     * @param {Conversation} conversation 目标会话
     * @param {number} fromIndex 本参数暂时无效！ messageId，表示从那一条消息开始获取
     * @param {boolean} before 本参数暂时无效！ true, 获取fromIndex之前的消息，即更旧的消息；false，获取fromIndex之后的消息，即更新的消息。都不包含fromIndex对应的消息
     * @param {number} count 本参数暂时无效! 获取多少条消息
     * @return
     */
    getUserMessages(userId, conversation2, fromIndex, before = true, count = 20) {
      return self$6.getUserMessages(userId, conversation2, fromIndex, before, count);
    }
    /**
     * 获取用户消息
     * @deprecated 请使用{@link getUserMessagesExV2}
     * @param {string} userId 用户id
     * @param {[number]} conversationTypes 想获取的会话类型，可选值参考{@link ConversationType}
     * @param {[0]} lines 想获取哪些会话线路的会话，默认传[0]即可
     * @param {number} fromIndex 本参数暂时无效！ messageId，表示从那一条消息开始获取
     * @param {boolean} before 本参数暂时无效！ true, 获取fromIndex之前的消息，即更旧的消息；false，获取fromIndex之后的消息，即更新的消息。都不包含fromIndex对应的消息
     * @param {number} count 本参数暂时无效！ 获取多少条消息
     * @param {[number]} contentTypes 消息类型，可选值参考{@link MessageContentType}
     * @return
     */
    getUserMessagesEx(userId, conversationTypes, lines, fromIndex, before = true, count = 20, contentTypes = []) {
      return self$6.getUserMessagesEx(userId, conversationTypes, lines, fromIndex, before, count, contentTypes);
    }
    /**
     * 获取会话消息
     * @param {Conversation} conversation 目标会话
     * @param {number} fromIndex messageId，表示从那一条消息开始获取
     * @param {boolean} before true, 获取fromIndex之前的消息，即更旧的消息；false，获取fromIndex之后的消息，即更新的消息。都不包含fromIndex对应的消息
     * @param {number} count 获取多少条消息
     * @param {string} withUser 只有会话类型为{@link ConversationType#Channel}时生效, channel主用来查询和某个用户的所有消息
     * @param {function (Message)} successCB
     * @param failCB
     */
    getMessagesV2(conversation2, fromIndex, before, count, withUser, successCB, failCB) {
      self$6.getMessagesV2(conversation2, fromIndex, before, count, withUser, successCB, failCB);
    }
    /**
     * 获取消息
     * @param {[number]} conversationTypes 会话类型列表，可选值参考{@link  ConversationType}
     * @param {[number]} lines 会话线路列表
     * @param {number} fromIndex 本参数暂时无效! messageId，表示从那一条消息开始获取
     * @param {boolean} before 本参数暂时无效! true, 获取fromIndex之前的消息，即更旧的消息；false，获取fromIndex之后的消息，即更新的消息。都不包含fromIndex对应的消息
     * @param {number} count 本参数暂时无效! 获取多少条消息
     * @param {string} withUser 只有会话类型为{@link ConversationType#Channel}时生效, channel主用来查询和某个用户的所有消息
     * @param {[number]} contentTypes 消息类型列表，可选值参考{@link MessageContentType}
     * @param {function (Message)} successCB
     * @param failCB
     */
    getMessagesExV2(conversationTypes, lines, fromIndex, before, count, withUser, contentTypes, successCB, failCB) {
      self$6.getMessagesExV2(conversationTypes, lines, contentTypes, fromIndex, before, count, withUser, successCB, failCB);
    }
    /**
     *
     * @param {[number]} conversationTypes 会话类型列表，可选值参考{@link  ConversationType}
     * @param {[number]} lines 会话线路列表
     * @param {[number]} messageStatuses 消息状态，可选值参考{@link MessageStatus}
     * @param {number} fromIndex 本参数暂时无效! messageId，表示从那一条消息开始获取
     * @param {boolean} before 本参数暂时无效! true, 获取fromIndex之前的消息，即更旧的消息；false，获取fromIndex之后的消息，即更新的消息。都不包含fromIndex对应的消息
     * @param {number} count 本参数暂时无效! 获取多少条消息
     * @param {string} withUser 只有会话类型为{@link ConversationType#Channel}时生效, channel主用来查询和某个用户的所有消息
     * @param {function (Message)} successCB
     * @param failCB
     */
    getMessagesEx2V2(conversationTypes, lines, messageStatuses, fromIndex, before, count, withUser, successCB, failCB) {
      self$6.getMessagesEx2V2(conversationTypes, lines, messageStatuses, fromIndex, before, count, withUser, successCB, failCB);
    }
    /**
     * 获取会话消息
     * @param {Conversation} conversation 目标会话
     * @param {[number]} contentTypes 消息类型，可选值参考{@link MessageContentType}
     * @param {number} timestamp 时间戳
     * @param {boolean} before true, 获取timestamp之前的消息，即更旧的消息；false，获取timestamp之后的消息，即更新的消息。都不包含timestamp对应的消息
     * @param {number} count 获取多少条消息
     * @param {string} withUser 只有会话类型为{@link ConversationType#Channel}时生效, channel主用来查询和某个用户的所有消息
     * @param {function (Message)} successCB
     * @param failCB
     */
    getMessagesByTimestampV2(conversation2, contentTypes, timestamp, before, count, withUser, successCB, failCB) {
      self$6.getMessagesByTimestampV2(conversation2, contentTypes, timestamp, before, count, withUser, successCB, failCB);
    }
    /**
     * 获取用户会话消息
     * @param {string} userId 用户id
     * @param {Conversation} conversation 目标会话
     * @param {number} fromIndex 本参数暂时无效！ messageId，表示从那一条消息开始获取
     * @param {boolean} before 本参数暂时无效！ true, 获取fromIndex之前的消息，即更旧的消息；false，获取fromIndex之后的消息，即更新的消息。都不包含fromIndex对应的消息
     * @param {number} count 本参数暂时无效! 获取多少条消息
     * @param {function (Message)} successCB
     * @param failCB
     */
    getUserMessagesV2(userId, conversation2, fromIndex, before, count, successCB, failCB) {
      self$6.getUserMessagesV2(userId, conversation2, fromIndex, before, count, successCB, failCB);
    }
    /**
     * 获取用户消息
     * @param {string} userId 用户id
     * @param {[number]} conversationTypes 想获取的会话类型，可选值参考{@link ConversationType}
     * @param {[0]} lines 想获取哪些会话线路的会话，默认传[0]即可
     * @param {number} fromIndex 本参数暂时无效！ messageId，表示从那一条消息开始获取
     * @param {boolean} before 本参数暂时无效！ true, 获取fromIndex之前的消息，即更旧的消息；false，获取fromIndex之后的消息，即更新的消息。都不包含fromIndex对应的消息
     * @param {number} count 本参数暂时无效！ 获取多少条消息
     * @param {[number]} contentTypes 消息类型，可选值参考{@link MessageContentType}
     * @param {function (Message)} successCB
     * @param failCB
     */
    getUserMessagesExV2(userId, conversationTypes, lines, fromIndex, before, count, contentTypes, successCB, failCB) {
      self$6.getUserMessagesExV2(userId, conversationTypes, lines, fromIndex, before, count, contentTypes, successCB, failCB);
    }
    /**
     * 获取会话第一条未读消息的消息id
     * @param {Conversation} conversation
     * @return {number}
     */
    getFirstUnreadMessageId(conversation2) {
      return self$6.getFirstUnreadMessageId(conversation2);
    }
    /**
     * 已废弃，请使用{@link loadRemoteConversationMessages}
     * 获取会还的远程历史消息
     * @param {Conversation} conversation 目标会话
     * @param {[number]} contentTypes 消息类型列表，可选值参考{@link MessageContentType}
     * @param {number | Long} beforeUid 消息uid，表示拉取本条消息之前的消息
     * @param {number} count
     * @param {function (Message)} successCB
     * @param failCB
     */
    loadRemoteMessages(conversation2, contentTypes, beforeUid, count, successCB, failCB) {
      self$6.loadRemoteMessages(conversation2, contentTypes, beforeUid, count, successCB, failCB);
    }
    /**
     * 获取会话的远程历史消息
     * @param {Conversation} conversation 目标会话
     * @param {[number]} contentTypes 消息类型列表，可选值参考{@link MessageContentType}
     * @param {number | Long} beforeUid 消息uid，表示拉取本条消息之前的消息
     * @param {number} count
     * @param {function ([Message])} successCB
     * @param failCB
     */
    loadRemoteConversationMessages(conversation2, contentTypes, beforeUid, count, successCB, failCB) {
      self$6.loadRemoteMessages(conversation2, contentTypes, beforeUid, count, successCB, failCB);
    }
    /**
     * 获取会话的远程历史消息，仅 web 有效
     * @param {Conversation} conversation 目标会话
     * @param {[number]} contentTypes 消息类型列表，可选值参考{@link MessageContentType}
     * @param {number | Long} beforeUid 消息uid，表示拉取本条消息之前的消息
     * @param {number} count
     * @param {boolean} filterLocalMessage 是否过滤本地已经存在的消息
     * @param {function ([Message])} successCB
     * @param failCB
     */
    loadRemoteConversationMessagesEx(conversation2, contentTypes, beforeUid, count, filterLocalMessage, successCB, failCB) {
      self$6.loadRemoteMessages(conversation2, contentTypes, beforeUid, count, successCB, failCB, filterLocalMessage);
    }
    /**
     * 根据会话线路，获取远程历史消息
     * @param {number} line 会话线路
     * @param {number | Long} beforeUid 消息uid，表示拉取本条消息之前的消息
     * @param {[number]} contentTypes 消息类型列表，可选值参考{@link MessageContentType}
     * @param {number} count
     * @param {function ([Message])} successCB
     * @param failCB
     */
    loadRemoteLineMessages(line, contentTypes, beforeUid, count, successCB, failCB) {
      self$6.loadRemoteLineMessages(line, contentTypes, beforeUid, count, successCB, failCB);
    }
    /**
     * 根据消息 uid，获取远程消息
     * @param {Long} messageUid 消息uid
     * @param {function ([Message])} successCB
     * @param failCB
     */
    loadRemoteMessage(messageUid, successCB, failCB) {
      self$6.loadRemoteMessage(messageUid, successCB, failCB);
    }
    /**
     * 获取消息
     * @param {number} messageId 消息id
     * @returns {null|Message}
     */
    getMessageById(messageId) {
      return self$6.getMessageById(messageId);
    }
    /**
     * 获取消息
     * @param {Long|string|number} messageUid
     * @returns {null|Message}
     */
    getMessageByUid(messageUid) {
      return self$6.getMessageByUid(messageUid);
    }
    /**
     * 搜索消息
     * @param {Conversation} conversation 目标会话
     * @param {string} keyword 关键字
     * @param {string} withUser 目标用户
     * @returns {[Message]}
     */
    searchMessage(conversation2, keyword, withUser = "") {
      return self$6.searchMessage(conversation2, keyword, withUser);
    }
    /**
     * 搜索消息
     * @param {Conversation} conversation 目标会话，如果为空搜索所有会话
     * @param {string} keyword 关键字
     * @param {boolean} desc 逆序排列
     * @param {int} limit 返回数量
     * @param {int} offset 偏移
     * @param {string} withUser 目标用户
     * @returns {Message[]}
     */
    searchMessageEx(conversation2, keyword, desc, limit, offset, withUser = "") {
      return self$6.searchMessageEx(conversation2, keyword, desc, limit, offset, withUser);
    }
    /**
     * 搜索消息
     * @param {Conversation} conversation 目标会话，如果为空搜索所有会话
     * @param {string} keyword 关键字
     * @param {[number]} contentTypes 消息类型列表，可选值参考{@link MessageContentType}
     * @param {boolean} desc 逆序排列
     * @param {int} limit 返回数量
     * @param {int} offset 偏移
     * @param {string} withUser 目标用户
     * @returns {Message[]}
     */
    searchMessageByTypes(conversation2, keyword, contentTypes, desc, limit, offset, withUser = "") {
      return self$6.searchMessageByTypes(conversation2, keyword, contentTypes, desc, limit, offset, withUser);
    }
    /**
     * 搜索消息
     * @param {Conversation} conversation 目标会话，如果为空搜索所有会话
     * @param {string} keyword 关键字
     * @param {[number]} contentTypes 消息类型列表，可选值参考{@link MessageContentType}
     * @param {Long} 消息起始时间，如果为0，则忽略起始时间。
     * @param {Long} 消息结束时间，如果为0，测忽略结束时间。
     * @param {boolean} desc 逆序排列
     * @param {int} limit 返回数量
     * @param {int} offset 偏移
     * @param {string} withUser 目标用户
     * @returns {Message[]}
     */
    searchMessageByTypesAndTimes(conversation2, keyword, contentTypes, startTime, endTime, desc, limit, offset, withUser = "") {
      return self$6.searchMessageByTypesAndTimes(conversation2, keyword, contentTypes, startTime, endTime, desc, limit, offset, withUser);
    }
    /**
     * 搜索消息
     * @param {[number]} conversationTypes 会话类型列表，可选值参考{@link  ConversationType}
     * @param {[number]} lines 会话线路列表
     * @param {[number]} contentTypes 消息类型列表，可选值参考{@link MessageContentType}
     * @param {string} keyword 关键字
     * @param {number} fromIndex messageId，表示从那一条消息开始获取
     * @param {boolean} desc 逆序排列
     * @param {number} count 最大数量
     * @param {string} withUser 目标用户
     * @returns {[Message]}
     */
    searchMessageEx2(conversationTypes, lines, contentTypes, keyword, fromIndex, desc, count, withUser = "") {
      return self$6.searchMessageEx2(conversationTypes, lines, contentTypes, keyword, fromIndex, desc, count, withUser);
    }
    /**
     * 发送消息
     * @param {Conversation} conversation 目标会话
     * @param {MessageContent} messageContent 具体的消息内容，一定要求是{@link MessageContent} 的子类，不能是普通的object
     * @param {[string]} toUsers 定向发送给会话中的某些用户；为空，则发给所有人；另外对单聊会话，本参数无效
     * @param {function (number, number)} preparedCB 消息已插入本地数据的回调，回调的两个参数表示：messageId, timestamp
     * @param {function (number, number)} progressCB 媒体上传进度回调，针对媒体消息，且媒体大于100K时有效，回调参数表示：uploaded, total
     * @param {function (number, number)} successCB 发送成功回调，回调参数表示：messageUid, timestamp
     * @param {function (number)} failCB
     * @returns {Promise<void>}
     */
    async sendConversationMessage(conversation2, messageContent, toUsers = [], preparedCB = null, progressCB = null, successCB = null, failCB = null) {
      self$6.sendConversationMessage(conversation2, messageContent, toUsers, preparedCB, progressCB, successCB, failCB);
    }
    /**
     * 发送消息，参考{@link sendConversationMessage}
     * @param {Message} message 一定要求是{@link Message}类型
     * @param preparedCB
     * @param progressCB
     * @param successCB
     * @param failCB
     * @returns {Promise<void>}
     */
    async sendMessage(message2, preparedCB, progressCB, successCB, failCB) {
      self$6.sendMessage(message2, preparedCB, progressCB, successCB, failCB);
    }
    /**
     * 发送消息，参考{@link sendMessage}
     * @param message
     * @param toUsers
     * @param preparedCB
     * @param progressCB
     * @param successCB
     * @param failCB
     * @returns {Promise<void>}
     */
    async sendMessageEx(message2, toUsers = [], preparedCB, progressCB, successCB, failCB) {
      self$6.sendMessageEx(message2, toUsers, preparedCB, progressCB, successCB, failCB);
    }
    // 更新了原始消息的内容
    /**
     * 撤回消息
     * @param {Long} messageUid
     * @param {function ()} successCB
     * @param {function (number)} failCB
     * @returns {Promise<void>}
     */
    async recallMessage(messageUid, successCB, failCB) {
      self$6.recallMessage(messageUid, successCB, failCB);
    }
    /**
     * 删除消息
     * @param {number} messageId 消息id
     * @returns {*}
     */
    deleteMessage(messageId) {
      return self$6.deleteMessageById(messageId);
    }
    /**
     * 删除远程消息
     * @param {Long | string} msgUid 消息uid
     * @param {function ()} successCB
     * @param {function (number)} failCB
     */
    deleteRemoteMessageByUid(msgUid, successCB, failCB) {
      self$6.deleteRemoteMessage(msgUid, successCB, failCB);
    }
    /**
     * 更新远程消息消息内容，只有专业版支持。客户端仅能更新自己发送的消息，更新的消息类型不能变，更新的消息类型是服务配置允许更新的内容。Server API更新则没有限制。
     * @param {Long | string} msgUid 消息uid
     * @param {MessageContent} messageContent 具体的消息内容，一定要求是{@link MessageContent} 的子类，不能是普通的object
     * @param {boolean} distribute 是否重新分发给其他客户端
     * @param {boolean} updateLocal 是否更新本地消息内容
     * @param {function ()} successCB
     * @param {function (number)} failCB
     */
    updateRemoteMessageContent(msgUid, messageContent, distribute, updateLocal, successCB, failCB) {
      self$6.updateRemoteMessageContent(msgUid, messageContent, distribute, updateLocal, successCB, failCB);
    }
    /**
     * 清除会话消息
     * @param {Conversation} conversation 目标会话
     * @returns {Promise<void>}
     */
    async clearMessages(conversation2) {
      self$6.clearMessages(conversation2);
    }
    /**
     * 清除远程会话消息
     * @param {Conversation} conversation
     * @param {function ()} successCB
     * @param {function (error)} failCB
     * @return {Promise<void>}
     */
    async clearRemoteConversationMessages(conversation2, successCB, failCB) {
      self$6.clearRemoteConversationMessages(conversation2, successCB, failCB);
    }
    /**
     * 插入消息
     * @param {Conversation} conversation 目标会话
     * @param {MessageContent} messageContent 具体的消息内容，一定要求是{@link MessageContent} 的子类，不能是普通的object
     * @param {number} status 消息状态，可选值参考{@link MessageStatus}
     * @param {boolean} notify 是否触发onReceiveMessage
     * @param {[string]} toUsers 群会话时有效，定向发送给会话中的某些用户；为空，则发给所有人
     * @param {Number} serverTime 服务器时间，精度到毫秒
     *
     * @return {Message} 插入的消息
     */
    insertMessage(conversation2, messageContent, status, notify = false, toUsers = [], serverTime = 0) {
      self$6.insertMessage(conversation2, messageContent, status, notify, toUsers, serverTime);
    }
    /**
     * 更新消息
     * @param {number} messageId 消息id
     * @param {MessageContent} messageContent 具体的消息内容，一定要求是{@link MessageContent} 的子类，不能是普通的object
     * @returns {Promise<void>}
     */
    async updateMessageContent(messageId, messageContent) {
      self$6.updateMessageContent(messageId, messageContent);
    }
    /**
     * 更新消息状态
     * @param {number} messageId 消息id
     * @param {MessageStatus} status 消息状态，可选值参考{@link MessageStatus}
     */
    async updateMessageStatus(messageId, status) {
      self$6.updateMessageStatus(messageId, status);
    }
    /**
     * 上传媒体文件
     * @param {string} fileName
     * @param {string} fileOrData base64格式的dataUri
     * @param {number} mediaType 媒体类型，可选值参考{@link MessageContentMediaType}
     * @param {function (string)} successCB 回调通知上传成功之后的url
     * @param {function (number)} failCB
     * @param {function (number, number)} progressCB
     * @returns {Promise<void>}
     */
    async uploadMedia(fileName, fileOrData, mediaType, successCB, failCB, progressCB) {
      self$6.uploadMedia(fileName, fileOrData, mediaType, successCB, failCB, progressCB);
    }
    getVersion() {
      return self$6.getVersion();
    }
    /**
     * 获取经过认证的下载地址。
     */
    getAuthorizedMediaUrl(messageUid, mediaType, mediaPath, successCB, failCB) {
      self$6.getAuthorizedMediaUrl(messageUid, mediaType, mediaPath, successCB, failCB);
    }
    /**
     * 是否支持上传大文件上传。只有专业版才支持此功能。当支持大文件上传时，调用getUploadMediaUrl获取上传url，然后在应用层上传
     */
    isSupportBigFilesUpload() {
      return self$6.isSupportBigFilesUpload();
    }
    /**
     * 获取上传链接。一般用户大文件上传。
     * @param {string} fileName
     * @param {number} mediaType 媒体类型，可选值参考{@link MessageContentMediaType}
     * @param {string} contentType HTTP请求的ContentType header，为空时默认为"application/octet-stream"
     * @param {function (string, string)} successCB 回调通知上传成功之后的url
     * @param {function (number)} failCB
     */
    getUploadMediaUrl(fileName, mediaType, contentType, successCB, failCB) {
      self$6.getUploadMediaUrl(fileName, mediaType, contentType, successCB, failCB);
    }
    /**
     * 微信小程序切到前台时调用应用切到了前台
     *
     */
    onForeground() {
      self$6.onForeground();
    }
    /**
     *
     * 是否开启了已送达报告和已读报告功能
     * @return {boolean}
     */
    isReceiptEnabled() {
      return self$6.isReceiptEnabled();
    }
    /**
     * 当前用户是否开启消息回执
     * @return {boolean}
     */
    isUserReceiptEnabled() {
      return self$6.isUserReceiptEnabled();
    }
    /**
     * 判断是否是专业版IM服务
     * @return {boolean}
     */
    isCommercialServer() {
      return self$6.isCommercialServer();
    }
    /**
     * 判断是否应用禁止草稿同步
     * @return {boolean}
     */
    isGlobalDisableSyncDraft() {
      return self$6.isGlobalDisableSyncDraft();
    }
    /**
     *
     * @param disable
     * @param successCB
     * @param failCB
     */
    setDisableSyncDraft(disable, successCB, failCB) {
      self$6.setDisableSyncDraft(disable, successCB, failCB);
    }
    isDisableSyncDraft() {
      return self$6.isDisableSyncDraft();
    }
    /**
     * 设置当前用户是否开启消息回执
     * @param enable
     * @param successCB
     * @param failCB
     */
    setUserEnableReceipt(enable, successCB, failCB) {
      self$6.setUserEnableReceipt(enable, successCB, failCB);
    }
    /**
     *
     * @param conversation
     * @return {Map<string, Long>}
     */
    getConversationRead(conversation2) {
      return self$6.getConversationRead(conversation2);
    }
    /**
     * 获取会话中的文件记录
     * @param {Conversation} conversation 会话
     * @param {String} fromUser 来源用户
     * @param {Long} beforeMessageUid 消息uid，表示获取此消息uid之前的文件记录
     * @param {number} count 数量
     * @param {function (FileRecord[])} successCB 成功回调
     * @param {function (number)} failCB 失败回调
     */
    getConversationFileRecords(conversation2, fromUser, beforeMessageUid, count, successCB, failCB) {
      self$6.getConversationFileRecords(conversation2, fromUser, beforeMessageUid, count, successCB, failCB);
    }
    /**
     * 获取我发送的文件记录
     * @param {Long} beforeMessageUid 消息uid，表示获取此消息uid之前的文件记录
     * @param {number} count 数量
     * @param {function (FileRecord[])} successCB 成功回调
     * @param {function (number)} failCB 失败回调
     */
    getMyFileRecords(beforeMessageUid, count, successCB, failCB) {
      self$6.getMyFileRecords(beforeMessageUid, count, successCB, failCB);
    }
    /**
     * 删除文件记录
     * @param {Long} messageUid 文件对应的消息的uid
     * @param {function ()} successCB 成功回调
     * @param {function (number)} failCB 失败回调
     */
    deleteFileRecord(messageUid, successCB, failCB) {
      self$6.deleteFileRecord(messageUid, successCB, failCB);
    }
    /**
     * 搜索远程文件记录
     * @param {string} keyword
     * @param {Conversation} conversation 会话，如果为空则获取当前用户所有收到和发出的文件记录
     * @param {string} fromUser 文件发送用户，如果为空则获取该用户发出的文件记录
     * @param {Long | string} beforeMessageId 起始消息的消息id
     * @param {number} count
     * @param {function (FileRecord[])} successCB
     * @param {function (number)} failCB
     */
    searchFiles(keyword, conversation2, fromUser, beforeMessageId, count, successCB, failCB) {
      self$6.searchFiles(keyword, conversation2, fromUser, beforeMessageId, count, successCB, failCB);
    }
    /**
     * 搜索我自己的远程文件记录
     * @param keyword
     * @param beforeMessageUid
     * @param count
     * @param successCB
     * @param failCB
     */
    searchMyFiles(keyword, beforeMessageUid, count, successCB, failCB) {
      self$6.searchMyFiles(keyword, beforeMessageUid, count, successCB, failCB);
    }
    /**
     * 获取host
     */
    getHost() {
      return self$6.getHost();
    }
    getEncodedClientId() {
      return self$6.getEncodedClientId();
    }
    /**
     *
     * @param {string} data 将要编码的数据
     * @returns {string} 编码结果，base64格式
     */
    encodeData(data) {
      return self$6.encodeData(data);
    }
    /**
     *
     * @param {string} encodedData 将要解码的数据，base64格式
     * @returns {null | string} 解码之后的数据
     */
    decodeData(encodedData) {
      return self$6.decodeData(encodedData);
    }
    /**
     * 发送会议相关请求
     * @param sessionId
     * @param roomId
     * @param request
     * @param data
     * @param callback
     */
    sendConferenceRequest(sessionId, roomId, request, data, callback) {
      this.sendConferenceRequestEx(sessionId, roomId, request, data, false, callback);
    }
    sendConferenceRequestEx(sessionId, roomId, request, data, advance, callback) {
      self$6.sendConferenceRequest(sessionId, roomId, request, data, advance, callback);
    }
    isUserOnlineStateEnabled() {
      return self$6.isUserOnlineStateEnabled();
    }
    /**
     *
     * @param {number} type 会话类型， 支持{@link ConversationType.Single}和{@link ConversationType.Group}
     * @param {string[]} targets 会话类型为单聊时，是用户 id列表；会话类型为群组时，是群组 id 列表
     * @param {number} duration 关注时间长度，单位是秒
     * @param {function(UserOnlineState[])} successCB
     * @param {function(number)} failCB
     */
    watchOnlineState(type, targets, duration, successCB, failCB) {
      self$6.watchOnlineState(type, targets, duration, successCB, failCB);
    }
    unwatchOnlineState(type, targets, successCB, failCB) {
      self$6.unwatchOnlineState(type, targets, successCB, failCB);
    }
    setMyCustomState(customState, customText, successCB, failCB) {
      self$6.setMyCustomState(customState, customText, successCB, failCB);
    }
    getAuthCode(appId, appType, host, successCB, failCB) {
      self$6.getAuthCode(appId, appType, host, successCB, failCB);
    }
    configApplication(appId, appType, timestamp, nonceStr, signature, successCB, failCB) {
      self$6.configApplication(appId, appType, timestamp, nonceStr, signature, successCB, failCB);
    }
    notify(title, content) {
      self$6.notify(title, content);
    }
    clearAllNotification() {
      self$6.clearAllNotification();
    }
    chooseFile(type, successCB, failCB) {
      self$6.chooseFile(type, successCB, failCB);
    }
    _getStore() {
      return self$6._getStore();
    }
    /**
     * 内部使用，electron主窗口之外的，其他窗口，attach到主窗口初始化的proto上，可以调用get相关方法，但没有通知
     * @param protoObj
     */
    attach(protoObj) {
      self$6.attach(protoObj);
    }
    /**
     * utf8转base64
     * @param {string} str
     * @returns {string}
     */
    utf8_to_b64(str) {
      return btoa(unescape(encodeURIComponent(str)));
    }
    /**
     * base64转utf8
     * @param {string} str
     * @returns {string}
     */
    b64_to_utf8(str) {
      return decodeURIComponent(escape(atob(str)));
    }
    unescape(str) {
      return (str + "===".slice((str.length + 3) % 4)).replace(/-/g, "+").replace(/_/g, "/");
    }
    escape(str) {
      return str.replace(/\+/g, "-").replace(/\//g, "_").replace(/=/g, "");
    }
    defaultUserPortrait(userInfo) {
      return `${Config.APP_SERVER}/avatar?name=${encodeURIComponent(userInfo.displayName)}`;
    }
    defaultGroupPortrait(groupInfo) {
      let memberIds = this.getGroupMemberIds(groupInfo.target);
      memberIds = memberIds.slice(0, 9);
      let members = self$6.getUserInfos(memberIds, groupInfo.target);
      let req = {
        members: []
      };
      let pending = false;
      members.forEach((m) => {
        if (m.portrait && !m.portrait.startsWith(`${Config.APP_SERVER}`)) {
          req.members.push({
            avatarUrl: m.portrait
          });
        } else {
          req.members.push({
            name: m.displayName
          });
        }
        if (m instanceof NullUserInfo) {
          pending = true;
        }
      });
      if (members.length === 0 || pending) {
        return null;
      }
      req = JSON.stringify(req, null, "");
      return `${Config.APP_SERVER}/avatar/group?request=${encodeURIComponent(req)}`;
    }
  }
  const self$5 = new WfcManager();
  const wfc = self$5;
  const _export_sfc = (sfc, props) => {
    const target = sfc.__vccOpts || sfc;
    for (const [key, val] of props) {
      target[key] = val;
    }
    return target;
  };
  const _sfc_main$1p = {
    name: "SplashPage",
    onLoad() {
      let userId = getItem("userId");
      let token = getItem("token");
      if (token) {
        wfc.connect(userId, token);
        this.go2ConversationList();
      } else {
        uni.redirectTo({
          url: "/pages/login/LoginPage"
        });
      }
    },
    methods: {
      go2ConversationList() {
        uni.switchTab({
          url: "/pages/conversationList/ConversationListPage",
          success: () => {
            formatAppLog("log", "at pages/SplashPage.vue:27", "to conversation list success");
          },
          fail: (e) => {
            formatAppLog("log", "at pages/SplashPage.vue:30", "to conversation list error", e);
          },
          complete: () => {
            formatAppLog("log", "at pages/SplashPage.vue:33", "switch tab complete");
          }
        });
      }
    }
  };
  function _sfc_render$1o(_ctx, _cache, $props, $setup, $data, $options) {
    return null;
  }
  const PagesSplashPage = /* @__PURE__ */ _export_sfc(_sfc_main$1p, [["render", _sfc_render$1o], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/SplashPage.vue"]]);
  class FavItem {
    constructor() {
      __publicField(this, "id");
      __publicField(this, "messageUid");
      // 和消息类型对应
      __publicField(this, "favType");
      __publicField(this, "timestamp");
      __publicField(this, "conversation");
      __publicField(this, "origin");
      __publicField(this, "sender");
      __publicField(this, "title");
      __publicField(this, "url");
      __publicField(this, "thumbUrl");
      __publicField(this, "data");
    }
    static fromMessage(message2) {
      let favItem = new FavItem();
      favItem.messageUid = message2.messageUid;
      favItem.conversation = message2.conversation;
      favItem.favType = message2.messageContent.type;
      favItem.sender = message2.from;
      switch (message2.conversation.type) {
        case ConversationType.Group:
          let groupInfo = wfc.getGroupInfo(message2.conversation.target, false);
          favItem.origin = groupInfo.name;
          break;
        case ConversationType.Single:
          favItem.origin = wfc.getUserDisplayName(message2.from);
          break;
        case ConversationType.Channel:
          let channelInfo = wfc.getChannelInfo(message2.conversation.target, false);
          favItem.origin = channelInfo.name;
          break;
      }
      let data;
      switch (message2.messageContent.type) {
        case MessageContentType.Text:
          let textMessageContent = message2.messageContent;
          favItem.title = textMessageContent.content;
          break;
        case MessageContentType.Image:
          let imageContent = message2.messageContent;
          favItem.url = imageContent.remotePath;
          if (imageContent.thumbnail) {
            let data2 = {
              "thumb": imageContent.thumbnail
            };
            favItem.data = JSON.stringify(data2);
          }
          break;
        case MessageContentType.Video:
          let videoContent = message2.messageContent;
          favItem.url = videoContent.remotePath;
          data = {
            duration: videoContent.duration
          };
          if (videoContent.thumbnail) {
            data["thumb"] = videoContent.thumbnail;
          }
          favItem.data = JSON.stringify(data);
          break;
        case MessageContentType.File:
          let fileContent = message2.messageContent;
          favItem.url = fileContent.remotePath;
          favItem.title = fileContent.name;
          data = {
            size: fileContent.size
          };
          favItem.data = JSON.stringify(data);
          break;
        case MessageContentType.Composite_Message:
          let compositeContent = message2.messageContent;
          favItem.title = compositeContent.title;
          let payload = compositeContent.encode();
          if (payload.remoteMediaUrl) {
            let str = wfc.b64_to_utf8(payload.binaryContent);
            let obj = JSON.parse(str);
            obj["remote_url"] = payload.remoteMediaUrl;
            str = JSON.stringify(obj);
            payload.binaryContent = wfc.utf8_to_b64(str);
          }
          favItem.data = payload.binaryContent;
          break;
        case MessageContentType.Voice:
          let voiceContent = message2.messageContent;
          favItem.url = voiceContent.remotePath;
          data = {
            duration: voiceContent.duration
          };
          favItem.data = JSON.stringify(data);
          break;
      }
      if (Config.urlRedirect) {
        favItem.url = Config.urlRedirect(favItem.url);
      }
      return favItem;
    }
    toMessage() {
      if (this.messageUid) {
        let msg2 = wfc.getMessageByUid(this.messageUid);
        if (msg2) {
          return msg2;
        }
      }
      let content;
      try {
        switch (this.favType) {
          case MessageContentType.Text:
            content = new TextMessageContent(this.title);
            break;
          case MessageContentType.Image:
            content = new ImageMessageContent(null, this.url, Config.DEFAULT_THUMBNAIL_URL.split(",")[1]);
            if (this.data) {
              content.thumbnail = this.data.thumb;
            }
            break;
          case MessageContentType.Video:
            content = new VideoMessageContent(null, this.url, Config.DEFAULT_THUMBNAIL_URL.split(",")[1]);
            if (this.data) {
              content.thumbnail = this.data.thumb;
            }
            break;
          case MessageContentType.File:
            content = new FileMessageContent(null, this.url, this.title);
            if (this.data) {
              content.size = this.data.size;
            }
            break;
          case MessageContentType.Composite_Message:
            content = new CompositeMessageContent();
            content.title = this.title;
            if (this.data) {
              let payload = new MessagePayload();
              payload.type = this.favType;
              payload.content = this.title;
              payload.binaryContent = this.data;
              let obj = JSON.parse(this.data);
              payload.remoteMediaUrl = obj["remote_url"];
              content.decode(payload);
            }
            break;
          case MessageContentType.Voice:
            content = new SoundMessageContent(null, this.url);
            if (this.data) {
              content.duration = this.data.duration;
            }
            break;
          default:
            break;
        }
      } catch (e) {
        formatAppLog("log", "at wfc/model/favItem.js:181", "toMessage Error", e);
        content = new UnknownMessageContent();
      }
      let msg = new Message(this.conversation, content);
      if (this.messageUid) {
        msg.messageUid = Long.fromValue(this.messageUid);
      }
      return msg;
    }
  }
  class AppServerError extends Error {
    constructor(errorCode, message2) {
      super(message2);
      __publicField(this, "errorCode");
      this.errorCode = errorCode;
    }
    toString() {
      return this.errorCode + "-" + this.message;
    }
  }
  class AppServerApi {
    constructor() {
    }
    requestAuthCode(mobile) {
      return this._post("/send_code", { mobile });
    }
    loinWithPassword(mobile, password) {
      return new Promise((resolve, reject) => {
        let responsePromise = this._post("/login_pwd", {
          mobile,
          password,
          platform: Config.getWFCPlatform(),
          clientId: wfc.getClientId()
        }, true);
        this._interceptLoginResponse(responsePromise, resolve, reject);
      });
    }
    loginWithAuthCode(mobile, authCode) {
      return new Promise((resolve, reject) => {
        let responsePromise = this._post("/login", {
          mobile,
          code: authCode,
          platform: Config.getWFCPlatform(),
          clientId: wfc.getClientId()
        }, true);
        this._interceptLoginResponse(responsePromise, resolve, reject);
      });
    }
    changePassword(oldPassword, newPassword) {
      return this._post("/change_pwd", {
        oldPassword,
        newPassword
      });
    }
    requestResetPasswordAuthCode() {
      return this._post("/send_reset_code");
    }
    resetPassword(resetPasswordAuthCode, newPassword) {
      return this._post("/reset_pwd", {
        resetCode: resetPasswordAuthCode,
        newPassword
      });
    }
    getGroupAnnouncement(groupId) {
      return this._post("/get_group_announcement", { groupId });
    }
    updateGroupAnnouncement(author, groupId, announcement) {
      return this._post("/put_group_announcement", {
        author,
        groupId,
        text: announcement
      });
    }
    favMessage(message2) {
      let favItem = FavItem.fromMessage(message2);
      return this._post("/fav/add", {
        messageUid: stringValue(favItem.messageUid),
        type: favItem.favType,
        convType: favItem.conversation.type,
        convTarget: favItem.conversation.target,
        convLine: favItem.conversation.line,
        origin: favItem.origin,
        sender: favItem.sender,
        title: favItem.title,
        url: favItem.url,
        thumbUrl: favItem.thumbUrl,
        data: favItem.data
      });
    }
    getFavList(startId, count = 20) {
      return this._post("/fav/list", { id: startId, count }, false, true);
    }
    delFav(favItemId) {
      return this._post("/fav/del/" + favItemId, "");
    }
    _interceptLoginResponse(responsePromise, resolve, reject) {
      responsePromise.then((response) => {
        if (response.data.code === 0) {
          let appAuthToken = response.header["authtoken"];
          if (!appAuthToken) {
            appAuthToken = response.header["authToken"];
          }
          if (appAuthToken) {
            setItem("authToken-app", appAuthToken);
          }
          resolve(response.data.result);
        } else {
          reject(new AppServerError(response.data.code, response.data.message));
        }
      }).catch((err) => {
        reject(err);
      });
    }
    /**
     *
     * @param path
     * @param data
     * @param rawResponse
     * @param rawResponseData
     * @return {Promise<string | Response<any>|*|T>}
     * @private
     */
    _post(path, data = {}, rawResponse = false, rawResponseData = false) {
      path = Config.APP_SERVER + path;
      let p = new Promise((resolve, reject) => {
        formatAppLog("log", "at api/appServerApi.js:131", "_post", path, data);
        uni.request({
          url: path,
          data,
          header: {
            "content-type": "application/json",
            // 默认值
            "authToken": getItem("authToken-app")
          },
          method: "POST",
          success: (res) => {
            formatAppLog("log", "at api/appServerApi.js:142", "_post result", res);
            if (res.statusCode === 200) {
              if (rawResponse) {
                resolve(res);
                return;
              }
              if (rawResponseData) {
                resolve(res.data);
                return;
              }
              if (res.data.code === 0) {
                resolve(res.data.result);
              } else {
                throw new AppServerError(res.data.code, res.data.message);
              }
            } else {
              throw new Error("request error, status code: " + res.status);
            }
          },
          fail: (res) => {
            formatAppLog("log", "at api/appServerApi.js:162", "fail", res);
            throw new Error("request error: " + res);
          }
        });
      });
      return p;
    }
    login(phone, code) {
      let appServer = Config.APP_SERVER + "/login";
      let clientId = wfc.getClientId();
      formatAppLog("log", "at api/appServerApi.js:173", "login", wfc.getClientId(), Config.getWFCPlatform());
      uni.request({
        url: appServer,
        data: {
          mobile: phone,
          code,
          clientId,
          platform: Config.getWFCPlatform()
        },
        header: {
          "content-type": "application/json"
          // 默认值
        },
        method: "POST",
        success: (res) => {
          if (res.statusCode === 200) {
            let loginResult = res.data;
            if (loginResult.code === 0) {
              let userId = loginResult.result.userId;
              let token = loginResult.result.token;
              wfc.connect(userId, token);
              setItem("userId", userId);
              setItem("token", token);
              let authToken = res.header["authToken"];
              if (!authToken) {
                authToken = res.header["authtoken"];
              }
              formatAppLog("log", "at api/appServerApi.js:203", "setupAppserver", Config.APP_SERVER, authToken);
              this.go2ConversationList();
            } else {
              formatAppLog("log", "at api/appServerApi.js:210", "login failed", loginResult);
            }
          }
        }
      });
    }
  }
  const appServerApi = new AppServerApi();
  const _sfc_main$1o = {
    name: "LoginPage",
    data() {
      return {
        focus: false,
        phone: "",
        code: ""
      };
    },
    components: {},
    props: {},
    onShow() {
      formatAppLog("log", "at pages/login/LoginPage.vue:47", "login onShow");
      if (Config.APP_SERVER.indexOf("wildfirechat") >= 0 && Config.IM_SERVER_HOST.indexOf("wildfirechat") === -1 || Config.APP_SERVER.indexOf("wildfirechat") === -1 && Config.IM_SERVER_HOST.indexOf("wildfirechat") >= 0) {
        formatAppLog("error", "at pages/login/LoginPage.vue:50", "!!!! 严重错误!!!! Config.APP_SERVER 和 Config.IM_SERVER_HOST要一起修改，不能一个用官方服务，一个用自己部署的服务");
      } else if (Config.IM_SERVER_HOST.indexOf(":") >= 0) {
        formatAppLog("error", "at pages/login/LoginPage.vue:52", "!!!! 严重错误!!!! Config.IM_SERVER_HOST 不能包含端口，只需要 HOST 即可");
      } else if (Config.IM_SERVER_HOST.indexOf("http") >= 0) {
        formatAppLog("error", "at pages/login/LoginPage.vue:54", "!!!! 严重错误!!!! Config.IM_SERVER_HOST 不能包含http，只需要 HOST 即可");
      }
    },
    methods: {
      bindPhoneInput: function(e) {
        this.phone = e.detail.value;
      },
      bindCodeInput: function(e) {
        this.code = e.detail.value;
      },
      bindLoginTap: function(e) {
        formatAppLog("log", "at pages/login/LoginPage.vue:65", this.phone);
        this.login(this.phone, this.code);
      },
      login(phone, code) {
        formatAppLog("log", "at pages/login/LoginPage.vue:70", "login", wfc.getClientId(), Config.getWFCPlatform());
        appServerApi.loginWithAuthCode(phone, code).then((result) => {
          formatAppLog("log", "at pages/login/LoginPage.vue:73", "login result", result);
          let userId = result.userId;
          let token = result.token;
          wfc.connect(userId, token);
          setItem("userId", userId);
          setItem("token", token);
          this.go2ConversationList();
        }).catch((r) => {
          formatAppLog("log", "at pages/login/LoginPage.vue:83", "login failed", r);
          uni.showToast({
            title: r,
            icon: "none"
          });
        });
      },
      bindAuthCodeTap: function(e) {
        formatAppLog("log", "at pages/login/LoginPage.vue:92", this.phone);
        this.authCode(this.phone);
      },
      authCode(phone) {
        appServerApi.requestAuthCode(phone).then((result) => {
          uni.showToast({
            title: "发送验证码成功",
            icon: "none"
          });
        }).catch((reason) => {
          uni.showToast({
            title: reason,
            icon: "none"
          });
        });
      },
      go2ConversationList() {
        uni.switchTab({
          url: "/pages/conversationList/ConversationListPage",
          success: () => {
            formatAppLog("log", "at pages/login/LoginPage.vue:116", "to conversation list success");
          },
          fail: (e) => {
            formatAppLog("log", "at pages/login/LoginPage.vue:119", "to conversation list error", e);
          },
          complete: () => {
            formatAppLog("log", "at pages/login/LoginPage.vue:122", "switch tab complete");
          }
        });
      }
    }
  };
  function _sfc_render$1n(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("view", { class: "page-body" }, [
      vue.createElementVNode("view", { class: "login-type-title" }, "验证码登录"),
      vue.createElementVNode("view", { class: "mobile-container" }, [
        vue.createElementVNode("view", null, "请输入手机号"),
        vue.createElementVNode("view", null, [
          vue.createElementVNode("view", { class: "mobile-input-container" }, [
            vue.createElementVNode(
              "input",
              {
                class: "input",
                onInput: _cache[0] || (_cache[0] = (...args) => $options.bindPhoneInput && $options.bindPhoneInput(...args)),
                type: "number",
                placeholder: "手机号"
              },
              null,
              32
              /* NEED_HYDRATION */
            )
          ])
        ])
      ]),
      vue.createElementVNode("view", { class: "auth-code-container" }, [
        vue.createElementVNode("view", null, "请输入验证码"),
        vue.createElementVNode("view", { class: "auth-code-input-container" }, [
          vue.createElementVNode(
            "input",
            {
              onInput: _cache[1] || (_cache[1] = (...args) => $options.bindCodeInput && $options.bindCodeInput(...args)),
              type: "number",
              placeholder: "验证码"
            },
            null,
            32
            /* NEED_HYDRATION */
          ),
          vue.createElementVNode("button", {
            size: "mini",
            disabled: $data.phone.length !== 11,
            onClick: _cache[2] || (_cache[2] = (...args) => $options.bindAuthCodeTap && $options.bindAuthCodeTap(...args))
          }, "获取验证码", 8, ["disabled"])
        ])
      ]),
      vue.createElementVNode("button", {
        disabled: !($data.phone && $data.code),
        class: "confirm-button",
        onClick: _cache[3] || (_cache[3] = (...args) => $options.bindLoginTap && $options.bindLoginTap(...args))
      }, "登录", 8, ["disabled"])
    ]);
  }
  const PagesLoginLoginPage = /* @__PURE__ */ _export_sfc(_sfc_main$1o, [["render", _sfc_render$1n], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/login/LoginPage.vue"]]);
  const _sfc_main$1n = {
    name: "uniList",
    "mp-weixin": {
      options: {
        multipleSlots: false
      }
    },
    props: {
      enableBackToTop: {
        type: [Boolean, String],
        default: false
      },
      scrollY: {
        type: [Boolean, String],
        default: false
      },
      border: {
        type: Boolean,
        default: true
      }
    },
    // provide() {
    // 	return {
    // 		list: this
    // 	};
    // },
    created() {
      this.firstChildAppend = false;
    },
    methods: {
      loadMore(e) {
        this.$emit("scrolltolower");
      }
    }
  };
  function _sfc_render$1m(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("view", { class: "uni-list uni-border-top-bottom" }, [
      $props.border ? (vue.openBlock(), vue.createElementBlock("view", {
        key: 0,
        class: "uni-list--border-top"
      })) : vue.createCommentVNode("v-if", true),
      vue.renderSlot(_ctx.$slots, "default", {}, void 0, true),
      $props.border ? (vue.openBlock(), vue.createElementBlock("view", {
        key: 1,
        class: "uni-list--border-bottom"
      })) : vue.createCommentVNode("v-if", true)
    ]);
  }
  const __easycom_0$2 = /* @__PURE__ */ _export_sfc(_sfc_main$1n, [["render", _sfc_render$1m], ["__scopeId", "data-v-7b0ccca2"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/components/uni-list/uni-list.vue"]]);
  const _sfc_main$1m = {
    props: {
      maskBg: {
        type: String,
        default: "rgba(0,0,0,0)"
      },
      placement: {
        type: String,
        default: "default"
        //default top-start top-end bottom-start bottom-end 
      },
      direction: {
        type: String,
        default: "column"
        //column row
      },
      x: {
        type: Number,
        default: 0
      },
      y: {
        type: Number,
        default: 0
      },
      modelValue: {
        type: Boolean,
        default: false
      },
      popData: {
        type: Array,
        default: () => []
      },
      theme: {
        type: String,
        default: "light"
        //light dark
      },
      dynamic: {
        type: Boolean,
        default: false
      },
      gap: {
        type: Number,
        default: 20
      },
      triangle: {
        type: Boolean,
        default: true
      }
    },
    data() {
      return {
        popupsTop: "0px",
        popupsLeft: "0px",
        show: false,
        dynPlace: ""
      };
    },
    mounted() {
      this.popupsPosition();
    },
    methods: {
      tapMask() {
        this.$emit("update:modelValue", false);
      },
      tapItem(item) {
        if (item.disabled)
          return;
        this.$emit("tapPopup", item);
        this.$emit("update:modelValue", false);
      },
      getStatusBar() {
        let promise = new Promise((resolve, reject) => {
          uni.getSystemInfo({
            success: function(e) {
              let customBar;
              resolve(customBar);
            }
          });
        });
        return promise;
      },
      async popupsPosition() {
        await this.getStatusBar();
        let promise = new Promise((resolve, reject) => {
          let popupsDom = uni.createSelectorQuery().in(this).select(".popups");
          popupsDom.fields({
            size: true
          }, (data) => {
            let width = data.width;
            let height = data.height;
            let y = this.dynamic ? this.dynamicGetY(this.y, this.gap) : this.transformRpx(this.y);
            let x = this.dynamic ? this.dynamicGetX(this.x, this.gap) : this.transformRpx(this.x);
            this.dynPlace = this.placement == "default" ? this.getPlacement(x, y) : this.placement;
            switch (this.dynPlace) {
              case "top-start":
                this.popupsTop = `${y + 9}px`;
                this.popupsLeft = `${x - 15}px`;
                break;
              case "top-end":
                this.popupsTop = `${y + 9}px`;
                this.popupsLeft = `${x + 15 - width}px`;
                break;
              case "bottom-start":
                this.popupsTop = `${y - 18 - height}px`;
                this.popupsLeft = `${x - 15}px`;
                break;
              case "bottom-end":
                this.popupsTop = `${y - 9 - height}px`;
                this.popupsLeft = `${x + 15 - width}px`;
                break;
            }
            resolve();
          }).exec();
        });
        return promise;
      },
      getPlacement(x, y) {
        let width = uni.getSystemInfoSync().windowWidth;
        let height = uni.getSystemInfoSync().windowHeight;
        if (x > width / 2 && y > height / 2) {
          return "bottom-end";
        } else if (x < width / 2 && y < height / 2) {
          return "top-start";
        } else if (x > width / 2 && y < height / 2) {
          return "top-end";
        } else if (x < width / 2 && y > height / 2) {
          return "bottom-start";
        } else if (x > width / 2) {
          return "top-end";
        } else {
          return "top-start";
        }
      },
      dynamicGetY(y, gap) {
        let height = uni.getSystemInfoSync().windowHeight;
        y = y < gap ? gap : y;
        y = height - y < gap ? height - gap : y;
        return y;
      },
      dynamicGetX(x, gap) {
        let width = uni.getSystemInfoSync().windowWidth;
        x = x < gap ? gap : x;
        x = width - x < gap ? width - gap : x;
        return x;
      },
      transformRpx(params) {
        return params * uni.getSystemInfoSync().screenWidth / 375;
      }
    },
    watch: {
      modelValue: {
        immediate: true,
        handler: async function(newVal, oldVal) {
          if (newVal)
            await this.popupsPosition();
          this.show = newVal;
        }
      },
      placement: {
        immediate: true,
        handler(newVal, oldVal) {
          this.dynPlace = newVal;
        }
      }
    }
  };
  function _sfc_render$1l(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock(
      "view",
      {
        class: vue.normalizeClass(["mask", !$data.show ? "" : "mask-show"]),
        style: vue.normalizeStyle({ backgroundColor: $data.show ? $props.maskBg : "rgba(0,0,0,0)" }),
        onClick: _cache[0] || (_cache[0] = (...args) => $options.tapMask && $options.tapMask(...args))
      },
      [
        vue.createElementVNode(
          "view",
          {
            class: vue.normalizeClass(["popups", [$props.theme]]),
            style: vue.normalizeStyle({ top: $data.popupsTop, left: $data.popupsLeft, flexDirection: $props.direction })
          },
          [
            $props.triangle ? (vue.openBlock(), vue.createElementBlock(
              "text",
              {
                key: 0,
                class: vue.normalizeClass($data.dynPlace),
                style: { width: "0px", height: "0px" }
              },
              null,
              2
              /* CLASS */
            )) : vue.createCommentVNode("v-if", true),
            (vue.openBlock(true), vue.createElementBlock(
              vue.Fragment,
              null,
              vue.renderList($props.popData, (item, index) => {
                return vue.openBlock(), vue.createElementBlock("view", {
                  key: index,
                  onClick: vue.withModifiers(($event) => $options.tapItem(item), ["stop"]),
                  class: vue.normalizeClass(["itemChild view", [$props.direction === "row" ? "solid-right" : "solid-bottom", item.disabled ? "disabledColor" : ""]])
                }, [
                  item.icon ? (vue.openBlock(), vue.createElementBlock("image", {
                    key: 0,
                    class: "image",
                    src: item.icon
                  }, null, 8, ["src"])) : vue.createCommentVNode("v-if", true),
                  vue.createTextVNode(
                    vue.toDisplayString(item.title),
                    1
                    /* TEXT */
                  )
                ], 10, ["onClick"]);
              }),
              128
              /* KEYED_FRAGMENT */
            )),
            vue.renderSlot(_ctx.$slots, "default", {}, void 0, true)
          ],
          6
          /* CLASS, STYLE */
        )
      ],
      6
      /* CLASS, STYLE */
    );
  }
  const __easycom_0$1 = /* @__PURE__ */ _export_sfc(_sfc_main$1m, [["render", _sfc_render$1l], ["__scopeId", "data-v-f7a7ba25"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/components/chunLei-popups/chunLei-popups.vue"]]);
  const helper = {
    parseXml: (text, tagName) => {
      var parser2 = new window.DOMParser();
      var xml = parser2.parseFromString(text.replace(/&lt;/g, "<").replace(/&gt;/g, ">"), "text/xml");
      var value = {};
      tagName = Array.isArray(tagName) ? tagName : [tagName];
      tagName.map((e) => {
        value[e] = xml.getElementsByTagName(e)[0].childNodes[0].nodeValue;
      });
      return { xml, value };
    },
    humanSize: (size) => {
      var value = (size / 1024).toFixed(1);
      if (size > 1024 << 10) {
        value = (value / 1024).toFixed(1);
        return `${value} M`;
      } else {
        return `${value} KB`;
      }
    },
    getFiletypeIcon: (extension) => {
      var filename = "unknow";
      extension = (extension || "").toLowerCase().replace(/^\./, "");
      switch (true) {
        case ["mp3", "flac", "aac", "m4a", "wma"].includes(extension):
          filename = "audio";
          break;
        case ["mp4", "mkv", "avi", "flv"].includes(extension):
          filename = "audio";
          break;
        case ["zip", "rar", "tar", "tar.gz"].includes(extension):
          filename = "archive";
          break;
        case ["doc", "docx"].includes(extension):
          filename = "word";
          break;
        case ["xls", "xlsx"].includes(extension):
          filename = "excel";
          break;
        case ["ai", "apk", "exe", "ipa", "pdf", "ppt", "psd"].includes(extension):
          filename = extension;
          break;
      }
      return `${filename}.png`;
    },
    getPallet: (image) => {
      return new Promise((resolve, reject) => {
        new window.AlbumColors(image).getColors((colors, err) => {
          if (err) {
            resolve([
              [0, 0, 0],
              [0, 0, 0],
              [0, 0, 0]
            ]);
          } else {
            resolve(colors);
          }
        });
      });
    },
    decodeHTML: (text = "") => {
      return text.replace(/&lt;/g, "<").replace(/&gt;/g, ">").replace(/&amp;/g, "&");
    },
    isImage: (ext) => {
      return ["bmp", "gif", "jpeg", "jpg", "png"].includes(ext);
    },
    // 3 types supported: pic, video, doc
    getMediaType: (ext = "") => {
      ext = ext.toLowerCase();
      switch (true) {
        case helper.isImage(ext):
          return "pic";
        case ["mp4"].includes(ext):
          return "video";
        default:
          return "doc";
      }
    },
    getDataURL: (src) => {
      var image = new window.Image();
      return new Promise((resolve, reject) => {
        image.src = src;
        image.onload = () => {
          var canvas = document.createElement("canvas");
          var context = canvas.getContext("2d");
          canvas.width = image.width;
          canvas.height = image.height;
          context.drawImage(image, 0, 0, image.width, image.height);
          resolve(canvas.toDataURL("image/png"));
        };
        image.onerror = () => {
          resolve("");
        };
      });
    },
    // md5: (file) => {
    //     return new Promise((resolve, reject) => {
    //         new MD5().md5(file, (err, md5) => {
    //             resolve(err ? false : md5);
    //         });
    //     });
    // },
    weekFormat: (num) => {
      let str;
      switch (num) {
        case 1:
          str = "星期一";
          break;
        case 2:
          str = "星期二";
          break;
        case 3:
          str = "星期三";
          break;
        case 4:
          str = "星期四";
          break;
        case 5:
          str = "星期五";
          break;
        case 6:
          str = "星期六";
          break;
        default:
          str = "星期天";
      }
      return str;
    },
    /**
     * 会话时间显示
     */
    dateFormat(date) {
      if (!date)
        return "";
      if (typeof date === "object") {
        date = numberValue(date);
      }
      let today = (/* @__PURE__ */ new Date()).setHours(0, 0, 0, 0);
      let that = new Date(date).setHours(0, 0, 0, 0);
      if (today === that) {
        return this.timeFormat(date);
      } else {
        let thatDate = new Date(date);
        return thatDate.getFullYear() + "/" + (thatDate.getMonth() + 1) + "/" + thatDate.getDate();
      }
    },
    /**
     * 消息会话时间显示
     */
    timeFormat: (date) => {
      if (!date)
        return "";
      if (typeof date === "object") {
        date = numberValue(date);
      }
      let newtime;
      let nowtime = /* @__PURE__ */ new Date();
      date = new Date(date);
      let Y = date.getFullYear();
      let M = date.getMonth() + 1 < 10 ? "0" + (date.getMonth() + 1) : date.getMonth() + 1;
      let D = date.getDate() < 10 ? "0" + date.getDate() : date.getDate();
      let W = date.getDay();
      let H = date.getHours() < 10 ? "0" + date.getHours() : date.getHours();
      let Min = date.getMinutes() < 10 ? "0" + date.getMinutes() : date.getMinutes();
      let nowY = nowtime.getFullYear();
      let nowM = nowtime.getMonth() + 1 < 10 ? "0" + (nowtime.getMonth() + 1) : nowtime.getMonth() + 1;
      let nowD = nowtime.getDate() < 10 ? "0" + nowtime.getDate() : nowtime.getDate();
      if (Y < nowY) {
        newtime = Y + "-" + M + "-" + D + " " + H + ":" + Min;
      } else {
        if (Y === nowY && M === nowM && nowD - D <= 7) {
          if (nowD - D === 1) {
            newtime = "昨天 " + H + ":" + Min;
          } else if (nowD === D) {
            newtime = H + ":" + Min;
          } else {
            newtime = helper.weekFormat(W) + " " + H + ":" + Min;
          }
        } else {
          newtime = M + "-" + D + " " + H + ":" + Min;
        }
      }
      return newtime;
    }
  };
  class ForwardType {
  }
  /**
   * 普通转发
   * @type {number}
   */
  __publicField(ForwardType, "NORMAL", 0);
  /**
   * 逐条转发
   * @type {number}
   */
  __publicField(ForwardType, "ONE_BY_ONE", 1);
  /**
   * 合并转发
   * @type {number}
   */
  __publicField(ForwardType, "COMPOSITE", 2);
  class SearchType {
  }
  //模糊搜索displayName，精确搜索name或电话号码
  __publicField(SearchType, "General", 0);
  //精确搜索name或电话号码
  __publicField(SearchType, "NameOrMobile", 1);
  //精确搜索name
  __publicField(SearchType, "Name", 2);
  //精确搜索电话号码
  __publicField(SearchType, "Mobile", 3);
  var isVue2 = false;
  function set(target, key, val) {
    if (Array.isArray(target)) {
      target.length = Math.max(target.length, key);
      target.splice(key, 1, val);
      return val;
    }
    target[key] = val;
    return val;
  }
  function del(target, key) {
    if (Array.isArray(target)) {
      target.splice(key, 1);
      return;
    }
    delete target[key];
  }
  function getDevtoolsGlobalHook$1() {
    return getTarget$1().__VUE_DEVTOOLS_GLOBAL_HOOK__;
  }
  function getTarget$1() {
    return typeof navigator !== "undefined" && typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {};
  }
  const isProxyAvailable$1 = typeof Proxy === "function";
  const HOOK_SETUP$1 = "devtools-plugin:setup";
  const HOOK_PLUGIN_SETTINGS_SET$1 = "plugin:settings:set";
  let supported;
  let perf;
  function isPerformanceSupported() {
    var _a;
    if (supported !== void 0) {
      return supported;
    }
    if (typeof window !== "undefined" && window.performance) {
      supported = true;
      perf = window.performance;
    } else if (typeof global !== "undefined" && ((_a = global.perf_hooks) === null || _a === void 0 ? void 0 : _a.performance)) {
      supported = true;
      perf = global.perf_hooks.performance;
    } else {
      supported = false;
    }
    return supported;
  }
  function now() {
    return isPerformanceSupported() ? perf.now() : Date.now();
  }
  let ApiProxy$1 = class ApiProxy {
    constructor(plugin, hook) {
      this.target = null;
      this.targetQueue = [];
      this.onQueue = [];
      this.plugin = plugin;
      this.hook = hook;
      const defaultSettings = {};
      if (plugin.settings) {
        for (const id in plugin.settings) {
          const item = plugin.settings[id];
          defaultSettings[id] = item.defaultValue;
        }
      }
      const localSettingsSaveId = `__vue-devtools-plugin-settings__${plugin.id}`;
      let currentSettings = Object.assign({}, defaultSettings);
      try {
        const raw = localStorage.getItem(localSettingsSaveId);
        const data = JSON.parse(raw);
        Object.assign(currentSettings, data);
      } catch (e) {
      }
      this.fallbacks = {
        getSettings() {
          return currentSettings;
        },
        setSettings(value) {
          try {
            localStorage.setItem(localSettingsSaveId, JSON.stringify(value));
          } catch (e) {
          }
          currentSettings = value;
        },
        now() {
          return now();
        }
      };
      if (hook) {
        hook.on(HOOK_PLUGIN_SETTINGS_SET$1, (pluginId, value) => {
          if (pluginId === this.plugin.id) {
            this.fallbacks.setSettings(value);
          }
        });
      }
      this.proxiedOn = new Proxy({}, {
        get: (_target, prop) => {
          if (this.target) {
            return this.target.on[prop];
          } else {
            return (...args) => {
              this.onQueue.push({
                method: prop,
                args
              });
            };
          }
        }
      });
      this.proxiedTarget = new Proxy({}, {
        get: (_target, prop) => {
          if (this.target) {
            return this.target[prop];
          } else if (prop === "on") {
            return this.proxiedOn;
          } else if (Object.keys(this.fallbacks).includes(prop)) {
            return (...args) => {
              this.targetQueue.push({
                method: prop,
                args,
                resolve: () => {
                }
              });
              return this.fallbacks[prop](...args);
            };
          } else {
            return (...args) => {
              return new Promise((resolve) => {
                this.targetQueue.push({
                  method: prop,
                  args,
                  resolve
                });
              });
            };
          }
        }
      });
    }
    async setRealTarget(target) {
      this.target = target;
      for (const item of this.onQueue) {
        this.target.on[item.method](...item.args);
      }
      for (const item of this.targetQueue) {
        item.resolve(await this.target[item.method](...item.args));
      }
    }
  };
  function setupDevtoolsPlugin$1(pluginDescriptor, setupFn) {
    const descriptor = pluginDescriptor;
    const target = getTarget$1();
    const hook = getDevtoolsGlobalHook$1();
    const enableProxy = isProxyAvailable$1 && descriptor.enableEarlyProxy;
    if (hook && (target.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__ || !enableProxy)) {
      hook.emit(HOOK_SETUP$1, pluginDescriptor, setupFn);
    } else {
      const proxy = enableProxy ? new ApiProxy$1(descriptor, hook) : null;
      const list2 = target.__VUE_DEVTOOLS_PLUGINS__ = target.__VUE_DEVTOOLS_PLUGINS__ || [];
      list2.push({
        pluginDescriptor: descriptor,
        setupFn,
        proxy
      });
      if (proxy)
        setupFn(proxy.proxiedTarget);
    }
  }
  /*!
   * pinia v2.1.7
   * (c) 2023 Eduardo San Martin Morote
   * @license MIT
   */
  let activePinia;
  const setActivePinia = (pinia2) => activePinia = pinia2;
  const piniaSymbol = Symbol("pinia");
  function isPlainObject$1(o) {
    return o && typeof o === "object" && Object.prototype.toString.call(o) === "[object Object]" && typeof o.toJSON !== "function";
  }
  var MutationType;
  (function(MutationType2) {
    MutationType2["direct"] = "direct";
    MutationType2["patchObject"] = "patch object";
    MutationType2["patchFunction"] = "patch function";
  })(MutationType || (MutationType = {}));
  const IS_CLIENT = typeof window !== "undefined";
  const USE_DEVTOOLS = IS_CLIENT;
  const _global = /* @__PURE__ */ (() => typeof window === "object" && window.window === window ? window : typeof self === "object" && self.self === self ? self : typeof global === "object" && global.global === global ? global : typeof globalThis === "object" ? globalThis : { HTMLElement: null })();
  function bom(blob, { autoBom = false } = {}) {
    if (autoBom && /^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)) {
      return new Blob([String.fromCharCode(65279), blob], { type: blob.type });
    }
    return blob;
  }
  function download(url, name, opts) {
    const xhr = new XMLHttpRequest();
    xhr.open("GET", url);
    xhr.responseType = "blob";
    xhr.onload = function() {
      saveAs(xhr.response, name, opts);
    };
    xhr.onerror = function() {
      console.error("could not download file");
    };
    xhr.send();
  }
  function corsEnabled(url) {
    const xhr = new XMLHttpRequest();
    xhr.open("HEAD", url, false);
    try {
      xhr.send();
    } catch (e) {
    }
    return xhr.status >= 200 && xhr.status <= 299;
  }
  function click(node2) {
    try {
      node2.dispatchEvent(new MouseEvent("click"));
    } catch (e) {
      const evt = document.createEvent("MouseEvents");
      evt.initMouseEvent("click", true, true, window, 0, 0, 0, 80, 20, false, false, false, false, 0, null);
      node2.dispatchEvent(evt);
    }
  }
  const _navigator = typeof navigator === "object" ? navigator : { userAgent: "" };
  const isMacOSWebView = /* @__PURE__ */ (() => /Macintosh/.test(_navigator.userAgent) && /AppleWebKit/.test(_navigator.userAgent) && !/Safari/.test(_navigator.userAgent))();
  const saveAs = !IS_CLIENT ? () => {
  } : (
    // Use download attribute first if possible (#193 Lumia mobile) unless this is a macOS WebView or mini program
    typeof HTMLAnchorElement !== "undefined" && "download" in HTMLAnchorElement.prototype && !isMacOSWebView ? downloadSaveAs : (
      // Use msSaveOrOpenBlob as a second approach
      "msSaveOrOpenBlob" in _navigator ? msSaveAs : (
        // Fallback to using FileReader and a popup
        fileSaverSaveAs
      )
    )
  );
  function downloadSaveAs(blob, name = "download", opts) {
    const a = document.createElement("a");
    a.download = name;
    a.rel = "noopener";
    if (typeof blob === "string") {
      a.href = blob;
      if (a.origin !== location.origin) {
        if (corsEnabled(a.href)) {
          download(blob, name, opts);
        } else {
          a.target = "_blank";
          click(a);
        }
      } else {
        click(a);
      }
    } else {
      a.href = URL.createObjectURL(blob);
      setTimeout(function() {
        URL.revokeObjectURL(a.href);
      }, 4e4);
      setTimeout(function() {
        click(a);
      }, 0);
    }
  }
  function msSaveAs(blob, name = "download", opts) {
    if (typeof blob === "string") {
      if (corsEnabled(blob)) {
        download(blob, name, opts);
      } else {
        const a = document.createElement("a");
        a.href = blob;
        a.target = "_blank";
        setTimeout(function() {
          click(a);
        });
      }
    } else {
      navigator.msSaveOrOpenBlob(bom(blob, opts), name);
    }
  }
  function fileSaverSaveAs(blob, name, opts, popup2) {
    popup2 = popup2 || open("", "_blank");
    if (popup2) {
      popup2.document.title = popup2.document.body.innerText = "downloading...";
    }
    if (typeof blob === "string")
      return download(blob, name, opts);
    const force = blob.type === "application/octet-stream";
    const isSafari = /constructor/i.test(String(_global.HTMLElement)) || "safari" in _global;
    const isChromeIOS = /CriOS\/[\d]+/.test(navigator.userAgent);
    if ((isChromeIOS || force && isSafari || isMacOSWebView) && typeof FileReader !== "undefined") {
      const reader = new FileReader();
      reader.onloadend = function() {
        let url = reader.result;
        if (typeof url !== "string") {
          popup2 = null;
          throw new Error("Wrong reader.result type");
        }
        url = isChromeIOS ? url : url.replace(/^data:[^;]*;/, "data:attachment/file;");
        if (popup2) {
          popup2.location.href = url;
        } else {
          location.assign(url);
        }
        popup2 = null;
      };
      reader.readAsDataURL(blob);
    } else {
      const url = URL.createObjectURL(blob);
      if (popup2)
        popup2.location.assign(url);
      else
        location.href = url;
      popup2 = null;
      setTimeout(function() {
        URL.revokeObjectURL(url);
      }, 4e4);
    }
  }
  function toastMessage(message2, type) {
    const piniaMessage = "🍍 " + message2;
    if (typeof __VUE_DEVTOOLS_TOAST__ === "function") {
      __VUE_DEVTOOLS_TOAST__(piniaMessage, type);
    } else if (type === "error") {
      console.error(piniaMessage);
    } else if (type === "warn") {
      console.warn(piniaMessage);
    } else {
      console.log(piniaMessage);
    }
  }
  function isPinia(o) {
    return "_a" in o && "install" in o;
  }
  function checkClipboardAccess() {
    if (!("clipboard" in navigator)) {
      toastMessage(`Your browser doesn't support the Clipboard API`, "error");
      return true;
    }
  }
  function checkNotFocusedError(error) {
    if (error instanceof Error && error.message.toLowerCase().includes("document is not focused")) {
      toastMessage('You need to activate the "Emulate a focused page" setting in the "Rendering" panel of devtools.', "warn");
      return true;
    }
    return false;
  }
  async function actionGlobalCopyState(pinia2) {
    if (checkClipboardAccess())
      return;
    try {
      await navigator.clipboard.writeText(JSON.stringify(pinia2.state.value));
      toastMessage("Global state copied to clipboard.");
    } catch (error) {
      if (checkNotFocusedError(error))
        return;
      toastMessage(`Failed to serialize the state. Check the console for more details.`, "error");
      console.error(error);
    }
  }
  async function actionGlobalPasteState(pinia2) {
    if (checkClipboardAccess())
      return;
    try {
      loadStoresState(pinia2, JSON.parse(await navigator.clipboard.readText()));
      toastMessage("Global state pasted from clipboard.");
    } catch (error) {
      if (checkNotFocusedError(error))
        return;
      toastMessage(`Failed to deserialize the state from clipboard. Check the console for more details.`, "error");
      console.error(error);
    }
  }
  async function actionGlobalSaveState(pinia2) {
    try {
      saveAs(new Blob([JSON.stringify(pinia2.state.value)], {
        type: "text/plain;charset=utf-8"
      }), "pinia-state.json");
    } catch (error) {
      toastMessage(`Failed to export the state as JSON. Check the console for more details.`, "error");
      console.error(error);
    }
  }
  let fileInput;
  function getFileOpener() {
    if (!fileInput) {
      fileInput = document.createElement("input");
      fileInput.type = "file";
      fileInput.accept = ".json";
    }
    function openFile() {
      return new Promise((resolve, reject) => {
        fileInput.onchange = async () => {
          const files = fileInput.files;
          if (!files)
            return resolve(null);
          const file = files.item(0);
          if (!file)
            return resolve(null);
          return resolve({ text: await file.text(), file });
        };
        fileInput.oncancel = () => resolve(null);
        fileInput.onerror = reject;
        fileInput.click();
      });
    }
    return openFile;
  }
  async function actionGlobalOpenStateFile(pinia2) {
    try {
      const open2 = getFileOpener();
      const result = await open2();
      if (!result)
        return;
      const { text, file } = result;
      loadStoresState(pinia2, JSON.parse(text));
      toastMessage(`Global state imported from "${file.name}".`);
    } catch (error) {
      toastMessage(`Failed to import the state from JSON. Check the console for more details.`, "error");
      console.error(error);
    }
  }
  function loadStoresState(pinia2, state) {
    for (const key in state) {
      const storeState = pinia2.state.value[key];
      if (storeState) {
        Object.assign(storeState, state[key]);
      } else {
        pinia2.state.value[key] = state[key];
      }
    }
  }
  function formatDisplay(display) {
    return {
      _custom: {
        display
      }
    };
  }
  const PINIA_ROOT_LABEL = "🍍 Pinia (root)";
  const PINIA_ROOT_ID = "_root";
  function formatStoreForInspectorTree(store2) {
    return isPinia(store2) ? {
      id: PINIA_ROOT_ID,
      label: PINIA_ROOT_LABEL
    } : {
      id: store2.$id,
      label: store2.$id
    };
  }
  function formatStoreForInspectorState(store2) {
    if (isPinia(store2)) {
      const storeNames = Array.from(store2._s.keys());
      const storeMap = store2._s;
      const state2 = {
        state: storeNames.map((storeId) => ({
          editable: true,
          key: storeId,
          value: store2.state.value[storeId]
        })),
        getters: storeNames.filter((id) => storeMap.get(id)._getters).map((id) => {
          const store22 = storeMap.get(id);
          return {
            editable: false,
            key: id,
            value: store22._getters.reduce((getters, key) => {
              getters[key] = store22[key];
              return getters;
            }, {})
          };
        })
      };
      return state2;
    }
    const state = {
      state: Object.keys(store2.$state).map((key) => ({
        editable: true,
        key,
        value: store2.$state[key]
      }))
    };
    if (store2._getters && store2._getters.length) {
      state.getters = store2._getters.map((getterName) => ({
        editable: false,
        key: getterName,
        value: store2[getterName]
      }));
    }
    if (store2._customProperties.size) {
      state.customProperties = Array.from(store2._customProperties).map((key) => ({
        editable: true,
        key,
        value: store2[key]
      }));
    }
    return state;
  }
  function formatEventData(events2) {
    if (!events2)
      return {};
    if (Array.isArray(events2)) {
      return events2.reduce((data, event) => {
        data.keys.push(event.key);
        data.operations.push(event.type);
        data.oldValue[event.key] = event.oldValue;
        data.newValue[event.key] = event.newValue;
        return data;
      }, {
        oldValue: {},
        keys: [],
        operations: [],
        newValue: {}
      });
    } else {
      return {
        operation: formatDisplay(events2.type),
        key: formatDisplay(events2.key),
        oldValue: events2.oldValue,
        newValue: events2.newValue
      };
    }
  }
  function formatMutationType(type) {
    switch (type) {
      case MutationType.direct:
        return "mutation";
      case MutationType.patchFunction:
        return "$patch";
      case MutationType.patchObject:
        return "$patch";
      default:
        return "unknown";
    }
  }
  let isTimelineActive = true;
  const componentStateTypes = [];
  const MUTATIONS_LAYER_ID = "pinia:mutations";
  const INSPECTOR_ID = "pinia";
  const { assign: assign$1 } = Object;
  const getStoreType = (id) => "🍍 " + id;
  function registerPiniaDevtools(app2, pinia2) {
    setupDevtoolsPlugin$1({
      id: "dev.esm.pinia",
      label: "Pinia 🍍",
      logo: "https://pinia.vuejs.org/logo.svg",
      packageName: "pinia",
      homepage: "https://pinia.vuejs.org",
      componentStateTypes,
      app: app2
    }, (api) => {
      if (typeof api.now !== "function") {
        toastMessage("You seem to be using an outdated version of Vue Devtools. Are you still using the Beta release instead of the stable one? You can find the links at https://devtools.vuejs.org/guide/installation.html.");
      }
      api.addTimelineLayer({
        id: MUTATIONS_LAYER_ID,
        label: `Pinia 🍍`,
        color: 15064968
      });
      api.addInspector({
        id: INSPECTOR_ID,
        label: "Pinia 🍍",
        icon: "storage",
        treeFilterPlaceholder: "Search stores",
        actions: [
          {
            icon: "content_copy",
            action: () => {
              actionGlobalCopyState(pinia2);
            },
            tooltip: "Serialize and copy the state"
          },
          {
            icon: "content_paste",
            action: async () => {
              await actionGlobalPasteState(pinia2);
              api.sendInspectorTree(INSPECTOR_ID);
              api.sendInspectorState(INSPECTOR_ID);
            },
            tooltip: "Replace the state with the content of your clipboard"
          },
          {
            icon: "save",
            action: () => {
              actionGlobalSaveState(pinia2);
            },
            tooltip: "Save the state as a JSON file"
          },
          {
            icon: "folder_open",
            action: async () => {
              await actionGlobalOpenStateFile(pinia2);
              api.sendInspectorTree(INSPECTOR_ID);
              api.sendInspectorState(INSPECTOR_ID);
            },
            tooltip: "Import the state from a JSON file"
          }
        ],
        nodeActions: [
          {
            icon: "restore",
            tooltip: 'Reset the state (with "$reset")',
            action: (nodeId) => {
              const store2 = pinia2._s.get(nodeId);
              if (!store2) {
                toastMessage(`Cannot reset "${nodeId}" store because it wasn't found.`, "warn");
              } else if (typeof store2.$reset !== "function") {
                toastMessage(`Cannot reset "${nodeId}" store because it doesn't have a "$reset" method implemented.`, "warn");
              } else {
                store2.$reset();
                toastMessage(`Store "${nodeId}" reset.`);
              }
            }
          }
        ]
      });
      api.on.inspectComponent((payload, ctx) => {
        const proxy = payload.componentInstance && payload.componentInstance.proxy;
        if (proxy && proxy._pStores) {
          const piniaStores = payload.componentInstance.proxy._pStores;
          Object.values(piniaStores).forEach((store2) => {
            payload.instanceData.state.push({
              type: getStoreType(store2.$id),
              key: "state",
              editable: true,
              value: store2._isOptionsAPI ? {
                _custom: {
                  value: vue.toRaw(store2.$state),
                  actions: [
                    {
                      icon: "restore",
                      tooltip: "Reset the state of this store",
                      action: () => store2.$reset()
                    }
                  ]
                }
              } : (
                // NOTE: workaround to unwrap transferred refs
                Object.keys(store2.$state).reduce((state, key) => {
                  state[key] = store2.$state[key];
                  return state;
                }, {})
              )
            });
            if (store2._getters && store2._getters.length) {
              payload.instanceData.state.push({
                type: getStoreType(store2.$id),
                key: "getters",
                editable: false,
                value: store2._getters.reduce((getters, key) => {
                  try {
                    getters[key] = store2[key];
                  } catch (error) {
                    getters[key] = error;
                  }
                  return getters;
                }, {})
              });
            }
          });
        }
      });
      api.on.getInspectorTree((payload) => {
        if (payload.app === app2 && payload.inspectorId === INSPECTOR_ID) {
          let stores = [pinia2];
          stores = stores.concat(Array.from(pinia2._s.values()));
          payload.rootNodes = (payload.filter ? stores.filter((store2) => "$id" in store2 ? store2.$id.toLowerCase().includes(payload.filter.toLowerCase()) : PINIA_ROOT_LABEL.toLowerCase().includes(payload.filter.toLowerCase())) : stores).map(formatStoreForInspectorTree);
        }
      });
      api.on.getInspectorState((payload) => {
        if (payload.app === app2 && payload.inspectorId === INSPECTOR_ID) {
          const inspectedStore = payload.nodeId === PINIA_ROOT_ID ? pinia2 : pinia2._s.get(payload.nodeId);
          if (!inspectedStore) {
            return;
          }
          if (inspectedStore) {
            payload.state = formatStoreForInspectorState(inspectedStore);
          }
        }
      });
      api.on.editInspectorState((payload, ctx) => {
        if (payload.app === app2 && payload.inspectorId === INSPECTOR_ID) {
          const inspectedStore = payload.nodeId === PINIA_ROOT_ID ? pinia2 : pinia2._s.get(payload.nodeId);
          if (!inspectedStore) {
            return toastMessage(`store "${payload.nodeId}" not found`, "error");
          }
          const { path } = payload;
          if (!isPinia(inspectedStore)) {
            if (path.length !== 1 || !inspectedStore._customProperties.has(path[0]) || path[0] in inspectedStore.$state) {
              path.unshift("$state");
            }
          } else {
            path.unshift("state");
          }
          isTimelineActive = false;
          payload.set(inspectedStore, path, payload.state.value);
          isTimelineActive = true;
        }
      });
      api.on.editComponentState((payload) => {
        if (payload.type.startsWith("🍍")) {
          const storeId = payload.type.replace(/^🍍\s*/, "");
          const store2 = pinia2._s.get(storeId);
          if (!store2) {
            return toastMessage(`store "${storeId}" not found`, "error");
          }
          const { path } = payload;
          if (path[0] !== "state") {
            return toastMessage(`Invalid path for store "${storeId}":
${path}
Only state can be modified.`);
          }
          path[0] = "$state";
          isTimelineActive = false;
          payload.set(store2, path, payload.state.value);
          isTimelineActive = true;
        }
      });
    });
  }
  function addStoreToDevtools(app2, store2) {
    if (!componentStateTypes.includes(getStoreType(store2.$id))) {
      componentStateTypes.push(getStoreType(store2.$id));
    }
    setupDevtoolsPlugin$1({
      id: "dev.esm.pinia",
      label: "Pinia 🍍",
      logo: "https://pinia.vuejs.org/logo.svg",
      packageName: "pinia",
      homepage: "https://pinia.vuejs.org",
      componentStateTypes,
      app: app2,
      settings: {
        logStoreChanges: {
          label: "Notify about new/deleted stores",
          type: "boolean",
          defaultValue: true
        }
        // useEmojis: {
        //   label: 'Use emojis in messages ⚡️',
        //   type: 'boolean',
        //   defaultValue: true,
        // },
      }
    }, (api) => {
      const now2 = typeof api.now === "function" ? api.now.bind(api) : Date.now;
      store2.$onAction(({ after, onError, name, args }) => {
        const groupId = runningActionId++;
        api.addTimelineEvent({
          layerId: MUTATIONS_LAYER_ID,
          event: {
            time: now2(),
            title: "🛫 " + name,
            subtitle: "start",
            data: {
              store: formatDisplay(store2.$id),
              action: formatDisplay(name),
              args
            },
            groupId
          }
        });
        after((result) => {
          activeAction = void 0;
          api.addTimelineEvent({
            layerId: MUTATIONS_LAYER_ID,
            event: {
              time: now2(),
              title: "🛬 " + name,
              subtitle: "end",
              data: {
                store: formatDisplay(store2.$id),
                action: formatDisplay(name),
                args,
                result
              },
              groupId
            }
          });
        });
        onError((error) => {
          activeAction = void 0;
          api.addTimelineEvent({
            layerId: MUTATIONS_LAYER_ID,
            event: {
              time: now2(),
              logType: "error",
              title: "💥 " + name,
              subtitle: "end",
              data: {
                store: formatDisplay(store2.$id),
                action: formatDisplay(name),
                args,
                error
              },
              groupId
            }
          });
        });
      }, true);
      store2._customProperties.forEach((name) => {
        vue.watch(() => vue.unref(store2[name]), (newValue, oldValue) => {
          api.notifyComponentUpdate();
          api.sendInspectorState(INSPECTOR_ID);
          if (isTimelineActive) {
            api.addTimelineEvent({
              layerId: MUTATIONS_LAYER_ID,
              event: {
                time: now2(),
                title: "Change",
                subtitle: name,
                data: {
                  newValue,
                  oldValue
                },
                groupId: activeAction
              }
            });
          }
        }, { deep: true });
      });
      store2.$subscribe(({ events: events2, type }, state) => {
        api.notifyComponentUpdate();
        api.sendInspectorState(INSPECTOR_ID);
        if (!isTimelineActive)
          return;
        const eventData = {
          time: now2(),
          title: formatMutationType(type),
          data: assign$1({ store: formatDisplay(store2.$id) }, formatEventData(events2)),
          groupId: activeAction
        };
        if (type === MutationType.patchFunction) {
          eventData.subtitle = "⤵️";
        } else if (type === MutationType.patchObject) {
          eventData.subtitle = "🧩";
        } else if (events2 && !Array.isArray(events2)) {
          eventData.subtitle = events2.type;
        }
        if (events2) {
          eventData.data["rawEvent(s)"] = {
            _custom: {
              display: "DebuggerEvent",
              type: "object",
              tooltip: "raw DebuggerEvent[]",
              value: events2
            }
          };
        }
        api.addTimelineEvent({
          layerId: MUTATIONS_LAYER_ID,
          event: eventData
        });
      }, { detached: true, flush: "sync" });
      const hotUpdate = store2._hotUpdate;
      store2._hotUpdate = vue.markRaw((newStore) => {
        hotUpdate(newStore);
        api.addTimelineEvent({
          layerId: MUTATIONS_LAYER_ID,
          event: {
            time: now2(),
            title: "🔥 " + store2.$id,
            subtitle: "HMR update",
            data: {
              store: formatDisplay(store2.$id),
              info: formatDisplay(`HMR update`)
            }
          }
        });
        api.notifyComponentUpdate();
        api.sendInspectorTree(INSPECTOR_ID);
        api.sendInspectorState(INSPECTOR_ID);
      });
      const { $dispose } = store2;
      store2.$dispose = () => {
        $dispose();
        api.notifyComponentUpdate();
        api.sendInspectorTree(INSPECTOR_ID);
        api.sendInspectorState(INSPECTOR_ID);
        api.getSettings().logStoreChanges && toastMessage(`Disposed "${store2.$id}" store 🗑`);
      };
      api.notifyComponentUpdate();
      api.sendInspectorTree(INSPECTOR_ID);
      api.sendInspectorState(INSPECTOR_ID);
      api.getSettings().logStoreChanges && toastMessage(`"${store2.$id}" store installed 🆕`);
    });
  }
  let runningActionId = 0;
  let activeAction;
  function patchActionForGrouping(store2, actionNames, wrapWithProxy) {
    const actions = actionNames.reduce((storeActions, actionName) => {
      storeActions[actionName] = vue.toRaw(store2)[actionName];
      return storeActions;
    }, {});
    for (const actionName in actions) {
      store2[actionName] = function() {
        const _actionId = runningActionId;
        const trackedStore = wrapWithProxy ? new Proxy(store2, {
          get(...args) {
            activeAction = _actionId;
            return Reflect.get(...args);
          },
          set(...args) {
            activeAction = _actionId;
            return Reflect.set(...args);
          }
        }) : store2;
        activeAction = _actionId;
        const retValue = actions[actionName].apply(trackedStore, arguments);
        activeAction = void 0;
        return retValue;
      };
    }
  }
  function devtoolsPlugin({ app: app2, store: store2, options }) {
    if (store2.$id.startsWith("__hot:")) {
      return;
    }
    store2._isOptionsAPI = !!options.state;
    patchActionForGrouping(store2, Object.keys(options.actions), store2._isOptionsAPI);
    const originalHotUpdate = store2._hotUpdate;
    vue.toRaw(store2)._hotUpdate = function(newStore) {
      originalHotUpdate.apply(this, arguments);
      patchActionForGrouping(store2, Object.keys(newStore._hmrPayload.actions), !!store2._isOptionsAPI);
    };
    addStoreToDevtools(
      app2,
      // FIXME: is there a way to allow the assignment from Store<Id, S, G, A> to StoreGeneric?
      store2
    );
  }
  function createPinia() {
    const scope = vue.effectScope(true);
    const state = scope.run(() => vue.ref({}));
    let _p = [];
    let toBeInstalled = [];
    const pinia2 = vue.markRaw({
      install(app2) {
        setActivePinia(pinia2);
        {
          pinia2._a = app2;
          app2.provide(piniaSymbol, pinia2);
          app2.config.globalProperties.$pinia = pinia2;
          if (USE_DEVTOOLS) {
            registerPiniaDevtools(app2, pinia2);
          }
          toBeInstalled.forEach((plugin) => _p.push(plugin));
          toBeInstalled = [];
        }
      },
      use(plugin) {
        if (!this._a && !isVue2) {
          toBeInstalled.push(plugin);
        } else {
          _p.push(plugin);
        }
        return this;
      },
      _p,
      // it's actually undefined here
      // @ts-expect-error
      _a: null,
      _e: scope,
      _s: /* @__PURE__ */ new Map(),
      state
    });
    if (USE_DEVTOOLS && typeof Proxy !== "undefined") {
      pinia2.use(devtoolsPlugin);
    }
    return pinia2;
  }
  function patchObject(newState, oldState) {
    for (const key in oldState) {
      const subPatch = oldState[key];
      if (!(key in newState)) {
        continue;
      }
      const targetValue = newState[key];
      if (isPlainObject$1(targetValue) && isPlainObject$1(subPatch) && !vue.isRef(subPatch) && !vue.isReactive(subPatch)) {
        newState[key] = patchObject(targetValue, subPatch);
      } else {
        {
          newState[key] = subPatch;
        }
      }
    }
    return newState;
  }
  const noop = () => {
  };
  function addSubscription(subscriptions, callback, detached, onCleanup = noop) {
    subscriptions.push(callback);
    const removeSubscription = () => {
      const idx = subscriptions.indexOf(callback);
      if (idx > -1) {
        subscriptions.splice(idx, 1);
        onCleanup();
      }
    };
    if (!detached && vue.getCurrentScope()) {
      vue.onScopeDispose(removeSubscription);
    }
    return removeSubscription;
  }
  function triggerSubscriptions(subscriptions, ...args) {
    subscriptions.slice().forEach((callback) => {
      callback(...args);
    });
  }
  const fallbackRunWithContext = (fn) => fn();
  function mergeReactiveObjects(target, patchToApply) {
    if (target instanceof Map && patchToApply instanceof Map) {
      patchToApply.forEach((value, key) => target.set(key, value));
    }
    if (target instanceof Set && patchToApply instanceof Set) {
      patchToApply.forEach(target.add, target);
    }
    for (const key in patchToApply) {
      if (!patchToApply.hasOwnProperty(key))
        continue;
      const subPatch = patchToApply[key];
      const targetValue = target[key];
      if (isPlainObject$1(targetValue) && isPlainObject$1(subPatch) && target.hasOwnProperty(key) && !vue.isRef(subPatch) && !vue.isReactive(subPatch)) {
        target[key] = mergeReactiveObjects(targetValue, subPatch);
      } else {
        target[key] = subPatch;
      }
    }
    return target;
  }
  const skipHydrateSymbol = Symbol("pinia:skipHydration");
  function shouldHydrate(obj) {
    return !isPlainObject$1(obj) || !obj.hasOwnProperty(skipHydrateSymbol);
  }
  const { assign: assign$2 } = Object;
  function isComputed(o) {
    return !!(vue.isRef(o) && o.effect);
  }
  function createOptionsStore(id, options, pinia2, hot) {
    const { state, actions, getters } = options;
    const initialState = pinia2.state.value[id];
    let store2;
    function setup() {
      if (!initialState && !hot) {
        {
          pinia2.state.value[id] = state ? state() : {};
        }
      }
      const localState = hot ? (
        // use ref() to unwrap refs inside state TODO: check if this is still necessary
        vue.toRefs(vue.ref(state ? state() : {}).value)
      ) : vue.toRefs(pinia2.state.value[id]);
      return assign$2(localState, actions, Object.keys(getters || {}).reduce((computedGetters, name) => {
        if (name in localState) {
          console.warn(`[🍍]: A getter cannot have the same name as another state property. Rename one of them. Found with "${name}" in store "${id}".`);
        }
        computedGetters[name] = vue.markRaw(vue.computed(() => {
          setActivePinia(pinia2);
          const store22 = pinia2._s.get(id);
          return getters[name].call(store22, store22);
        }));
        return computedGetters;
      }, {}));
    }
    store2 = createSetupStore(id, setup, options, pinia2, hot, true);
    return store2;
  }
  function createSetupStore($id, setup, options = {}, pinia2, hot, isOptionsStore) {
    let scope;
    const optionsForPlugin = assign$2({ actions: {} }, options);
    if (!pinia2._e.active) {
      throw new Error("Pinia destroyed");
    }
    const $subscribeOptions = {
      deep: true
      // flush: 'post',
    };
    {
      $subscribeOptions.onTrigger = (event) => {
        if (isListening) {
          debuggerEvents = event;
        } else if (isListening == false && !store2._hotUpdating) {
          if (Array.isArray(debuggerEvents)) {
            debuggerEvents.push(event);
          } else {
            console.error("🍍 debuggerEvents should be an array. This is most likely an internal Pinia bug.");
          }
        }
      };
    }
    let isListening;
    let isSyncListening;
    let subscriptions = [];
    let actionSubscriptions = [];
    let debuggerEvents;
    const initialState = pinia2.state.value[$id];
    if (!isOptionsStore && !initialState && !hot) {
      {
        pinia2.state.value[$id] = {};
      }
    }
    const hotState = vue.ref({});
    let activeListener;
    function $patch(partialStateOrMutator) {
      let subscriptionMutation;
      isListening = isSyncListening = false;
      {
        debuggerEvents = [];
      }
      if (typeof partialStateOrMutator === "function") {
        partialStateOrMutator(pinia2.state.value[$id]);
        subscriptionMutation = {
          type: MutationType.patchFunction,
          storeId: $id,
          events: debuggerEvents
        };
      } else {
        mergeReactiveObjects(pinia2.state.value[$id], partialStateOrMutator);
        subscriptionMutation = {
          type: MutationType.patchObject,
          payload: partialStateOrMutator,
          storeId: $id,
          events: debuggerEvents
        };
      }
      const myListenerId = activeListener = Symbol();
      vue.nextTick().then(() => {
        if (activeListener === myListenerId) {
          isListening = true;
        }
      });
      isSyncListening = true;
      triggerSubscriptions(subscriptions, subscriptionMutation, pinia2.state.value[$id]);
    }
    const $reset = isOptionsStore ? function $reset2() {
      const { state } = options;
      const newState = state ? state() : {};
      this.$patch(($state) => {
        assign$2($state, newState);
      });
    } : (
      /* istanbul ignore next */
      () => {
        throw new Error(`🍍: Store "${$id}" is built using the setup syntax and does not implement $reset().`);
      }
    );
    function $dispose() {
      scope.stop();
      subscriptions = [];
      actionSubscriptions = [];
      pinia2._s.delete($id);
    }
    function wrapAction(name, action) {
      return function() {
        setActivePinia(pinia2);
        const args = Array.from(arguments);
        const afterCallbackList = [];
        const onErrorCallbackList = [];
        function after(callback) {
          afterCallbackList.push(callback);
        }
        function onError(callback) {
          onErrorCallbackList.push(callback);
        }
        triggerSubscriptions(actionSubscriptions, {
          args,
          name,
          store: store2,
          after,
          onError
        });
        let ret;
        try {
          ret = action.apply(this && this.$id === $id ? this : store2, args);
        } catch (error) {
          triggerSubscriptions(onErrorCallbackList, error);
          throw error;
        }
        if (ret instanceof Promise) {
          return ret.then((value) => {
            triggerSubscriptions(afterCallbackList, value);
            return value;
          }).catch((error) => {
            triggerSubscriptions(onErrorCallbackList, error);
            return Promise.reject(error);
          });
        }
        triggerSubscriptions(afterCallbackList, ret);
        return ret;
      };
    }
    const _hmrPayload = /* @__PURE__ */ vue.markRaw({
      actions: {},
      getters: {},
      state: [],
      hotState
    });
    const partialStore = {
      _p: pinia2,
      // _s: scope,
      $id,
      $onAction: addSubscription.bind(null, actionSubscriptions),
      $patch,
      $reset,
      $subscribe(callback, options2 = {}) {
        const removeSubscription = addSubscription(subscriptions, callback, options2.detached, () => stopWatcher());
        const stopWatcher = scope.run(() => vue.watch(() => pinia2.state.value[$id], (state) => {
          if (options2.flush === "sync" ? isSyncListening : isListening) {
            callback({
              storeId: $id,
              type: MutationType.direct,
              events: debuggerEvents
            }, state);
          }
        }, assign$2({}, $subscribeOptions, options2)));
        return removeSubscription;
      },
      $dispose
    };
    const store2 = vue.reactive(assign$2(
      {
        _hmrPayload,
        _customProperties: vue.markRaw(/* @__PURE__ */ new Set())
        // devtools custom properties
      },
      partialStore
      // must be added later
      // setupStore
    ));
    pinia2._s.set($id, store2);
    const runWithContext = pinia2._a && pinia2._a.runWithContext || fallbackRunWithContext;
    const setupStore = runWithContext(() => pinia2._e.run(() => (scope = vue.effectScope()).run(setup)));
    for (const key in setupStore) {
      const prop = setupStore[key];
      if (vue.isRef(prop) && !isComputed(prop) || vue.isReactive(prop)) {
        if (hot) {
          set(hotState.value, key, vue.toRef(setupStore, key));
        } else if (!isOptionsStore) {
          if (initialState && shouldHydrate(prop)) {
            if (vue.isRef(prop)) {
              prop.value = initialState[key];
            } else {
              mergeReactiveObjects(prop, initialState[key]);
            }
          }
          {
            pinia2.state.value[$id][key] = prop;
          }
        }
        {
          _hmrPayload.state.push(key);
        }
      } else if (typeof prop === "function") {
        const actionValue = hot ? prop : wrapAction(key, prop);
        {
          setupStore[key] = actionValue;
        }
        {
          _hmrPayload.actions[key] = prop;
        }
        optionsForPlugin.actions[key] = prop;
      } else {
        if (isComputed(prop)) {
          _hmrPayload.getters[key] = isOptionsStore ? (
            // @ts-expect-error
            options.getters[key]
          ) : prop;
          if (IS_CLIENT) {
            const getters = setupStore._getters || // @ts-expect-error: same
            (setupStore._getters = vue.markRaw([]));
            getters.push(key);
          }
        }
      }
    }
    {
      assign$2(store2, setupStore);
      assign$2(vue.toRaw(store2), setupStore);
    }
    Object.defineProperty(store2, "$state", {
      get: () => hot ? hotState.value : pinia2.state.value[$id],
      set: (state) => {
        if (hot) {
          throw new Error("cannot set hotState");
        }
        $patch(($state) => {
          assign$2($state, state);
        });
      }
    });
    {
      store2._hotUpdate = vue.markRaw((newStore) => {
        store2._hotUpdating = true;
        newStore._hmrPayload.state.forEach((stateKey) => {
          if (stateKey in store2.$state) {
            const newStateTarget = newStore.$state[stateKey];
            const oldStateSource = store2.$state[stateKey];
            if (typeof newStateTarget === "object" && isPlainObject$1(newStateTarget) && isPlainObject$1(oldStateSource)) {
              patchObject(newStateTarget, oldStateSource);
            } else {
              newStore.$state[stateKey] = oldStateSource;
            }
          }
          set(store2, stateKey, vue.toRef(newStore.$state, stateKey));
        });
        Object.keys(store2.$state).forEach((stateKey) => {
          if (!(stateKey in newStore.$state)) {
            del(store2, stateKey);
          }
        });
        isListening = false;
        isSyncListening = false;
        pinia2.state.value[$id] = vue.toRef(newStore._hmrPayload, "hotState");
        isSyncListening = true;
        vue.nextTick().then(() => {
          isListening = true;
        });
        for (const actionName in newStore._hmrPayload.actions) {
          const action = newStore[actionName];
          set(store2, actionName, wrapAction(actionName, action));
        }
        for (const getterName in newStore._hmrPayload.getters) {
          const getter = newStore._hmrPayload.getters[getterName];
          const getterValue = isOptionsStore ? (
            // special handling of options api
            vue.computed(() => {
              setActivePinia(pinia2);
              return getter.call(store2, store2);
            })
          ) : getter;
          set(store2, getterName, getterValue);
        }
        Object.keys(store2._hmrPayload.getters).forEach((key) => {
          if (!(key in newStore._hmrPayload.getters)) {
            del(store2, key);
          }
        });
        Object.keys(store2._hmrPayload.actions).forEach((key) => {
          if (!(key in newStore._hmrPayload.actions)) {
            del(store2, key);
          }
        });
        store2._hmrPayload = newStore._hmrPayload;
        store2._getters = newStore._getters;
        store2._hotUpdating = false;
      });
    }
    if (USE_DEVTOOLS) {
      const nonEnumerable = {
        writable: true,
        configurable: true,
        // avoid warning on devtools trying to display this property
        enumerable: false
      };
      ["_p", "_hmrPayload", "_getters", "_customProperties"].forEach((p) => {
        Object.defineProperty(store2, p, assign$2({ value: store2[p] }, nonEnumerable));
      });
    }
    pinia2._p.forEach((extender) => {
      if (USE_DEVTOOLS) {
        const extensions = scope.run(() => extender({
          store: store2,
          app: pinia2._a,
          pinia: pinia2,
          options: optionsForPlugin
        }));
        Object.keys(extensions || {}).forEach((key) => store2._customProperties.add(key));
        assign$2(store2, extensions);
      } else {
        assign$2(store2, scope.run(() => extender({
          store: store2,
          app: pinia2._a,
          pinia: pinia2,
          options: optionsForPlugin
        })));
      }
    });
    if (store2.$state && typeof store2.$state === "object" && typeof store2.$state.constructor === "function" && !store2.$state.constructor.toString().includes("[native code]")) {
      console.warn(`[🍍]: The "state" must be a plain object. It cannot be
	state: () => new MyClass()
Found in store "${store2.$id}".`);
    }
    if (initialState && isOptionsStore && options.hydrate) {
      options.hydrate(store2.$state, initialState);
    }
    isListening = true;
    isSyncListening = true;
    return store2;
  }
  function defineStore(idOrOptions, setup, setupOptions) {
    let id;
    let options;
    const isSetupStore = typeof setup === "function";
    if (typeof idOrOptions === "string") {
      id = idOrOptions;
      options = isSetupStore ? setupOptions : setup;
    } else {
      options = idOrOptions;
      id = idOrOptions.id;
      if (typeof id !== "string") {
        throw new Error(`[🍍]: "defineStore()" must be passed a store id as its first argument.`);
      }
    }
    function useStore(pinia2, hot) {
      const hasContext = vue.hasInjectionContext();
      pinia2 = // in test mode, ignore the argument provided as we can always retrieve a
      // pinia instance with getActivePinia()
      pinia2 || (hasContext ? vue.inject(piniaSymbol, null) : null);
      if (pinia2)
        setActivePinia(pinia2);
      if (!activePinia) {
        throw new Error(`[🍍]: "getActivePinia()" was called but there was no active Pinia. Are you trying to use a store before calling "app.use(pinia)"?
See https://pinia.vuejs.org/core-concepts/outside-component-usage.html for help.
This will fail in production.`);
      }
      pinia2 = activePinia;
      if (!pinia2._s.has(id)) {
        if (isSetupStore) {
          createSetupStore(id, setup, options, pinia2);
        } else {
          createOptionsStore(id, options, pinia2);
        }
        {
          useStore._pinia = pinia2;
        }
      }
      const store2 = pinia2._s.get(id);
      if (hot) {
        const hotId = "__hot:" + id;
        const newStore = isSetupStore ? createSetupStore(hotId, setup, options, pinia2, true) : createOptionsStore(hotId, assign$2({}, options), pinia2, true);
        hot._hotUpdate(newStore);
        delete pinia2.state.value[hotId];
        pinia2._s.delete(hotId);
      }
      if (IS_CLIENT) {
        const currentInstance = vue.getCurrentInstance();
        if (currentInstance && currentInstance.proxy && // avoid adding stores that are just built for hot module replacement
        !hot) {
          const vm = currentInstance.proxy;
          const cache2 = "_pStores" in vm ? vm._pStores : vm._pStores = {};
          cache2[id] = store2;
        }
      }
      return store2;
    }
    useStore.$id = id;
    return useStore;
  }
  function storeToRefs(store2) {
    {
      store2 = vue.toRaw(store2);
      const refs = {};
      for (const key in store2) {
        const value = store2[key];
        if (vue.isRef(value) || vue.isReactive(value)) {
          refs[key] = // ---
          vue.toRef(store2, key);
        }
      }
      return refs;
    }
  }
  const pstore = defineStore("store-p", () => {
    const conversationStore = vue.ref({
      currentConversationInfo: null,
      conversationInfoList: [],
      currentConversationMessageList: [],
      currentConversationOldestMessageId: 0,
      currentConversationOldestMessageUid: 0,
      currentConversationRead: null,
      // TODO 调用setUserEnableReceipt时，需要更新
      isMessageReceiptEnable: false,
      inputtingUser: null,
      inputClearHandler: null,
      shouldAutoScrollToBottom: true,
      previewMediaItems: [],
      previewMediaIndex: null,
      enableMessageMultiSelection: false,
      showChannelMenu: false,
      quotedMessage: null,
      // 为什么不用 map？
      // map 里面的元素并不是 reactive 的
      downloadingMessages: [],
      sendingMessages: [],
      floatingConversations: [],
      currentVoiceMessage: null,
      contextMenuConversationInfo: null,
      _reset() {
        this.currentConversationInfo = null;
        this.conversationInfoList = [];
        this.currentConversationMessageList = [];
        this.currentConversationOldestMessageId = 0;
        this.currentConversationOldestMessageUid = 0;
        this.currentConversationRead = null;
        this.isMessageReceiptEnable = false;
        this.inputtingUser = null;
        this.inputClearHandler = null;
        this.shouldAutoScrollToBottom = true;
        this.previewMediaItems = [];
        this.previewMediaIndex = null;
        this.enableMessageMultiSelection = false;
        this.showChannelMenu = false;
        this.quotedMessage = null;
        this.downloadingMessages = [];
        this.sendingMessages = [];
        this.floatingConversations = [];
        this.currentVoiceMessage = null;
        this.contextMenuConversationInfo = null;
      }
    });
    const contactStore = vue.ref({
      currentFriendRequest: null,
      currentGroup: null,
      currentChannel: null,
      currentFriend: null,
      currentOrganization: null,
      currentChatroom: null,
      currentUser: null,
      expandFriendRequestList: false,
      expandFriendList: true,
      expandGroup: false,
      expandChanel: false,
      expandOrganization: false,
      expandChatroom: false,
      unreadFriendRequestCount: 0,
      friendList: [],
      friendRequestList: [],
      favGroupList: [],
      channelList: [],
      favContactList: [],
      selfUserInfo: null,
      contextMenuUserInfo: null,
      _reset() {
        this.currentFriendRequest = null;
        this.currentGroup = null;
        this.currentChannel = null;
        this.currentFriend = null;
        this.currentOrganization = null;
        this.currentChatroom = null;
        this.currentUser = null;
        this.expandFriendRequestList = false;
        this.expandFriendList = true;
        this.expandGroup = false;
        this.expandChanel = false;
        this.unreadFriendRequestCount = 0;
        this.friendList = [];
        this.friendRequestList = [];
        this.favGroupList = [];
        this.channelList = [];
        this.favContactList = [];
        this.selfUserInfo = null;
        this.contextMenuUserInfo = null;
      }
    });
    const searchStore = vue.ref({
      query: null,
      userSearchResult: [],
      channelSearchResult: [],
      contactSearchResult: [],
      groupSearchResult: [],
      conversationSearchResult: [],
      messageSearchResult: [],
      _reset() {
        this.query = null;
        this.userSearchResult = [];
        this.channelSearchResult = [];
        this.contactSearchResult = [];
        this.groupSearchResult = [];
        this.conversationSearchResult = [];
        this.messageSearchResult = [];
      }
    });
    const pickStore = vue.ref({
      users: [],
      organizations: [],
      conversations: [],
      messages: [],
      _reset() {
        this.users = [];
        this.organizations = [];
        this.conversations = [];
        this.messages = [];
      }
    });
    const miscStore = vue.ref({
      connectionStatus: ConnectionStatus.ConnectionStatusUnconnected,
      enableNotification: true,
      enableNotificationMessageDetail: true,
      enableAutoLogin: false,
      isMainWindow: false,
      isCommercialServer: false,
      isDisableSyncDraft: false,
      isVoipOngoing: false,
      config: Config,
      userOnlineStateMap: /* @__PURE__ */ new Map(),
      _reset() {
        this.connectionStatus = ConnectionStatus.ConnectionStatusUnconnected;
        this.enableNotification = true;
        this.enableAutoLogin = false;
        this.isCommercialServer = false;
        this.isDisableSyncDraft = false;
        this.isVoipOngoing = false;
        this.config = Config;
        this.userOnlineStateMap = /* @__PURE__ */ new Map();
      }
    });
    return { conversationStore, contactStore, pickStore, searchStore, miscStore };
  });
  let conversationState;
  let contactState;
  let searchState;
  let pickState;
  let miscState;
  let store = {
    debug: true,
    state: {
      conversation: null,
      contact: null,
      search: null,
      pick: null,
      misc: null
    },
    init() {
      formatAppLog("log", "at store.js:69", "init store");
      const { conversationStore, contactStore, pickStore, searchStore, miscStore } = storeToRefs(pstore());
      conversationState = conversationStore.value;
      contactState = contactStore.value;
      searchState = searchStore.value;
      pickState = pickStore.value;
      miscState = miscStore.value;
      store.state.conversation = conversationState;
      store.state.contact = contactState;
      store.state.search = searchState;
      store.state.pick = pickState;
      store.state.misc = miscState;
      wfc.eventEmitter.on(EventType.ConnectionStatusChanged, (status) => {
        miscState.connectionStatus = status;
        formatAppLog("log", "at store.js:86", "connection status changed", status);
        if (status === ConnectionStatus.ConnectionStatusConnected) {
          this._loadDefaultData();
        } else if (status === ConnectionStatus.ConnectionStatusLogout || status === ConnectionStatus.ConnectionStatusRejected || status === ConnectionStatus.ConnectionStatusSecretKeyMismatch || status === ConnectionStatus.ConnectionStatusKickedOff || status === ConnectionStatus.ConnectionStatusTokenIncorrect) {
          clear();
          if (status === ConnectionStatus.ConnectionStatusKickedOff) {
            wfc.disconnect();
          }
          _reset();
        }
      });
      wfc.eventEmitter.on(EventType.UserInfosUpdate, (userInfos) => {
        formatAppLog("log", "at store.js:105", "store UserInfosUpdate", userInfos, miscState.connectionStatus);
        this._reloadSingleConversationIfExist(userInfos);
        this._loadCurrentConversationMessages();
        this._loadFriendList();
        this._loadFriendRequest();
        this._loadSelfUserInfo();
      });
      wfc.eventEmitter.on(EventType.SettingUpdate, () => {
        formatAppLog("log", "at store.js:116", "store SettingUpdate");
        this._loadDefaultConversationList();
        this._loadFavContactList();
        this._loadFavGroupList();
        this._loadChannelList();
        this._loadCurrentConversationMessages();
      });
      wfc.eventEmitter.on(EventType.FriendRequestUpdate, (newFrs) => {
        this._loadFriendRequest();
      });
      wfc.eventEmitter.on(EventType.FriendListUpdate, (updatedFriendIds) => {
        this._loadFriendList();
        this._loadFriendRequest();
        this._loadFavContactList();
        this._loadDefaultConversationList();
        this._loadCurrentConversationMessages();
      });
      wfc.eventEmitter.on(EventType.GroupInfosUpdate, (groupInfos) => {
        formatAppLog("log", "at store.js:138", "store GroupInfosUpdate", groupInfos);
        this._reloadGroupConversationIfExist(groupInfos);
        this._loadFavGroupList();
      });
      wfc.eventEmitter.on(EventType.GroupMembersUpdate, (groupId, members) => {
        formatAppLog("log", "at store.js:147", "store GroupMembersUpdate", groupId);
        this._reloadGroupConversationIfExist([new NullGroupInfo(groupId)]);
      });
      wfc.eventEmitter.on(EventType.ChannelInfosUpdate, (groupInfos) => {
        this._loadDefaultConversationList();
        this._loadChannelList();
      });
      wfc.eventEmitter.on(EventType.ConversationInfoUpdate, (conversationInfo) => {
        this._reloadConversation(conversationInfo.conversation);
        if (conversationState.currentConversationInfo && conversationState.currentConversationInfo.conversation.equal(conversationInfo.conversation)) {
          this._loadCurrentConversationMessages();
        }
      });
      wfc.eventEmitter.on(EventType.ReceiveMessage, (msg, hasMore) => {
        if (miscState.connectionStatus === ConnectionStatus.ConnectionStatusReceiveing) {
          return;
        }
        if (msg.messageContent instanceof DismissGroupNotification || msg.messageContent instanceof KickoffGroupMemberNotification && msg.messageContent.kickedMembers.indexOf(wfc.getUserId()) >= 0 || msg.messageContent instanceof QuitGroupNotification && msg.messageContent.operator === wfc.getUserId()) {
          this.setCurrentConversationInfo(null);
          return;
        }
        if (!hasMore) {
          this._reloadConversation(msg.conversation);
        }
        if (conversationState.currentConversationInfo && msg.conversation.equal(conversationState.currentConversationInfo.conversation)) {
          if (msg.messageContent.type === MessageContentType.Typing) {
            let groupId = msg.conversation.type === 1 ? msg.conversation.target : "";
            let userInfo = wfc.getUserInfo(msg.from, false, groupId);
            userInfo = Object.assign({}, userInfo);
            userInfo._displayName = wfc.getGroupMemberDisplayNameEx(userInfo);
            conversationState.inputtingUser = userInfo;
            if (!conversationState.inputClearHandler) {
              conversationState.inputClearHandler = () => {
                conversationState.inputtingUser = null;
              };
            }
            clearTimeout(conversationState.inputClearHandler);
            setTimeout(conversationState.inputClearHandler, 3e3);
          } else {
            clearTimeout(conversationState.inputClearHandler);
            conversationState.inputtingUser = null;
          }
          if (!this._isDisplayMessage(msg) || msg.messageContent.type === MessageContentType.RecallMessage_Notification) {
            return;
          }
          let lastTimestamp = 0;
          let msgListLength = conversationState.currentConversationMessageList.length;
          if (msgListLength > 0) {
            lastTimestamp = conversationState.currentConversationMessageList[msgListLength - 1].timestamp;
          }
          this._patchMessage(msg, lastTimestamp);
          let msgIndex = conversationState.currentConversationMessageList.findIndex((m) => {
            return m.messageId === msg.messageId || gt(m.messageUid, 0) && eq(m.messageUid, msg.messageUid) || m.messageContent.type === MessageContentType.Streaming_Text_Generating && (msg.messageContent.type === MessageContentType.Streaming_Text_Generating || msg.messageContent.type === MessageContentType.Streaming_Text_Generated) && m.messageContent.streamId === msg.messageContent.streamId;
          });
          if (msgIndex > -1) {
            conversationState.currentConversationMessageList.splice(msgIndex, 1, msg);
            formatAppLog("log", "at store.js:226", "msg duplicate", msg.messageId, msg.messageUid);
            return;
          }
          conversationState.currentConversationMessageList.push(msg);
        }
        if (msg.conversation.type !== 2 && miscState.isAppHidden && (miscState.enableNotification || msg.status === MessageStatus.AllMentioned || msg.status === MessageStatus.Mentioned)) {
          this.notify(msg);
        }
      });
      wfc.eventEmitter.on(EventType.RecallMessage, (operator, messageUid) => {
        this._reloadConversationByMessageUidIfExist(messageUid);
        if (conversationState.currentConversationInfo) {
          let msg = wfc.getMessageByUid(messageUid);
          if (msg && msg.conversation.equal(conversationState.currentConversationInfo.conversation)) {
            if (conversationState.currentConversationMessageList) {
              let lastTimestamp = 0;
              conversationState.currentConversationMessageList = conversationState.currentConversationMessageList.map((msg2) => {
                if (eq(msg2.messageUid, messageUid)) {
                  let newMsg = wfc.getMessageByUid(messageUid);
                  this._patchMessage(newMsg, lastTimestamp);
                  return newMsg;
                }
                lastTimestamp = msg2.timestamp;
                return msg2;
              });
            }
          }
        }
      });
      wfc.eventEmitter.on(EventType.UserOnlineEvent, (userOnlineStatus) => {
        userOnlineStatus.forEach((e) => {
          miscState.userOnlineStateMap.set(e.userId, e);
        });
        contactState.friendList = this._patchAndSortUserInfos(contactState.friendList, "");
      });
      wfc.eventEmitter.on(EventType.MessageDeleted, (messageUid) => {
        this._reloadConversationByMessageUidIfExist(messageUid);
        if (conversationState.currentConversationInfo) {
          if (conversationState.currentConversationMessageList) {
            conversationState.currentConversationMessageList = conversationState.currentConversationMessageList.filter((msg) => !eq(msg.messageUid, messageUid));
          }
        }
      });
      wfc.eventEmitter.on(EventType.DeleteMessage, (messageId) => {
        this._reloadConversationByMessageIdIfExist(messageId);
        if (conversationState.currentConversationInfo) {
          if (conversationState.currentConversationMessageList) {
            conversationState.currentConversationMessageList = conversationState.currentConversationMessageList.filter((msg) => msg.messageId !== messageId);
          }
        }
      });
      wfc.eventEmitter.on(EventType.SendMessage, (message2) => {
        if (message2.messageContent instanceof LeaveChannelChatMessageContent) {
          return;
        }
        this._reloadConversation(message2.conversation);
        if (!this._isDisplayMessage(message2)) {
          return;
        }
        if (!conversationState.currentConversationInfo || !message2.conversation.equal(conversationState.currentConversationInfo.conversation)) {
          formatAppLog("log", "at store.js:298", "not current conv");
          return;
        }
        let index = conversationState.currentConversationMessageList.findIndex((m) => m.messageId === message2.messageId);
        if (index !== -1) {
          return;
        }
        let length = conversationState.currentConversationMessageList.length;
        let lastTimestamp = 0;
        if (length > 0) {
          let lastMessage = conversationState.currentConversationMessageList[length - 1];
          lastTimestamp = lastMessage.timestamp;
        }
        this._patchMessage(message2, lastTimestamp);
        conversationState.currentConversationMessageList.push(message2);
      });
      wfc.eventEmitter.on(EventType.MessageStatusUpdate, (message2) => {
        formatAppLog("log", "at store.js:317", "message status update", message2);
        if (!this._isDisplayMessage(message2)) {
          return;
        }
        if (!conversationState.currentConversationInfo || !message2.conversation.equal(conversationState.currentConversationInfo.conversation)) {
          formatAppLog("log", "at store.js:322", "not current conv");
          return;
        }
        let index = conversationState.currentConversationMessageList.findIndex((m) => m.messageId === message2.messageId);
        if (index < 0) {
          return;
        }
        let msg = conversationState.currentConversationMessageList[index];
        Object.assign(msg, message2);
        if (conversationState.currentConversationInfo.lastMessage && conversationState.currentConversationInfo.lastMessage.messageId === message2.messageId) {
          Object.assign(conversationState.currentConversationInfo.lastMessage, message2);
        }
      });
      wfc.eventEmitter.on(EventType.MessageRead, (readEntries) => {
        if (conversationState.currentConversationInfo) {
          conversationState.currentConversationRead = new Map(wfc.getConversationRead(conversationState.currentConversationInfo.conversation));
        }
      });
      if (wfc.getConnectionStatus() === ConnectionStatus.ConnectionStatusConnected) {
        this._loadDefaultData();
      }
      miscState.connectionStatus = wfc.getConnectionStatus();
    },
    _loadDefaultData() {
      formatAppLog("log", "at store.js:355", "store.js", "_loadDefaultData");
      this._loadFavGroupList();
      this._loadChannelList();
      this._loadFriendList();
      this._loadFavContactList();
      this._loadFriendRequest();
      this._loadSelfUserInfo();
      this._loadDefaultConversationList();
      this._loadUserLocalSettings();
      conversationState.isMessageReceiptEnable = wfc.isReceiptEnabled() && wfc.isUserReceiptEnabled();
      if (conversationState.currentConversationInfo) {
        this._loadCurrentConversationMessages();
      }
    },
    // conversation actions
    _isDisplayMessage(message2) {
      return message2.messageId !== 0 || message2.messageContent.type === MessageContentType.Streaming_Text_Generating;
    },
    _loadDefaultConversationList() {
      this._loadConversationList([0, 1, 3], [0]);
    },
    _loadConversationList(conversationType = [0, 1, 3], lines = [0]) {
      let conversationList = wfc.getConversationList(conversationType, lines);
      let toLoadUserIdSet = /* @__PURE__ */ new Set();
      let toLoadGroupIds = [];
      formatAppLog("log", "at store.js:385", "_loadConversationList size", conversationList.length);
      conversationList.forEach((info) => {
        if (info.conversation.type === ConversationType.Single) {
          toLoadUserIdSet.add(info.conversation.target);
          if (info.lastMessage) {
            toLoadUserIdSet.add(info.lastMessage.from);
          }
        } else if (info.conversation.type === ConversationType.Group) {
          toLoadGroupIds.push(info.conversation.target);
          if (info.lastMessage) {
            toLoadUserIdSet.add(info.lastMessage.from);
          }
        }
      });
      let userInfoMap = /* @__PURE__ */ new Map();
      let groupInfoMap = /* @__PURE__ */ new Map();
      toLoadUserIdSet.forEach((uid) => {
        userInfoMap.set(uid, new NullUserInfo(uid));
      });
      toLoadGroupIds.forEach((gid) => {
        groupInfoMap.set(gid, new NullGroupInfo(gid));
      });
      formatAppLog("log", "at store.js:408", "to load userIds", toLoadUserIdSet.size);
      wfc.getUserInfos([...toLoadUserIdSet], "").forEach((u) => {
        userInfoMap.set(u.uid, u);
      });
      wfc.getGroupInfos(toLoadGroupIds).forEach((g) => {
        groupInfoMap.set(g.target, g);
      });
      conversationList.forEach((info) => {
        this._patchConversationInfo(info, true, userInfoMap, groupInfoMap);
        if (conversationState.currentConversationInfo && conversationState.currentConversationInfo.conversation.equal(info.conversation)) {
          conversationState.currentConversationInfo = info;
          this._patchCurrentConversationOnlineStatus();
        }
      });
      conversationState.conversationInfoList = conversationList;
    },
    _reloadConversation(conversation2, insertIfNoExist = true) {
      let conversationInfo = wfc.getConversationInfo(conversation2);
      if (conversationInfo) {
        conversationInfo = this._patchConversationInfo(conversationInfo);
      }
      let index = conversationState.conversationInfoList.findIndex((info) => info.conversation.equal(conversation2));
      if (index >= 0) {
        Object.assign(conversationState.conversationInfoList[index], conversationInfo);
      } else {
        if (insertIfNoExist && gt(conversationInfo.timestamp, 0) && conversation2.type !== ConversationType.ChatRoom) {
          conversationState.conversationInfoList.push(conversationInfo);
        } else {
          return conversationInfo;
        }
      }
      if (conversationState.currentConversationInfo && conversationState.currentConversationInfo.conversation.equal(conversation2)) {
        conversationState.currentConversationInfo = conversationInfo;
      }
      conversationState.conversationInfoList.sort((a, b) => {
        if (a.top && b.top || !a.top && !b.top) {
          return gt(a.timestamp, b.timestamp) ? -1 : 1;
        } else {
          if (a.top) {
            return -1;
          } else {
            return 1;
          }
        }
      });
      return conversationInfo;
    },
    _reloadSingleConversationIfExist(userInfos) {
      if (userInfos.length > 10) {
        this._loadDefaultConversationList();
      } else {
        userInfos.forEach((ui) => {
          let conv = new Conversation(ConversationType.Single, ui.uid, 0);
          this._reloadConversation(conv, false);
        });
      }
    },
    _reloadGroupConversationIfExist(groupInfos) {
      if (groupInfos.length > 10) {
        this._loadDefaultConversationList();
      } else {
        groupInfos.forEach((gi) => {
          let conv = new Conversation(ConversationType.Group, gi.target, 0);
          this._reloadConversation(conv, false);
        });
      }
    },
    _reloadConversationByMessageIdIfExist(messageId) {
      if (messageId === 0) {
        return;
      }
      let toLoadConversationInfo = null;
      for (let i2 = 0; i2 < conversationState.conversationInfoList.length; i2++) {
        let info = conversationState.conversationInfoList[i2];
        if (info.lastMessage && info.lastMessage.messageId === messageId) {
          toLoadConversationInfo = info;
          break;
        }
      }
      if (toLoadConversationInfo) {
        this._reloadConversation(toLoadConversationInfo.conversation);
      }
    },
    _reloadConversationByMessageUidIfExist(messageUid) {
      let toLoadConversationInfo = null;
      for (let i2 = 0; i2 < conversationState.conversationInfoList.length; i2++) {
        let info = conversationState.conversationInfoList[i2];
        if (info.lastMessage && eq(info.lastMessage.messageUid, messageUid)) {
          toLoadConversationInfo = info;
          break;
        }
      }
      if (toLoadConversationInfo) {
        this._reloadConversation(toLoadConversationInfo.conversation);
      }
    },
    setCurrentConversation(conversation2) {
      if (!conversation2) {
        this.setCurrentConversationInfo(null);
        return;
      }
      if (conversationState.currentConversationInfo && conversation2.equal(conversationState.currentConversationInfo.conversation)) {
        return;
      }
      let convs = conversationState.conversationInfoList.filter((info2) => info2.conversation.equal(conversation2));
      let info;
      if (convs && convs.length > 0) {
        info = convs[0];
      } else {
        wfc.setConversationTimestamp(conversation2, (/* @__PURE__ */ new Date()).getTime());
        info = this._reloadConversation(conversation2);
      }
      this.setCurrentConversationInfo(info);
    },
    setCurrentConversationInfo(conversationInfo) {
      if (!conversationInfo) {
        if (conversationState.currentConversationInfo) {
          let conversation3 = conversationState.currentConversationInfo.conversation;
          if ([ConversationType.Single, ConversationType.Group].indexOf(conversation3.type) >= 0) {
            wfc.unwatchOnlineState(conversation3.type, [conversation3.target]);
          } else if (conversation3.type === ConversationType.Channel) {
            let content = new LeaveChannelChatMessageContent();
            wfc.sendConversationMessage(conversation3, content);
          } else if (conversation3.type === ConversationType.ChatRoom) {
            wfc.quitChatroom(conversation3.target);
          }
        }
        conversationState.currentConversationInfo = null;
        conversationState.shouldAutoScrollToBottom = false;
        conversationState.currentConversationMessageList.length = 0;
        conversationState.currentConversationOldestMessageId = 0;
        conversationState.currentConversationOldestMessageUid = 0;
        conversationState.currentConversationRead = null;
        conversationState.enableMessageMultiSelection = false;
        return;
      }
      if (conversationState.currentConversationInfo && conversationState.currentConversationInfo.conversation.equal(conversationInfo.conversation)) {
        return;
      }
      let conversation2 = conversationInfo.conversation;
      if (conversation2.type === ConversationType.Group || conversation2.type === ConversationType.Single && !wfc.isMyFriend(conversation2.target)) {
        wfc.watchOnlineState(conversation2.type, [conversation2.target], 1e3, (states) => {
          states.forEach((e) => {
            miscState.userOnlineStateMap.set(e.userId, e);
          });
          this._patchCurrentConversationOnlineStatus();
        }, (err) => {
          formatAppLog("log", "at store.js:576", "watchOnlineState error", err);
        });
      }
      if (conversation2.type === ConversationType.Channel) {
        let content = new EnterChannelChatMessageContent();
        wfc.sendConversationMessage(conversation2, content);
      } else if (conversation2.type === ConversationType.ChatRoom) {
        wfc.joinChatroom(conversation2.target);
      }
      conversationState.currentConversationInfo = conversationInfo;
      conversationState.shouldAutoScrollToBottom = true;
      conversationState.currentConversationMessageList.length = 0;
      conversationState.currentConversationOldestMessageId = 0;
      conversationState.currentConversationOldestMessageUid = 0;
      this._loadCurrentConversationMessages();
      conversationState.currentConversationRead = wfc.getConversationRead(conversationInfo.conversation);
      conversationState.enableMessageMultiSelection = false;
      conversationState.showChannelMenu = false;
      if (conversation2.type === ConversationType.Channel) {
        let channelInfo = wfc.getChannelInfo(conversation2.target, true);
        if (channelInfo.menus && channelInfo.menus.length > 0) {
          conversationState.showChannelMenu = true;
        }
      } else if (conversation2.type === ConversationType.Group) {
        wfc.getGroupInfo(conversation2.target, true);
      } else if (conversation2.type === ConversationType.Single) {
        wfc.getUserInfo(conversation2.target, true);
      }
      conversationState.quotedMessage = null;
      conversationState.currentVoiceMessage = null;
      clearTimeout(conversationState.inputClearHandler);
      conversationState.inputtingUser = null;
      pickState.messages.length = 0;
    },
    quitGroup(groupId) {
      wfc.quitGroup(groupId, [0], null, () => {
        this.setCurrentConversationInfo(null);
        let conversation2 = new Conversation(ConversationType.Group, groupId, 0);
        conversationState.conversationInfoList = conversationState.conversationInfoList.filter((info) => !info.conversation.equal(conversation2));
      }, (err) => {
        formatAppLog("log", "at store.js:622", "quit group error", err);
      });
    },
    dismissGroup(groupId) {
      wfc.dismissGroup(groupId, [0], null, () => {
        this.setCurrentConversationInfo(null);
        let conversation2 = new Conversation(ConversationType.Group, groupId, 0);
        conversationState.conversationInfoList = conversationState.conversationInfoList.filter((info) => !info.conversation.equal(conversation2));
      }, (err) => {
        formatAppLog("log", "at store.js:631", "dismiss group error", err);
      });
    },
    subscribeChannel(channelId, subscribe) {
      wfc.listenChannel(channelId, subscribe, () => {
      }, (err) => {
        formatAppLog("log", "at store.js:638", "unsubscribe channel error", err);
      });
    },
    toggleMessageMultiSelection(message2) {
      conversationState.enableMessageMultiSelection = !conversationState.enableMessageMultiSelection;
      pickState.messages.length = 0;
      if (conversationState.enableMessageMultiSelection && message2) {
        pickState.messages.push(message2);
      }
    },
    toggleChannelMenu(toggle) {
      conversationState.showChannelMenu = toggle;
    },
    selectOrDeselectMessage(message2) {
      let index = pickState.messages.findIndex((m) => m.messageId === message2.messageId);
      if (index >= 0) {
        pickState.messages.splice(index, 1);
      } else {
        pickState.messages.push(message2);
      }
    },
    deleteSelectedMessages() {
      conversationState.enableMessageMultiSelection = false;
      if (pickState.messages.length < 1) {
        return;
      }
      pickState.messages.sort((m1, m2) => m1.messageId - m2.messageId);
      pickState.messages.forEach((m) => {
        wfc.deleteMessage(m.messageId);
      });
      pickState.messages.length = 0;
    },
    forwardMessage(forwardType, targetConversations, messages2, extraMessageText) {
      targetConversations.forEach((conversation2) => {
        if (forwardType === ForwardType.NORMAL || forwardType === ForwardType.ONE_BY_ONE) {
          messages2.forEach((message2) => {
            if (message2.messageContent instanceof ArticlesMessageContent) {
              let linkContents = message2.messageContent.toLinkMessageContent();
              linkContents.forEach((lm) => {
                wfc.sendConversationMessage(conversation2, lm);
              });
            } else {
              message2.messageContent = this._filterForwardMessageContent(message2);
              wfc.sendConversationMessage(conversation2, message2.messageContent);
            }
          });
        } else {
          let compositeMessageContent = new CompositeMessageContent();
          let title = "";
          let msgConversation = messages2[0].conversation;
          if (msgConversation.type === ConversationType.Single) {
            let users = store.getUserInfos([wfc.getUserId(), msgConversation.target], "");
            title = users[0]._displayName + "和" + users[1]._displayName + "的聊天记录";
          } else {
            title = "群的聊天记录";
          }
          compositeMessageContent.title = title;
          let msgs = messages2.map((m) => {
            m.messageContent = this._filterForwardMessageContent(m);
            return m;
          });
          compositeMessageContent.setMessages(msgs);
          wfc.sendConversationMessage(conversation2, compositeMessageContent);
        }
        if (extraMessageText) {
          let textMessage = new TextMessageContent(extraMessageText);
          wfc.sendConversationMessage(conversation2, textMessage);
        }
      });
    },
    forwardByCreateConversation(forwardType, users, messages2, extraMessageText) {
      this.createConversation(
        users,
        (conversation2) => {
          this.forwardMessage(forwardType, [conversation2], messages2, extraMessageText);
        },
        (err) => {
          formatAppLog("error", "at store.js:727", "createConversation error", err);
        }
      );
    },
    setShouldAutoScrollToBottom(scroll) {
      conversationState.shouldAutoScrollToBottom = scroll;
    },
    /**
     *
     * @param src {String} 媒体url
     * @param thumbUrl {String} 缩略图url
     * @param thumb {String} base64格式的缩略图，但不包含'data:image/png;base64,'
     * @param autoplay
     */
    previewMedia(src, thumbUrl, thumb, autoplay = true) {
      conversationState.previewMediaItems.length = 0;
      conversationState.previewMediaItems.push({
        src,
        thumb: thumbUrl ? thumbUrl : "data:image/png;base64," + thumb,
        autoplay
      });
      conversationState.previewMediaIndex = 0;
      formatAppLog("log", "at store.js:750", "preview media", conversationState.previewMediaItems, conversationState.previewMediaIndex);
    },
    previewMedias(mediaItems, index) {
      conversationState.previewMediaItems.length = 0;
      conversationState.previewMediaItems.push(...mediaItems);
      conversationState.previewMediaIndex = index;
      formatAppLog("log", "at store.js:756", "preview medias", conversationState.previewMediaItems, conversationState.previewMediaIndex);
    },
    playVoice(message2) {
      if (conversationState.currentVoiceMessage) {
        conversationState.currentVoiceMessage._isPlaying = false;
      }
      conversationState.currentVoiceMessage = message2;
    },
    /**
     *
     * @param message
     * @param {Boolean} continuous  true，预览周围的媒体消息；false，只预览第一个参数传入的那条媒体消息
     */
    previewMessage(message2, continuous) {
      conversationState.previewMediaItems.length = 0;
      conversationState.previewMediaIndex = 0;
      if (continuous && conversationState.currentConversationMessageList.length > 0) {
        let mediaMsgs = conversationState.currentConversationMessageList.filter((m) => [MessageContentType.Image, MessageContentType.Video].indexOf(m.messageContent.type) > -1);
        let msg;
        for (let i2 = 0; i2 < mediaMsgs.length; i2++) {
          msg = mediaMsgs[i2];
          if (msg.messageId === message2.messageId) {
            conversationState.previewMediaIndex = i2;
          }
          conversationState.previewMediaItems.push({
            src: msg.messageContent.remotePath,
            thumb: "data:image/png;base64," + msg.messageContent.thumbnail,
            autoplay: true
          });
        }
      } else {
        conversationState.previewMediaIndex = 0;
        conversationState.previewMediaItems.push({
          src: message2.messageContent.remotePath,
          thumb: "data:image/png;base64," + message2.messageContent.thumbnail,
          autoplay: true
        });
      }
    },
    previewCompositeMessage(compositeMessage, focusMessageUid) {
      conversationState.previewMediaItems.length = 0;
      conversationState.previewMediaIndex = 0;
      let mediaMsgs = compositeMessage.messageContent.messages.filter((m) => [MessageContentType.Image, MessageContentType.Video].indexOf(m.messageContent.type) > -1);
      let msg;
      for (let i2 = 0; i2 < mediaMsgs.length; i2++) {
        msg = mediaMsgs[i2];
        if (eq(msg.messageUid, focusMessageUid)) {
          conversationState.previewMediaIndex = i2;
        }
        conversationState.previewMediaItems.push({
          src: msg.messageContent.remotePath,
          thumb: "data:image/png;base64," + msg.messageContent.thumbnail,
          autoplay: true
        });
      }
    },
    /**
     *
     * @param conversation
     * @param {File | string} file html File 类型或者url，绝对路径只在electron里面生效
     * @return {Promise<boolean>}
     */
    async sendFile(conversation2, file) {
      if (file.size && file.size > 100 * 1024 * 1024) {
        if (!wfc.isSupportBigFilesUpload() || conversation2.type === ConversationType.SecretChat) {
          formatAppLog("log", "at store.js:827", "file too big, and not support upload big file");
          return true;
        }
      }
      let fileOrLocalPath = null;
      let remotePath = null;
      if (typeof file === "string") {
        if (!file.startsWith("http")) {
          fileOrLocalPath = file;
        } else {
          remotePath = file;
        }
        file = {
          path: file,
          name: file.substring(file.lastIndexOf("/") + 1)
        };
      } else {
        fileOrLocalPath = file;
      }
      let msg = new Message();
      msg.conversation = conversation2;
      let mediaType = helper.getMediaType(file.name.split(".").slice(-1).pop());
      let messageContentmediaType = {
        "pic": MessageContentMediaType.Image,
        "video": MessageContentMediaType.Video,
        "doc": MessageContentMediaType.File
      }[mediaType];
      let messageContent;
      switch (messageContentmediaType) {
        case MessageContentMediaType.Image:
          messageContent = new ImageMessageContent(fileOrLocalPath, remotePath);
          break;
        case MessageContentMediaType.Video:
          messageContent = new VideoMessageContent(fileOrLocalPath, remotePath, "", 0);
          break;
        case MessageContentMediaType.File:
          messageContent = new FileMessageContent(fileOrLocalPath, remotePath);
          break;
        default:
          formatAppLog("log", "at store.js:870", "not support file");
          return false;
      }
      msg.messageContent = messageContent;
      wfc.sendMessage(
        msg,
        (messageId) => {
          msg.messageId = messageId;
          formatAppLog("log", "at store.js:877", "sf, pr", messageId);
        },
        (progress, total) => {
          let sm = conversationState.sendingMessages.find((e) => e.messageId === msg.messageId);
          if (sm) {
            sm.progress = progress;
            sm.total = total;
          } else {
            conversationState.sendingMessages.push({ messageId: msg.messageId, progress, total });
          }
        },
        (messageUid) => {
          formatAppLog("log", "at store.js:891", "sf s", messageUid);
          conversationState.sendingMessages = conversationState.sendingMessages.filter((e) => e.messageId !== msg.messageId);
        },
        (error) => {
          formatAppLog("log", "at store.js:896", "sf e", error);
          conversationState.sendingMessages = conversationState.sendingMessages.filter((e) => e.messageId !== msg.messageId);
        }
      );
    },
    quoteMessage(message2) {
      conversationState.quotedMessage = message2;
    },
    getConversationInfo(conversation2) {
      let info = wfc.getConversationInfo(conversation2);
      return this._patchConversationInfo(info, false);
    },
    /**
     * 获取会话消息
     * @param {Conversation} conversation 会话
     * @param {number} fromIndex 其实消息的 messageId
     * @param {boolean} before 获取其实消息之前，还是之后的消息
     * @param {string} withUser 过滤该用户发送或接收的消息
     * @param {function (Message[]) } callback 消息列表会回调
     */
    getMessages(conversation2, fromIndex = 0, before = true, withUser = "", callback) {
      wfc.getMessagesV2(conversation2, fromIndex, before, 20, withUser, (msgs) => {
        msgs = msgs.map((m) => this._patchMessage(m, 0));
        callback && callback(msgs);
      }, (err) => {
        formatAppLog("error", "at store.js:926", "getMessageV2 error", err);
        callback && callback([]);
      });
    },
    getMessageInTypes(conversation2, contentTypes, timestamp, before = true, withUser = "", callback) {
      wfc.getMessagesByTimestampV2(conversation2, contentTypes, timestamp, before, 20, withUser, (msgs) => {
        msgs = msgs.map((m) => this._patchMessage(m, 0));
        setTimeout(() => callback && callback(msgs), 200);
      }, (err) => {
        callback && callback([]);
      });
    },
    _loadCurrentConversationMessages() {
      formatAppLog("log", "at store.js:941", "_loadCurrentConversationMessages");
      if (!conversationState.currentConversationInfo) {
        return;
      }
      let conversation2 = conversationState.currentConversationInfo.conversation;
      wfc.getMessagesV2(conversation2, 0, true, 20, "", (msgs) => {
        conversationState.currentConversationMessageList = msgs;
        this._patchCurrentConversationMessages();
        if (msgs.length) {
          conversationState.currentConversationOldestMessageId = msgs[0].messageId;
        }
        for (let i2 = 0; i2 < msgs.length; i2++) {
          if (gt(msgs[i2].messageUid, 0)) {
            conversationState.currentConversationOldestMessageUid = msgs[0].messageUid;
            break;
          }
        }
        formatAppLog("log", "at store.js:958", "_loadCurrentConversationMessages success", conversation2, msgs);
      }, (err) => {
        formatAppLog("error", "at store.js:960", "_loadCurrentConversationMessages error", err);
      });
    },
    _patchCurrentConversationMessages() {
      let lastTimestamp = 0;
      let msgs = conversationState.currentConversationMessageList;
      msgs.forEach((m) => {
        this._patchMessage(m, lastTimestamp);
        lastTimestamp = m.timestamp;
      });
    },
    _onloadConversationMessages(conversation2, messages2) {
      if (!messages2 || messages2.length === 0) {
        return false;
      }
      let loadNewMsg = false;
      let lastTimestamp = 0;
      let newMsgs = [];
      messages2.forEach((m) => {
        let index = conversationState.currentConversationMessageList.findIndex((cm) => cm.messageId === m.messageId);
        if (index === -1) {
          this._patchMessage(m, lastTimestamp);
          lastTimestamp = m.timestamp;
          newMsgs.push(m);
          loadNewMsg = true;
        }
      });
      conversationState.currentConversationMessageList = newMsgs.concat(conversationState.currentConversationMessageList);
      return loadNewMsg;
    },
    loadConversationHistoryMessages(loadedCB, completeCB) {
      if (!conversationState.currentConversationInfo) {
        return;
      }
      let conversation2 = conversationState.currentConversationInfo.conversation;
      formatAppLog("log", "at store.js:998", "loadConversationHistoryMessage", conversation2, conversationState.currentConversationOldestMessageId, stringValue(conversationState.currentConversationOldestMessageUid));
      let loadRemoteHistoryMessageFunc = () => {
        wfc.loadRemoteConversationMessages(
          conversation2,
          [],
          conversationState.currentConversationOldestMessageUid,
          20,
          (msgs, hasMore) => {
            formatAppLog("log", "at store.js:1002", "loadRemoteConversationMessages response", msgs.length);
            if (msgs.length === 0) {
              if (hasMore) {
                loadedCB();
              } else {
                completeCB();
              }
            } else {
              if (conversation2.equal(conversationState.currentConversationInfo.conversation)) {
                conversationState.currentConversationOldestMessageUid = msgs[0].messageUid;
                msgs = msgs.filter((m) => m.messageId !== 0);
                this._onloadConversationMessages(conversation2, msgs);
              }
              this._reloadConversation(conversation2);
              loadedCB();
            }
          },
          (error) => {
            completeCB();
          }
        );
      };
      wfc.getMessagesV2(conversation2, conversationState.currentConversationOldestMessageId, true, 20, "", (lmsgs) => {
        if (lmsgs.length > 0) {
          if (!conversation2.equal(conversationState.currentConversationInfo.conversation)) {
            return;
          }
          conversationState.currentConversationOldestMessageId = lmsgs[0].messageId;
          if (gt(lmsgs[0].messageUid, 0)) {
            conversationState.currentConversationOldestMessageUid = lmsgs[0].messageUid;
          }
          let loadNewMsg = this._onloadConversationMessages(conversation2, lmsgs);
          if (!loadNewMsg) {
            loadRemoteHistoryMessageFunc();
          } else {
            setTimeout(() => loadedCB(), 200);
          }
        } else {
          loadRemoteHistoryMessageFunc();
        }
      }, (err) => {
        completeCB();
      });
    },
    setConversationTop(conversation2, top) {
      wfc.setConversationTop(
        conversation2,
        top,
        () => {
          this._reloadConversation(conversation2);
        },
        (err) => {
          formatAppLog("log", "at store.js:1056", "setConversationTop error", err);
        }
      );
    },
    setConversationSilent(conversation2, silent) {
      wfc.setConversationSlient(
        conversation2,
        silent,
        () => {
          this._reloadConversation(conversation2);
        },
        (err) => {
          formatAppLog("log", "at store.js:1066", "setConversationSilent error", err);
        }
      );
    },
    removeConversation(conversation2) {
      wfc.removeConversation(conversation2, false);
      if (conversationState.currentConversationInfo && conversationState.currentConversationInfo.conversation.equal(conversation2)) {
        this.setCurrentConversationInfo(null);
      }
      conversationState.conversationInfoList = conversationState.conversationInfoList.filter((info) => !info.conversation.equal(conversation2));
    },
    getMessageById(messageId) {
      let msg = wfc.getMessageById(messageId);
      if (msg) {
        this._patchMessage(msg, 0);
      }
      return msg;
    },
    getMessageByUid(messageUid) {
      let msg = wfc.getMessageByUid(messageUid);
      if (msg) {
        this._patchMessage(msg, 0);
      }
      return msg;
    },
    _patchMessage(m, lastTimestamp = 0, userInfoMap) {
      if (m.conversation.type === ConversationType.Single) {
        m._from = userInfoMap ? userInfoMap.get(m.from) : wfc.getUserInfo(m.from, false, "");
      }
      if (!m._from) {
        m._from = wfc.getUserInfo(m.from, false, m.conversation.type === ConversationType.Group ? m.conversation.target : "");
      }
      if (m.conversation.type === ConversationType.Group) {
        m._from._displayName = wfc.getGroupMemberDisplayNameEx(m._from);
      } else {
        m._from._displayName = wfc.getUserDisplayNameEx(m._from);
      }
      if (numberValue(lastTimestamp) > 0 && numberValue(m.timestamp) - numberValue(lastTimestamp) > 5 * 60 * 1e3) {
        m._showTime = true;
      }
      m._timeStr = helper.timeFormat(m.timestamp);
      if (m.messageContent instanceof CompositeMessageContent) {
        this._patchCompositeMessageContent(m.messageContent);
      }
      return m;
    },
    _patchCompositeMessageContent(compositeMessageContent) {
      let messages2 = compositeMessageContent.messages;
      messages2.forEach((m) => {
        this._patchMessage(m, 0);
      });
    },
    _patchConversationInfo(info, patchLastMessage = true, userInfoMap, groupInfoMap) {
      if (info.conversation.type === ConversationType.Single) {
        info.conversation._target = userInfoMap ? userInfoMap.get(info.conversation.target) : wfc.getUserInfo(info.conversation.target, false);
        if (info.conversation._target) {
          info.conversation._target._displayName = wfc.getUserDisplayNameEx(info.conversation._target);
        }
      } else if (info.conversation.type === ConversationType.Group) {
        info.conversation._target = groupInfoMap ? groupInfoMap.get(info.conversation.target) : wfc.getGroupInfo(info.conversation.target, false);
        if (info.conversation._target) {
          info.conversation._target._isFav = wfc.isFavGroup(info.conversation.target);
          info.conversation._target._displayName = info.conversation._target.remark ? info.conversation._target.remark : info.conversation._target.name;
        }
      } else if (info.conversation.type === ConversationType.Channel) {
        info.conversation._target = wfc.getChannelInfo(info.conversation.target, false);
        info.conversation._target._displayName = info.conversation._target.name;
      } else if (info.conversation.type === ConversationType.ChatRoom) {
        wfc.getChatroomInfo(info.conversation.target, 0, (chatRoomInfo) => {
          info.conversation._target = chatRoomInfo;
        }, (err) => {
          formatAppLog("log", "at store.js:1155", "get chatRoomInfo error", err);
          info.conversation._target = {};
        });
      }
      if (gt(info.timestamp, 0)) {
        info._timeStr = helper.dateFormat(info.timestamp);
      } else {
        info._timeStr = "";
      }
      if (info.lastMessage && info.lastMessage.conversation !== void 0 && patchLastMessage) {
        if (!info.lastMessage._from) {
          info.lastMessage._from = void 0;
        }
      }
      if (info.unreadCount) {
        info._unread = info.unreadCount.unread + info.unreadCount.unreadMention + info.unreadCount.unreadMentionAll;
      }
      return info;
    },
    addDownloadingMessage(messageId) {
      conversationState.downloadingMessages.push({
        messageId,
        progress: 0,
        total: Number.MAX_SAFE_INTEGER
      });
      formatAppLog("log", "at store.js:1191", "add downloading");
    },
    isDownloadingMessage(messageId) {
      return conversationState.downloadingMessages.findIndex((dm) => dm.messageId === messageId) >= 0;
    },
    isSendingMessage(messageId) {
      return conversationState.sendingMessages.has(messageId);
    },
    getDownloadingMessageStatus(messageId) {
      return conversationState.downloadingMessages.find((dm) => dm.messageId === messageId);
    },
    getSendingStatus(messageId) {
      return conversationState.sendingMessages.find((e) => e.messageId === messageId);
    },
    addFloatingConversation(conversation2) {
      conversationState.floatingConversations.push(conversation2);
    },
    removeFloatingConversation(conversation2) {
      conversationState.floatingConversations = conversationState.floatingConversations.filter((c2) => !c2.equal(conversation2));
    },
    isConversationInCurrentWindow(conversation2) {
      if (miscState.isMainWindow) {
        let index = conversationState.floatingConversations.findIndex((fc) => fc.equal(conversation2));
        return index === -1;
      } else {
        return conversationState.currentConversationInfo && conversationState.currentConversationInfo.conversation.equal(conversation2);
      }
    },
    // contact actions
    _loadSelfUserInfo() {
      contactState.selfUserInfo = wfc.getUserInfo(wfc.getUserId(), false);
    },
    _loadFriendList() {
      let friends = wfc.getMyFriendList(false);
      let fileHelperIndex = friends.indexOf(Config.FILE_HELPER_ID);
      if (fileHelperIndex < 0) {
        friends.push(Config.FILE_HELPER_ID);
      }
      if (friends && friends.length > 0) {
        let friendList = wfc.getUserInfos(friends, "");
        contactState.friendList = this._patchAndSortUserInfos(friendList, "");
      }
    },
    getUserOnlineState(userId) {
      let userOnlineState = miscState.userOnlineStateMap.get(userId);
      if (userOnlineState) {
        return userOnlineState.desc();
      }
      return "";
    },
    _patchCurrentConversationOnlineStatus() {
      let convInfo = conversationState.currentConversationInfo;
      if (convInfo && convInfo.conversation.type === ConversationType.Single) {
        conversationState.currentConversationInfo.conversation._targetOnlineStateDesc = this.getUserOnlineState(convInfo.conversation.target);
      }
    },
    _loadFriendRequest() {
      let requests = wfc.getIncommingFriendRequest();
      requests.sort((a, b) => numberValue(b.timestamp) - numberValue(a.timestamp));
      requests = requests.length >= 20 ? requests.slice(0, 20) : requests;
      let uids = [];
      requests.forEach((fr) => {
        uids.push(fr.target);
      });
      let userInfos = wfc.getUserInfos(uids, "");
      requests.forEach((fr) => {
        let userInfo = userInfos.find((u) => u.uid === fr.target);
        fr._target = userInfo;
      });
      contactState.friendRequestList = requests;
      contactState.unreadFriendRequestCount = wfc.getUnreadFriendRequestCount();
    },
    _patchAndSortUserInfos(userInfos, groupId = "", compareFn) {
      userInfos = userInfos.map((u) => {
        if (groupId) {
          u._displayName = wfc.getGroupMemberDisplayNameEx(u);
        } else {
          u._displayName = wfc.getUserDisplayNameEx(u);
        }
        u._pinyin = wfcClient_utsProxy.pinyin(u._displayName, { style: 0 }).join("").trim().toLowerCase();
        let firstLetter = u._pinyin[0];
        if (firstLetter >= "a" && firstLetter <= "z") {
          u.__sortPinyin = "a" + u._pinyin;
        } else {
          u.__sortPinyin = "z" + u._pinyin;
        }
        u._firstLetters = wfcClient_utsProxy.pinyin(u._displayName, { style: 4 }).join("").trim().toLowerCase();
        return u;
      });
      if (compareFn) {
        userInfos = userInfos.sort(compareFn);
      } else {
        userInfos = userInfos.sort((a, b) => a.__sortPinyin.localeCompare(b.__sortPinyin));
      }
      userInfos.forEach((u) => {
        let uFirstLetter = u.__sortPinyin[1];
        if (uFirstLetter >= "a" && uFirstLetter <= "z") {
          u._category = uFirstLetter;
        } else {
          u._category = "#";
        }
        u._userOnlineStatusDesc = this.getUserOnlineState(u.uid);
      });
      return userInfos;
    },
    _loadFavGroupList() {
      contactState.favGroupList = wfc.getFavGroupList();
    },
    _loadChannelList() {
      let channelIds = wfc.getListenedChannels();
      if (channelIds) {
        contactState.channelList = channelIds.map((channelId) => wfc.getChannelInfo(channelId, false));
        contactState.channelList = contactState.channelList.filter((ch) => {
          return !(ch instanceof NullChannelInfo);
        });
      }
    },
    _loadFavContactList() {
      let favUserIds = wfc.getFavUsers();
      if (favUserIds.length > 0) {
        contactState.favContactList = this.getUserInfos(favUserIds, "");
        contactState.favContactList.forEach((u) => {
          u._category = "☆ 星标朋友";
        });
      } else {
        contactState.favContactList = [];
      }
    },
    reloadFavGroupList() {
      this._loadFavGroupList();
    },
    setCurrentFriendRequest(friendRequest) {
      contactState.currentFriendRequest = friendRequest;
      contactState.currentFriend = null;
      contactState.currentOrganization = null;
      contactState.currentGroup = null;
    },
    setCurrentFriend(friend) {
      contactState.currentFriendRequest = null;
      contactState.currentFriend = friend;
      contactState.currentOrganization = null;
      contactState.currentGroup = null;
    },
    setCurrentGroup(group2) {
      contactState.currentFriendRequest = null;
      contactState.currentFriend = null;
      contactState.currentOrganization = null;
      contactState.currentGroup = group2;
    },
    setCurrentOrganization(organization) {
      contactState.currentFriendRequest = null;
      contactState.currentFriend = null;
      contactState.currentGroup = null;
      contactState.currentOrganization = organization;
    },
    toggleGroupList() {
      contactState.expandGroup = !contactState.expandGroup;
    },
    toggleFriendRequestList() {
      contactState.expandFriendRequestList = !contactState.expandFriendRequestList;
    },
    toggleFriendList() {
      contactState.expandFriendList = !contactState.expandFriendList;
    },
    setSearchQuery(query, options) {
      searchState.query = query;
      if (query) {
        formatAppLog("log", "at store.js:1388", "search", query, options);
        if (options.contact) {
          searchState.contactSearchResult = this.filterContact(query);
        }
        if (options.group) {
          searchState.groupSearchResult = this.filterGroupConversation(query);
        }
        if (options.conversation) {
          searchState.conversationSearchResult = this.searchConversation(query);
        }
        if (options.user) {
          this.searchUser(query);
        }
      } else {
        searchState.contactSearchResult = [];
        searchState.conversationSearchResult = [];
        searchState.groupSearchResult = [];
        searchState.messageSearchResult = [];
        searchState.userSearchResult = [];
      }
    },
    searchUser(query) {
      formatAppLog("log", "at store.js:1414", "search user", query);
      wfc.searchUser(query, SearchType.General, 0, (keyword, userInfos) => {
        formatAppLog("log", "at store.js:1416", "search user result", query, userInfos);
        if (searchState.query === keyword) {
          searchState.userSearchResult = userInfos.filter((u) => !wfc.isMyFriend(u.uid));
        }
      }, (err) => {
        formatAppLog("log", "at store.js:1421", "search user error", query, err);
        if (searchState.query === query) {
          searchState.userSearchResult = [];
        }
      });
    },
    // TODO 到底是什么匹配了
    filterContact(query) {
      let result = contactState.friendList.filter((u) => {
        return u._displayName.indexOf(query) > -1 || u._firstLetters.indexOf(query.toLowerCase()) > -1 || u._pinyin.indexOf(query.toLowerCase()) > -1;
      });
      formatAppLog("log", "at store.js:1434", "friend searchResult", result);
      return result;
    },
    searchFiles(keyword, beforeMessageUid, successCB, failCB) {
      if (!keyword) {
        return;
      }
      wfc.searchFiles(
        keyword,
        null,
        "",
        beforeMessageUid,
        0,
        20,
        (files) => {
          this._patchFileRecords(files);
          successCB && successCB(files);
        },
        (errorCode) => {
          formatAppLog("log", "at store.js:1448", "search file error", errorCode);
          failCB && failCB(errorCode);
        }
      );
    },
    filterUsers(users, filter) {
      if (!users || !filter || !filter.trim()) {
        return users;
      }
      let queryPinyin = wfcClient_utsProxy.pinyin(filter, { style: 0 }).join("").trim().toLowerCase();
      let result = users.filter((u) => {
        return u._displayName.indexOf(filter) > -1 || u._displayName.indexOf(queryPinyin) > -1 || u._pinyin.indexOf(filter) > -1 || u._pinyin.indexOf(queryPinyin) > -1 || u._firstLetters.indexOf(filter) > -1 || u._firstLetters.indexOf(queryPinyin) > -1;
      });
      return result;
    },
    // TODO 匹配类型，是群名称匹配上了，还是群成员的名称匹配上了？
    // 目前只搜索群名称
    filterFavGroup(query) {
      formatAppLog("log", "at store.js:1469", "to search group", contactState.favGroupList);
      let queryPinyin = wfcClient_utsProxy.pinyin(query, { style: 0 }).join("").trim().toLowerCase();
      let result = contactState.favGroupList.filter((g) => {
        let groupNamePinyin = wfcClient_utsProxy.pinyin(g.name, { style: 0 }).join("").trim().toLowerCase();
        return g.name.indexOf(query) > -1 || g.name.indexOf(queryPinyin) > -1 || groupNamePinyin.indexOf(query) > -1 || groupNamePinyin.indexOf(queryPinyin) > -1;
      });
      formatAppLog("log", "at store.js:1477", "group searchResult", result);
      return result;
    },
    // TODO
    filterConversation(query) {
      return conversationState.conversationInfoList.filter((info) => {
        let displayNamePinyin = wfcClient_utsProxy.pinyin(info.conversation._target._displayName, { style: 0 }).join("").trim().toLowerCase();
        let firstLetters = wfcClient_utsProxy.pinyin(info.conversation._target._displayName, { style: 4 }).join("").trim().toLowerCase();
        return info.conversation._target._displayName.indexOf(query) > -1 || displayNamePinyin.indexOf(query.toLowerCase()) > -1 || firstLetters.indexOf(query) > -1;
      });
    },
    filterGroupConversation(query) {
      let gsr = wfc.searchGroups(query);
      return gsr.map((r) => r.groupInfo);
    },
    searchMessage(conversation2, query) {
      let msgs = wfc.searchMessage(conversation2, query);
      msgs = msgs.reverse();
      return msgs.map((m) => this._patchMessage(m, 0));
    },
    searchMessageInTypes(conversation2, contentTypes, query, offset) {
      let msgs = wfc.searchMessageByTypes(conversation2, query, contentTypes, true, 20, offset);
      return msgs.map((m) => this._patchMessage(m, 0));
    },
    searchConversation(query, types = [0, 1, 2], lines = [0, 1, 2]) {
      let results = wfc.searchConversation(query, types, lines);
      return results.map((r) => {
        let info = wfc.getConversationInfo(r.conversation);
        r._conversationInfo = this._patchConversationInfo(info, false);
        return r;
      });
    },
    // pick actions
    pickOrUnpickUser(user) {
      let index = pickState.users.findIndex((u) => u.uid === user.uid);
      if (index >= 0) {
        pickState.users = pickState.users.filter((u) => user.uid !== u.uid);
      } else {
        pickState.users.push(user);
      }
    },
    isUserPicked(user) {
      let index = pickState.users.findIndex((u) => u.uid === user.uid);
      return index >= 0;
    },
    // pick actions
    pickOrUnpickOrganization(org) {
      let index = pickState.organizations.findIndex((o) => o.id === org.id);
      if (index >= 0) {
        pickState.organizations = pickState.organizations.filter((o) => o.id !== org.id);
      } else {
        pickState.organizations.push(org);
      }
    },
    isOrganizationPicked(org) {
      let index = pickState.organizations.findIndex((o) => o.id === org.id);
      return index >= 0;
    },
    pickOrUnpickConversation(conversation2) {
      let index = pickState.conversations.findIndex((c2) => conversation2.target === c2.target && conversation2.line === c2.line && conversation2.type === c2.type);
      if (index >= 0) {
        pickState.conversations = pickState.conversations.filter((c2) => !(conversation2.target === c2.target && conversation2.line === c2.line && conversation2.type === c2.type));
      } else {
        pickState.conversations.push(conversation2);
      }
    },
    // misc actions
    createConversation(users, successCB, failCB) {
      if (users.length === 1) {
        let conversation2 = new Conversation(ConversationType.Single, users[0].uid, 0);
        this.setCurrentConversation(conversation2);
        successCB && successCB(conversation2);
        return;
      }
      let groupName = contactState.selfUserInfo.displayName;
      let groupMemberIds = [];
      let groupMemberPortraits = [contactState.selfUserInfo.portrait];
      for (let i2 = 0; i2 < users.length; i2++) {
        groupMemberIds.push(users[i2].uid);
        if (i2 <= 3) {
          groupName += "、" + users[i2].displayName;
        }
        if (i2 < 8) {
          groupMemberPortraits.push(users[i2].portrait);
        }
      }
      groupName = groupName.substr(0, groupName.length - 1);
      wfc.createGroup(
        null,
        GroupType.Restricted,
        groupName,
        null,
        null,
        groupMemberIds,
        null,
        [0],
        null,
        (groupId) => {
          let conversation2 = new Conversation(ConversationType.Group, groupId, 0);
          this.setCurrentConversation(conversation2);
          successCB && successCB(conversation2);
        },
        (error) => {
          formatAppLog("log", "at store.js:1591", "create group error", error);
          failCB && failCB(error);
        }
      );
    },
    _loadUserLocalSettings() {
      let userId = wfc.getUserId();
      let setting2 = getItem(userId + "-notification");
      miscState.enableNotification = setting2 === null || setting2 === "" || setting2 === "1";
      setting2 = getItem(userId + "-notificationDetail");
      miscState.enableNotificationMessageDetail = setting2 === null || setting2 === "1";
    },
    setEnableNotification(enable) {
      miscState.enableNotification = enable;
      setItem(contactState.selfUserInfo.uid + "-notification", enable ? "1" : "0");
    },
    setEnableNotificationDetail(enable) {
      miscState.enableNotificationMessageDetail = enable;
      setItem(contactState.selfUserInfo.uid + "-notificationDetail", enable ? "1" : "0");
    },
    // clone一下，别影响到好友列表
    getUserInfos(userIds, groupId) {
      let userInfos = wfc.getUserInfos(userIds, groupId);
      let userInfosCloneCopy = userInfos.map((u) => Object.assign({}, u));
      return this._patchAndSortUserInfos(userInfosCloneCopy, groupId);
    },
    // clone一下，别影响到好友列表
    getGroupMemberUserInfos(groupId, includeSelf = true, sortByPinyin = false) {
      let memberIds = wfc.getGroupMemberIds(groupId);
      let userInfos = wfc.getUserInfos(memberIds, groupId);
      if (!includeSelf) {
        userInfos = userInfos.filter((u) => u.uid !== wfc.getUserId());
      }
      let userInfosCloneCopy = userInfos.map((u) => Object.assign({}, u));
      if (sortByPinyin) {
        return this._patchAndSortUserInfos(userInfosCloneCopy, groupId);
      } else {
        let compareFn = (u1, u2) => {
          let index1 = memberIds.findIndex((id) => id === u1.uid);
          let index2 = memberIds.findIndex((id) => id === u2.uid);
          return index1 - index2;
        };
        return this._patchAndSortUserInfos(userInfosCloneCopy, groupId, compareFn);
      }
    },
    // clone一下，别影响到好友列表
    getConversationMemberUsrInfos(conversation2) {
      let userInfos = [];
      if (conversation2.type === 0) {
        if (conversation2.target !== contactState.selfUserInfo.uid) {
          userInfos.push(wfc.getUserInfo(wfc.getUserId(), false));
        }
        userInfos.push(wfc.getUserInfo(conversation2.target, false));
        let userInfosCloneCopy = userInfos.map((u) => Object.assign({}, u));
        userInfos = this._patchAndSortUserInfos(userInfosCloneCopy, "");
      } else if (conversation2.type === 1) {
        userInfos = this.getGroupMemberUserInfos(conversation2.target, true);
      }
      return userInfos;
    },
    getMyFileRecords(beforeUid, count, successCB, failCB) {
      if (!successCB) {
        return;
      }
      wfc.getMyFileRecords(beforeUid, 0, count, (fileRecords) => {
        this._patchFileRecords(fileRecords);
        successCB(fileRecords);
      }, failCB);
    },
    getConversationFileRecords(conversation2, fromUser, beforeMessageUid, count, successCB, failCB) {
      wfc.getConversationFileRecords(conversation2, fromUser, beforeMessageUid, 0, count, (fileRecords) => {
        this._patchFileRecords(fileRecords);
        successCB(fileRecords);
      }, failCB);
    },
    deleteFriend(target) {
      wfc.deleteFriend(target, () => {
        let conv = new Conversation(ConversationType.Single, target, 0);
        wfc.removeConversation(conv, true);
        conversationState.conversationInfoList = conversationState.conversationInfoList.filter((info) => !info.conversation.equal(conv));
      }, (err) => {
        formatAppLog("log", "at store.js:1682", "deleteFriend error", err);
      });
    },
    _patchFileRecords(fileRecords) {
      fileRecords.forEach((fileRecord) => {
        let groupId = fileRecord.conversation.type === 1 ? fileRecord.conversation.target : "";
        if (groupId) {
          fileRecord._userDisplayName = wfc.getGroupMemberDisplayName(groupId, fileRecord.userId);
        } else {
          fileRecord._userDisplayName = wfc.getUserDisplayName(fileRecord.userId);
        }
        let conversationInfo = wfc.getConversationInfo(fileRecord.conversation);
        this._patchConversationInfo(conversationInfo, false);
        if (fileRecord.conversation.type === 0) {
          fileRecord._conversationDisplayName = "与" + conversationInfo.conversation._target._displayName + "的聊天";
        } else {
          fileRecord._conversationDisplayName = conversationInfo.conversation._target._displayName;
        }
        if (fileRecord.name.indexOf(FileMessageContent.FILE_NAME_PREFIX) === 0) {
          fileRecord.name = fileRecord.name.substring(fileRecord.name.indexOf(FileMessageContent.FILE_NAME_PREFIX) + FileMessageContent.FILE_NAME_PREFIX.length);
        }
        fileRecord._timeStr = helper.dateFormat(fileRecord.timestamp);
        fileRecord._sizeStr = helper.humanSize(fileRecord.size);
        fileRecord._fileIconName = helper.getFiletypeIcon(fileRecord.name.substring(fileRecord.name.lastIndexOf(".")));
      });
    },
    clearConversationUnreadStatus(conversation2) {
      let info = wfc.getConversationInfo(conversation2);
      if (info && info.unreadCount.unread + info.unreadCount.unreadMention + info.unreadCount.unreadMentionAll > 0) {
        wfc.clearConversationUnreadStatus(conversation2);
      }
    },
    clearAllUnreadStatus() {
      wfc.clearAllUnreadStatus();
      conversationState.conversationInfoList.forEach((info) => {
        info.unreadCount = new UnreadCount();
      });
    },
    notify(msg) {
      let content = msg.messageContent;
      let tip;
      if (msg.direction === 0) {
        return;
      }
      if (MessageConfig.getMessageContentPersitFlag(content.type) === PersistFlag.Persist_And_Count) {
        if (msg.status !== MessageStatus.AllMentioned && msg.status !== MessageStatus.Mentioned) {
          let silent = false;
          for (const info of conversationState.conversationInfoList) {
            if (info.conversation.equal(msg.conversation)) {
              silent = info.isSilent;
              break;
            }
          }
          if (silent) {
            return;
          }
          tip = "新消息来了";
        } else {
          tip = "有人@你";
        }
        wfc.notify(tip, miscState.enableNotificationMessageDetail ? content.digest(msg) : "");
      }
    },
    _filterForwardMessageContent(message2) {
      let content = message2.messageContent;
      if (content instanceof CallStartMessageContent) {
        content = new TextMessageContent(content.digest(message2));
      } else if (content instanceof SoundMessageContent) {
        content = new TextMessageContent(content.digest(message2) + " " + content.duration + "''");
      }
      return content;
    }
  };
  function _reset() {
    conversationState._reset();
    contactState._reset();
    searchState._reset();
    pickState._reset();
    miscState._reset();
    uni.reLaunch(
      {
        url: "/pages/login/LoginPage"
      }
    );
  }
  const _WfcScheme = class _WfcScheme {
    static buildConferenceLink(conferenceId, password) {
      let link = _WfcScheme.QR_CODE_PREFIX_CONFERENCE + conferenceId;
      if (password) {
        link += "/?pwd=" + password;
      }
      return link;
    }
  };
  __publicField(_WfcScheme, "QR_CODE_PREFIX_PC_SESSION", "wildfirechat://pcsession/");
  __publicField(_WfcScheme, "QR_CODE_PREFIX_USER", "wildfirechat://user/");
  __publicField(_WfcScheme, "QR_CODE_PREFIX_GROUP", "wildfirechat://group/");
  __publicField(_WfcScheme, "QR_CODE_PREFIX_CHANNEL", "wildfirechat://channel/");
  __publicField(_WfcScheme, "QR_CODE_PREFIX_CONFERENCE", "wildfirechat://conference/");
  let WfcScheme = _WfcScheme;
  const _sfc_main$1l = {
    data() {
      return {
        height: 0,
        //距离顶部高度oo
        isActive: false,
        animationData: {}
      };
    },
    props: {
      list: {
        type: Array,
        default() {
          return [{}];
        }
      }
    },
    onShow() {
    },
    mounted() {
      this.getstatusBarHeight();
      let animation = uni.createAnimation({
        duration: 300,
        timingFunction: "linear"
      });
      this.animation = animation;
    },
    methods: {
      go2CreateGroup() {
        let sharedContactState = store.state.contact;
        let users = sharedContactState.favContactList.concat(sharedContactState.friendList);
        users = users.filter((u) => {
          return u.uid !== Config.FILE_HELPER_ID;
        });
        this.$pickUsers({
          users,
          successCB: (users2) => {
            store.createConversation(users2, (conversation2) => {
              setTimeout(() => {
                this.$go2ConversationPage();
              }, 50);
            }, (err) => {
            });
          }
        });
      },
      go2SearchFriend() {
        uni.navigateTo({
          url: "/pages/contact/SearchUserPage",
          fail: (err) => {
          }
        });
      },
      go2ScanQrCode() {
        uni.scanCode({
          success: (res) => {
            formatAppLog("log", "at components/main-action-menu/main-action-menu.vue:95", "条码类型：" + res.scanType);
            formatAppLog("log", "at components/main-action-menu/main-action-menu.vue:96", "条码内容：" + res.result);
            if (res.result) {
              this.onScanQrCode(res.result);
            }
          }
        });
      },
      showAnimation() {
        this.animation.opacity(1).step();
        this.animationData = this.animation.export();
      },
      hideAnimation() {
        this.animation.opacity(0).step();
        this.animationData = this.animation.export();
      },
      moveHandle(e) {
        this.hide();
      },
      toggle() {
        if (this.isActive) {
          this.hide();
        } else {
          this.show();
        }
      },
      show() {
        this.isActive = true;
        setTimeout(() => {
          this.showAnimation();
        }, 30);
      },
      hide() {
        if (this.isActive) {
          this.isActive = false;
          this.hideAnimation();
        }
      },
      getstatusBarHeight() {
        uni.getSystemInfoSync();
      },
      onScanQrCode(qrcode) {
        let prefix = qrcode.substring(0, qrcode.lastIndexOf("/") + 1);
        let value = qrcode.substring(qrcode.lastIndexOf("/") + 1);
        switch (prefix) {
          case WfcScheme.QR_CODE_PREFIX_USER:
            wfc.getUserInfoEx(value, false, (userInfo) => {
              store.setCurrentFriend(userInfo);
              uni.navigateTo({
                url: "/pages/contact/UserDetailPage",
                success: () => {
                  formatAppLog("log", "at components/main-action-menu/main-action-menu.vue:155", "nav to UserDetailPage success");
                },
                fail: (err) => {
                  formatAppLog("log", "at components/main-action-menu/main-action-menu.vue:158", "nav to UserDetailPage err", err);
                }
              });
            }, (err) => {
            });
            break;
          default:
            uni.showToast({
              title: "不支持该二维码: " + qrcode,
              icon: "none"
            });
            break;
        }
      }
    }
  };
  function _sfc_render$1k(_ctx, _cache, $props, $setup, $data, $options) {
    return $data.isActive ? (vue.openBlock(), vue.createElementBlock(
      "view",
      {
        key: 0,
        onTouchmove: _cache[3] || (_cache[3] = vue.withModifiers(($event) => $options.moveHandle("touchmove"), ["stop", "prevent"])),
        onClick: _cache[4] || (_cache[4] = ($event) => $options.moveHandle("click"))
      },
      [
        vue.createElementVNode("view", {
          class: "main-action-menu",
          animation: $data.animationData,
          style: vue.normalizeStyle({ top: $data.height + "px" })
        }, [
          vue.createElementVNode("view", { class: "main-action-menu-top-arrow" }),
          vue.createElementVNode("view", { class: "menu-list" }, [
            vue.createElementVNode("view", {
              class: "menu-item",
              onClick: _cache[0] || (_cache[0] = (...args) => $options.go2CreateGroup && $options.go2CreateGroup(...args))
            }, [
              vue.createElementVNode("view", { class: "menu-item-icon" }, [
                vue.createElementVNode("view", { class: "wxfont message2" })
              ]),
              vue.createElementVNode("view", { class: "text" }, "发起群聊")
            ]),
            vue.createElementVNode("view", {
              class: "menu-item",
              onClick: _cache[1] || (_cache[1] = (...args) => $options.go2SearchFriend && $options.go2SearchFriend(...args))
            }, [
              vue.createElementVNode("view", { class: "menu-item-icon" }, [
                vue.createElementVNode("view", { class: "wxfont add2" })
              ]),
              vue.createElementVNode("view", { class: "text" }, "添加朋友")
            ]),
            vue.createElementVNode("view", {
              class: "menu-item",
              onClick: _cache[2] || (_cache[2] = (...args) => $options.go2ScanQrCode && $options.go2ScanQrCode(...args))
            }, [
              vue.createElementVNode("view", { class: "menu-item-icon" }, [
                vue.createElementVNode("view", { class: "wxfont qr_code" })
              ]),
              vue.createElementVNode("view", { class: "text" }, "扫一扫")
            ])
          ])
        ], 12, ["animation"]),
        vue.createElementVNode("view", { class: "main-action-menu-background-model" })
      ],
      32
      /* NEED_HYDRATION */
    )) : vue.createCommentVNode("v-if", true);
  }
  const __easycom_1$1 = /* @__PURE__ */ _export_sfc(_sfc_main$1l, [["render", _sfc_render$1k], ["__scopeId", "data-v-234a7099"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/components/main-action-menu/main-action-menu.vue"]]);
  class Draft {
    static setConversationDraft(conversation2, draftText, quoteInfo, mentions = null) {
      if (!draftText && !quoteInfo) {
        wfc.setConversationDraft(conversation2, "");
        return;
      }
      let obj = {
        content: draftText,
        mentions,
        quoteInfo
      };
      let jsonStr = JSON.stringify(obj, (key, value) => {
        if (key === "messageUid") {
          return stringValue(value);
        }
        return value;
      });
      jsonStr = _patchToJavaLong(jsonStr, "messageUid");
      wfc.setConversationDraft(conversation2, jsonStr);
    }
    static getConversationDraftEx(conversationInfo) {
      let obj = {
        text: "",
        quotedMessage: null
      };
      if (!conversationInfo || !conversationInfo.draft) {
        return obj;
      }
      if (!conversationInfo.draft.startsWith("{")) {
        obj.text = conversationInfo.draft;
        return obj;
      }
      let draftStr = conversationInfo.draft;
      draftStr = _reverseToJsLongString(draftStr, "messageUid");
      let draft = JSON.parse(draftStr);
      obj.text = draft.content;
      obj.text = obj.text ? obj.text : "";
      if (draft.quoteInfo) {
        let msg = store.getMessageByUid(draft.quoteInfo.messageUid);
        obj.quotedMessage = msg;
      }
      return obj;
    }
    static getConversationDraft(conversation2) {
      let conversationInfo = wfc.getConversationInfo(conversation2);
      return this.getConversationDraftEx(conversationInfo);
    }
  }
  const _sfc_main$1k = {
    name: "ConversationItemView",
    props: {
      conversationInfo: {
        type: ConversationInfo,
        required: true
      }
    },
    data() {
      return {
        shareConversationState: store.state.conversation
      };
    },
    methods: {
      imgUrlAlt(e) {
        e.target.src = Config.DEFAULT_PORTRAIT_URL;
      }
    },
    computed: {
      conversationTitle() {
        let info = this.conversationInfo;
        if (info.conversation.type === ConversationType.Single) {
          return info.conversation._target._displayName;
        } else {
          return info.conversation._target.name;
        }
      },
      shouldShowDraft() {
        if (this.shareConversationState.currentConversationInfo && this.shareConversationState.currentConversationInfo.conversation.equal(this.conversationInfo.conversation)) {
          return false;
        }
        if (this.conversationInfo.unreadCount.unreadMention + this.conversationInfo.unreadCount.unreadMentionAll > 0) {
          return false;
        }
        let draft = Draft.getConversationDraftEx(this.conversationInfo);
        return draft.text.trim() !== "" || draft.quotedMessage !== null;
      },
      draft() {
        let draft = Draft.getConversationDraftEx(this.conversationInfo);
        let draftText = `<em>[${this.$t("common.draft")}]</em>` + draft.text;
        draftText = draftText.replace(/<img [:a-zA-Z0-9_+; ,\-=\/."]+>/g, "[图片]");
        draftText = draftText.replace(/&nbsp;/g, " ");
        draftText = draftText.replace(/<br>/g, "");
        if (draft.quotedMessage) {
          draftText += "...";
        }
        return draftText;
      },
      lastMessageContent() {
        let conversationInfo = this.conversationInfo;
        if (conversationInfo.lastMessage && conversationInfo.lastMessage.messageContent) {
          let senderName = "";
          if (conversationInfo.conversation.type === 1 && conversationInfo.lastMessage.direction === 1 && !(conversationInfo.lastMessage.messageContent instanceof NotificationMessageContent)) {
            if (conversationInfo.lastMessage._from) {
              senderName = conversationInfo.lastMessage._from._displayName + ": ";
            } else {
              conversationInfo.lastMessage = store._patchMessage(conversationInfo.lastMessage, 0);
              if (conversationInfo.lastMessage._from) {
                senderName = conversationInfo.lastMessage._from._displayName + ": ";
              } else {
                senderName = "<" + conversationInfo.lastMessage.from + ">: ";
              }
            }
          }
          return senderName + conversationInfo.lastMessage.messageContent.digest(conversationInfo.lastMessage);
        } else {
          return "";
        }
      },
      unread() {
        let conversationInfo = this.conversationInfo;
        let unreadCount = conversationInfo.unreadCount;
        return unreadCount ? unreadCount.unread + unreadCount.unreadMention + unreadCount.unreadMentionAll : 0;
      },
      unreadMention() {
        let conversationInfo = this.conversationInfo;
        let unreadCount = conversationInfo.unreadCount;
        return unreadCount ? unreadCount.unreadMention + unreadCount.unreadMentionAll : 0;
      }
    }
  };
  function _sfc_render$1j(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("view", { class: "conversation-item-container" }, [
      vue.createElementVNode("view", { class: "conversation-item" }, [
        vue.createElementVNode("view", { class: "header" }, [
          vue.createElementVNode("img", {
            class: "avatar",
            draggable: "false",
            src: $props.conversationInfo.conversation._target.portrait,
            alt: "",
            onError: _cache[0] || (_cache[0] = (...args) => $options.imgUrlAlt && $options.imgUrlAlt(...args))
          }, null, 40, ["src"]),
          $options.unread > 0 ? (vue.openBlock(), vue.createElementBlock(
            "em",
            {
              key: 0,
              class: vue.normalizeClass(["badge", { silent: $props.conversationInfo.isSilent }])
            },
            vue.toDisplayString($options.unread > 99 ? "99" : $options.unread),
            3
            /* TEXT, CLASS */
          )) : vue.createCommentVNode("v-if", true)
        ]),
        vue.createElementVNode("view", { class: "content-container" }, [
          vue.createElementVNode("view", { class: "title-time-container" }, [
            vue.createElementVNode(
              "h2",
              { class: "title single-line" },
              vue.toDisplayString($options.conversationTitle),
              1
              /* TEXT */
            ),
            vue.createElementVNode(
              "p",
              { class: "time" },
              vue.toDisplayString($props.conversationInfo._timeStr),
              1
              /* TEXT */
            )
          ]),
          vue.createElementVNode("view", { class: "content" }, [
            $options.shouldShowDraft ? (vue.openBlock(), vue.createElementBlock("p", {
              key: 0,
              class: "draft single-line",
              innerHTML: $options.draft
            }, null, 8, ["innerHTML"])) : (vue.openBlock(), vue.createElementBlock("p", {
              key: 1,
              class: "last-message-desc single-line"
            }, [
              $options.unreadMention > 0 ? (vue.openBlock(), vue.createElementBlock("i", { key: 0 }, "[有人@我]")) : vue.createCommentVNode("v-if", true),
              vue.createTextVNode(
                " " + vue.toDisplayString($options.lastMessageContent),
                1
                /* TEXT */
              )
            ])),
            $props.conversationInfo.isSilent ? (vue.openBlock(), vue.createElementBlock("i", {
              key: 2,
              class: "icon-ion-android-notifications-off"
            })) : vue.createCommentVNode("v-if", true)
          ])
        ])
      ])
    ]);
  }
  const ConversationItemView = /* @__PURE__ */ _export_sfc(_sfc_main$1k, [["render", _sfc_render$1j], ["__scopeId", "data-v-15885850"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversationList/ConversationItemView.vue"]]);
  class OrganizationServerError extends Error {
    constructor(errorCode, message2) {
      super(message2);
      __publicField(this, "errorCode");
      this.errorCode = errorCode;
    }
    toString() {
      return this.errorCode + "-" + this.message;
    }
  }
  class OrganizationServerApi {
    constructor() {
      __publicField(this, "isServiceAvailable", true);
      __publicField(this, "serviceUnavailbelError", new OrganizationServerError(-1, "未登录或服务不可用"));
    }
    login() {
      return new Promise((resolve, reject) => {
        if (!Config.ORGANIZATION_SERVER) {
          return Promise.reject(this.serviceUnavailbelError);
        }
        wfc.getAuthCode("admin", 2, "", (code) => {
          let path = "/api/user_login";
          this._post(path, {
            authCode: code
          }, true).then((response) => {
            if (response.data.code === 0) {
              let appAuthToken = response.header["authtoken"];
              if (!appAuthToken) {
                appAuthToken = response.header["authToken"];
              }
              if (appAuthToken) {
                setItem("authToken-org", appAuthToken);
              }
              this.isServiceAvailable = true;
              resolve(response.data.result);
            } else {
              reject(new OrganizationServerError(response.data.code, response.data.message));
            }
          });
        }, (error) => {
          formatAppLog("error", "at api/organizationServerApi.js:47", "getAuthCode error", error);
          reject(new OrganizationServerError(-1, "未登录，或服务不可用"));
        });
      });
    }
    getRootOrganization() {
      return this._post("/api/organization/root");
    }
    getRelationShip(employeeId) {
      return this._post("/api/relationship/employee", { employeeId });
    }
    getOrganizationEx(orgId) {
      return this._post("/api/organization/query_ex", { id: orgId });
    }
    getOrganizations(orgIds) {
      return this._post("/api/organization/query_list", { ids: orgIds });
    }
    async getOrganizationEmployees(orgIds) {
      let employeeIds = await this._post("/api/organization/batch_employees", { ids: orgIds });
      return this.getEmployeeList(employeeIds);
    }
    getOrgEmployees(orgId) {
      return this._post("/api/organization/employees", { ids: orgId });
    }
    getEmployee(employeeId) {
      return this._post("/api/employee/query", { employeeId });
    }
    getEmployeeEx(employeeId) {
      return this._post("/api/employee/query_ex", { employeeId });
    }
    getEmployeeList(employeeIds) {
      return this._post("/api/employee/query_list", { employeeIds });
    }
    searchEmployee(orgId, keyword) {
      return this._post("/api/employee/search", { organizationId: orgId, keyword });
    }
    async getOrganizationPath(organizationId) {
      let pathList = [];
      let org = await this._getOrganizationSync(organizationId);
      if (org) {
        pathList.push(org);
        if (org.parentId) {
          pathList.push(...await this.getOrganizationPath(org.parentId));
        }
      }
      return pathList;
    }
    employeeToUserInfo(employee) {
      let userInfo = new UserInfo();
      userInfo.uid = employee.employeeId;
      userInfo.name = employee.name;
      userInfo.displayName = employee.name;
      userInfo.portrait = employee.portrait ? employee.portrait : Config.DEFAULT_PORTRAIT_URL;
      userInfo.gender = employee.gender;
      userInfo.mobile = employee.mobile;
      userInfo.email = employee.email;
      userInfo.updateDt = employee.updateDt;
      userInfo.type = 1;
      userInfo.deleted = 0;
      return userInfo;
    }
    async _getOrganizationSync(orgId) {
      let orgs = await this.getOrganizations([orgId]);
      return orgs && orgs.length > 0 ? orgs[0] : null;
    }
    /**
     *
     * @param path
     * @param data
     * @param rawResponse
     * @param rawResponseData
     * @return {Promise<string | AxiosResponse<any>|*|T>}
     * @private
     */
    _post(path, data = {}, rawResponse = false, rawResponseData = false) {
      path = Config.ORGANIZATION_SERVER + path;
      let p = new Promise((resolve, reject) => {
        uni.request({
          url: path,
          data,
          header: {
            "content-type": "application/json",
            // 默认值
            "authToken": getItem("authToken-org")
          },
          method: "POST",
          success: (res) => {
            formatAppLog("log", "at api/organizationServerApi.js:151", "_post result", res);
            if (res.statusCode === 200) {
              if (rawResponse) {
                resolve(res);
                return;
              }
              if (rawResponseData) {
                resolve(res.data);
                return;
              }
              if (res.data.code === 0) {
                resolve(res.data.result);
              } else {
                throw new OrganizationServerError(res.data.code, res.data.message);
              }
            } else {
              throw new Error("request error, status code: " + res.status);
            }
          },
          fail: (res) => {
            formatAppLog("log", "at api/organizationServerApi.js:171", "fail", res);
            throw new Error("request error: " + res);
          }
        });
      });
      return p;
    }
  }
  const organizationServerApi = new OrganizationServerApi();
  var isIOS;
  function album() {
    var result = 0;
    var PHPhotoLibrary = plus.ios.import("PHPhotoLibrary");
    var authStatus = PHPhotoLibrary.authorizationStatus();
    if (authStatus === 0) {
      result = null;
    } else if (authStatus == 3) {
      result = 1;
    } else {
      result = 0;
    }
    plus.ios.deleteObject(PHPhotoLibrary);
    return result;
  }
  function camera() {
    var result = 0;
    var AVCaptureDevice = plus.ios.import("AVCaptureDevice");
    var authStatus = AVCaptureDevice.authorizationStatusForMediaType("vide");
    if (authStatus === 0) {
      result = null;
    } else if (authStatus == 3) {
      result = 1;
    } else {
      result = 0;
    }
    plus.ios.deleteObject(AVCaptureDevice);
    return result;
  }
  function location$1() {
    var result = 0;
    var cllocationManger = plus.ios.import("CLLocationManager");
    var enable = cllocationManger.locationServicesEnabled();
    var status = cllocationManger.authorizationStatus();
    if (!enable) {
      result = 2;
    } else if (status === 0) {
      result = null;
    } else if (status === 3 || status === 4) {
      result = 1;
    } else {
      result = 0;
    }
    plus.ios.deleteObject(cllocationManger);
    return result;
  }
  function push() {
    var result = 0;
    var UIApplication = plus.ios.import("UIApplication");
    var app2 = UIApplication.sharedApplication();
    var enabledTypes = 0;
    if (app2.currentUserNotificationSettings) {
      var settings = app2.currentUserNotificationSettings();
      enabledTypes = settings.plusGetAttribute("types");
      if (enabledTypes == 0) {
        result = 0;
        formatAppLog("log", "at common/permission.js:63", "推送权限没有开启");
      } else {
        result = 1;
        formatAppLog("log", "at common/permission.js:66", "已经开启推送功能!");
      }
      plus.ios.deleteObject(settings);
    } else {
      enabledTypes = app2.enabledRemoteNotificationTypes();
      if (enabledTypes == 0) {
        result = 3;
        formatAppLog("log", "at common/permission.js:73", "推送权限没有开启!");
      } else {
        result = 4;
        formatAppLog("log", "at common/permission.js:76", "已经开启推送功能!");
      }
    }
    plus.ios.deleteObject(app2);
    plus.ios.deleteObject(UIApplication);
    return result;
  }
  function contact$3() {
    var result = 0;
    var CNContactStore = plus.ios.import("CNContactStore");
    var cnAuthStatus = CNContactStore.authorizationStatusForEntityType(0);
    if (cnAuthStatus === 0) {
      result = null;
    } else if (cnAuthStatus == 3) {
      result = 1;
    } else {
      result = 0;
    }
    plus.ios.deleteObject(CNContactStore);
    return result;
  }
  function record() {
    var result = null;
    var avaudiosession = plus.ios.import("AVAudioSession");
    var avaudio = avaudiosession.sharedInstance();
    var status = avaudio.recordPermission();
    formatAppLog("log", "at common/permission.js:104", "permissionStatus:" + status);
    if (status === 1970168948) {
      result = null;
    } else if (status === 1735552628) {
      result = 1;
    } else {
      result = 0;
    }
    plus.ios.deleteObject(avaudiosession);
    return result;
  }
  function calendar() {
    var result = null;
    var EKEventStore = plus.ios.import("EKEventStore");
    var ekAuthStatus = EKEventStore.authorizationStatusForEntityType(0);
    if (ekAuthStatus == 3) {
      result = 1;
      formatAppLog("log", "at common/permission.js:122", "日历权限已经开启");
    } else {
      formatAppLog("log", "at common/permission.js:124", "日历权限没有开启");
    }
    plus.ios.deleteObject(EKEventStore);
    return result;
  }
  function memo() {
    var result = null;
    var EKEventStore = plus.ios.import("EKEventStore");
    var ekAuthStatus = EKEventStore.authorizationStatusForEntityType(1);
    if (ekAuthStatus == 3) {
      result = 1;
      formatAppLog("log", "at common/permission.js:136", "备忘录权限已经开启");
    } else {
      formatAppLog("log", "at common/permission.js:138", "备忘录权限没有开启");
    }
    plus.ios.deleteObject(EKEventStore);
    return result;
  }
  function requestIOS(permissionIDs) {
    let ps = [];
    for (const permissionID of permissionIDs) {
      let p = new Promise((resolve, reject) => {
        switch (permissionID) {
          case "push":
            resolve(push());
            break;
          case "location":
            resolve(location$1());
            break;
          case "record":
            resolve(record());
            break;
          case "camera":
            resolve(camera());
            break;
          case "album":
            resolve(album());
            break;
          case "contact":
            resolve(contact$3());
            break;
          case "calendar":
            resolve(calendar());
            break;
          case "memo":
            resolve(memo());
            break;
          default:
            resolve(0);
            break;
        }
      });
      ps.push(p);
    }
    return new Promise((resolve, reject) => {
      Promise.all(ps).then((value) => {
        let result = 1;
        for (const v of value) {
          if (v !== 1 && v != null) {
            result = v;
            break;
          }
        }
        resolve(result);
      }, (reason) => {
        reject(reason);
      });
    });
  }
  function requestAndroid(permissionIDs) {
    return new Promise((resolve, reject) => {
      plus.android.requestPermissions(
        permissionIDs,
        function(resultObj) {
          var result = 0;
          for (var i2 = 0; i2 < resultObj.granted.length; i2++) {
            var grantedPermission = resultObj.granted[i2];
            formatAppLog("log", "at common/permission.js:206", "已获取的权限：" + grantedPermission);
            result = 1;
          }
          for (var i2 = 0; i2 < resultObj.deniedPresent.length; i2++) {
            var deniedPresentPermission = resultObj.deniedPresent[i2];
            formatAppLog("log", "at common/permission.js:211", "拒绝本次申请的权限：" + deniedPresentPermission);
            result = 0;
          }
          for (var i2 = 0; i2 < resultObj.deniedAlways.length; i2++) {
            var deniedAlwaysPermission = resultObj.deniedAlways[i2];
            formatAppLog("log", "at common/permission.js:216", "永久拒绝申请的权限：" + deniedAlwaysPermission);
            result = -1;
          }
          resolve(result);
        },
        function(error) {
          formatAppLog("log", "at common/permission.js:222", "result error: " + error.message);
          resolve({
            code: error.code,
            message: error.message
          });
        }
      );
    });
  }
  function gotoAppPermissionSetting() {
    if (permission.isIOS) {
      var UIApplication = plus.ios.import("UIApplication");
      var application2 = UIApplication.sharedApplication();
      var NSURL2 = plus.ios.import("NSURL");
      var setting2 = NSURL2.URLWithString("app-settings:");
      application2.openURL(setting2);
      plus.ios.deleteObject(setting2);
      plus.ios.deleteObject(NSURL2);
      plus.ios.deleteObject(application2);
    } else {
      var Intent = plus.android.importClass("android.content.Intent");
      var Settings = plus.android.importClass("android.provider.Settings");
      var Uri = plus.android.importClass("android.net.Uri");
      var mainActivity = plus.android.runtimeMainActivity();
      var intent = new Intent();
      intent.setAction(Settings.ACTION_APPLICATION_DETAILS_SETTINGS);
      var uri = Uri.fromParts("package", mainActivity.getPackageName(), null);
      intent.setData(uri);
      mainActivity.startActivity(intent);
    }
  }
  const permission = {
    get isIOS() {
      return typeof isIOS === "boolean" ? isIOS : isIOS = uni.getSystemInfoSync().platform === "ios";
    },
    requestIOS,
    requestAndroid,
    gotoAppSetting: gotoAppPermissionSetting
  };
  const _sfc_main$1j = {
    name: "ConversationListPage",
    data() {
      return {
        sharedConversationState: store.state.conversation,
        sharedMiscState: store.state.misc,
        showContextMenu: false,
        contextMenuX: 0,
        contextMenuY: 0,
        contextMenuItems: []
      };
    },
    onShow() {
      formatAppLog("log", "at pages/conversationList/ConversationListPage.vue:46", "conversationList onShow", this.sharedConversationState.conversationInfoList.length);
      let userId = getItem("userId");
      if (!userId) {
        uni.reLaunch(
          {
            url: "/pages/login/LoginPage"
          }
        );
      } else {
        if (!permission.isIOS) {
          permission.requestAndroid(["android.permission.RECORD_AUDIO"]);
        }
        this.updateTabBarBadge();
      }
    },
    onHide() {
      formatAppLog("log", "at pages/conversationList/ConversationListPage.vue:67", "conversationList onHide");
      this.$refs.mainActionMenu.hide();
    },
    onNavigationBarButtonTap(e) {
      formatAppLog("log", "at pages/conversationList/ConversationListPage.vue:72", "onNavigationBarButtonTap");
      switch (e.index) {
        case 0:
          this.$refs.mainActionMenu.toggle();
          break;
        case 1:
          this.$refs.mainActionMenu.hide();
          uni.navigateTo({
            url: "/pages/search/SearchPortalPage"
          });
          break;
      }
    },
    methods: {
      showConversation(conversationInfo) {
        store.setCurrentConversationInfo(conversationInfo);
        this.$go2ConversationPage();
      },
      removeConversation(conversationInfo) {
        store.removeConversation(conversationInfo.conversation);
      },
      conversationInfoKey(conversationInfo) {
        let conv = conversationInfo.conversation;
        return conv.target + "-" + conv.type + "-" + conv.line;
      },
      scrollActiveElementCenter() {
        let el = this.$el.getElementsByClassName("active")[0];
        el && el.scrollIntoView({ behavior: "instant", block: "center" });
      },
      onScroll() {
      },
      showConversationContextMenu(e, conversationInfo) {
        this.contextMenuX = e.touches[0].clientX;
        this.contextMenuY = e.touches[0].clientY;
        this.contextMenuItems = [];
        this.contextMenuItems.push({
          title: conversationInfo.top ? "取消置顶" : "置顶",
          tag: "top",
          conversationInfo
        });
        this.contextMenuItems.push({
          title: conversationInfo.isSilent ? "取消静音" : "静音",
          tag: "silent",
          conversationInfo
        });
        this.contextMenuItems.push({
          title: "删除会话",
          tag: "delete",
          conversationInfo
        });
        this.contextMenuItems.push({
          title: conversationInfo._unread === 0 ? "标记为未读" : "标记为已读",
          tag: "mark",
          conversationInfo
        });
        this.showContextMenu = true;
      },
      onContextMenuItemSelect(t2) {
        switch (t2.tag) {
          case "delete":
            store.removeConversation(t2.conversationInfo.conversation);
            break;
          case "top":
            store.setConversationTop(t2.conversationInfo.conversation, t2.conversationInfo.top > 0 ? 0 : 1);
            break;
          case "silent":
            store.setConversationSilent(t2.conversationInfo.conversation, !t2.conversationInfo.isSilent);
            break;
          case "mark":
            let conversation2 = t2.conversationInfo.conversation;
            if (t2.conversationInfo._unread === 0) {
              wfc.markConversationAsUnread(conversation2, true);
            } else {
              wfc.clearConversationUnreadStatus(conversation2);
            }
            break;
          default:
            uni.showToast({
              title: "TODO " + t2.title,
              icon: "none"
            });
            break;
        }
      },
      updateTabBarBadge() {
        let newValue = this.unread;
        if (newValue > 0) {
          uni.setTabBarBadge({
            index: 0,
            text: "" + newValue
          });
        } else {
          uni.removeTabBarBadge({
            index: 0
          });
        }
      }
    },
    activated() {
      this.scrollActiveElementCenter();
    },
    computed: {
      connectionStatusDesc() {
        let desc = "";
        switch (this.sharedMiscState.connectionStatus) {
          case ConnectionStatus.ConnectionStatusConnecting:
            desc = "正在连接...";
            break;
          case ConnectionStatus.ConnectionStatusReceiveing:
            desc = "正在同步...";
            break;
          case ConnectionStatus.ConnectionStatusConnected:
            organizationServerApi.login().then((r) => formatAppLog("log", "at pages/conversationList/ConversationListPage.vue:201", "org login result", r)).catch((reason) => formatAppLog("log", "at pages/conversationList/ConversationListPage.vue:201", "org login fail ", reason));
            desc = "";
            break;
          case ConnectionStatus.ConnectionStatusUnconnected:
            desc = "连接失败";
            break;
        }
        return desc;
      },
      unread() {
        let count = 0;
        this.sharedConversationState.conversationInfoList.forEach((info) => {
          if (info.isSilent) {
            return;
          }
          let unreadCount = info.unreadCount;
          count += unreadCount.unread;
        });
        return count;
      }
    },
    updated() {
      formatAppLog("log", "at pages/conversationList/ConversationListPage.vue:224", "updated xxx");
    },
    components: {
      ConversationItemView
    }
  };
  function _sfc_render$1i(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_ConversationItemView = vue.resolveComponent("ConversationItemView");
    const _component_uni_list = resolveEasycom(vue.resolveDynamicComponent("uni-list"), __easycom_0$2);
    const _component_chunLei_popups = resolveEasycom(vue.resolveDynamicComponent("chunLei-popups"), __easycom_0$1);
    const _component_main_action_menu = resolveEasycom(vue.resolveDynamicComponent("main-action-menu"), __easycom_1$1);
    return vue.openBlock(), vue.createElementBlock(
      "view",
      {
        class: "conversation-list",
        onScroll: _cache[1] || (_cache[1] = (...args) => $options.onScroll && $options.onScroll(...args))
      },
      [
        $options.connectionStatusDesc || $options.unread === void 0 ? (vue.openBlock(), vue.createElementBlock(
          "view",
          {
            key: 0,
            style: { "text-align": "center", "padding": "5px 0" }
          },
          vue.toDisplayString($options.connectionStatusDesc),
          1
          /* TEXT */
        )) : vue.createCommentVNode("v-if", true),
        vue.createVNode(_component_uni_list, {
          border: true,
          onScroll: $options.onScroll
        }, {
          default: vue.withCtx(() => [
            (vue.openBlock(true), vue.createElementBlock(
              vue.Fragment,
              null,
              vue.renderList($data.sharedConversationState.conversationInfoList, (conversationInfo) => {
                return vue.openBlock(), vue.createElementBlock("view", {
                  class: vue.normalizeClass(["conversation-item", { top: conversationInfo.top }]),
                  onClick: ($event) => $options.showConversation(conversationInfo),
                  key: $options.conversationInfoKey(conversationInfo)
                }, [
                  vue.createVNode(_component_ConversationItemView, {
                    "conversation-info": conversationInfo,
                    onContextmenu: vue.withModifiers(($event) => $options.showConversationContextMenu($event, conversationInfo), ["prevent"])
                  }, null, 8, ["conversation-info", "onContextmenu"])
                ], 10, ["onClick"]);
              }),
              128
              /* KEYED_FRAGMENT */
            ))
          ]),
          _: 1
          /* STABLE */
        }, 8, ["onScroll"]),
        vue.createVNode(_component_chunLei_popups, {
          modelValue: $data.showContextMenu,
          "onUpdate:modelValue": _cache[0] || (_cache[0] = ($event) => $data.showContextMenu = $event),
          popData: $data.contextMenuItems,
          onTapPopup: $options.onContextMenuItemSelect,
          x: $data.contextMenuX,
          y: $data.contextMenuY,
          direction: "column",
          theme: "dark",
          triangle: false,
          dynamic: ""
        }, null, 8, ["modelValue", "popData", "onTapPopup", "x", "y"]),
        vue.createVNode(
          _component_main_action_menu,
          { ref: "mainActionMenu" },
          null,
          512
          /* NEED_PATCH */
        )
      ],
      32
      /* NEED_HYDRATION */
    );
  }
  const PagesConversationListConversationListPage = /* @__PURE__ */ _export_sfc(_sfc_main$1j, [["render", _sfc_render$1i], ["__scopeId", "data-v-15c1bdfd"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversationList/ConversationListPage.vue"]]);
  const emojiStickerConfig = [
    {
      category: "emoji",
      poster: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAB4CAYAAAA5ZDbSAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAAB3RJTUUH5gcHDhgUsWHXuAAAGWZJREFUeNrtnXmQXFd97z+/2/t09+wzmkX7MrYlG0lIooIsB9vBENuyzWLjxMYEQigCCYFUPYpnh7w/eAGHIlUxSV6CixcHnqF4JASTeFFs2cK2vCTSyAuOkNFo3zWj2Xumt3vvL3/c262eVTPTt7tHznyrRqPq6e7zO+d7f+f8zm85BxawgAVcvpBKC1AK6J47IJiFrM8AfIAfMBAM5w3YCDZgAhambRPwI5v+pdKie47LlmDdexuIAuIDrQaaUWkDliC0Ay0oDUANQhVKaBzBaWAUGAR6gfPAaeAkymmgGxgCLARk8+OV7vKccNkQrJ23AQoQQGkBrkTk3cB60A6gDaQWCBfRLwVSKIPAGYSDwJvAa8AB0HOoZBEL2fxUpYdkRpjXBOve7SACSgTRDpBtoNcDG1BZjBAukygp4DToG6g8D+xG9CBKEjGQzf9a6aGaEvOSYIdY/CgrEW4C2Q5sAhrngcyKM6V3Ak+iPAMcAUzZMv+m8UoPVh665zYwFJAo8F7gt1D9ACKL55Oc48UGTqG6E+T/I/oqkEBBtjxRadmAeTBw2nk7YANSA3wQ5VMI24BYpWWbJUZAdwPfA3kaZQBRZHNlia4YwRetYGIgtwC/D2wFQhUdkeKRBl4F/TuQHSjDGDay6cmKCFMRgh2LmADKdQh/DLwfymYwlQsp4DngL4EXQbOV0OayEqydt4EqiKwCvgR8HKgte6/LiwHgB8BDwGEo7566bATr3tsADYPciXA/sLZsvZwf+CWqDwI/AVLlMsJKTrB2bgcVgOXAnwD3IkTK0rv5hyTwQ+DroMdQodRbq5ISrJ3bAQyUG4EHEdlc0t5cPtiH8j+BXYBdSpJLRrDu3Q4QRvg08L9AmkvWi8sT3cDXgL8HUqValz0nWP/9NvArqNQhfBX4PO88C9krpFD+DvjfCP2oeu4g8ZTgvJUM7SDfQrgb3AjOAqaCDfwY9MvAaWxF3uPdntkzgp31VgBWgv4NyM3lHqnLGsoOhD9EOeKlB8wTgi+G8mQ16MMgN1ZwqC5n7EL1syCHvCK56OlTO293p2VZibJAbnG4EXgYYSUq6L7tRX9hURqcjwAp7Yh8F1iYlj2B7gA+g5NhUpQmF6fBgmMtI99igVwPITej8i2grthVdM4EO65Hwghfda3lBXgJZ0y/Chp2HUZzwpwIdpwYKgi/h7PPXdgKeQ8D5PMgv4eKuAo1a8xa//NxXJWbEB4FFlV6JN7RUM4D9wE752JZz03zVFYA32CB3NJDWAR8A3SFk1Q6O8yKYO3cDqJhhPsRFgIH5cNm4H5g1uvxjAl2wn6Ayl04gfoFlAsCiHwckbvQfEbMjDALDRYQWY3wFfhvG8+tJCLAVxBWM4u5ekYE697bQPGjfBFYV+me/jfGOpAvgvhnqsWXJFg7XatZuB7h3kr3cAHcC/o+yMfcp8WlNdhZd+Ou9tZVuncLoA6VL6Ean8kud1qCnT0vALfgpLYuYD5AeD/iuIYvpcUz0eBa4LNlLPRawKURRvl9hFpkei2ekuCLT4Z+ELi20j1awDiIbMUp9WG6vfHUGiyAaAz4JEKwrMJrwTZAGLvU6BzcOe9MuULA7yDEpluLJ/2L7rsdbMUp3eSnlKsQzKl6AAHLUhKJNCPJLIpSFQ4Qj4Xw+w3X8HPfW2a5TNNmOJFmNJVFEKKRALFYCJ9PKiAXCeAjoDsxDGTTxDpl/6QftG0AH8jdlJlcW5VDR/t4ae9xjp0cYCSZBYVI2M+Sthq2bl7C2jXN+Awpz2C6bVi2cqCrm5c7T3LyzCDJlAkC0UiA5Utq2bZ5GatX1GNImeQCHO3lbmAXtm1N/pbJ+tR5GyhXAM8gLC29pLmxVF7ed5LHdhxgcDjjKI1cHGdViFb5ufXGNfzGtlUOyWWAZSvPvXSYJ3d1MTJqTipXTTzIh2++ims3LUHKpcGOBCdQPgD8arKU2wlrsEsuoDeVjVxVEDh0vI+f/dvbDCUy+HxgGOQH0zDA54PRpMkTz3Xx1tvn3YySEq59rlxvvX2eJ57rYjRpTinXUCLDz/7tbQ4d7y+9XGMgSxF5P+STMMZgopHlyBVB5NYySehMgZbN7j0nGBhKY0yzeTMMh+QX/+MY6bRZ2qlQhHTa5IV/P8Zo0rykXANDaXbvOY5l2eVbhwGUW0EmjQ9MIbJegbKpbAIK9A+mOHS0d0bjYhhw7NQg3RdGSltdJdB9YYTjpwenJTf/doFDR3vpH0yVtzBX2IzQMVmbY8R2472AbENoKqeEff2jDI1kZvzgjyYzdPeOlFyDu3tHGE1mZvp2hkYy9PUnKXPpdROq22DiND3uuRRAAgjvK6d0CKTSFrZlz/gjtg2ptFly0VJp091UzFAuy3bkKvvZCXI9SmD8q+MIVkBbgA3lFm8BRUJ0A6It7rkneUy2slwFLK60vAuYLWQxDndjkCc4vz1S2chCuefliDDIRnTsOjxWg0V8COsrLekC5oz1Lod5FBCsOKe2akdlZNO5ZIXOO2jBvxVovAOlurD58WtwM9BWCdlEZFaGp+NJKr2pKsxuJyaUR64p0IbDYR4XCVYBlXb3SN7yQiFaFcQf8M34Iz5DiFWVPooZi4Zm5fMOBHxEq4KVUWKhFqF9iikaEBZTiZRYVRrrqqiviczIhasK8XiIlqZoyX3Ri5qixGOhGctVVxOhsa6qUnHrCON2QAbkj+8FtGLbo+p4iGuubM4P1HRQhatWNdFQX1VaTVForK/iqtVNM5IJ4Jorm6mOV/S4zXZU88nxjgYLuYGqTK2RG7W57j3LWNJWjW1PTrIqWBY0N1Zxw9bl+HxGyTXY5zO4YetymhursKyp5bJtWNJWzXXvWVbmaNIEYVrIxaQpnKJFDaChIkKJgK00N0a550PXsGpZLeCQadnujxvOXtIa5547rmFZe617LEhpfdEoLGuv5Z47rmFJW3xKuVYtq+WeD11Dc2PUzYaplKElDajmeXUyOpyjBn0INRWSKj+Yq5fX87n7tvDGL8/RdaSXgeEUqkp1LMSqZfVsXNdKY4M7NSul9/m6bVx9ZTMtTTFe33+Ww8f7GEqkERFq42HWrGxgw9oWamvCpX/oLjmOVDsXlWCTGx7X8xEBnkCo7CEq+fwnwbZssqajIn6/4UzJULFtZu5hsiwb03QiEAG/DyO3VJQzH2tq7AK2A0nZ/LirwY5MBvPhMO6CXBjDEELBgrSxSntC3PZ9hoEvWOgj0rGyVxZBCpZef4GAziVS80PIBcwdPgoIXjhb4x0Od4oWcBZlq5gvW8C8gIVrYEF+igb3xXTl72FZQJHIMIFgBybOXX4LuKyhIzhcAmPXYAvnosYFXN5wLtR0UWjr2wi9JWvWdUeqOPvIbNbCduqfwJB5cEWXhyjok20r2ayFZdmOP6nkbkzpRbFzA+pM0Qa5Wftcydo1hAu9o+z9xWmOnugnlTGJVQVpaYrR2hynuSFKbU2YqkgAv9+HGBf3wxXf/045luT3vmorpmkxmswyMJSi+8IIZ7uHOdeTIDGSIRzys2JpHZvf1U5TQ0mDJGM49APIpsdzOVmnPdckVTCEoyf6+eFjv+D46aGxVZjilH6EQ36q42EaaiMsaorR0hSjqd4JIcZiQcIhv0O8FGh77otKNVi5dvLOF6d+yjQtUmmTxEiG/oEk3X2jnO9JcP5Cgt7+JEPDaZLpLKY1VrbX959n3y/OcO+H38WKpXWl8VkrpxHJ38100chyBusUSBIvY8IijIxmeezptzl2agjDYEKVgG075SgjownOnEvw1ts9GAYE/AaRsJ94LERtdZi6mgj1tRHqasLUxENEq4JURQKEgn6CAR9+n4HhEwyRixkflxo/lzRVsFWxLcV0l5BUxiSZMkmMpBkcTjMwmKJvMEnfQJKBoRTDiTTJlEnWtPO504WFab7xSckKx04N8djTb/PZezcTjQTwGEmEU4UvXCTYEeo06MBUdS5zgiF0He3l0LG+fNHWJM/AmN+5wciaNtlEhsHhDCfPDOff4xR8CQG/j1DQRyjoJxzyEwr5CQd9BF3CAwEDv8/xYRsG5JKCFMW2XZ+yZZPN2mSyFpmMSSpjkU6bpDIm6bRJOmORNS0sS8eEMQuJBGcWuhRysh861kfX0V42XN3qaLF3GMA9Y3oiwU7nu4EzQKtnTapy5Hg/mYw9o0EoHIzJ/p+rsTZNxTQdDVNN5/9W9HQtE2fmQjlmUqN0qX5lMjZHTvSzYV1LkcKOg3IGh8M8CqZowDGxDyLeFZ7ZltI7MPn2enwAZibLkeT/GTto8wl500AnanoOvf2j2JYTUPEQB3E4zGNc2iwWom9621klk7EmeR2q65pZuno9kWg1AJbpBNBzU2HuZ96iQEbbDf5broshEq1myep3UV3XPGkfMhkL9bxz+iYy1t2c12DZ8kTutJbXca5G9aa6QcDwTfKUKogY3PGpP6O6dhHHu/Zx8vAbnDtxgN7u44wMXiCdHsU21Vmm5KL2TreOezZUU6TmoBeXAnH7FgpXEa1upL55Ka1Lr2LJqg0s7djEcH83j/7lZyZNTPD5xOv02hQirwNj7kMcd0aHABwATgGrvWjVZxiTWotiwMCFczz302/zu195lOVXbHG0PT1KYrCH/p5T9J4/xoWzR+k9f4z+C6cYHuxhdLiP1Ogw2UwKM5vGti1s2z1WZDKFmIEVPdlnclOrz+fDFwgSDEYIReJUxeuorm2mrnEx9YuW0diygsaWFdQ2LiZe00gwHEVEGOw7x88eeYCBC+cwJrE9qiIBr6fnUygHxvd3LMHOY3sO5A3nVFMPIEJ9bWRyrTPgwGvP8tgj93P35x4iEq0hFI4SCkdpWLSc1Vdvc8VSTDNDJjVKanSI5MgAo4kBRob7SCac/4+ODJAaHSaTSpBJJ50HwMxgmVlsy0TVzk+JIoKIgeHz4/MH8PuDBIJhgqEIwXCMcCRGJFpLVcz5icbrqYrVEYnVEq6KEwxF8QeCU2pgcmSQxx65nwOvPYcYkw4J9bVVFCbHeYA3kImOqokaLJoFngfu9IZgaGmO4/MJtq0TrGNVeHXnowRDVXz4d79BJDoxLUxECARCBAIhovE6YNmUzeVIVLVR23b3uHbujxcbxlkiRAQxDMRlothp0yH3AV7d+WhhUwXyOdNza3OsMJu1eCjPI5p18+vyGEOwbHk8l0/7EtADHlT5q9K2KE48GmRwOD3hzyKgtsULjz9MJjXChz/9IDX1c9+lSZ48H5POjSXEYN/ZPLlqW1PaBfFokLZFce+0V+kGXprsPuLJD2FRDqJ0etQ4jXVVLG6tnrJS3tFki1ee+T6PfPMTnOh6rQQWZgmhyolDr/EP3/wErzz9vWnJtW1Y3FpNQ52H/mhhH84WaQImWSEUhCToU171Pxj0s66jGWOaPPXcgPyy81m+87U7eWnHd0klE16JUDKkkwl27/i/fOdrd7K/89kxfRkPVcdRsq6jmWDQP4tWLokngeRkT8wEgp3DtBSEnaAnvGlfufqKZuprp689crYd0HP2KD/66y/wyDc/TtdbL2KZWS8HwxNYZpaut3bzyDfv40d//QV6zhzF8E2/XVOF+toIV1/RjIcRkhPAToRJ7x6e/DFyFupDDsl8umgRFBY1Rlm/dhG7Xj52ybcbBphmhtd2/wtdv9jNhms/xLUf/BTLOjYTCFb28IFsJsXxrn288vQ/8PrLjzE80DdpAGUqrF+7iEWNUS+Nq53A4an+PDnBhmv5wI89Oa9SFTGErZuW8NpbZxkYTnOpLWAujDgy3Mfupx7h9Zd+yhXrr+fdv34nHdf8OjUNbRhlMqJs22Kw9yxdb73Ivt0/4eCbzzM82J8/5W5G36FQWx1i66YlTqzbm1BhAudyaWuqAZ2yBderFUPlH3OnixcLVeWfdxzg6RcOT+mjnfqzjoESCPhpbF3Bmquvo2PDDSxdvZH6pqWEIjHPPEOqSjqZoK/nJCcPvcav3nyeQ/+5m54zR8hmzSmjYtPJrgq/ef0qPvKbV3nnwVJ2gH4MSEx1Nbx/mg+DSAL0++6dwMVVPbhafP17l7P/YDenzg7PrnLe1WjLMjl3souzJ7p45ZnvE6tppLltFa3L1tK6dC2NrSupbWwjGm8gHInhD4Tx+QMYhayoYts2lpnFzKZIJROMDPUy2HeWnjOHOXviAGeP76fn7GGGBy5gmlaBZ2tOXWdJa5z3/dpyL7U3jfB9kGkt0WlbcWuWaoGfItxQrES5Fve8cZr/989vkslYRfUz5xu23d9igD/gJxSOEo7ECVdVE4rECIar8AdC+AwfijPlmpk0mfQo6WSC1OgQqeQw6dQIZtZEbUdOw82hKlbGUNDHJz66ni0b2r3MPtkFfBQYyGVvTIZL2+rCAMp3gPfiRQBC4d1Xt3L0RD/PvXy0qHotcQnIKZUqWKbJaGKQkeHB/GuFbbt9Gvsd434bHu1gcm1v27KUjVe3ekiupkAeRnVgznc2QEFUQtgB7PSq136fwc03rGFdR5OnIcHcNJoLzOeMoPyP3/0peC33vsLPetRNVGFdRxM337AGv6fF6rIT9CkEptNemEltkigow6DfBvqLl81xQFfHQ9x16zqWtlfP75jvHKEKS9uruevWdc6RDt6VlvYD33bW3iLvTQKQTa51pvICyg896b1b0d/W4lTrtzRHZ3Xg53yHbUNLc5R77riGtpa419mTPwBegEtrL8ywutCdqk3g2yj7PRHTrehftbye+z6ynlaX5MtZm3NbudbmKPd9ZD2rltd7XfG/H+WvAHMm5MJsy0eFQ6B/jpL0blSgY2UDn7xrI8vc6fpyJDkn97L2aj5510Y6VjZ4na+dRPlzRA/N5ntn9Wi526Yw6F8h8hlPxRc4e36Yf3xiP/sP9jgvzbNkuinHxR3wdR1NfGz7OloXxb1Pxle+i+gfAanZXPM+6yF048XLgX8CD28BdysghobT7Ph5F7v3nCCdsTy1bL1GTmtDQR/XvWcpN9+wxjGovK5YUPYCH0M4NtOpOYfZ7/icjLNjIA8Aj7p3zBcP1/CqjoX46C1rWb64lqd+3sWZ84n8n+cTcuS2LYpxyw1r2PSuNmcr5H05ynlEHwA5Npe1a06SuFO1gH4ekb/Ay/OlC24ZO9+T4NndR9jz5mlGkqZTsFdhotX1nEUjfrasb+em61ayqClWolvPNAX8D5C/BdXZTM05zFka9/LKMMjXgS8hHp73kUszda+SO3ikl5+/cpQDh3pIpe1ZO/s9Ecm1kMMhgytXN3Hj1hV0rGwouGqvmNGcFDbKQ6B/AqSmCiZcCkWJ5GpyHcL/AX7b0+7BmNKAdDrL24cv8ErnSX515AKJUTNfvVkqsvPJ90Csyk/Hykau3bSEK1c3EgoFSng2loLKj4A/APrH51nNBsV7XYV+lC8DNQi3eNrP3MDZNqGgn/VrW7lqTRMnTg3y+v6z7D/YQ3fvCJms4yXJh0TnWE+eW+JywYtg0KC5oYp1Hc1sXNfC0vZaJ9Ump84le7rkKdAv44HnsGjpdO/tIDaorAS+W9KT8go0WlUZGk5x7NQAvzp8gSMnBujpG2FkNItl6cSzyQrLivP/jM2k9fmc20SbGqpYsbSOK1c2snxJLdXxsBPDLc9pdruAzwBHQJnLulsITyTNXwWvrEb0YTd+XDoUDrIhqK2kUln6BpKc60lwtjtBT+8IA0MpEqMZ0mmnhrcw8T3gNwiF/MSqgtRWh2lqqKKlKU5Lc4yG2gjhcOBi7HZ8m6XDLuCzwCEUipmac/BMYufMaQFYifI3XmWBXLrhgl7kFmUFtW2nvjhrkclamJbtnAkCGIbg9xluDbGPgN9AnALisUdGlOOw04sNPQV8AfTIZPnNc4Wn4uc1GdqBb6Hc7al17WVP54871Eb5MaJfdo5fMJDN/1r8t07R7aKhe27FLcipQ/gq8HkW7mGaCimUv0X4M6Df0VzvyIUSTkCuSzMMfBr0T0Eqc5r8/EU38DVU/x6ZnX95NijpCuNmZhooN4I8iHjou7680YlyP8IuwJ6tf3k2KLkJUXDN2nLgAeDjSAVudpkPUJIIPwS+jnJsJik3xaJsDr+LoUY+6jrP15ar7XmCXwIPovwESHllJV8KZfXoaud2pyxGdBUqX8TR5rpyylB2KAMIPwAeQvVw4SFl5UBFYjOuNgdAr0Pkj4H3846ztDWF8izIQ8CLQLZcWluIigXfnKMTFZAYcDPC54CtzId7I4rqGGnQVxC+g8oOYBjDRjY9WRFxKh5G187bcU5ClRrQD6LyKYRtFFvwVvaO6AjCbpDvofo0MADeeaTmiooTnIPuuR0MG1SiCO8Ffgv4AM5dfPNGzvFig54Cecb1Rr2KknCs49Lsa2eLeTlw7sm3fkRXAjeB3IqT/9U4D2RWlAvusQlPAs+AHgHM+UJqISo9WNMiH8BQIoh2oLIN4XpgA8pipGyGWQrnoNbXgRdQ2Q0cBE2W2yqeLeY1wYUoWKsDKIuAq4CNCBtQOkDbQGpd0ufaL3ULuwaAMyhdoG+4J8gdwDlsOwuld1B4hcuG4PHQzptxE1J8KHHQZpB2hCUo7QgtoA1ANRBFJYi4hYiKhWgGZAR0CJVehPPAKXdNPY3jK3buPzBBfu3yIHQ8LluCp4PjUDFAbOc2N/CjYuRDl4qNqI2KiaiFiI3tTYB9AQtYwAK8w38ByyT7h6f/icsAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMDctMDdUMTQ6MjQ6MjArMDA6MDDbH0lqAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTA3LTA3VDE0OjI0OjIwKzAwOjAwqkLx1gAAAABJRU5ErkJggg==",
      emojis: ["😁", "😂", "😃", "😄", "😅", "😆", "😉", "😊", "😋", "😌", "😍", "😏", "😒", "😓", "😔", "😖", "😘", "😚", "😜", "😝", "😞", "😠", "😡", "😢", "😣", "😤", "😥", "😨", "😩", "😪", "😫", "😭", "😰", "😱", "😲", "😳", "😵", "😷", "😸", "😹", "😺", "😻", "😼", "😽", "😾", "😿", "🙀", "🙅", "🙆", "🙇", "🙈", "🙉", "🙊", "🙋", "🙌", "🙍", "🙎", "🙏"]
    },
    {
      category: "sticker-b",
      poster: "https://static.wildfirechat.net/sticker/b/B%E6%95%B0%EF%BC%8C%E6%B2%A1%E6%9C%89%EF%BC%8C%E6%88%91%E5%BE%88%E8%86%A8%E8%83%80.png",
      stickers: [
        "https://static.wildfirechat.net/sticker/b/B%E6%95%B0%EF%BC%8C%E6%B2%A1%E6%9C%89%EF%BC%8C%E6%88%91%E5%BE%88%E8%86%A8%E8%83%80.png",
        "https://static.wildfirechat.net/sticker/b/%E6%9C%89%E6%B2%A1%E6%9C%89B%E6%95%B0%EF%BC%8C%E4%BD%A0%E5%BF%83%E9%87%8C%E6%B2%A1%E6%9C%89%E7%82%B9B%E6%95%B0%E5%90%97.png",
        "https://static.wildfirechat.net/sticker/b/%E5%BF%83%E9%87%8C%E6%B2%A1%E6%9C%89%E4%B8%80%E7%82%B9B%E6%95%B0%E5%90%97.jpg",
        "https://static.wildfirechat.net/sticker/b/%E5%A7%94%E5%B1%88%E5%9C%B0%E5%93%AD%E4%BA%86%E8%B5%B7%E6%9D%A5.jpg",
        "https://static.wildfirechat.net/sticker/b/%E5%BF%83%E9%87%8C%E9%9A%BE%E9%81%93%E6%B2%A1%E6%9C%89%E4%B8%80%E7%82%B9B%E6%95%B0%E5%90%97.jpg",
        "https://static.wildfirechat.net/sticker/b/%E8%87%AA%E5%B7%B1%E5%BF%83%E9%87%8C%E6%B2%A1%E6%9C%89%E4%B8%80%E7%82%B9B%E6%95%B0%E5%90%97.jpg",
        "https://static.wildfirechat.net/sticker/b/%E4%BD%A0%E4%BB%A5%E5%89%8D%E4%B8%8D%E6%98%AF%E8%BF%99%E6%A0%B7%E5%AD%90%E7%9A%84.jpg",
        "https://static.wildfirechat.net/sticker/b/%E5%AE%9D%E5%AE%9D%E5%A7%94%E5%B1%88%EF%BC%8C%E4%BD%86%E5%AE%9D%E5%AE%9D%E4%B8%8D%E8%AF%B4.jpg",
        "https://static.wildfirechat.net/sticker/b/%E5%AE%9D%E5%AE%9D%E5%BF%83%E9%87%8C%E8%8B%A6%EF%BC%8C%E4%BD%86%E5%AE%9D%E5%AE%9D%E8%AF%B4%E4%BA%86.png",
        "https://static.wildfirechat.net/sticker/b/%E5%AE%9D%E5%AE%9D%E5%A7%94%E5%B1%88%EF%BC%8C%E5%AE%9D%E5%AE%9D%E5%BF%83%E9%87%8C%E8%8B%A6%EF%BC%8C%E5%AE%9D%E5%AE%9D%E4%B8%8D%E8%AF%B4.jpg",
        "https://static.wildfirechat.net/sticker/b/%E6%9C%AC%E5%AE%9D%E5%AE%9D%E4%B8%8D%E5%BC%80%E5%BF%83%E4%BA%86%EF%BC%8C%E6%9C%AC%E5%AE%9D%E5%AE%9D%E6%9C%89%E5%B0%8F%E6%83%85%E7%BB%AA%E4%BA%86.jpeg"
      ]
    },
    {
      category: "sticker-p",
      poster: "https://static.wildfirechat.net/sticker/p/666.jpg",
      stickers: [
        "https://static.wildfirechat.net/sticker/p/666.jpg",
        "https://static.wildfirechat.net/sticker/p/Android%E5%9F%B9%E8%AE%AD.png",
        "https://static.wildfirechat.net/sticker/p/Android%E5%BC%80%E5%8F%91%E6%B2%A1%E4%BA%BA%E8%A6%81%E4%BA%86.jpg",
        "https://static.wildfirechat.net/sticker/p/MySQL%E4%BB%8E%E5%88%A0%E5%BA%93%E5%88%B0%E8%B7%91%E8%B7%AF.gif",
        "https://static.wildfirechat.net/sticker/p/java%E5%9F%B9%E8%AE%AD.jpg",
        "https://static.wildfirechat.net/sticker/p/%E8%B0%81TM%E6%94%B9%E4%BA%86%E6%88%91%E4%BB%A3%E7%A0%81.jpg",
        "https://static.wildfirechat.net/sticker/p/%E5%8A%A0%E7%8F%AD.gif",
        "https://static.wildfirechat.net/sticker/p/%E4%B8%87%E8%83%BD.jpg",
        "https://static.wildfirechat.net/sticker/p/%E5%85%A8%E8%83%BD.jpg",
        "https://static.wildfirechat.net/sticker/p/%E6%89%93%E6%9D%82.jpg",
        "https://static.wildfirechat.net/sticker/p/%E7%BC%96%E7%A8%8B5%E5%88%86%E9%92%9F%EF%BC%8C%E6%89%AF%E6%B7%A12%E5%B0%8F%E6%97%B6.png",
        "https://static.wildfirechat.net/sticker/p/%E5%86%99%E4%B8%AAJ8%E4%BB%A3%E7%A0%81%EF%BC%8C%E8%80%81%E5%AD%90%E4%B8%8D%E5%B9%B2%E4%BA%86.gif",
        "https://static.wildfirechat.net/sticker/p/%E5%9E%83%E5%9C%BEQQ%EF%BC%8C%E6%AF%81%E6%88%91%E9%9D%92%E6%98%A5%EF%BC%8C%E9%A2%93%E6%88%91%E7%B2%BE%E7%A5%9E%EF%BC%8C%E8%80%97%E6%88%91%E9%92%B1%E8%B4%A2.gif",
        "https://static.wildfirechat.net/sticker/p/%E6%95%B2%E4%BB%A3%E7%A0%81.gif",
        "https://static.wildfirechat.net/sticker/p/%E4%BB%A3%E7%A0%81%E7%8B%97.jpg",
        "https://static.wildfirechat.net/sticker/p/%E5%86%BB%E6%88%90%E7%8B%97.jpg",
        "https://static.wildfirechat.net/sticker/p/%E7%94%B5%E8%84%91%E7%8B%97.jpg",
        "https://static.wildfirechat.net/sticker/p/%E5%92%B1%E5%96%9D%E6%9D%AFJava%E5%86%B7%E9%9D%99%E4%B8%8B.jpg",
        "https://static.wildfirechat.net/sticker/p/%E5%91%A6%EF%BC%8C%E5%86%99bug%E5%91%A2.jpg",
        "https://static.wildfirechat.net/sticker/p/%E5%90%83%E6%88%91%E4%B8%80%E6%8B%9B.jpg",
        "https://static.wildfirechat.net/sticker/p/%E5%9C%9F%E8%B1%AA%E8%80%81%E6%9D%BF.jpg",
        "https://static.wildfirechat.net/sticker/p/%E5%A4%A7%E4%BD%AC%E4%B8%89%E8%BF%9E.png",
        "https://static.wildfirechat.net/sticker/p/%E8%87%AA%E5%B7%B1%E4%B8%8A%E7%BD%91%E6%9F%A5.gif",
        "https://static.wildfirechat.net/sticker/p/%E6%88%91%E5%9C%A8%E6%95%B2%E4%BB%A3%E7%A0%81.jpg",
        "https://static.wildfirechat.net/sticker/p/%E6%89%AB%E7%A0%81%E6%94%B9%E9%9C%80%E6%B1%82.jpg",
        "https://static.wildfirechat.net/sticker/p/%E7%A8%8B%E5%BA%8F%E5%91%98%E6%80%9D%E7%BB%B4.jpg",
        "https://static.wildfirechat.net/sticker/p/%E7%A9%BA%E6%8C%87%E9%92%88%E5%BC%82%E5%B8%B8.jpg",
        "https://static.wildfirechat.net/sticker/p/%E5%86%99%E4%B8%AA%E5%B1%81%E7%9A%84%E4%BB%A3%E7%A0%81.jpg",
        "https://static.wildfirechat.net/sticker/p/%E6%88%91%E6%9D%A5%E5%86%99%E4%BB%A3%E7%A0%81%E4%BA%86.jpg",
        "https://static.wildfirechat.net/sticker/p/%E7%A8%8B%E5%BA%8F%E5%86%99%E5%AE%8C%E4%BA%86%E5%90%97.jpg",
        "https://static.wildfirechat.net/sticker/p/%E7%A8%8B%E5%BA%8F%E7%8C%BF%E7%9A%84%E6%97%A5%E5%B8%B8.jpg",
        "https://static.wildfirechat.net/sticker/p/%E7%A8%8B%E5%BA%8F%E7%8C%BF%E7%9A%84%E6%A0%87%E9%85%8D.jpg",
        "https://static.wildfirechat.net/sticker/p/%E6%88%91%E8%BF%98%E8%83%BD%E5%86%99%E4%BB%A3%E7%A0%81.png",
        "https://static.wildfirechat.net/sticker/p/%E4%BD%A0%E4%BB%96%E5%A6%88%E8%84%91%E8%A2%8B%E6%9C%89bug.jpg",
        "https://static.wildfirechat.net/sticker/p/%E4%BD%A0%E5%8F%88%E5%9C%A8%E5%81%B7%E5%81%B7%E5%86%99bug.jpg",
        "https://static.wildfirechat.net/sticker/p/%E6%88%91%E5%8F%AA%E6%98%AF%E4%B8%AA%E5%B0%8F%E5%AE%89%E5%8D%93.jpg",
        "https://static.wildfirechat.net/sticker/p/%E9%9B%B6%E9%94%99%E8%AF%AF%EF%BC%8C%E9%9B%B6%E7%AD%89%E5%BE%85.jpg",
        "https://static.wildfirechat.net/sticker/p/%E4%BD%9B%E7%A5%96%E4%BF%9D%E4%BD%91%EF%BC%8C%E6%B0%B8%E6%97%A0BUG.png",
        "https://static.wildfirechat.net/sticker/p/%E5%8A%B3%E8%B5%84%E5%86%8D%E4%B9%9F%E4%B8%8D%E5%86%99%E4%BB%A3%E7%A0%81%E4%BA%86.gif",
        "https://static.wildfirechat.net/sticker/p/%E5%9E%83%E5%9C%BE%E8%AF%AD%E8%A8%80%EF%BC%8C%E6%AF%81%E6%88%91%E9%9D%92%E6%98%A5.gif",
        "https://static.wildfirechat.net/sticker/p/%E5%9E%83%E5%9C%BE%E8%BD%AF%E4%BB%B6%EF%BC%8C%E6%AF%81%E6%88%91%E9%9D%92%E6%98%A5.gif",
        "https://static.wildfirechat.net/sticker/p/%E6%88%91%E5%8F%AF%E8%83%BD%E6%98%AF%E4%B8%AA%E5%81%87%E7%A8%8B%E5%BA%8F%E5%91%98.jpg",
        "https://static.wildfirechat.net/sticker/p/%E6%B5%81%E4%B8%8B%E4%BA%86%E6%B2%A1%E6%8A%80%E6%9C%AF%E7%9A%84%E6%B3%AA%E6%B0%B4.jpg",
        "https://static.wildfirechat.net/sticker/p/%E5%88%AB%E8%B7%91%EF%BC%8C%E5%9B%9E%E6%9D%A5%E6%8A%8A%E4%BB%A3%E7%A0%81%E5%86%99%E5%AE%8C.gif",
        "https://static.wildfirechat.net/sticker/p/%E7%9C%9F%E6%AD%A3%E9%9A%90%E4%B8%96%E7%9A%84%E9%AB%98%E6%89%8B%E7%A8%8B%E5%BA%8F%E5%91%98.jpg",
        "https://static.wildfirechat.net/sticker/p/%E7%A0%81%E5%86%9C%E5%92%8C%E4%BA%A7%E5%93%81%E7%BB%8F%E7%90%86%E7%9A%84%E5%8C%BA%E5%88%AB.jpg",
        "https://static.wildfirechat.net/sticker/p/%E5%A6%82%E6%9E%9C%E6%8A%8A%E9%9D%A2%E8%AF%95%E5%AE%98%E5%94%AC%E4%BD%8F%E4%BA%86%E5%B0%B1%E8%A6%8150k%EF%BC%8C%E6%B2%A1%E5%94%AC%E4%BD%8F%E5%B0%B1%E8%A6%815k.png",
        "https://static.wildfirechat.net/sticker/p/%E5%B0%B1%E6%98%AF%E4%BB%96%EF%BC%8C%E4%B8%80%E8%A1%8C%E4%BB%A3%E7%A0%81%EF%BC%8C%E6%8A%A5%E4%B8%89%E4%B8%AA%E9%94%99.jpg",
        "https://static.wildfirechat.net/sticker/p/%E9%AA%9A%E5%B9%B4%E5%87%BA%E6%8B%9B%E5%90%A7%EF%BC%8C%E5%93%A5%E8%AE%A9%E4%BD%A0%E4%B8%89%E8%A1%8C%E4%BB%A3%E7%A0%81.jpg",
        "https://static.wildfirechat.net/sticker/p/%E9%82%A3%E4%B9%88%E5%A5%BD%E7%94%A8%E7%9A%84%E6%A1%86%E6%9E%B6%EF%BC%8C%E8%BF%98%E4%B8%8D%E8%B5%B6%E7%B4%A7%E6%9D%A5Star.jpg",
        "https://static.wildfirechat.net/sticker/p/%E4%BD%A0%E5%B0%B1%E6%98%AF%E6%89%93%E6%AD%BB%E6%88%91%EF%BC%8C%E6%88%91%E4%B9%9F%E4%B8%8D%E6%94%B9%E8%BF%99%E4%B8%AAbug.png",
        "https://static.wildfirechat.net/sticker/p/%E4%BD%A0%E4%BB%AC%E5%A6%82%E6%9E%9C%E8%BF%98%E4%B8%8D%E5%8E%BB%E5%86%99%E4%BB%A3%E7%A0%81%E6%88%91%E5%B0%B1%E5%BC%80%E6%9E%AA%E4%BA%86.jpg",
        "https://static.wildfirechat.net/sticker/p/%E7%AE%97%E6%88%91%E6%B1%82%E4%BD%A0%E7%9A%84%EF%BC%8C%E4%BD%A0%E7%89%B9%E4%B9%88%E5%8E%BB%E5%86%99%E4%BB%A3%E7%A0%81%E5%A5%BD%E4%B8%8D%E5%A5%BD.jpg",
        "https://static.wildfirechat.net/sticker/p/%E5%AF%B9%E6%96%B9%E4%B8%8D%E7%90%86%E4%BD%A0%E7%9A%84%E5%BC%82%E5%B8%B8%EF%BC%8C%E5%BD%93%E4%BD%A0%E9%9D%A2%E5%85%B3%E9%97%AD%E4%BA%86%E7%A8%8B%E5%BA%8F.png",
        "https://static.wildfirechat.net/sticker/p/%E5%AF%B9%E6%96%B9%E4%B8%8D%E6%83%B3%E5%92%8C%E4%BD%A0%E8%AF%B4%E8%AF%9D%EF%BC%8C%E5%B9%B6%E5%90%91%E4%BD%A0%E6%8A%9B%E5%87%BA%E4%BA%86%E4%B8%80%E4%B8%AA%E5%BC%82%E5%B8%B8.jpg",
        "https://static.wildfirechat.net/sticker/p/%E5%AF%B9%E6%96%B9%E4%B8%8D%E6%83%B3%E8%B7%9F%E4%BD%A0%E8%AF%B4%E8%AF%9D%EF%BC%8C%E5%B9%B6%E5%90%91%E4%BD%A0%E6%89%94%E4%BA%86%E4%B8%80%E4%BB%BD%E9%B8%9F%E5%93%A5%E8%AF%AD%E5%BD%95.jpg",
        "https://static.wildfirechat.net/sticker/p/%E5%9C%A8%E4%BD%A0%E4%BB%AC%E8%81%8A%E5%A4%A9%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E6%88%91%E5%B7%B2%E7%BB%8F%E5%86%99%E4%BA%86%E5%A5%BD%E5%87%A0%E4%B8%87%E8%A1%8C%E4%BB%A3%E7%A0%81%E4%BA%86.gif",
        "https://static.wildfirechat.net/sticker/p/%E5%AF%B9%E6%96%B9%E5%90%91%E4%BD%A0%E4%B8%A2%E4%BA%86%E4%B8%80%E5%A0%86%E7%A5%9E%E7%A7%98%E4%BB%A3%E7%A0%81%EF%BC%8C%E5%8F%AF%E6%98%AF%E4%BD%A0%E5%8D%B4%E4%B8%8D%E8%83%BD%E5%A4%8D%E5%88%B6.jpg",
        "https://static.wildfirechat.net/sticker/p/%E5%90%8C%E5%BF%97%E5%BF%AB%E9%86%92%E9%86%92%EF%BC%8C%E4%BD%A0%E8%BF%98%E6%9C%89%E4%B8%80%E4%B8%B2%E4%BB%A3%E7%A0%81%E6%8F%90%E7%A4%BA%E9%94%99%E8%AF%AF%EF%BC%8C%E8%B5%B7%E6%9D%A5%E6%94%B9%E6%94%B9.jpg",
        "https://static.wildfirechat.net/sticker/p/%E5%9B%9E%E5%8E%BB%E5%86%99%E4%BB%A3%E7%A0%81%EF%BC%8C%E8%B0%81%E8%AE%A9%E4%BD%A0%E8%B7%91%E5%87%BA%E6%9D%A5%E8%A3%85%E9%80%BC%E7%9A%84%EF%BC%8C%E7%9C%8B%E6%88%91%E4%B8%8D%E6%89%93%E6%AD%BB%E4%BD%A0.jpg"
      ]
    }
  ];
  const _sfc_main$1i = {
    name: "AudioInputView",
    props: {
      conversationInfo: {
        type: Object,
        required: true
      }
    },
    data() {
      return {
        popupToggle: false,
        isRecording: false,
        canSend: true,
        text: "按住说话",
        recorderManager: null,
        title: " ",
        recordTime: 0,
        recordTimer: null,
        longPressClientY: 0
      };
    },
    mounted() {
      recorderManager.onStop((res) => {
        clearInterval(this.recordTimer);
        let duration = res.duration ? res.duration / 1e3 : this.recordTime * 1e3;
        uni.hideLoading();
        if (this.canSend) {
          if (duration < 1e3) {
            uni.showToast({
              title: "录音时间太短",
              icon: "none"
            });
          } else {
            let filePath = plus.io.convertLocalFileSystemURL(res.tempFilePath);
            let soudMessageContent = new SoundMessageContent(filePath, "", this.recordTime);
            wfc.sendConversationMessage(this.conversationInfo.conversation, soudMessageContent);
          }
        }
        this.popupToggle = false;
        this.isRecording = false;
        this.canSend = true;
        this.title = " ";
        this.text = "按住说话";
      });
    },
    methods: {
      async handleLongPress(e) {
        this.longPressClientY = e.changedTouches[e.changedTouches.length - 1].clientY;
        this.popupToggle = true;
        recorderManager.start({
          duration: 6e4,
          // 录音的时长，单位 ms，最大值 600000（10 分钟）
          sampleRate: 44100,
          // 采样率
          // numberOfChannels: 1,
          // 录音通道数
          // encodeBitRate: 192000,
          // 编码码率
          format: "mp3"
          // aac 音频格式，选择此格式创建的音频消息，可以在即时通信 IM 全平台（Android、iOS、微信小程序和Web）互通
        });
        this.startPoint = e.target;
        this.title = "正在录音";
        this.isRecording = true;
        this.recordTime = 0;
        this.recordTimer = setInterval(() => {
          this.recordTime++;
        }, 1e3);
      },
      // 录音时的手势上划移动距离对应文案变化
      handleTouchMove(e) {
        if (this.isRecording) {
          if (Math.abs(this.longPressClientY - e.changedTouches[e.changedTouches.length - 1].clientY) > 100) {
            this.text = "抬起停止";
            this.title = "松开手指，取消发送";
            this.canSend = false;
          } else if (Math.abs(this.longPressClientY - e.changedTouches[e.changedTouches.length - 1].clientY) > 20) {
            this.text = "抬起停止";
            this.title = "上划可取消";
            this.canSend = true;
          } else {
            this.text = "抬起停止";
            this.title = "正在录音";
            this.canSend = true;
          }
        }
      },
      // 手指离开页面滑动
      handleTouchEnd() {
        this.isRecording = false;
        this.popupToggle = false;
        this.text = "按住说话";
        uni.hideLoading();
        recorderManager.stop();
      }
    }
  };
  function _sfc_render$1h(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock(
      "view",
      {
        class: "TUI-message-input-main",
        onLongpress: _cache[3] || (_cache[3] = (...args) => $options.handleLongPress && $options.handleLongPress(...args)),
        onTouchmove: _cache[4] || (_cache[4] = (...args) => $options.handleTouchMove && $options.handleTouchMove(...args)),
        onTouchend: _cache[5] || (_cache[5] = (...args) => $options.handleTouchEnd && $options.handleTouchEnd(...args))
      },
      [
        vue.createElementVNode(
          "text",
          null,
          vue.toDisplayString($data.text),
          1
          /* TEXT */
        ),
        $data.popupToggle ? (vue.openBlock(), vue.createElementBlock(
          "view",
          {
            key: 0,
            class: "record-modal",
            onLongpress: _cache[0] || (_cache[0] = (...args) => $options.handleLongPress && $options.handleLongPress(...args)),
            onTouchmove: _cache[1] || (_cache[1] = (...args) => $options.handleTouchMove && $options.handleTouchMove(...args)),
            onTouchend: _cache[2] || (_cache[2] = (...args) => $options.handleTouchEnd && $options.handleTouchEnd(...args))
          },
          [
            vue.createElementVNode("view", { class: "wrapper" }, [
              vue.createElementVNode("view", { class: "modal-loading" })
            ]),
            vue.createElementVNode(
              "view",
              { class: "modal-title" },
              vue.toDisplayString($data.title),
              1
              /* TEXT */
            )
          ],
          32
          /* NEED_HYDRATION */
        )) : vue.createCommentVNode("v-if", true)
      ],
      32
      /* NEED_HYDRATION */
    );
  }
  const AudioInputView = /* @__PURE__ */ _export_sfc(_sfc_main$1i, [["render", _sfc_render$1h], ["__scopeId", "data-v-3e75fb0b"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/AudioInputView.vue"]]);
  class PttEventType {
  }
  //某人开始在频道中讲话
  // function (conversation, userId) {}
  __publicField(PttEventType, "userStartTalking", "userStartTalking");
  //某人结束在频道中讲话
  // function (conversation, userId) {}
  __publicField(PttEventType, "userEndTalking", "userEndTalking");
  //接收到用户自定义数据
  // function (conversation, userId, data) {}
  __publicField(PttEventType, "receiveData", "receiveData");
  //用户说话音量大小回调
  // function (conversation, userId, averageAmplitude) {}
  __publicField(PttEventType, "userAmplitudeUpdate", "userAmplitudeUpdate");
  class PttSoundMessageContent extends SoundMessageContent {
    constructor(file, duration) {
      super(file, null, duration);
      this.type = 23;
    }
    digest(message2) {
      return "[对讲语音]";
    }
    encode() {
      let payload = super.encode();
      payload.searchableContent = "[对讲语音]";
      return payload;
    }
    decode(payload) {
      super.decode(payload);
    }
  }
  const uniWfcPttClient = Config.ENABLE_PTT ? requireNativePlugin("wf-uni-wfc-pttclient") : null;
  const _PttClient = class _PttClient {
    constructor() {
      __publicField(this, "eventEmitter", new eventsExports.EventEmitter());
      __publicField(this, "_nativeEvent2WfcEvent", {
        "onChannelInfoUpdate": this.onChannelInfoUpdate,
        "onClearMessage": null,
        "onConferenceEvent": this.onConferenceEvent,
        "onConnectToServer": this.onConnectToServer,
        "onConnectionStatusChange": this.onConnectionChanged,
        "onConversationDraftUpdate": null,
        "onDeleteMessage": this.onDeleteRemoteMessage,
        "onFriendListUpdate": this.onFriendListUpdate,
        "onFriendRequestUpdate": this.onFriendRequestUpdate,
        "onGroupInfoUpdate": this.onGroupInfoUpdate,
        "onGroupMembersUpdate": this.onGroupMemberUpdateListener,
        "onServiceConnected": null,
        "onMessageDelivered": this.onUserReceivedMessage,
        "onMessageRead": this.onUserReadedMessage,
        "onMessageUpdate": this.onMessageUpdate,
        "onReceiveMessage": this.onReceiveMessage,
        "onRecallMessage": this.onRecallMessage,
        "onConversationRemove": null,
        "onSettingUpdate": this.onSettingUpdate,
        "onTrafficData": null,
        "onUserInfoUpdate": this.onUserInfoUpdate,
        "onUserOnlineEvent": this.onOnlineEvent,
        // sendMessageListener
        "onSendSuccess": this.onSendSuccess,
        "onSendFail": this.onSendFail,
        "onSendPrepare": this.onSendPrepare,
        "onProgress": this.onProgress,
        "onMediaUpload": this.onMediaUpload
      });
    }
    isPttClientEnable() {
      return !!uniWfcPttClient;
    }
    // 初始化
    init() {
      uniWfcPttClient.initClient({
        enableFullDuplex: _PttClient.ENABLE_FULL_DUPLEX,
        enableGlobalPtt: _PttClient.ENABLE_GLOBAL_PTT,
        enablePriorityMode: _PttClient.ENABLE_PRIORITY_MODE,
        groupChatMaxSpeakTime: _PttClient.GROUP_CHAT_MAX_SPEAK_TIME,
        groupChatMaxSpeakerCount: _PttClient.GROUP_CHAT_MAX_SPEAKER_COUNT,
        groupChatSaveVoiceMessage: _PttClient.SINGLE_CHAT_SEND_VOICE_MESSAGE,
        singleChatMaxSpeakTime: _PttClient.SINGLE_CHAT_MAX_SPEAK_TIME,
        singleChatMaxSpeakerCount: _PttClient.SINGLE_CHAT_MAX_SPEAKER_COUNT,
        singleChatSaveVoiceMessage: _PttClient.SINGLE_CHAT_SEND_VOICE_MESSAGE
      });
      plus.globalEvent.addEventListener("wfc-ptt-event", (e) => {
        self$4._handleNativeEvent(e);
      });
      wfc.registerMessageContent("pttSoundMessage", PersistFlag.Persist_And_Count, 23, PttSoundMessageContent);
    }
    uninit() {
    }
    /**
     * 请求说话
     * @param conversation
     * @param {Number} priority 对讲优先级，默认优先级都是0，数字越高，优先级越高
     * @param {TalkingCallback} talkingCallback
     */
    requestTalk(conversation2, priority, talkingCallback) {
      let strConv = JSON.stringify(conversation2);
      uniWfcPttClient.requestTalk(
        strConv,
        priority,
        (args) => {
          talkingCallback && talkingCallback.onStartTalking(conversation2);
        },
        (args) => {
          talkingCallback && talkingCallback.onTalkingEnd(conversation2);
        },
        (args) => {
          talkingCallback && talkingCallback.onRequestFail(conversation2, args[1]);
        },
        (args) => {
          talkingCallback && talkingCallback.onAmplitudeUpdate(conversation2, args[1]);
        }
      );
    }
    // 说话结束
    releaseTalking(conversation2) {
      let strConv = JSON.stringify(conversation2);
      uniWfcPttClient.releaseTalking(strConv);
    }
    /**
     * 获取频道允许同时说话人数
     */
    getMaxSpeakCount(conversation2) {
      let strConv = JSON.stringify(conversation2);
      return uniWfcPttClient.getMaxSpeakCount(strConv);
    }
    isSendVoiceMessage(conversation2) {
    }
    getMaxSpeakTime(conversation2) {
      let strConv = JSON.stringify(conversation2);
      return uniWfcPttClient.getMaxSpeakTime(strConv);
    }
    setSendVoiceMessage(conversation2, send, successCB, failCB) {
      let strConv = JSON.stringify(conversation2);
      uniWfcPttClient.setSaveVoiceMessage(strConv, !!send, () => {
        successCB && successCB();
      }, (err) => {
        failCB && failCB(err);
      });
    }
    setConversationMaxSpeakTime(conversation2, duration, successCB, failCB) {
      let strConv = JSON.stringify(conversation2);
      uniWfcPttClient.setConversationMaxSpeakTime(strConv, duration, () => {
        successCB && successCB();
      }, (err) => {
        failCB && failCB(err);
      });
    }
    setConversationMaxSpeakerCount(conversation2, count, successCB, failCB) {
      let strConv = JSON.stringify(conversation2);
      uniWfcPttClient.setConversationMaxSpeakerCount(strConv, count, () => {
        successCB && successCB();
      }, (err) => {
        failCB && failCB(err);
      });
    }
    setConversationPttSilent(conversation2, silent, successCB, failCB) {
      let strConv = JSON.stringify(conversation2);
      uniWfcPttClient.setConversationPttSilent(strConv, !!silent, () => {
        successCB && successCB();
      }, (err) => {
        failCB && failCB(err);
      });
    }
    isConversationPttSilent(conversation2) {
      let strConv = JSON.stringify(conversation2);
      return uniWfcPttClient.isConversationPttSilent(strConv);
    }
    getTalkingConversation() {
    }
    getTalkingStartTime() {
      return uniWfcPttClient.getTalkingStartTime();
    }
    getTalkingMembers(conversation2) {
      let strConv = JSON.stringify(conversation2);
      let members = uniWfcPttClient.getTalkingMembers(strConv);
      return JSON.parse(members);
    }
    getTalkingMemberCount(conversation2) {
      let strConv = JSON.stringify(conversation2);
      return uniWfcPttClient.getTalkingMemberCount(strConv);
    }
    setEnablePtt(conversation2, enable) {
      let strConv = JSON.stringify(conversation2);
      uniWfcPttClient.setEnablePtt(strConv, !!enable);
    }
    _handleNativeEvent(e) {
      let args = e.args;
      formatAppLog("log", "at wfc/ptt/pttClient.js:236", "native ptt event", e.args);
      let conversation2 = Object.assign(new Conversation(), JSON.parse(args[1]));
      this.eventEmitter.emit(args[0], conversation2, ...args.slice(2));
    }
    _eventTest() {
      this.eventEmitter.on(PttEventType.userStartTalking, (conversation2, userId) => {
        formatAppLog("log", "at wfc/ptt/pttClient.js:258", "userStartTalking", conversation2, userId);
      });
      this.eventEmitter.on(PttEventType.userEndTalking, (conversation2, userId) => {
        formatAppLog("log", "at wfc/ptt/pttClient.js:261", "userEndTalking", conversation2, userId);
      });
      this.eventEmitter.on(PttEventType.receiveData, (conversation2, userId, data) => {
        formatAppLog("log", "at wfc/ptt/pttClient.js:264", "receiveData", conversation2, userId, data);
      });
      this.eventEmitter.on(PttEventType.userAmplitudeUpdate, (conversation2, userId, averageAmplitude) => {
        formatAppLog("log", "at wfc/ptt/pttClient.js:267", "userAmplitudeUpdate", conversation2, userId, averageAmplitude);
      });
    }
  };
  /**
   * 只在正常模式下生效
   * 单聊会话里面，最多允许几个人同时说话
   */
  __publicField(_PttClient, "SINGLE_CHAT_MAX_SPEAKER_COUNT", 1);
  /**
   * 只在正常模式下生效
   * 群会话里面，最多允许几个人同时说话
   */
  __publicField(_PttClient, "GROUP_CHAT_MAX_SPEAKER_COUNT", 3);
  // 对讲时，是否发送额外的语音消息
  __publicField(_PttClient, "SINGLE_CHAT_SEND_VOICE_MESSAGE", true);
  __publicField(_PttClient, "GROUP_CHAT_SEND_VOICE_MESSAGE", true);
  /**
   * 单位是秒
   */
  __publicField(_PttClient, "SINGLE_CHAT_MAX_SPEAK_TIME", 60);
  /**
   * 单位是秒
   */
  __publicField(_PttClient, "GROUP_CHAT_MAX_SPEAK_TIME", 60);
  /**
   * 对讲模式
   * 默认是正常模式
   * 1. 正常模式，用户可以同时播放多路对讲，一个会话里面，可以配置允许多个人同时说话
   * 2. 优先级模式，用户只能播放优先级最高的那路对讲，一个会话里面，只允许一个人说话
   */
  __publicField(_PttClient, "ENABLE_PRIORITY_MODE", false);
  /**
   * 全局开启对讲功能，为false时，会话需要分别开启 {@link PTTClient#setEnablePtt}
   */
  __publicField(_PttClient, "ENABLE_GLOBAL_PTT", true);
  //  是否支持双工模式，双工模式下，说话的时候，允许收听其他人的说话。
  __publicField(_PttClient, "ENABLE_FULL_DUPLEX", false);
  let PttClient = _PttClient;
  const self$4 = new PttClient();
  class TalkingCallback {
    // 对讲优先级，默认优先级都是0，数字越高，优先级越高
    talkingPriority(conversation2) {
      formatAppLog("log", "at wfc/ptt/talkingCallback.js:6", "talkingPriority", conversation2);
      return 0;
    }
    //可以开始讲话了
    onStartTalking(conversation2) {
      formatAppLog("log", "at wfc/ptt/talkingCallback.js:12", "onStartTalking", conversation2);
    }
    //reason包括超时，被禁言，被强制抢麦等
    onTalkingEnd(conversation2, reason) {
      formatAppLog("log", "at wfc/ptt/talkingCallback.js:17", "onTalkingEnd", conversation2, reason);
    }
    //errorCode包括单工模式下没有抢到麦，全工模式下超过最大发言人数，被禁言。
    onRequestFail(conversation2, errorCode) {
      formatAppLog("log", "at wfc/ptt/talkingCallback.js:22", "onRequestFail", conversation2, errorCode);
    }
    // 说话音量通知，每400秒通知一次
    // 暂不支持
    onAmplitudeUpdate(averageAmplitude) {
      formatAppLog("log", "at wfc/ptt/talkingCallback.js:28", "onAmplitudeUpdate", averageAmplitude);
    }
    /**
     * 默认发送的是 PTTSoundMessageContent，正常不用修改
     * @param conversation
     * @param {File | string} fileOrLocalPath File类型，或者dataUri或者本地路径，本地路径是必须是绝对路径
     * @param {number} duration
     */
    onCreateSoundMessageContent(conversation2, fileOrLocalPath, duration) {
    }
  }
  const _sfc_main$1h = {
    name: "PttAudioInputView",
    props: {
      conversationInfo: {
        type: Object,
        required: true
      }
    },
    data() {
      return {
        popupToggle: false,
        isPttRecording: false,
        text: "按住对讲",
        title: " ",
        recordTime: 0,
        recordTimer: null,
        longPressClientY: 0
      };
    },
    mounted() {
    },
    methods: {
      async handleLongPress(e) {
        this.longPressClientY = e.changedTouches[e.changedTouches.length - 1].clientY;
        this.popupToggle = true;
        let talkingCallBack = new TalkingCallback();
        talkingCallBack.onAmplitudeUpdate = (averageAmplitude) => {
        };
        talkingCallBack.onTalkingEnd = (conversation2) => {
          this.isPttRecording = false;
          this.popupToggle = false;
          this.text = "按住对讲";
        };
        talkingCallBack.onStartTalking = (conversation2) => {
          this.title = "正在对讲";
          this.text = "正在对讲";
          this.isPttRecording = true;
          this.recordTime = 0;
          this.recordTimer = setInterval(() => {
            this.recordTime++;
          }, 1e3);
        };
        talkingCallBack.onRequestFail = (conversation2, errorCode) => {
          this.isPttRecording = false;
          this.popupToggle = false;
          this.text = "按住对讲";
        };
        self$4.requestTalk(this.conversationInfo.conversation, 0, talkingCallBack);
        this.startPoint = e.target;
      },
      // 录音时的手势上划移动距离对应文案变化
      handleTouchMove(e) {
        if (this.isPttRecording) {
          this.title = "正在对讲";
        }
      },
      // 手指离开页面滑动
      handleTouchEnd() {
        this.isPttRecording = false;
        this.popupToggle = false;
        this.text = "按住对讲";
        formatAppLog("log", "at pages/conversation/message/PttAudioInputView.vue:121", "xxxx handleTouchEnd");
        self$4.releaseTalking(this.conversationInfo.conversation);
      }
    }
  };
  function _sfc_render$1g(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock(
      "view",
      {
        class: "TUI-message-input-main",
        onLongpress: _cache[3] || (_cache[3] = (...args) => $options.handleLongPress && $options.handleLongPress(...args)),
        onTouchmove: _cache[4] || (_cache[4] = (...args) => $options.handleTouchMove && $options.handleTouchMove(...args)),
        onTouchend: _cache[5] || (_cache[5] = (...args) => $options.handleTouchEnd && $options.handleTouchEnd(...args))
      },
      [
        vue.createElementVNode(
          "text",
          null,
          vue.toDisplayString($data.text),
          1
          /* TEXT */
        ),
        $data.popupToggle ? (vue.openBlock(), vue.createElementBlock(
          "view",
          {
            key: 0,
            class: "record-modal",
            onLongpress: _cache[0] || (_cache[0] = (...args) => $options.handleLongPress && $options.handleLongPress(...args)),
            onTouchmove: _cache[1] || (_cache[1] = (...args) => $options.handleTouchMove && $options.handleTouchMove(...args)),
            onTouchend: _cache[2] || (_cache[2] = (...args) => $options.handleTouchEnd && $options.handleTouchEnd(...args))
          },
          [
            vue.createElementVNode("view", { class: "wrapper" }, [
              vue.createElementVNode("view", { class: "modal-loading" })
            ]),
            vue.createElementVNode(
              "view",
              { class: "modal-title" },
              vue.toDisplayString($data.title),
              1
              /* TEXT */
            )
          ],
          32
          /* NEED_HYDRATION */
        )) : vue.createCommentVNode("v-if", true)
      ],
      32
      /* NEED_HYDRATION */
    );
  }
  const PttAudioInputView = /* @__PURE__ */ _export_sfc(_sfc_main$1h, [["render", _sfc_render$1g], ["__scopeId", "data-v-738674c6"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/PttAudioInputView.vue"]]);
  class CallSession {
    constructor() {
      //通话ID
      __publicField(this, "callId");
      __publicField(this, "title");
      __publicField(this, "desc");
      //通话的发起者，如果发起者离开，会重新选举出最早加入者为发起者
      __publicField(this, "initiator");
      //邀请当前用户加入通话的用户
      __publicField(this, "inviter");
      //通话状态
      __publicField(this, "state");
      //开始时间
      __publicField(this, "startTime");
      //接通时间
      __publicField(this, "connectedTime");
      //结束时间
      __publicField(this, "endTime");
      //会话
      __publicField(this, "conversation");
      //是否是音频
      __publicField(this, "audioOnly");
      //通话结束原因
      __publicField(this, "endReason");
      //是否是会议
      __publicField(this, "conference");
      //是否是观众，仅当会议有效
      __publicField(this, "audience");
      //是否是超级会议
      __publicField(this, "advanced");
      //是否是多人通话
      __publicField(this, "multiCall");
      // 是否关闭摄像头
      __publicField(this, "videoMuted");
      // 是否关闭麦克风
      __publicField(this, "audioMuted");
    }
  }
  //call状态
  __publicField(CallSession, "kWFAVEngineStateIdle", 0);
  __publicField(CallSession, "kWFAVEngineStateOutgoing", 1);
  __publicField(CallSession, "kWFAVEngineStateIncomming", 2);
  __publicField(CallSession, "kWFAVEngineStateConnecting", 3);
  __publicField(CallSession, "kWFAVEngineStateConnected", 4);
  //通话结束原因
  __publicField(CallSession, "kWFAVCallEndReasonUnknown", 0);
  __publicField(CallSession, "kWFAVCallEndReasonBusy", 1);
  __publicField(CallSession, "kWFAVCallEndReasonSignalError", 2);
  __publicField(CallSession, "kWFAVCallEndReasonHangup", 3);
  __publicField(CallSession, "kWFAVCallEndReasonMediaError", 4);
  __publicField(CallSession, "kWFAVCallEndReasonRemoteHangup", 5);
  __publicField(CallSession, "kWFAVCallEndReasonOpenCameraFailure", 6);
  __publicField(CallSession, "kWFAVCallEndReasonTimeout", 7);
  __publicField(CallSession, "kWFAVCallEndReasonAcceptByOtherClient", 8);
  __publicField(CallSession, "kWFAVCallEndReasonAllLeft", 9);
  __publicField(CallSession, "kWFAVCallEndReasonRemoteBusy", 10);
  __publicField(CallSession, "kWFAVCallEndReasonRemoteTimeout", 11);
  __publicField(CallSession, "kWFAVCallEndReasonRemoteNetworkError", 12);
  __publicField(CallSession, "kWFAVCallEndReasonRoomDestroyed", 13);
  __publicField(CallSession, "kWFAVCallEndReasonRoomNotExist", 14);
  __publicField(CallSession, "kWFAVCallEndReasonRoomParticipantsFull", 15);
  class AvengineCallback {
    constructor() {
      __publicField(this, "innerAudioContext");
    }
    onReceiveCall(session) {
      formatAppLog("log", "at wfc/av/engine/avengineCallback.js:8", "onReceiveCall", session);
      if (typeof session === "string") {
        session = Object.assign(new CallSession(), JSON.parse(session));
      }
      let url;
      if (session.conversation.type === ConversationType.Single) {
        url = "/pages/voip/Single";
      } else if (session.conversation.type === ConversationType.Group) {
        url = "/pages/voip/Multi";
      }
      url += `?session=${JSON.stringify(session)}`;
      if (url) {
        uni.navigateTo({
          url,
          success: (res) => {
            formatAppLog("log", "at wfc/av/engine/avengineCallback.js:24", `navigate to ${url} success`);
            res.eventChannel.emit("options", {
              callSession: session
            });
          },
          fail: (e) => {
            formatAppLog("log", "at wfc/av/engine/avengineCallback.js:30", `navigate to ${url} error`, e);
          }
        });
      }
    }
    shouldStartRing(isIncoming) {
      self$3.innerAudioContext = uni.createInnerAudioContext();
      self$3.innerAudioContext.src = isIncoming ? "/static/audios/incoming_call_ring.mp3" : "/static/audios/outgoing_call_ring.mp3";
      self$3.innerAudioContext.autoplay = true;
      self$3.innerAudioContext.loop = true;
      self$3.innerAudioContext.play();
      self$3.innerAudioContext.onPlay(() => {
        formatAppLog("log", "at wfc/av/engine/avengineCallback.js:43", "开始播放");
      });
      self$3.innerAudioContext.onError((e) => {
        formatAppLog("error", "at wfc/av/engine/avengineCallback.js:46", "播放响铃失败", e);
      });
    }
    shouldStopRing() {
      formatAppLog("log", "at wfc/av/engine/avengineCallback.js:51", "shouldStopRing");
      self$3.innerAudioContext.stop();
      self$3.innerAudioContext.destroy();
      self$3.innerAudioContext = null;
    }
    didCallEnded(reason, duration) {
      formatAppLog("log", "at wfc/av/engine/avengineCallback.js:59", "didCallEnded", reason, duration);
      let pages = getCurrentPages();
      let singleVoipRoute = "pages/voip/Single";
      let multiVoipRoute = "pages/voip/Multi";
      let conferenceVoipRoute = "pages/voip/conference/ConferencePage";
      let curRoute = pages[pages.length - 1].route;
      if (curRoute === singleVoipRoute || curRoute === multiVoipRoute || curRoute === conferenceVoipRoute) {
        uni.navigateBack({
          delta: 1,
          fail: (err) => {
            formatAppLog("log", "at wfc/av/engine/avengineCallback.js:70", "nav back to conversationView err", err);
          }
        });
      }
    }
  }
  let self$3 = new AvengineCallback();
  class ParticipantProfile {
    constructor() {
      __publicField(this, "userId");
      __publicField(this, "callExtra");
      __publicField(this, "state");
      __publicField(this, "joinTime", 0);
      __publicField(this, "acceptTime", 0);
      __publicField(this, "audioMuted", false);
      __publicField(this, "videoMuted", false);
      __publicField(this, "audience", false);
      __publicField(this, "screenSharing", false);
    }
  }
  const avengineKitPlugin = null;
  class AVEngineKit {
    constructor() {
      __publicField(this, "avengineCallback", self$3);
      __publicField(this, "sessionCallback");
    }
    /**
     * 判断 UIKit 原生插件是否集成
     * @return {boolean}
     */
    isAVEngineKitEnable() {
      return !!avengineKitPlugin;
    }
    init() {
      avengineKitPlugin.initAVEngineKit();
      plus.globalEvent.addEventListener("wfc-av-event", (e) => {
        self$2._handleNativeAVEngineEvent(e);
      });
      plus.globalEvent.addEventListener("wfc-av-session-event", (e) => {
        self$2._handleNativeCallSessionEvent(e);
      });
    }
    _handleNativeAVEngineEvent(e) {
      let args = e.args;
      if (this.avengineCallback) {
        let func = this.avengineCallback[args[0]];
        if (func) {
          func(...args.slice(1));
        }
      } else {
        formatAppLog("warn", "at wfc/av/engine/avengineKit.js:48", "_handleNativeAVEngineEvent avengineCallback is null", args);
      }
    }
    _handleNativeCallSessionEvent(e) {
      let args = e.args;
      if (args[0] !== "didReportAudioVolume") {
        formatAppLog("log", "at wfc/av/engine/avengineKit.js:55", "_handleNativeCallSessionEvent", args);
      }
      if (args[0] === "resumeVoipPage") {
        let session = this.currentCallSession();
        if (session) {
          this._resumeVoipPage(session);
        }
        return;
      }
      if (this.sessionCallback) {
        let func = this.sessionCallback[args[0]];
        if (func) {
          if (args[0] === "didChangeState") {
            func(Number(args[1]));
          } else if (args[0] === "didCallEndWithReason") {
            func(Number(args[1]));
          } else {
            func(...args.slice(1));
          }
        }
      } else {
        formatAppLog("warn", "at wfc/av/engine/avengineKit.js:77", "_handleNativeCallSessionEvent sessionCallback is null", args);
      }
    }
    _resumeVoipPage(session) {
      formatAppLog("log", "at wfc/av/engine/avengineKit.js:82", "_resumeVoipPage", session);
      let url;
      if (session.conference) {
        url = "/pages/voip/conference/ConferencePage";
      } else if (session.conversation.type === ConversationType.Single) {
        url = "/pages/voip/Single";
      } else if (session.conversation.type === ConversationType.Group) {
        url = "/pages/voip/Multi";
      }
      url += `?session=${JSON.stringify(session)}`;
      if (url) {
        uni.navigateTo({
          url,
          success: (res) => {
            formatAppLog("log", "at wfc/av/engine/avengineKit.js:96", `navigate to ${url} success`);
          },
          fail: (e) => {
            formatAppLog("log", "at wfc/av/engine/avengineKit.js:99", `navigate to ${url} error`, e);
          }
        });
      }
    }
    setSessionCallback(cb) {
      this.sessionCallback = cb;
    }
    /**
     * 发起单人音视频通话
     * @param {string} userId 用户 id
     * @param {boolean} audioOnly 是否是音频通话
     * @return {CallSession}
     */
    startSingleCall(userId, audioOnly) {
      let sessionStr = avengineKitPlugin.startSingleCall(userId, audioOnly);
      return !sessionStr ? null : Object.assign(new CallSession(), JSON.parse(sessionStr));
    }
    /**
     * 发起群音视频通话
     * @param {string} groupId 群 id
     * @param {[string]} participants 参与者 id，要求是群成员
     * @param {boolean} audioOnly 是否是音频通话
     * @return {CallSession}
     */
    startMultiCall(groupId, participants, audioOnly) {
      let sessionStr = avengineKitPlugin.startMultiCall(groupId, participants, audioOnly);
      return !sessionStr ? null : Object.assign(new CallSession(), JSON.parse(sessionStr));
    }
    /**
     * 开始会议
     * @param {string} callId 会议id
     * @param {boolean} audioOnly 是否仅仅开启音频; true，音频会议；false，视频会议
     * @param {string} pin 入会pin码
     * @param {string} host 主持人用户id
     * @param {string} title 会议标题
     * @param {string} desc 会议描述
     * @param {boolean} audience 其他人加入会议时，是否默认为观众；true，默认为观众；false，默认为互动者
     * @param {boolean} advance 是否为高级会议，当预计参与人员很多的时候，开需要开启超级会议
     * @param {boolean} record 是否开启服务端录制
     * @param {string} callExtra  通话附件信息，会议的所有参与者都能看到该附加信息
     * @return {CallSession}
     */
    startConference(callId, audioOnly, pin, host, title, desc, audience, advance, record2 = false, callExtra = "") {
      let sessionStr = avengineKitPlugin.startConference(callId, audioOnly, pin, host, title, desc, audience, advance, record2, callExtra);
      return !sessionStr ? null : Object.assign(new CallSession(), JSON.parse(sessionStr));
    }
    /**
     * 加入会议
     * @param {string} callId 会议id
     * @param {boolean} audioOnly 是否只开启音频
     * @param {string} pin 会议pin码
     * @param {string} host 会议主持人
     * @param {string} title 会议标题
     * @param {string} desc 会议描述
     * @param {boolean} audience 是否是以观众角色入会
     * @param {boolean} advance 是否是高级会议
     * @param {boolean} muteAudio 是否是静音加入会议
     * @param {boolean} muteVideo 是否是关闭摄像头加入会议
     * @param {string} callExtra 通话附加信息，会议的所有参与者都能看到该附加信息
     * @return {CallSession}
     */
    joinConference(callId, audioOnly, pin, host, title, desc, audience, advance, muteAudio, muteVideo, callExtra = "") {
      let sessionStr = avengineKitPlugin.joinConference(callId, audioOnly, pin, host, title, desc, audience, advance, muteAudio, muteVideo, callExtra);
      return !sessionStr ? null : Object.assign(new CallSession(), JSON.parse(sessionStr));
    }
    /**
     * 离开会议
     * @param {string} callId 会议id
     * @param {boolean} destroyRoom 是否销毁会议，主持有效
     */
    leaveConference(callId, destroyRoom = false) {
      avengineKitPlugin.leaveConference(callId, destroyRoom);
    }
    /**
     * 仅会议版有效
     *
     * 将参与者踢出会议
     *
     * @param {string} callId 会议 id
     * @param userId
     * @param successCB
     * @param failCB
     */
    kickoffParticipant(callId, userId, successCB, failCB) {
      avengineKitPlugin.kickoffParticipant(callId, userId, () => {
        successCB && successCB();
      }, (err) => {
        failCB && failCB(err);
      });
    }
    /**
     *  仅会议版有效
     * 设置参与者的 videoType
     * @param {string} callId 通话 id
     * @param {string} userId 用户 id
     * @param {boolean} screenSharing 是否是屏幕共享
     * @param {number} videoType 视频流类型，可选值参考{@link VideoType}
     */
    setParticipantVideoType(callId, userId, screenSharing, videoType) {
      formatAppLog("log", "at wfc/av/engine/avengineKit.js:208", "setParticipantVideoType", userId, screenSharing, videoType);
      avengineKitPlugin.setParticipantVideoType(callId, userId, screenSharing, videoType);
    }
    /**
     * 判断是否支持多人音视频通话
     * @return {boolean}
     */
    isSupportMultiCall() {
      return avengineKitPlugin.isSupportMultiCall();
    }
    /**
     * 判断是否支持会议
     * @return {boolean}
     */
    isSupportConference() {
      return avengineKitPlugin.isSupportConference();
    }
    /**
     * 设置视频通话时的视频属性
     * @param {number} profile 可选值参考{@link VideoProfile}
     * @param {boolean} swapWidthHeight 是否交换宽高，默认不不用设置
     */
    setVideoProfile(profile, swapWidthHeight = false) {
      avengineKitPlugin.setVideoProfile(profile, swapWidthHeight);
    }
    /**
     * 添加 ICE Server
     * @param {string} url
     * @param {string} name
     * @param {string} password
     */
    addICEServer(url, name, password) {
      avengineKitPlugin.addICEServer(url, name, password);
    }
    /**
     * 获取当前通话会话
     *
     * @@return {callSession}
     */
    currentCallSession() {
      let result = avengineKitPlugin.currentCallSession();
      if (result === "") {
        return null;
      }
      return Object.assign(new CallSession(), JSON.parse(result));
    }
    /**
     * 接听
     * @param {string} callId
     * @param {boolean} audioOnly 是否是以语音方式接听
     */
    answerCall(callId, audioOnly) {
      avengineKitPlugin.answerCall(callId, audioOnly);
    }
    /**
     * 挂断
     * @param {Object} callId 通话ID
     */
    endCall(callId) {
      avengineKitPlugin.endCall(callId);
    }
    /**
     * 关闭/开启摄像头
     * @param {string} callId 通话 id
     * @param {boolean} mute 是否关闭摄像头
     */
    muteVideo(callId, mute) {
      avengineKitPlugin.muteVideo(callId, mute);
    }
    /**
     * 关闭/开启麦克风
     * @param {string} callId 通话 id
     * @param {boolean} mute 是否关闭麦克风
     * @return {boolean} 是否关闭成功
     */
    muteAudio(callId, mute) {
      avengineKitPlugin.muteAudio(callId, mute);
    }
    /**
     * 会议时有效
     * 切换为观众
     * @param {string} callId 通话 id
     * @param {boolean} audience 是否切换成观众
     * @return {boolean} 是否切换成功
     */
    switchAudience(callId, audience) {
      return avengineKitPlugin.switchAudience(callId, audience);
    }
    /**
     * 将视频通话，降级到语音通话
     * @param {string} callId 通话 id
     */
    downgrade2Voice(callId) {
      avengineKitPlugin.downgrade2Voice(callId);
    }
    /**
     * 邀请新的通话成员
     * @param {string} callId 通话 id
     * @param {[string]} userIds 新参与者 id 列表
     */
    inviteNewParticipant(callId, userIds) {
      avengineKitPlugin.inviteNewParticipant(callId, userIds);
    }
    /**
     * 设置本地视频流容器 view
     * @param {string} callId 通话 id
     * @param {number} ref 容器 view 的 id
     */
    setLocalVideoView(callId, ref) {
      avengineKitPlugin.setLocalVideoView(callId, ref);
    }
    /**
     * 设置远程视频流容器 view
     * @param {string} callId 通话 id
     * @param {string} userId 用户 id
     * @param {number} ref 容器 view 的 id
     * @param {boolean} screenSharing 是否是屏幕共享
     */
    setRemoteVideoView(callId, userId, ref, screenSharing = false) {
      avengineKitPlugin.setRemoteVideoView(callId, userId, screenSharing, ref);
    }
    /**
     * 获取除自己外，所有通话参与者的 {@link ParticipantProfile}
     * @param {string} callId 通话 id
     * @return {[ParticipantProfile]}
     */
    getParticipantProfiles(callId) {
      let str = avengineKitPlugin.getParticipantProfiles(callId);
      if (!str) {
        return [];
      }
      let profiles = [];
      let ps = JSON.parse(str);
      ps.map((p) => {
        profiles.push(Object.assign(new ParticipantProfile(), p));
      });
      return profiles;
    }
    /**
     * 获取某个通话参与者（可以是自己）的{@link ParticipantProfile}
     * @param {string} callId 通话 id
     * @param {string} userId 用户 id
     * @param {boolean} screenSharing 是否是屏幕共享
     * @return {any| ParticipantProfile}
     */
    getParticipantProfile(callId, userId, screenSharing) {
      let str = avengineKitPlugin.getParticipantProfile(callId, userId, screenSharing);
      if (!str) {
        return null;
      }
      return Object.assign(new ParticipantProfile(), JSON.parse(str));
    }
    /**
     * 获取自己的 {@link ParticipantProfile}
     * @return {any|ParticipantProfile}
     * @param {string} callId
     */
    getMyProfile(callId) {
      let str = avengineKitPlugin.getMyProfile(callId);
      if (!str) {
        return null;
      }
      return Object.assign(new ParticipantProfile(), JSON.parse(str));
    }
    /**
     * 检查是否允许显示悬浮窗
     * @return {boolean}
     */
    checkOverlayPermission() {
      return avengineKitPlugin.checkOverlayPermission();
    }
    /**
     * 最小化
     * @param {string} callId
     * @param {string} focusVideoUser 视频通话/会议时有效，表示悬浮窗显示那个用户的视频流
     * 最小化，显示悬浮窗
     */
    minimize(callId, focusVideoUser = "") {
      avengineKitPlugin.minimize(callId, focusVideoUser);
      this.sessionCallback = null;
    }
    /**
     * 打开或关闭扬声器
     * @param {string} callId 通话 id
     * @param {boolean} speakerOn 是否打开扬声器
     */
    setSpeakerOn(callId, speakerOn) {
      avengineKitPlugin.setSpeakerOn(callId, speakerOn);
    }
    /**
     * 切换摄像头
     * @param {string} callId
     */
    switchCamera(callId) {
      avengineKitPlugin.switchCamera(callId);
    }
  }
  const self$2 = new AVEngineKit();
  async function checkVoipPermissions(audioOnly) {
    return true;
  }
  const _sfc_main$1g = {
    name: "MessageInputView",
    components: {
      AudioInputView,
      PttAudioInputView
    },
    props: {
      conversationInfo: {
        type: ConversationInfo,
        required: true,
        default: null
      }
    },
    data() {
      return {
        emojiStickerList: emojiStickerConfig,
        currentEmojiStickerIndex: 0,
        hideSendButton: Config.getWFCPlatform() === 1 || Config.getWFCPlatform() === 8,
        showRecorder: false,
        showVoice: false,
        showPtt: false,
        isPttEnable: self$4.isPttClientEnable(),
        extList: [
          {
            title: "相册",
            tag: "image",
            icon: "image"
          },
          {
            title: "语音通话",
            tag: "voip_a",
            icon: "voip"
          },
          {
            title: "视频通话",
            tag: "voip_v",
            icon: "voip_v"
          },
          {
            title: "拍摄",
            tag: "shot",
            icon: "camera"
          },
          {
            title: "文件",
            tag: "file",
            icon: "file"
          },
          {
            title: "位置",
            tag: "location",
            icon: "location"
          },
          {
            title: "名片",
            tag: "userCard",
            icon: "user_card"
          }
        ],
        msgFocus: false,
        showExt: false,
        showEmoji: false,
        lastInputFocusState: void 0,
        text: "",
        timer: "",
        talkTo: "",
        keyboardHeight: 300,
        currentKeyboardHeight: 0,
        windowHeight: 0,
        longTapItemKey: "",
        // chatWindowData:[],
        localData: {},
        sharedMiscState: store.state.misc,
        sharedConversationState: store.state.conversation,
        mentions: [],
        groupMemberUserInfos: []
      };
    },
    mounted() {
      formatAppLog("log", "at pages/conversation/MessageInputView.vue:155", "mounted", this.conversationInfo);
      if (this.conversationInfo.conversation.type === ConversationType.Group) {
        this.groupMemberUserInfos = store.getGroupMemberUserInfos(this.conversationInfo.conversation.target, false, false);
      }
      this.restoreDraft();
    },
    beforeUnmount() {
      this.storeDraft(this.conversationInfo);
    },
    methods: {
      onInput(event) {
        let inserting = false;
        if (event.detail.value.length > this.text.length) {
          inserting = true;
        }
        this.text = event.detail.value;
        const cursor = event.detail.cursor;
        if (this.conversationInfo.conversation.type === ConversationType.Group) {
          if (inserting) {
            if (inserting && this.text.length > 0 && this.text.charAt(cursor - 1) === "@") {
              const onPickUser = (user) => {
                this.text = this.text.substring(0, cursor - 1) + `@${user.displayName} ` + this.text.substring(cursor);
                this.mentions.push(user);
                this.inputFocus = true;
              };
              let atAll = {
                uid: "@all",
                displayName: "所有人",
                portrait: this.conversationInfo.conversation._target.portrait
              };
              this.$pickUser(
                {
                  users: [atAll, ...this.groupMemberUserInfos],
                  showCategoryLabel: false,
                  successCB: onPickUser
                }
              );
            }
          }
        }
      },
      mention() {
      },
      send() {
        if (this.text) {
          let textMessageContent = new TextMessageContent(this.text);
          let quotedMessage = this.sharedConversationState.quotedMessage;
          if (quotedMessage) {
            let quoteInfo = QuoteInfo.initWithMessage(quotedMessage);
            textMessageContent.setQuoteInfo(quoteInfo);
            store.quoteMessage(null);
          }
          if (this.conversationInfo.conversation.type === ConversationType.Group && this.mentions.length > 0) {
            const regex2 = /@\S+(\s|$)/g;
            const matches = this.text.match(regex2);
            if (matches.length > 0) {
              for (let i2 = 0; i2 < matches.length; i2++) {
                const match = matches[i2].trim();
                if (match === "@所有人") {
                  let index = this.mentions.findIndex((user) => user.uid === "@all");
                  if (index >= 0) {
                    textMessageContent.mentionedType = 2;
                    break;
                  }
                } else {
                  let index = this.mentions.findIndex((user) => user.displayName === match.substring(1));
                  if (index >= 0) {
                    let uid = this.mentions[index].uid;
                    if (!textMessageContent.mentionedTargets) {
                      textMessageContent.mentionedTargets = [];
                    }
                    if (textMessageContent.mentionedTargets.indexOf(uid) === -1) {
                      textMessageContent.mentionedType = 1;
                      textMessageContent.mentionedTargets.push(uid);
                    }
                  }
                }
              }
            }
          }
          wfc.sendConversationMessage(this.conversationInfo.conversation, textMessageContent);
          this.text = "";
          this.mentions = [];
          Draft.setConversationDraft(this.conversationInfo.conversation, "", null);
        }
      },
      minimizeMessageInputView() {
        this.showEmoji = false;
        this.showExt = false;
      },
      onInputFocus() {
        this.showEmoji = false;
        this.showExt = false;
      },
      toggleVoice() {
        this.showVoice = !this.showVoice;
        this.showPtt = false;
        this.showEmoji = false;
        this.showExt = false;
      },
      togglePtt() {
        this.showPtt = !this.showPtt;
        this.showVoice = false;
        this.showEmoji = false;
        this.showExt = false;
      },
      toggleEmoji() {
        formatAppLog("log", "at pages/conversation/MessageInputView.vue:276", "------------- toggleEmoji");
        this.showEmoji = !this.showEmoji;
        this.showExt = false;
        this.showVoice = false;
        this.showPtt = false;
      },
      toggleExt() {
        this.showExt = !this.showExt;
        this.showEmoji = false;
        this.showVoice = false;
        this.showPtt = false;
      },
      onClickExt(ext) {
        formatAppLog("log", "at pages/conversation/MessageInputView.vue:291", "onClick ext", ext);
        switch (ext.tag) {
          case "image":
            this.chooseImage();
            break;
          case "shot":
            this.chooseVideo();
            break;
          case "file":
            this.chooseFile();
            break;
          case "voip_a":
            this.voip(true);
            break;
          case "voip_v":
            this.voip(false);
            break;
          default:
            uni.showToast({
              title: "TODO " + ext.title,
              icon: "none"
            });
            break;
        }
      },
      onCategoryClick(i2) {
        this.currentEmojiStickerIndex = i2;
      },
      onClickEmoji(emoji) {
        formatAppLog("log", "at pages/conversation/MessageInputView.vue:322", "onClick emoji", emoji);
        this.text = this.text + emoji;
      },
      onClickSticker(sticker) {
        formatAppLog("log", "at pages/conversation/MessageInputView.vue:326", "onClick sticker", sticker);
        let stickerMsg = new StickerMessageContent("", sticker, 200, 200);
        wfc.sendConversationMessage(this.conversationInfo.conversation, stickerMsg);
      },
      chooseImage() {
        uni.chooseImage({
          // count: _self.limit ? _self.limit  - _self.fileList.length : 999,
          sourceType: ["album", "camera"],
          sizeType: ["original", "compressed"],
          success: (e) => {
            formatAppLog("log", "at pages/conversation/MessageInputView.vue:337", "choose image", e.tempFilePaths);
            e.tempFilePaths.forEach(async (path) => {
              let filePath;
              store.sendFile(this.conversationInfo.conversation, filePath);
            });
          }
        });
      },
      async voip(audioOnly) {
        if (!await checkVoipPermissions()) {
          return;
        }
        let session = self$2.currentCallSession();
        if (session && session.state !== 0) {
          uni.showToast({
            title: "音视频通话正在进行中...",
            icon: "none"
          });
          return;
        }
        if (this.conversationInfo.conversation.type === ConversationType.Single) {
          let callSession = self$2.startSingleCall(this.conversationInfo.conversation.target, audioOnly);
          if (callSession) {
            let url = `/pages/voip/Single?session=${JSON.stringify(callSession)}`;
            this.$navigateToPage(url);
          }
        } else if (this.conversationInfo.conversation.type === ConversationType.Group) {
          this.showPickGroupMemberToVoipModal(audioOnly);
        }
      },
      showPickGroupMemberToVoipModal(audioOnly) {
        let beforeClose = (users) => {
          let ids = users.map((u) => u.uid);
          let callSession = self$2.startMultiCall(this.conversationInfo.conversation.target, ids, audioOnly);
          setTimeout(() => {
            if (callSession) {
              let url = `/pages/voip/Multi?session=${JSON.stringify(callSession)}`;
              this.$navigateToPage(url);
            }
          }, 50);
        };
        this.$pickUsers(
          {
            users: this.groupMemberUserInfos,
            confirmTitle: this.$t("common.confirm"),
            showCategoryLabel: false,
            successCB: beforeClose
          }
        );
      },
      chooseVideo() {
        uni.chooseVideo({
          // count: _self.limit ? _self.limit  - _self.fileList.length : 999,
          sourceType: ["camera"],
          sizeType: ["original", "compressed"],
          success: async (e) => {
            formatAppLog("log", "at pages/conversation/MessageInputView.vue:412", "choose video", e);
            let duration = e.duration;
            e.tempFilePath;
            let filePath;
            store.sendFile(this.conversationInfo.conversation, filePath, duration);
          }
        });
      },
      chooseFile() {
        wfc.chooseFile(
          "all",
          async (file) => {
            formatAppLog("log", "at pages/conversation/MessageInputView.vue:437", "choose file", file);
            file.path;
            let filePath;
            file.path = filePath;
            store.sendFile(this.conversationInfo.conversation, file);
          }
        );
      },
      onKeyboardHeightChange(keyboardHeight, currentKeyboardHeight) {
        this.keyboardHeight = keyboardHeight;
        this.currentKeyboardHeight = currentKeyboardHeight;
      },
      cancelQuote() {
        store.quoteMessage(null);
      },
      restoreDraft() {
        let draft = Draft.getConversationDraftEx(this.conversationInfo);
        if (!draft) {
          return;
        }
        formatAppLog("log", "at pages/conversation/MessageInputView.vue:474", "restore draft", this.conversationInfo, draft);
        store.quoteMessage(draft.quotedMessage);
        if (this.text) {
          formatAppLog("log", "at pages/conversation/MessageInputView.vue:477", "inputting, ignore", draft.text);
        } else {
          this.text = draft.text;
        }
      },
      storeDraft(conversationInfo) {
        let quotedMessage = this.sharedConversationState.quotedMessage;
        let draftText = this.text.trim();
        let quoteInfo = quotedMessage ? QuoteInfo.initWithMessage(quotedMessage) : null;
        if (draftText.length === 0) {
          if (conversationInfo.draft !== "") {
            Draft.setConversationDraft(conversationInfo.conversation, draftText, quoteInfo);
          }
        } else {
          if (draftText !== conversationInfo.draft) {
            Draft.setConversationDraft(conversationInfo.conversation, draftText, quoteInfo);
          }
        }
      }
    },
    computed: {
      // quotedMessage() {
      //     lastQuotedMessage = this.sharedConversationState.quotedMessage;
      //     return this.sharedConversationState.quotedMessage;
      // },
      inputFocus() {
        return !this.showExt && !this.showEmoji && !this.showVoice;
      }
    }
  };
  function _sfc_render$1f(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_AudioInputView = vue.resolveComponent("AudioInputView");
    const _component_PttAudioInputView = vue.resolveComponent("PttAudioInputView");
    return vue.openBlock(), vue.createElementBlock("view", null, [
      vue.createElementVNode("view", { class: "wf-message-input-container" }, [
        vue.createElementVNode("view", { class: "wf-message-input-toolbar" }, [
          vue.createElementVNode(
            "view",
            {
              class: vue.normalizeClass(["wf-input-button-icon wxfont", $data.showVoice ? "keyboard" : "voice"]),
              onClick: _cache[0] || (_cache[0] = (...args) => $options.toggleVoice && $options.toggleVoice(...args))
            },
            null,
            2
            /* CLASS */
          ),
          $data.isPttEnable ? (vue.openBlock(), vue.createElementBlock(
            "view",
            {
              key: 0,
              class: vue.normalizeClass(["wf-input-button-icon wxfont", $data.showPtt ? "keyboard" : "voice_playing"]),
              onClick: _cache[1] || (_cache[1] = (...args) => $options.togglePtt && $options.togglePtt(...args))
            },
            null,
            2
            /* CLASS */
          )) : vue.createCommentVNode("v-if", true),
          $data.showVoice ? (vue.openBlock(), vue.createElementBlock("view", {
            key: 1,
            class: "wf-input-voice-container"
          }, [
            vue.createVNode(_component_AudioInputView, { "conversation-info": $props.conversationInfo }, null, 8, ["conversation-info"])
          ])) : $data.showPtt ? (vue.openBlock(), vue.createElementBlock("view", {
            key: 2,
            class: "wf-input-voice-container"
          }, [
            vue.createVNode(_component_PttAudioInputView, { "conversation-info": $props.conversationInfo }, null, 8, ["conversation-info"])
          ])) : (vue.openBlock(), vue.createElementBlock("view", {
            key: 3,
            style: { "width": "100%" }
          }, [
            vue.createElementVNode("view", { class: "wf-input-text-container" }, [
              vue.createElementVNode("textarea", {
                ref: "textarea",
                onFocus: _cache[2] || (_cache[2] = (...args) => $options.onInputFocus && $options.onInputFocus(...args)),
                focus: $options.inputFocus,
                class: "wf-input-textarea",
                onInput: _cache[3] || (_cache[3] = (...args) => $options.onInput && $options.onInput(...args)),
                value: $data.text,
                placeholder: "",
                "hold-keyboard": "",
                "confirm-type": "send",
                onConfirm: _cache[4] || (_cache[4] = ($event) => $options.send($data.text)),
                maxlength: -1,
                "auto-height": ""
              }, null, 40, ["focus", "value"])
            ]),
            $data.sharedConversationState.quotedMessage ? (vue.openBlock(), vue.createElementBlock("view", {
              key: 0,
              class: "quote-message-container"
            }, [
              vue.createElementVNode(
                "view",
                { class: "quoted-message single-line" },
                vue.toDisplayString($data.sharedConversationState.quotedMessage.messageContent.digest($data.sharedConversationState.quotedMessage)),
                1
                /* TEXT */
              ),
              vue.createElementVNode("view", {
                class: "cancel icon-ion-close",
                onClick: _cache[5] || (_cache[5] = (...args) => $options.cancelQuote && $options.cancelQuote(...args))
              })
            ])) : vue.createCommentVNode("v-if", true)
          ])),
          vue.createElementVNode("view", {
            onClick: _cache[6] || (_cache[6] = vue.withModifiers((...args) => $options.toggleEmoji && $options.toggleEmoji(...args), ["prevent"])),
            class: "wf-input-button-icon wxfont emoji"
          }),
          !$data.hideSendButton && $data.text !== "" ? (vue.openBlock(), vue.createElementBlock(
            "view",
            {
              key: 4,
              class: "wf-input-text-send-button",
              onTouchstart: _cache[7] || (_cache[7] = vue.withModifiers(() => {
              }, ["prevent"])),
              onTouchmove: _cache[8] || (_cache[8] = vue.withModifiers(() => {
              }, ["prevent"])),
              onTouchend: _cache[9] || (_cache[9] = vue.withModifiers(($event) => $options.send($data.text), ["prevent"])),
              style: vue.normalizeStyle({ background: $data.text !== "" ? "#4168e0" : "#F7F7F7", color: $data.text !== "" ? "#fff" : "#ddd", "border-color": $data.text !== "" ? "#1BC418" : "#ddd" })
            },
            "发送 ",
            36
            /* STYLE, NEED_HYDRATION */
          )) : vue.createCommentVNode("v-if", true),
          $data.hideSendButton || $data.text === "" ? (vue.openBlock(), vue.createElementBlock("view", {
            key: 5,
            onClick: _cache[10] || (_cache[10] = (...args) => $options.toggleExt && $options.toggleExt(...args)),
            class: "wf-input-button-icon wxfont add2"
          })) : vue.createCommentVNode("v-if", true)
        ]),
        $data.showExt ? (vue.openBlock(), vue.createElementBlock(
          "view",
          {
            key: 0,
            class: "wf-ext-container",
            style: vue.normalizeStyle("height: " + $data.keyboardHeight + "px")
          },
          [
            (vue.openBlock(true), vue.createElementBlock(
              vue.Fragment,
              null,
              vue.renderList($data.extList, (v, i2) => {
                return vue.openBlock(), vue.createElementBlock("view", {
                  class: "wf-ext-item",
                  onClick: ($event) => $options.onClickExt(v),
                  key: i2
                }, [
                  vue.createElementVNode("view", { class: "wf-ext-item-icon" }, [
                    vue.createElementVNode(
                      "view",
                      {
                        class: vue.normalizeClass(["wxfont", v.icon])
                      },
                      null,
                      2
                      /* CLASS */
                    )
                  ]),
                  vue.createElementVNode(
                    "view",
                    { class: "wf-ext-item-text" },
                    vue.toDisplayString(v.title),
                    1
                    /* TEXT */
                  )
                ], 8, ["onClick"]);
              }),
              128
              /* KEYED_FRAGMENT */
            ))
          ],
          4
          /* STYLE */
        )) : vue.createCommentVNode("v-if", true),
        $data.showEmoji ? (vue.openBlock(), vue.createElementBlock(
          "view",
          {
            key: 1,
            class: "wf-stickers-container",
            style: vue.normalizeStyle("height: " + $data.keyboardHeight + "px")
          },
          [
            vue.createElementVNode("view", { class: "category-container" }, [
              (vue.openBlock(true), vue.createElementBlock(
                vue.Fragment,
                null,
                vue.renderList($data.emojiStickerList, (v, i2) => {
                  return vue.openBlock(), vue.createElementBlock("view", {
                    class: "category",
                    key: i2,
                    onClick: ($event) => $options.onCategoryClick(i2)
                  }, [
                    vue.createElementVNode("img", {
                      src: v.poster,
                      class: vue.normalizeClass({ active: i2 === $data.currentEmojiStickerIndex })
                    }, null, 10, ["src"])
                  ], 8, ["onClick"]);
                }),
                128
                /* KEYED_FRAGMENT */
              ))
            ]),
            $data.currentEmojiStickerIndex === 0 ? (vue.openBlock(), vue.createElementBlock(
              "scroll-view",
              {
                key: 0,
                "scroll-y": true,
                class: "wf-emoji-container",
                style: vue.normalizeStyle("height: " + ($data.keyboardHeight - 60) + "px")
              },
              [
                vue.createElementVNode("view", { class: "wf-emoji-content" }, [
                  (vue.openBlock(true), vue.createElementBlock(
                    vue.Fragment,
                    null,
                    vue.renderList($data.emojiStickerList[0].emojis, (v, i2) => {
                      return vue.openBlock(), vue.createElementBlock("view", {
                        class: "emoji-item",
                        onClick: ($event) => $options.onClickEmoji(v),
                        key: i2
                      }, vue.toDisplayString(v), 9, ["onClick"]);
                    }),
                    128
                    /* KEYED_FRAGMENT */
                  ))
                ])
              ],
              4
              /* STYLE */
            )) : (vue.openBlock(), vue.createElementBlock(
              "scroll-view",
              {
                key: 1,
                "scroll-y": true,
                class: "wf-sticker-container",
                style: vue.normalizeStyle("height: " + ($data.keyboardHeight - 60) + "px")
              },
              [
                vue.createElementVNode("view", { class: "wf-sticker-content" }, [
                  (vue.openBlock(true), vue.createElementBlock(
                    vue.Fragment,
                    null,
                    vue.renderList($data.emojiStickerList[$data.currentEmojiStickerIndex].stickers, (s, j) => {
                      return vue.openBlock(), vue.createElementBlock("img", {
                        src: s,
                        class: "sticker-item",
                        onClick: ($event) => $options.onClickSticker(s),
                        key: j
                      }, null, 8, ["src", "onClick"]);
                    }),
                    128
                    /* KEYED_FRAGMENT */
                  ))
                ])
              ],
              4
              /* STYLE */
            ))
          ],
          4
          /* STYLE */
        )) : vue.createCommentVNode("v-if", true)
      ])
    ]);
  }
  const MessageInputView = /* @__PURE__ */ _export_sfc(_sfc_main$1g, [["render", _sfc_render$1f], ["__scopeId", "data-v-28a1c5e3"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/MessageInputView.vue"]]);
  const _sfc_main$1f = {
    name: "FriendRequestView",
    props: {
      userInfo: {
        type: Object,
        required: true
      }
    },
    data() {
      return {
        reason: "",
        sharedContactState: store.state.contact
      };
    },
    methods: {
      cancel() {
        this.$modal.hide("friend-request-modal");
      },
      invite() {
        wfc.sendFriendRequest(this.userInfo.uid, this.reason, null, () => {
          formatAppLog("log", "at pages/contact/FriendRequestView.vue:46", "send friendRequest success", this.userInfo.uid);
        }, (err) => {
        });
        this.$modal.hide("friend-request-modal");
      }
    },
    computed: {
      defaultReason() {
        let userInfo = this.sharedContactState.selfUserInfo;
        return this.$t("friend_request.im") + userInfo.displayName;
      }
    }
  };
  function _sfc_render$1e(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", {
      class: "friend-request-container",
      onClick: _cache[3] || (_cache[3] = vue.withModifiers(() => {
      }, ["stop"]))
    }, [
      vue.createElementVNode("img", {
        class: "avatar",
        src: $props.userInfo.portrait,
        alt: ""
      }, null, 8, ["src"]),
      vue.createElementVNode("div", { class: "info-action-container" }, [
        vue.createElementVNode("div", { class: "info-container" }, [
          vue.createElementVNode(
            "p",
            { class: "title" },
            vue.toDisplayString(_ctx.$t("friend_request.request")),
            1
            /* TEXT */
          ),
          vue.createElementVNode(
            "p",
            { class: "desc" },
            vue.toDisplayString(_ctx.$t("friend_request.send_request_tip", [$props.userInfo.displayName])),
            1
            /* TEXT */
          )
        ]),
        vue.createElementVNode("label", null, [
          vue.withDirectives(vue.createElementVNode("input", {
            type: "text",
            placeholder: $options.defaultReason,
            "onUpdate:modelValue": _cache[0] || (_cache[0] = ($event) => $data.reason = $event)
          }, null, 8, ["placeholder"]), [
            [vue.vModelText, $data.reason]
          ])
        ]),
        vue.createElementVNode("div", { class: "action-container" }, [
          vue.createElementVNode(
            "button",
            {
              class: "cancel",
              onClick: _cache[1] || (_cache[1] = (...args) => $options.cancel && $options.cancel(...args))
            },
            vue.toDisplayString(_ctx.$t("common.cancel")),
            1
            /* TEXT */
          ),
          vue.createElementVNode(
            "button",
            {
              class: "confirm",
              onClick: _cache[2] || (_cache[2] = (...args) => $options.invite && $options.invite(...args))
            },
            vue.toDisplayString(_ctx.$t("common.send")),
            1
            /* TEXT */
          )
        ])
      ])
    ]);
  }
  const FriendRequestView = /* @__PURE__ */ _export_sfc(_sfc_main$1f, [["render", _sfc_render$1e], ["__scopeId", "data-v-a7f616a9"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/contact/FriendRequestView.vue"]]);
  class ModifyMyInfoEntry {
    constructor() {
      /**
       *
       * @type {number} 可选值，参考{@link ModifyMyInfoType }
       */
      __publicField(this, "type", -1);
      __publicField(this, "value", "");
    }
  }
  class ModifyMyInfoType {
  }
  __publicField(ModifyMyInfoType, "Modify_DisplayName", 0);
  __publicField(ModifyMyInfoType, "Modify_Portrait", 1);
  __publicField(ModifyMyInfoType, "Modify_Gender", 2);
  __publicField(ModifyMyInfoType, "Modify_Mobile", 3);
  __publicField(ModifyMyInfoType, "Modify_Email", 4);
  __publicField(ModifyMyInfoType, "Modify_Address", 5);
  __publicField(ModifyMyInfoType, "Modify_Company", 6);
  __publicField(ModifyMyInfoType, "Modify_Social", 7);
  __publicField(ModifyMyInfoType, "Modify_Extra", 8);
  const _sfc_main$1e = {
    name: "UserCardView",
    props: {
      userInfo: {
        type: Object,
        required: true
      },
      enableUpdatePortrait: {
        type: Boolean,
        required: false
      }
    },
    data() {
      return {
        friendAlias: this.userInfo.friendAlias
      };
    },
    methods: {
      share() {
        this.close();
      },
      chat() {
        let conversation2 = new Conversation(ConversationType.Single, this.userInfo.uid, 0);
        store.setCurrentConversation(conversation2);
        this.close();
      },
      addFriend() {
        this.close();
        this.$modal.show(
          FriendRequestView,
          {
            userInfo: this.userInfo
          },
          {
            name: "friend-request-modal",
            width: 600,
            height: 250,
            clickToClose: false
          },
          {}
        );
      },
      updateFriendAlias() {
        if (this.friendAlias !== this.userInfo.friendAlias) {
          wfc.setFriendAlias(
            this.userInfo.uid,
            this.friendAlias,
            () => {
            },
            (error) => {
            }
          );
        }
      },
      close() {
        this.$emit("close");
      },
      pickFile() {
        this.$refs["fileInput"].click();
      },
      onPickFile(event) {
        let file = event.target.files[0];
        wfc.uploadMedia(file.name, file, MessageContentMediaType.Portrait, (url) => {
          let entry = new ModifyMyInfoEntry();
          entry.type = ModifyMyInfoType.Modify_Portrait;
          entry.value = url;
          wfc.modifyMyInfo([entry], () => {
          }, (err) => {
            formatAppLog("log", "at pages/user/UserCardView.vue:126", "modify my info error", err);
          });
        }, (err) => {
          formatAppLog("log", "at pages/user/UserCardView.vue:129", "err", err);
        }, (p, t2) => {
          formatAppLog("log", "at pages/user/UserCardView.vue:131", "progress", p, t2);
        });
      }
    },
    computed: {
      isFriend() {
        return wfc.getUserId() === this.userInfo.uid || wfc.isMyFriend(this.userInfo.uid);
      }
    }
  };
  function _sfc_render$1d(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", {
      onClick: _cache[8] || (_cache[8] = vue.withModifiers(() => {
      }, ["stop"])),
      class: "user-info-container"
    }, [
      vue.createElementVNode("div", { class: "header" }, [
        vue.createElementVNode("div", { class: "desc" }, [
          vue.createElementVNode(
            "h2",
            null,
            vue.toDisplayString($props.userInfo.displayName),
            1
            /* TEXT */
          ),
          vue.createElementVNode(
            "label",
            null,
            vue.toDisplayString(_ctx.$t("common.wfc_id") + ": " + $props.userInfo.name),
            1
            /* TEXT */
          )
        ]),
        vue.createElementVNode("div", null, [
          vue.createElementVNode("img", {
            class: "avatar",
            draggable: "false",
            src: $props.userInfo.portrait,
            onClick: _cache[0] || (_cache[0] = (...args) => $options.pickFile && $options.pickFile(...args))
          }, null, 8, ["src"]),
          $props.enableUpdatePortrait ? (vue.openBlock(), vue.createElementBlock(
            "input",
            {
              key: 0,
              ref: "fileInput",
              onChange: _cache[1] || (_cache[1] = ($event) => $options.onPickFile($event)),
              class: "icon-ion-android-attach",
              type: "file",
              accept: "image/png, image/jpeg",
              style: { "display": "none" }
            },
            null,
            544
            /* NEED_HYDRATION, NEED_PATCH */
          )) : vue.createCommentVNode("v-if", true)
        ])
      ]),
      vue.createElementVNode("div", { class: "content" }, [
        vue.createElementVNode("ul", null, [
          $options.isFriend ? (vue.openBlock(), vue.createElementBlock("li", { key: 0 }, [
            vue.createElementVNode(
              "label",
              null,
              vue.toDisplayString(_ctx.$t("common.alias")),
              1
              /* TEXT */
            ),
            vue.createElementVNode("div", { class: "alias" }, [
              vue.withDirectives(vue.createElementVNode(
                "input",
                {
                  onClick: _cache[2] || (_cache[2] = vue.withModifiers(() => {
                  }, ["stop"])),
                  type: "text",
                  "onUpdate:modelValue": _cache[3] || (_cache[3] = ($event) => $data.friendAlias = $event),
                  onKeyup: _cache[4] || (_cache[4] = vue.withKeys((...args) => $options.updateFriendAlias && $options.updateFriendAlias(...args), ["enter"])),
                  placeholder: "备注名"
                },
                null,
                544
                /* NEED_HYDRATION, NEED_PATCH */
              ), [
                [vue.vModelText, $data.friendAlias]
              ])
            ])
          ])) : vue.createCommentVNode("v-if", true),
          vue.createElementVNode("li", null, [
            vue.createElementVNode(
              "label",
              null,
              vue.toDisplayString(_ctx.$t("common.area")),
              1
              /* TEXT */
            ),
            vue.createElementVNode(
              "div",
              null,
              vue.toDisplayString(_ctx.$t("misc.beijing")),
              1
              /* TEXT */
            )
          ]),
          vue.createElementVNode("li", null, [
            vue.createElementVNode(
              "label",
              null,
              vue.toDisplayString(_ctx.$t("common.label")),
              1
              /* TEXT */
            ),
            vue.createElementVNode(
              "div",
              null,
              vue.toDisplayString(_ctx.$t("misc.test_user")),
              1
              /* TEXT */
            )
          ])
        ])
      ]),
      vue.createElementVNode("div", { class: "action" }, [
        vue.createElementVNode("a", { href: "#" }, [
          vue.createElementVNode("i", {
            class: "icon-ion-ios-shuffle",
            onClick: _cache[5] || (_cache[5] = (...args) => $options.share && $options.share(...args))
          })
        ]),
        $options.isFriend ? (vue.openBlock(), vue.createElementBlock("a", {
          key: 0,
          href: "#"
        }, [
          vue.createElementVNode("i", {
            class: "icon-ion-ios-chatboxes",
            onClick: _cache[6] || (_cache[6] = (...args) => $options.chat && $options.chat(...args))
          })
        ])) : vue.createCommentVNode("v-if", true),
        !$options.isFriend ? (vue.openBlock(), vue.createElementBlock("a", {
          key: 1,
          href: "#"
        }, [
          vue.createElementVNode("i", {
            class: "icon-ion-person-add",
            onClick: _cache[7] || (_cache[7] = (...args) => $options.addFriend && $options.addFriend(...args))
          })
        ])) : vue.createCommentVNode("v-if", true)
      ])
    ]);
  }
  const UserCardView = /* @__PURE__ */ _export_sfc(_sfc_main$1e, [["render", _sfc_render$1d], ["__scopeId", "data-v-a7ee62b9"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/user/UserCardView.vue"]]);
  var node = {};
  var dictionary = {};
  var tlds = {};
  Object.defineProperty(tlds, "__esModule", { value: true });
  tlds.TLDs = "(AAA|AARP|ABARTH|ABB|ABBOTT|ABBVIE|ABC|ABLE|ABOGADO|ABUDHABI|AC|ACADEMY|ACCENTURE|ACCOUNTANT|ACCOUNTANTS|ACO|ACTOR|AD|ADAC|ADS|ADULT|AE|AEG|AERO|AETNA|AF|AFAMILYCOMPANY|AFL|AFRICA|AG|AGAKHAN|AGENCY|AI|AIG|AIGO|AIRBUS|AIRFORCE|AIRTEL|AKDN|AL|ALFAROMEO|ALIBABA|ALIPAY|ALLFINANZ|ALLSTATE|ALLY|ALSACE|ALSTOM|AM|AMERICANEXPRESS|AMERICANFAMILY|AMEX|AMFAM|AMICA|AMSTERDAM|ANALYTICS|ANDROID|ANQUAN|ANZ|AO|AOL|APARTMENTS|APP|APPLE|AQ|AQUARELLE|AR|ARAB|ARAMCO|ARCHI|ARMY|ARPA|ART|ARTE|AS|ASDA|ASIA|ASSOCIATES|AT|ATHLETA|ATTORNEY|AU|AUCTION|AUDI|AUDIBLE|AUDIO|AUSPOST|AUTHOR|AUTO|AUTOS|AVIANCA|AW|AWS|AX|AXA|AZ|AZURE|BA|BABY|BAIDU|BANAMEX|BANANAREPUBLIC|BAND|BANK|BAR|BARCELONA|BARCLAYCARD|BARCLAYS|BAREFOOT|BARGAINS|BASEBALL|BASKETBALL|BAUHAUS|BAYERN|BB|BBC|BBT|BBVA|BCG|BCN|BD|BE|BEATS|BEAUTY|BEER|BENTLEY|BERLIN|BEST|BESTBUY|BET|BF|BG|BH|BHARTI|BI|BIBLE|BID|BIKE|BING|BINGO|BIO|BIZ|BJ|BLACK|BLACKFRIDAY|BLOCKBUSTER|BLOG|BLOOMBERG|BLUE|BM|BMS|BMW|BN|BNPPARIBAS|BO|BOATS|BOEHRINGER|BOFA|BOM|BOND|BOO|BOOK|BOOKING|BOSCH|BOSTIK|BOSTON|BOT|BOUTIQUE|BOX|BR|BRADESCO|BRIDGESTONE|BROADWAY|BROKER|BROTHER|BRUSSELS|BS|BT|BUDAPEST|BUGATTI|BUILD|BUILDERS|BUSINESS|BUY|BUZZ|BV|BW|BY|BZ|BZH|CA|CAB|CAFE|CAL|CALL|CALVINKLEIN|CAM|CAMERA|CAMP|CANCERRESEARCH|CANON|CAPETOWN|CAPITAL|CAPITALONE|CAR|CARAVAN|CARDS|CARE|CAREER|CAREERS|CARS|CASA|CASE|CASEIH|CASH|CASINO|CAT|CATERING|CATHOLIC|CBA|CBN|CBRE|CBS|CC|CD|CEB|CENTER|CEO|CERN|CF|CFA|CFD|CG|CH|CHANEL|CHANNEL|CHARITY|CHASE|CHAT|CHEAP|CHINTAI|CHRISTMAS|CHROME|CHURCH|CI|CIPRIANI|CIRCLE|CISCO|CITADEL|CITI|CITIC|CITY|CITYEATS|CK|CL|CLAIMS|CLEANING|CLICK|CLINIC|CLINIQUE|CLOTHING|CLOUD|CLUB|CLUBMED|CM|CN|CO|COACH|CODES|COFFEE|COLLEGE|COLOGNE|COM|COMCAST|COMMBANK|COMMUNITY|COMPANY|COMPARE|COMPUTER|COMSEC|CONDOS|CONSTRUCTION|CONSULTING|CONTACT|CONTRACTORS|COOKING|COOKINGCHANNEL|COOL|COOP|CORSICA|COUNTRY|COUPON|COUPONS|COURSES|CPA|CR|CREDIT|CREDITCARD|CREDITUNION|CRICKET|CROWN|CRS|CRUISE|CRUISES|CSC|CU|CUISINELLA|CV|CW|CX|CY|CYMRU|CYOU|CZ|DABUR|DAD|DANCE|DATA|DATE|DATING|DATSUN|DAY|DCLK|DDS|DE|DEAL|DEALER|DEALS|DEGREE|DELIVERY|DELL|DELOITTE|DELTA|DEMOCRAT|DENTAL|DENTIST|DESI|DESIGN|DEV|DHL|DIAMONDS|DIET|DIGITAL|DIRECT|DIRECTORY|DISCOUNT|DISCOVER|DISH|DIY|DJ|DK|DM|DNP|DO|DOCS|DOCTOR|DOG|DOMAINS|DOT|DOWNLOAD|DRIVE|DTV|DUBAI|DUCK|DUNLOP|DUPONT|DURBAN|DVAG|DVR|DZ|EARTH|EAT|EC|ECO|EDEKA|EDU|EDUCATION|EE|EG|EMAIL|EMERCK|ENERGY|ENGINEER|ENGINEERING|ENTERPRISES|EPSON|EQUIPMENT|ER|ERICSSON|ERNI|ES|ESQ|ESTATE|ESURANCE|ET|ETISALAT|EU|EUROVISION|EUS|EVENTS|EXCHANGE|EXPERT|EXPOSED|EXPRESS|EXTRASPACE|FAGE|FAIL|FAIRWINDS|FAITH|FAMILY|FAN|FANS|FARM|FARMERS|FASHION|FAST|FEDEX|FEEDBACK|FERRARI|FERRERO|FI|FIAT|FIDELITY|FIDO|FILM|FINAL|FINANCE|FINANCIAL|FIRE|FIRESTONE|FIRMDALE|FISH|FISHING|FIT|FITNESS|FJ|FK|FLICKR|FLIGHTS|FLIR|FLORIST|FLOWERS|FLY|FM|FO|FOO|FOOD|FOODNETWORK|FOOTBALL|FORD|FOREX|FORSALE|FORUM|FOUNDATION|FOX|FR|FREE|FRESENIUS|FRL|FROGANS|FRONTDOOR|FRONTIER|FTR|FUJITSU|FUJIXEROX|FUN|FUND|FURNITURE|FUTBOL|FYI|GA|GAL|GALLERY|GALLO|GALLUP|GAME|GAMES|GAP|GARDEN|GAY|GB|GBIZ|GD|GDN|GE|GEA|GENT|GENTING|GEORGE|GF|GG|GGEE|GH|GI|GIFT|GIFTS|GIVES|GIVING|GL|GLADE|GLASS|GLE|GLOBAL|GLOBO|GM|GMAIL|GMBH|GMO|GMX|GN|GODADDY|GOLD|GOLDPOINT|GOLF|GOO|GOODYEAR|GOOG|GOOGLE|GOP|GOT|GOV|GP|GQ|GR|GRAINGER|GRAPHICS|GRATIS|GREEN|GRIPE|GROCERY|GROUP|GS|GT|GU|GUARDIAN|GUCCI|GUGE|GUIDE|GUITARS|GURU|GW|GY|HAIR|HAMBURG|HANGOUT|HAUS|HBO|HDFC|HDFCBANK|HEALTH|HEALTHCARE|HELP|HELSINKI|HERE|HERMES|HGTV|HIPHOP|HISAMITSU|HITACHI|HIV|HK|HKT|HM|HN|HOCKEY|HOLDINGS|HOLIDAY|HOMEDEPOT|HOMEGOODS|HOMES|HOMESENSE|HONDA|HORSE|HOSPITAL|HOST|HOSTING|HOT|HOTELES|HOTELS|HOTMAIL|HOUSE|HOW|HR|HSBC|HT|HU|HUGHES|HYATT|HYUNDAI|IBM|ICBC|ICE|ICU|ID|IE|IEEE|IFM|IKANO|IL|IM|IMAMAT|IMDB|IMMO|IMMOBILIEN|IN|INC|INDUSTRIES|INFINITI|INFO|ING|INK|INSTITUTE|INSURANCE|INSURE|INT|INTEL|INTERNATIONAL|INTUIT|INVESTMENTS|IO|IPIRANGA|IQ|IR|IRISH|IS|ISMAILI|IST|ISTANBUL|IT|ITAU|ITV|IVECO|JAGUAR|JAVA|JCB|JCP|JE|JEEP|JETZT|JEWELRY|JIO|JLL|JM|JMP|JNJ|JO|JOBS|JOBURG|JOT|JOY|JP|JPMORGAN|JPRS|JUEGOS|JUNIPER|KAUFEN|KDDI|KE|KERRYHOTELS|KERRYLOGISTICS|KERRYPROPERTIES|KFH|KG|KH|KI|KIA|KIM|KINDER|KINDLE|KITCHEN|KIWI|KM|KN|KOELN|KOMATSU|KOSHER|KP|KPMG|KPN|KR|KRD|KRED|KUOKGROUP|KW|KY|KYOTO|KZ|LA|LACAIXA|LAMBORGHINI|LAMER|LANCASTER|LANCIA|LAND|LANDROVER|LANXESS|LASALLE|LAT|LATINO|LATROBE|LAW|LAWYER|LB|LC|LDS|LEASE|LECLERC|LEFRAK|LEGAL|LEGO|LEXUS|LGBT|LI|LIDL|LIFE|LIFEINSURANCE|LIFESTYLE|LIGHTING|LIKE|LILLY|LIMITED|LIMO|LINCOLN|LINDE|LINK|LIPSY|LIVE|LIVING|LIXIL|LK|LLC|LLP|LOAN|LOANS|LOCKER|LOCUS|LOFT|LOL|LONDON|LOTTE|LOTTO|LOVE|LPL|LPLFINANCIAL|LR|LS|LT|LTD|LTDA|LU|LUNDBECK|LUPIN|LUXE|LUXURY|LV|LY|MA|MACYS|MADRID|MAIF|MAISON|MAKEUP|MAN|MANAGEMENT|MANGO|MAP|MARKET|MARKETING|MARKETS|MARRIOTT|MARSHALLS|MASERATI|MATTEL|MBA|MC|MCKINSEY|MD|ME|MED|MEDIA|MEET|MELBOURNE|MEME|MEMORIAL|MEN|MENU|MERCKMSD|METLIFE|MG|MH|MIAMI|MICROSOFT|MIL|MINI|MINT|MIT|MITSUBISHI|MK|ML|MLB|MLS|MM|MMA|MN|MO|MOBI|MOBILE|MODA|MOE|MOI|MOM|MONASH|MONEY|MONSTER|MORMON|MORTGAGE|MOSCOW|MOTO|MOTORCYCLES|MOV|MOVIE|MP|MQ|MR|MS|MSD|MT|MTN|MTR|MU|MUSEUM|MUTUAL|MV|MW|MX|MY|MZ|NA|NAB|NAGOYA|NAME|NATIONWIDE|NATURA|NAVY|NBA|NC|NE|NEC|NET|NETBANK|NETFLIX|NETWORK|NEUSTAR|NEW|NEWHOLLAND|NEWS|NEXT|NEXTDIRECT|NEXUS|NF|NFL|NG|NGO|NHK|NI|NICO|NIKE|NIKON|NINJA|NISSAN|NISSAY|NL|NO|NOKIA|NORTHWESTERNMUTUAL|NORTON|NOW|NOWRUZ|NOWTV|NP|NR|NRA|NRW|NTT|NU|NYC|NZ|OBI|OBSERVER|OFF|OFFICE|OKINAWA|OLAYAN|OLAYANGROUP|OLDNAVY|OLLO|OM|OMEGA|ONE|ONG|ONL|ONLINE|ONYOURSIDE|OOO|OPEN|ORACLE|ORANGE|ORG|ORGANIC|ORIGINS|OSAKA|OTSUKA|OTT|OVH|PA|PAGE|PANASONIC|PARIS|PARS|PARTNERS|PARTS|PARTY|PASSAGENS|PAY|PCCW|PE|PET|PF|PFIZER|PG|PH|PHARMACY|PHD|PHILIPS|PHONE|PHOTO|PHOTOGRAPHY|PHOTOS|PHYSIO|PICS|PICTET|PICTURES|PID|PIN|PING|PINK|PIONEER|PIZZA|PK|PL|PLACE|PLAY|PLAYSTATION|PLUMBING|PLUS|PM|PN|PNC|POHL|POKER|POLITIE|PORN|POST|PR|PRAMERICA|PRAXI|PRESS|PRIME|PRO|PROD|PRODUCTIONS|PROF|PROGRESSIVE|PROMO|PROPERTIES|PROPERTY|PROTECTION|PRU|PRUDENTIAL|PS|PT|PUB|PW|PWC|PY|QA|QPON|QUEBEC|QUEST|QVC|RACING|RADIO|RAID|RE|READ|REALESTATE|REALTOR|REALTY|RECIPES|RED|REDSTONE|REDUMBRELLA|REHAB|REISE|REISEN|REIT|RELIANCE|REN|RENT|RENTALS|REPAIR|REPORT|REPUBLICAN|REST|RESTAURANT|REVIEW|REVIEWS|REXROTH|RICH|RICHARDLI|RICOH|RIGHTATHOME|RIL|RIO|RIP|RMIT|RO|ROCHER|ROCKS|RODEO|ROGERS|ROOM|RS|RSVP|RU|RUGBY|RUHR|RUN|RW|RWE|RYUKYU|SA|SAARLAND|SAFE|SAFETY|SAKURA|SALE|SALON|SAMSCLUB|SAMSUNG|SANDVIK|SANDVIKCOROMANT|SANOFI|SAP|SARL|SAS|SAVE|SAXO|SB|SBI|SBS|SC|SCA|SCB|SCHAEFFLER|SCHMIDT|SCHOLARSHIPS|SCHOOL|SCHULE|SCHWARZ|SCIENCE|SCJOHNSON|SCOR|SCOT|SD|SE|SEARCH|SEAT|SECURE|SECURITY|SEEK|SELECT|SENER|SERVICES|SES|SEVEN|SEW|SEX|SEXY|SFR|SG|SH|SHANGRILA|SHARP|SHAW|SHELL|SHIA|SHIKSHA|SHOES|SHOP|SHOPPING|SHOUJI|SHOW|SHOWTIME|SHRIRAM|SI|SILK|SINA|SINGLES|SITE|SJ|SK|SKI|SKIN|SKY|SKYPE|SL|SLING|SM|SMART|SMILE|SN|SNCF|SO|SOCCER|SOCIAL|SOFTBANK|SOFTWARE|SOHU|SOLAR|SOLUTIONS|SONG|SONY|SOY|SPACE|SPORT|SPOT|SPREADBETTING|SR|SRL|SS|ST|STADA|STAPLES|STAR|STATEBANK|STATEFARM|STC|STCGROUP|STOCKHOLM|STORAGE|STORE|STREAM|STUDIO|STUDY|STYLE|SU|SUCKS|SUPPLIES|SUPPLY|SUPPORT|SURF|SURGERY|SUZUKI|SV|SWATCH|SWIFTCOVER|SWISS|SX|SY|SYDNEY|SYMANTEC|SYSTEMS|SZ|TAB|TAIPEI|TALK|TAOBAO|TARGET|TATAMOTORS|TATAR|TATTOO|TAX|TAXI|TC|TCI|TD|TDK|TEAM|TECH|TECHNOLOGY|TEL|TEMASEK|TENNIS|TEVA|TF|TG|TH|THD|THEATER|THEATRE|TIAA|TICKETS|TIENDA|TIFFANY|TIPS|TIRES|TIROL|TJ|TJMAXX|TJX|TK|TKMAXX|TL|TM|TMALL|TN|TO|TODAY|TOKYO|TOOLS|TOP|TORAY|TOSHIBA|TOTAL|TOURS|TOWN|TOYOTA|TOYS|TR|TRADE|TRADING|TRAINING|TRAVEL|TRAVELCHANNEL|TRAVELERS|TRAVELERSINSURANCE|TRUST|TRV|TT|TUBE|TUI|TUNES|TUSHU|TV|TVS|TW|TZ|UA|UBANK|UBS|UG|UK|UNICOM|UNIVERSITY|UNO|UOL|UPS|US|UY|UZ|VA|VACATIONS|VANA|VANGUARD|VC|VE|VEGAS|VENTURES|VERISIGN|VERSICHERUNG|VET|VG|VI|VIAJES|VIDEO|VIG|VIKING|VILLAS|VIN|VIP|VIRGIN|VISA|VISION|VIVA|VIVO|VLAANDEREN|VN|VODKA|VOLKSWAGEN|VOLVO|VOTE|VOTING|VOTO|VOYAGE|VU|VUELOS|WALES|WALMART|WALTER|WANG|WANGGOU|WATCH|WATCHES|WEATHER|WEATHERCHANNEL|WEBCAM|WEBER|WEBSITE|WED|WEDDING|WEIBO|WEIR|WF|WHOSWHO|WIEN|WIKI|WILLIAMHILL|WIN|WINDOWS|WINE|WINNERS|WME|WOLTERSKLUWER|WOODSIDE|WORK|WORKS|WORLD|WOW|WS|WTC|WTF|XBOX|XEROX|XFINITY|XIHUAN|XIN|XN--11B4C3D|XN--1CK2E1B|XN--1QQW23A|XN--2SCRJ9C|XN--30RR7Y|XN--3BST00M|XN--3DS443G|XN--3E0B707E|XN--3HCRJ9C|XN--3OQ18VL8PN36A|XN--3PXU8K|XN--42C2D9A|XN--45BR5CYL|XN--45BRJ9C|XN--45Q11C|XN--4GBRIM|XN--54B7FTA0CC|XN--55QW42G|XN--55QX5D|XN--5SU34J936BGSG|XN--5TZM5G|XN--6FRZ82G|XN--6QQ986B3XL|XN--80ADXHKS|XN--80AO21A|XN--80AQECDR1A|XN--80ASEHDB|XN--80ASWG|XN--8Y0A063A|XN--90A3AC|XN--90AE|XN--90AIS|XN--9DBQ2A|XN--9ET52U|XN--9KRT00A|XN--B4W605FERD|XN--BCK1B9A5DRE4C|XN--C1AVG|XN--C2BR7G|XN--CCK2B3B|XN--CG4BKI|XN--CLCHC0EA0B2G2A9GCD|XN--CZR694B|XN--CZRS0T|XN--CZRU2D|XN--D1ACJ3B|XN--D1ALF|XN--E1A4C|XN--ECKVDTC9D|XN--EFVY88H|XN--FCT429K|XN--FHBEI|XN--FIQ228C5HS|XN--FIQ64B|XN--FIQS8S|XN--FIQZ9S|XN--FJQ720A|XN--FLW351E|XN--FPCRJ9C3D|XN--FZC2C9E2C|XN--FZYS8D69UVGM|XN--G2XX48C|XN--GCKR3F0F|XN--GECRJ9C|XN--GK3AT1E|XN--H2BREG3EVE|XN--H2BRJ9C|XN--H2BRJ9C8C|XN--HXT814E|XN--I1B6B1A6A2E|XN--IMR513N|XN--IO0A7I|XN--J1AEF|XN--J1AMH|XN--J6W193G|XN--JLQ61U9W7B|XN--JVR189M|XN--KCRX77D1X4A|XN--KPRW13D|XN--KPRY57D|XN--KPU716F|XN--KPUT3I|XN--L1ACC|XN--LGBBAT1AD8J|XN--MGB9AWBF|XN--MGBA3A3EJT|XN--MGBA3A4F16A|XN--MGBA7C0BBN0A|XN--MGBAAKC7DVF|XN--MGBAAM7A8H|XN--MGBAB2BD|XN--MGBAH1A3HJKRD|XN--MGBAI9AZGQP6J|XN--MGBAYH7GPA|XN--MGBBH1A|XN--MGBBH1A71E|XN--MGBC0A9AZCG|XN--MGBCA7DZDO|XN--MGBCPQ6GPA1A|XN--MGBERP4A5D4AR|XN--MGBGU82A|XN--MGBI4ECEXP|XN--MGBPL2FH|XN--MGBT3DHD|XN--MGBTX2B|XN--MGBX4CD0AB|XN--MIX891F|XN--MK1BU44C|XN--MXTQ1M|XN--NGBC5AZD|XN--NGBE9E0A|XN--NGBRX|XN--NODE|XN--NQV7F|XN--NQV7FS00EMA|XN--NYQY26A|XN--O3CW4H|XN--OGBPF8FL|XN--OTU796D|XN--P1ACF|XN--P1AI|XN--PBT977C|XN--PGBS0DH|XN--PSSY2U|XN--Q7CE6A|XN--Q9JYB4C|XN--QCKA1PMC|XN--QXA6A|XN--QXAM|XN--RHQV96G|XN--ROVU88B|XN--RVC1E0AM3E|XN--S9BRJ9C|XN--SES554G|XN--T60B56A|XN--TCKWE|XN--TIQ49XQYJ|XN--UNUP4Y|XN--VERMGENSBERATER-CTB|XN--VERMGENSBERATUNG-PWB|XN--VHQUV|XN--VUQ861B|XN--W4R85EL8FHU5DNRA|XN--W4RS40L|XN--WGBH1C|XN--WGBL6A|XN--XHQ521B|XN--XKC2AL3HYE2A|XN--XKC2DL3A5EE0H|XN--Y9A3AQ|XN--YFRO4I67O|XN--YGBI2AMMX|XN--ZFR164B|XXX|XYZ|YACHTS|YAHOO|YAMAXUN|YANDEX|YE|YODOBASHI|YOGA|YOKOHAMA|YOU|YOUTUBE|YT|YUN|ZA|ZAPPOS|ZARA|ZERO|ZIP|ZM|ZONE|ZUERICH|ZW|TEST)";
  (function(exports) {
    Object.defineProperty(exports, "__esModule", { value: true });
    var tlds_1 = tlds;
    exports.openingParenthesis = `(["'{`;
    exports.closingParenthesis = `)]"'}`;
    exports.parenthesis = exports.openingParenthesis.split("").map(function(x, i2) {
      return "" + x + exports.closingParenthesis.charAt(i2);
    });
    exports.htmlAttributes = [
      "src",
      "data",
      "href",
      "cite",
      "formaction",
      "icon",
      "manifest",
      "poster",
      "codebase",
      "background",
      "profile",
      "usemap",
      "itemtype",
      "action",
      "longdesc",
      "classid",
      "archive"
    ];
    exports.nonLatinAlphabetRanges = "\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC";
    exports.TLDs = tlds_1.TLDs;
  })(dictionary);
  var transform$1 = {};
  Object.defineProperty(transform$1, "__esModule", { value: true });
  function applyOption(string, props, option) {
    if (typeof option === "function") {
      return option(string, props);
    } else {
      return option;
    }
  }
  function transform(input, options) {
    var protocol = "";
    var truncation = Infinity;
    var attributes = {};
    var truncateFromTheMiddle = false;
    if (options && options.specialTransform) {
      for (var index = 0; index < options.specialTransform.length; index++) {
        var transformer = options.specialTransform[index];
        if (transformer.test.test(input.string)) {
          return transformer.transform(input.string, input);
        }
      }
    }
    if (options && options.exclude) {
      if (applyOption(input.string, input, options.exclude))
        return input.string;
    }
    if (options && options.protocol) {
      protocol = applyOption(input.string, input, options.protocol);
    }
    if (input.protocol) {
      protocol = "";
    } else if (!protocol) {
      protocol = input.isEmail ? "mailto:" : input.isFile ? "file:///" : "http://";
    }
    if (options && options.truncate) {
      truncation = applyOption(input.string, input, options.truncate);
    }
    if (options && options.middleTruncation) {
      truncateFromTheMiddle = applyOption(input.string, input, options.middleTruncation);
    }
    if (options && options.attributes) {
      attributes = applyOption(input.string, input, options.attributes);
    }
    return "<a " + Object.keys(attributes).map(function(key) {
      return attributes[key] === true ? key : key + '="' + attributes[key] + '" ';
    }).join(" ") + 'href="' + protocol + input.string + '">' + (input.string.length > truncation ? truncateFromTheMiddle ? input.string.substring(0, Math.floor(truncation / 2)) + "…" + input.string.substring(input.string.length - Math.ceil(truncation / 2), input.string.length) : input.string.substring(0, truncation) + "…" : input.string) + "</a>";
  }
  transform$1.transform = transform;
  var regex = {};
  (function(exports) {
    Object.defineProperty(exports, "__esModule", { value: true });
    var dictionary_12 = dictionary;
    var email_address = "([a-z0-9!#$%&'*+=?^_`{|}~-]+(\\.[a-z0-9!#$%&'*+=?^_`{|}~-]+)*)";
    var domainWithTLD = "([a-z0-9]+(-+[a-z0-9]+)*\\.)+(" + dictionary_12.TLDs + ")";
    var domainWithAnyTLD = "([a-z0-9]+(-+[a-z0-9]+)*\\.)+([a-z0-9][a-z0-9-]{0," + (Math.max.apply(commonjsGlobal, dictionary_12.TLDs.split("|").map(function(x) {
      return x.length;
    })) - 2) + "}[a-z0-9])";
    var allowedInPath = `a-zA-Z\\d\\-._~\\!$&*+,;=:@%'"\\[\\]()`;
    var path = "(((\\/(([" + allowedInPath + "]+(\\/[" + allowedInPath + "]*)*))?)?)((\\?([" + allowedInPath + "\\/?]*))?)((\\#([" + allowedInPath + "\\/?]*))?))?";
    var ipv4 = "((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)";
    var ipv6 = "\\[(([a-f0-9:]+:+)+[a-f0-9]+)\\]";
    var port = "(:(\\d{1,5}))?";
    var protocol = "(https?:|ftps?:)\\/\\/";
    var confirmedByProtocol = "(" + protocol + ")\\S+";
    var additionalSlashes = "(([\\/]?))+";
    var fqdn = "(((" + protocol + ")?(" + domainWithTLD + "|" + ipv4 + "|(" + protocol + ")(" + ipv6 + "|" + domainWithAnyTLD + "))(?!@\\w)" + port + ")|(" + confirmedByProtocol + "))";
    var nonLatinMatches = fqdn + "((((\\/(([" + allowedInPath + "]+(\\/[" + allowedInPath + dictionary_12.nonLatinAlphabetRanges + "]*)*))?)?)((\\?([" + allowedInPath + "\\/?]*))?)((\\#([" + allowedInPath + "\\/?]*))?))?\\b((([" + allowedInPath + "\\/" + dictionary_12.nonLatinAlphabetRanges + "][a-zA-Z\\d\\-_~+=\\/" + dictionary_12.nonLatinAlphabetRanges + "]+)?))+)";
    exports.email = "\\b(mailto:)?" + email_address + "@(" + domainWithTLD + "|" + ipv4 + ")\\b";
    exports.url = "(" + nonLatinMatches + ")|(\\b" + fqdn + path + "\\b" + additionalSlashes + ")";
    exports.file = "(file:\\/\\/\\/)([a-z]+:(\\/|\\\\)+)?([\\w.]+([\\/\\\\]?)+)+";
    exports.final = "(" + exports.url + ")|(" + exports.email + ")|(" + exports.file + ")";
    exports.finalRegex = new RegExp(exports.final, "gi");
    exports.ipRegex = new RegExp("^(" + ipv4 + "|" + ipv6 + ")$", "i");
    exports.emailRegex = new RegExp("^(" + exports.email + ")$", "i");
    exports.fileRegex = new RegExp("^(" + exports.file + ")$", "i");
    exports.urlRegex = new RegExp("^(" + exports.url + ")$", "i");
    var iidxes = {
      isURL: 0,
      isEmail: 0,
      isFile: 0,
      file: {
        fileName: 0,
        protocol: 0
      },
      email: {
        protocol: 0,
        local: 0,
        host: 0
      },
      url: {
        ipv4: 0,
        ipv6: 0,
        ipv4Confirmation: 0,
        byProtocol: 0,
        port: 0,
        // three places where protocol can appear
        protocol1: 0,
        protocol2: 0,
        protocol3: 0,
        protocolWithDomain: 0,
        path: 0,
        // sometimes path might be split into two parts
        secondPartOfPath: 0,
        query: 0,
        fragment: 0
      }
    };
    exports.iidxes = iidxes;
    var testers = [
      "file:///some/file/path/filename.pdf",
      "mailto:e+_mail.me@sub.domain.com",
      "http://sub.domain.co.uk:3000/p/a/t/h_(asd)/h?q=abc123#dfdf",
      "http://www.عربي.com",
      "http://127.0.0.1:3000/p/a/t_(asd)/h?q=abc123#dfdf",
      "http://[2a00:1450:4025:401::67]/k/something",
      "a.org/abc/ი_გგ"
    ].join(" ");
    var result = null;
    var i2 = 0;
    while ((result = exports.finalRegex.exec(testers)) !== null) {
      if (i2 === 0) {
        iidxes.isFile = result.lastIndexOf(result[0]);
        iidxes.file.fileName = result.indexOf("filename.pdf");
        iidxes.file.protocol = result.indexOf("file:///");
      }
      if (i2 === 1) {
        iidxes.isEmail = result.lastIndexOf(result[0]);
        iidxes.email.protocol = result.indexOf("mailto:");
        iidxes.email.local = result.indexOf("e+_mail.me");
        iidxes.email.host = result.indexOf("sub.domain.com");
      }
      if (i2 === 2) {
        iidxes.isURL = result.lastIndexOf(result[0]);
        iidxes.url.protocol1 = result.indexOf("http://");
        iidxes.url.protocolWithDomain = result.indexOf("http://sub.domain.co.uk:3000");
        iidxes.url.port = result.indexOf("3000");
        iidxes.url.path = result.indexOf("/p/a/t/h_(asd)/h");
        iidxes.url.query = result.indexOf("q=abc123");
        iidxes.url.fragment = result.indexOf("dfdf");
      }
      if (i2 === 3) {
        iidxes.url.byProtocol = result.lastIndexOf("http://www.عربي.com");
        iidxes.url.protocol2 = result.lastIndexOf("http://");
      }
      if (i2 === 4) {
        iidxes.url.ipv4 = result.indexOf("127.0.0.1");
        iidxes.url.ipv4Confirmation = result.indexOf("0.");
      }
      if (i2 === 5) {
        iidxes.url.ipv6 = result.indexOf("2a00:1450:4025:401::67");
        iidxes.url.protocol3 = result.lastIndexOf("http://");
      }
      if (i2 === 6) {
        iidxes.url.secondPartOfPath = result.indexOf("გგ");
      }
      i2++;
    }
  })(regex);
  var utils = {};
  Object.defineProperty(utils, "__esModule", { value: true });
  var dictionary_1$1 = dictionary;
  function checkParenthesis(opening, closing, target, nextChar) {
    if (nextChar !== closing) {
      return false;
    }
    if (target.split(opening).length - target.split(closing).length === 1 || opening === closing && target.split(opening).length % 2 === 0) {
      return true;
    }
  }
  utils.checkParenthesis = checkParenthesis;
  utils.maximumAttrLength = dictionary_1$1.htmlAttributes.sort(function(a, b) {
    return b.length - a.length;
  })[0].length;
  function isInsideAttribute(prevFragment) {
    return /\s[a-z0-9-]+=('|")$/i.test(prevFragment) || /: ?url\(('|")?$/i.test(prevFragment);
  }
  utils.isInsideAttribute = isInsideAttribute;
  function isInsideAnchorTag(target, fullInput, targetEnd) {
    var escapedTarget = target.replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&");
    var regex2 = new RegExp("(?=(<a))(?!([\\s\\S]*)(<\\/a>)(" + escapedTarget + "))[\\s\\S]*?(" + escapedTarget + `)(?!"|')`, "gi");
    var result = null;
    while ((result = regex2.exec(fullInput)) !== null) {
      var end = result.index + result[0].length;
      if (end === targetEnd) {
        return true;
      }
    }
    return false;
  }
  utils.isInsideAnchorTag = isInsideAnchorTag;
  Object.defineProperty(node, "__esModule", { value: true });
  var dictionary_1 = dictionary;
  var transform_1 = transform$1;
  var regex_1 = regex;
  var utils_1 = utils;
  var list = function(input) {
    var found = [];
    var result = null;
    var _loop_1 = function() {
      var start = result.index;
      var end = start + result[0].length;
      var string = result[0];
      if (input.charAt(end) === "/") {
        string = string + input.charAt(end);
        end++;
      }
      if (dictionary_1.closingParenthesis.indexOf(input.charAt(end)) > -1) {
        dictionary_1.parenthesis.forEach(function(str) {
          var opening = str.charAt(0);
          var closing = str.charAt(1);
          if (utils_1.checkParenthesis(opening, closing, string, input.charAt(end))) {
            string = string + input.charAt(end);
            end++;
          }
        });
      }
      if (['""', "''", "()"].indexOf(input.charAt(start - 1) + input.charAt(end)) !== -1) {
        if (utils_1.isInsideAttribute(input.substring(start - utils_1.maximumAttrLength - 15, start))) {
          return "continue";
        }
      }
      if (input.substring(end, input.length).indexOf("</a>") > -1 && input.substring(0, start).indexOf("<a") > -1 && utils_1.isInsideAnchorTag(string, input, end)) {
        return "continue";
      }
      if (result[regex_1.iidxes.isURL]) {
        var path = (result[regex_1.iidxes.url.path] || "") + (result[regex_1.iidxes.url.secondPartOfPath] || "") || void 0;
        var protocol = result[regex_1.iidxes.url.protocol1] || result[regex_1.iidxes.url.protocol2] || result[regex_1.iidxes.url.protocol3];
        found.push({
          start,
          end,
          string,
          isURL: true,
          protocol,
          port: result[regex_1.iidxes.url.port],
          ipv4: result[regex_1.iidxes.url.ipv4Confirmation] ? result[regex_1.iidxes.url.ipv4] : void 0,
          ipv6: result[regex_1.iidxes.url.ipv6],
          host: result[regex_1.iidxes.url.byProtocol] ? void 0 : (result[regex_1.iidxes.url.protocolWithDomain] || "").substr((protocol || "").length),
          confirmedByProtocol: !!result[regex_1.iidxes.url.byProtocol],
          path: result[regex_1.iidxes.url.byProtocol] ? void 0 : path,
          query: result[regex_1.iidxes.url.query] || void 0,
          fragment: result[regex_1.iidxes.url.fragment] || void 0
        });
      } else if (result[regex_1.iidxes.isFile]) {
        var filePath = string.substr(8);
        found.push({
          start,
          end,
          string,
          isFile: true,
          protocol: result[regex_1.iidxes.file.protocol],
          filename: result[regex_1.iidxes.file.fileName],
          filePath,
          fileDirectory: filePath.substr(0, filePath.length - result[regex_1.iidxes.file.fileName].length)
        });
      } else if (result[regex_1.iidxes.isEmail]) {
        found.push({
          start,
          end,
          string,
          isEmail: true,
          local: result[regex_1.iidxes.email.local],
          protocol: result[regex_1.iidxes.email.protocol],
          host: result[regex_1.iidxes.email.host]
        });
      } else {
        found.push({
          start,
          end,
          string
        });
      }
    };
    while ((result = regex_1.finalRegex.exec(input)) !== null) {
      _loop_1();
    }
    return found;
  };
  var anchorme = function(arg) {
    var _a = typeof arg === "string" ? { input: arg, options: void 0, extensions: void 0 } : arg, input = _a.input, options = _a.options, extensions = _a.extensions;
    if (extensions) {
      for (var index = 0; index < extensions.length; index++) {
        var extension = extensions[index];
        input = input.replace(extension.test, extension.transform);
      }
    }
    var found = list(input);
    var newStr = "";
    for (var index = 0; index < found.length; index++) {
      newStr = (newStr ? newStr : index === 0 ? input.substring(0, found[index].start) : "") + transform_1.transform(found[index], options) + (found[index + 1] ? input.substring(found[index].end, found[index + 1].start) : input.substring(found[index].end));
    }
    return newStr ? newStr : input;
  };
  anchorme.list = function(input) {
    return list(input);
  };
  anchorme.validate = {
    ip: function(input) {
      return regex_1.ipRegex.test(input);
    },
    email: function(input) {
      return regex_1.emailRegex.test(input);
    },
    file: function(input) {
      return regex_1.fileRegex.test(input);
    },
    url: function(input) {
      return regex_1.urlRegex.test(input) || regex_1.ipRegex.test(input);
    }
  };
  var _default = node.default = anchorme;
  /*! Copyright Twitter Inc. and other contributors. Licensed under MIT */
  var twemoji = function() {
    var twemoji2 = { base: "https://twemoji.maxcdn.com/v/14.0.2/", ext: ".png", size: "72x72", className: "emoji", convert: { fromCodePoint, toCodePoint }, onerror: function onerror() {
      if (this.parentNode) {
        this.parentNode.replaceChild(createText(this.alt, false), this);
      }
    }, parse: parse2, replace, test }, escaper = { "&": "&amp;", "<": "&lt;", ">": "&gt;", "'": "&#39;", '"': "&quot;" }, re = /(?:\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffc-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb\udffd-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb-\udffd\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffc-\udfff]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb\udffd-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb-\udffd\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c[\udffc-\udfff]|\ud83e\udef1\ud83c\udffc\u200d\ud83e\udef2\ud83c[\udffb\udffd-\udfff]|\ud83e\udef1\ud83c\udffd\u200d\ud83e\udef2\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\udef1\ud83c\udffe\u200d\ud83e\udef2\ud83c[\udffb-\udffd\udfff]|\ud83e\udef1\ud83c\udfff\u200d\ud83e\udef2\ud83c[\udffb-\udffe]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d\udc8f\ud83c[\udffb-\udfff]|\ud83d\udc91\ud83c[\udffb-\udfff]|\ud83e\udd1d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d\udc8f\udc91]|\ud83e\udd1d)|(?:\ud83d[\udc68\udc69]|\ud83e\uddd1)(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc70\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd4\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83d\ude36\u200d\ud83c\udf2b\ufe0f|\u2764\ufe0f\u200d\ud83d\udd25|\u2764\ufe0f\u200d\ud83e\ude79|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc3b\u200d\u2744\ufe0f|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83d\ude2e\u200d\ud83d\udca8|\ud83d\ude35\u200d\ud83d\udcab|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f|\ud83d\udc08\u200d\u2b1b)|[#*0-9]\ufe0f?\u20e3|(?:[©®\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0c\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\udd77\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd\udec3-\udec5\udef0-\udef6]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udc8e\udc90\udc92-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5-\uded7\udedd-\udedf\udeeb\udeec\udef4-\udefc\udfe0-\udfeb\udff0]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd76\udd78-\uddb4\uddb7\uddba\uddbc-\uddcc\uddd0\uddde-\uddff\ude70-\ude74\ude78-\ude7c\ude80-\ude86\ude90-\udeac\udeb0-\udeba\udec0-\udec2\uded0-\uded9\udee0-\udee7]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g, UFE0Fg = /\uFE0F/g, U200D = String.fromCharCode(8205), rescaper = /[&<>'"]/g, shouldntBeParsed = /^(?:iframe|noframes|noscript|script|select|style|textarea)$/, fromCharCode = String.fromCharCode;
    return twemoji2;
    function createText(text, clean) {
      return document.createTextNode(clean ? text.replace(UFE0Fg, "") : text);
    }
    function escapeHTML(s) {
      return s.replace(rescaper, replacer);
    }
    function defaultImageSrcGenerator(icon, options) {
      return "".concat(options.base, options.size, "/", icon, options.ext);
    }
    function grabAllTextNodes(node2, allText) {
      var childNodes = node2.childNodes, length = childNodes.length, subnode, nodeType;
      while (length--) {
        subnode = childNodes[length];
        nodeType = subnode.nodeType;
        if (nodeType === 3) {
          allText.push(subnode);
        } else if (nodeType === 1 && !("ownerSVGElement" in subnode) && !shouldntBeParsed.test(subnode.nodeName.toLowerCase())) {
          grabAllTextNodes(subnode, allText);
        }
      }
      return allText;
    }
    function grabTheRightIcon(rawText) {
      return toCodePoint(rawText.indexOf(U200D) < 0 ? rawText.replace(UFE0Fg, "") : rawText);
    }
    function parseNode(node2, options) {
      var allText = grabAllTextNodes(node2, []), length = allText.length, attrib, attrname, modified, fragment, subnode, text, match, i2, index, img, rawText, iconId, src;
      while (length--) {
        modified = false;
        fragment = document.createDocumentFragment();
        subnode = allText[length];
        text = subnode.nodeValue;
        i2 = 0;
        while (match = re.exec(text)) {
          index = match.index;
          if (index !== i2) {
            fragment.appendChild(createText(text.slice(i2, index), true));
          }
          rawText = match[0];
          iconId = grabTheRightIcon(rawText);
          i2 = index + rawText.length;
          src = options.callback(iconId, options);
          if (iconId && src) {
            img = new Image();
            img.onerror = options.onerror;
            img.setAttribute("draggable", "false");
            attrib = options.attributes(rawText, iconId);
            for (attrname in attrib) {
              if (attrib.hasOwnProperty(attrname) && attrname.indexOf("on") !== 0 && !img.hasAttribute(attrname)) {
                img.setAttribute(attrname, attrib[attrname]);
              }
            }
            img.className = options.className;
            img.alt = rawText;
            img.src = src;
            modified = true;
            fragment.appendChild(img);
          }
          if (!img)
            fragment.appendChild(createText(rawText, false));
          img = null;
        }
        if (modified) {
          if (i2 < text.length) {
            fragment.appendChild(createText(text.slice(i2), true));
          }
          subnode.parentNode.replaceChild(fragment, subnode);
        }
      }
      return node2;
    }
    function parseString(str, options) {
      return replace(str, function(rawText) {
        var ret = rawText, iconId = grabTheRightIcon(rawText), src = options.callback(iconId, options), attrib, attrname;
        if (iconId && src) {
          ret = "<img ".concat('class="', options.className, '" ', 'draggable="false" ', 'alt="', rawText, '"', ' src="', src, '"');
          attrib = options.attributes(rawText, iconId);
          for (attrname in attrib) {
            if (attrib.hasOwnProperty(attrname) && attrname.indexOf("on") !== 0 && ret.indexOf(" " + attrname + "=") === -1) {
              ret = ret.concat(" ", attrname, '="', escapeHTML(attrib[attrname]), '"');
            }
          }
          ret = ret.concat("/>");
        }
        return ret;
      });
    }
    function replacer(m) {
      return escaper[m];
    }
    function returnNull() {
      return null;
    }
    function toSizeSquaredAsset(value) {
      return typeof value === "number" ? value + "x" + value : value;
    }
    function fromCodePoint(codepoint) {
      var code = typeof codepoint === "string" ? parseInt(codepoint, 16) : codepoint;
      if (code < 65536) {
        return fromCharCode(code);
      }
      code -= 65536;
      return fromCharCode(55296 + (code >> 10), 56320 + (code & 1023));
    }
    function parse2(what, how) {
      if (!how || typeof how === "function") {
        how = { callback: how };
      }
      return (typeof what === "string" ? parseString : parseNode)(what, { callback: how.callback || defaultImageSrcGenerator, attributes: typeof how.attributes === "function" ? how.attributes : returnNull, base: typeof how.base === "string" ? how.base : twemoji2.base, ext: how.ext || twemoji2.ext, size: how.folder || toSizeSquaredAsset(how.size || twemoji2.size), className: how.className || twemoji2.className, onerror: how.onerror || twemoji2.onerror });
    }
    function replace(text, callback) {
      return String(text).replace(re, callback);
    }
    function test(text) {
      re.lastIndex = 0;
      var result = re.test(text);
      re.lastIndex = 0;
      return result;
    }
    function toCodePoint(unicodeSurrogates, sep) {
      var r = [], c2 = 0, p = 0, i2 = 0;
      while (i2 < unicodeSurrogates.length) {
        c2 = unicodeSurrogates.charCodeAt(i2++);
        if (p) {
          r.push((65536 + (p - 55296 << 10) + (c2 - 56320)).toString(16));
          p = 0;
        } else if (55296 <= c2 && c2 <= 56319) {
          p = c2;
        } else {
          r.push(c2.toString(16));
        }
      }
      return r.join(sep || "-");
    }
  }();
  function parser(text) {
    var decodeText = _default({
      input: text,
      options: {
        attributes: {
          target: "_blank"
        }
      }
    });
    let emoji = twemoji.parse(decodeText);
    emoji = emoji.replace(/src="https:\/\/twemoji\.maxcdn\.com\/v\/[0-9.]+\//g, 'src="' + Config.emojiBaseUrl());
    return emoji;
  }
  const _sfc_main$1d = {
    name: "TextMessageContentView",
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    data() {
      return {
        textSelected: false
      };
    },
    mounted() {
    },
    methods: {
      escapeHtml(text) {
        return text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/ /g, "&nbsp;").replace(/<script/gi, "&lt;script").replace(/<iframe/gi, "&lt;iframe");
      }
    },
    computed: {
      textContent() {
        let content = this.message.messageContent.digest(this.message);
        let lines = content.split("\n");
        if (lines.length > 1) {
          content = lines.map((line) => `<span>${this.escapeHtml(line)}</span>
`).reduce((total, cv, ci, arr) => total + cv, "");
        } else {
          content = this.escapeHtml(content);
        }
        content = parser(content);
        if (content.indexOf("<img") >= 0) {
          content = content.replace(/<img/g, '<img style="max-width:400px;"');
          return content;
        }
        return content;
      }
    }
  };
  function _sfc_render$1c(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock(
      "div",
      {
        class: vue.normalizeClass(["text-message-container", { out: $props.message.direction === 0 }])
      },
      [
        vue.createElementVNode("p", {
          class: "text",
          innerHTML: this.textContent
        }, null, 8, ["innerHTML"])
      ],
      2
      /* CLASS */
    );
  }
  const TextMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$1d, [["render", _sfc_render$1c], ["__scopeId", "data-v-aac4a595"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/content/TextMessageContentView.vue"]]);
  var resizeImage = { exports: {} };
  (function(module, exports) {
    (function(root, factory) {
      {
        module.exports = factory();
      }
    })(commonjsGlobal, function() {
      var out = {};
      var IMG_TYPE_PNG = "png";
      var IMG_TYPE = [IMG_TYPE_PNG, "gif", "bmp", "jpeg", "webp"];
      for (var i2 = 0; i2 < IMG_TYPE.length; i2++) {
        out[IMG_TYPE[i2].toUpperCase()] = IMG_TYPE[i2];
      }
      function getNewImageDimentions(img, width, height) {
        var detImg = img.width / img.height;
        if (width > 0 && height > 0) {
          if (width / height > detImg) {
            height = width / detImg;
          } else {
            width = height * detImg;
          }
          return [width, height];
        } else if (width > 0) {
          return [width, width / detImg];
        } else if (height > 0) {
          return [height * detImg, height];
        } else {
          return [img.width, img.height];
        }
      }
      function resize2Canvas(img, width, height) {
        if (!img) {
          return img;
        }
        var newImageDimentions = getNewImageDimentions(img, width, height);
        width = newImageDimentions[0];
        height = newImageDimentions[1];
        var canvas = document.createElement("canvas");
        canvas.width = width;
        canvas.height = height;
        var ctx = canvas.getContext("2d");
        ctx.drawImage(img, 0, 0, width, height);
        return canvas;
      }
      out.resize2Canvas = resize2Canvas;
      out.resize = function resize(img, width, height, type) {
        if (IMG_TYPE.indexOf(type) < 0) {
          type = IMG_TYPE_PNG;
        }
        var canvas = resize2Canvas(img, width, height);
        var ctx = canvas.getContext("2d");
        if (type !== IMG_TYPE_PNG) {
          ctx.globalCompositeOperation = "destination-over";
          ctx.fillStyle = "#fff";
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          ctx.globalCompositeOperation = "";
        }
        return canvas.toDataURL("image/" + type);
      };
      return out;
    });
  })(resizeImage);
  function scaleDown(width, height, maxWidth, maxHeight) {
    if (width < maxWidth && height < maxHeight) {
      return { width, height };
    }
    const widthRatio = maxWidth / width;
    const heightRatio = maxHeight / height;
    const scale = Math.min(widthRatio, heightRatio);
    const scaledWidth = width * scale;
    const scaledHeight = height * scale;
    return { width: Math.ceil(scaledWidth), height: Math.ceil(scaledHeight) };
  }
  const _sfc_main$1c = {
    name: "ImageMessageContentView",
    props: {
      message: {
        type: Message,
        required: true
      },
      isInCompositeView: {
        default: false,
        type: Boolean,
        required: false
      }
    },
    data() {
      return {
        imageLoaded: false
      };
    },
    mounted() {
      let iw = this.message.messageContent.imageWidth;
      let ih = this.message.messageContent.imageHeight;
      if (iw && ih) {
        let size = scaleDown(iw, ih, 300, 300);
        if (size) {
          this.$refs.img.style.height = size.height + "px";
          this.$refs.img.style.width = size.width + "px";
          this.$refs.thumbnail.style.height = size.height + "px";
          this.$refs.thumbnail.style.width = size.width + "px";
        }
      }
    },
    methods: {
      preview(message2) {
        if (this.isInCompositeView) {
          this.$parent.previewCompositeMessage(message2.messageUid);
        } else {
          formatAppLog("log", "at pages/conversation/message/content/ImageMessageContentView.vue:51", "preview", message2);
          uni.previewImage({
            current: 1,
            urls: [this.message.messageContent.remotePath]
          });
        }
      },
      onImageLoaded() {
        this.imageLoaded = true;
      }
    }
  };
  function _sfc_render$1b(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "image-content-container" }, [
      vue.withDirectives(vue.createElementVNode("img", {
        ref: "thumbnail",
        onClick: _cache[0] || (_cache[0] = ($event) => $options.preview($props.message)),
        src: "data:video/jpeg;base64," + $props.message.messageContent.thumbnail
      }, null, 8, ["src"]), [
        [vue.vShow, $data.imageLoaded === false]
      ]),
      vue.withDirectives(vue.createElementVNode("img", {
        ref: "img",
        onClick: _cache[1] || (_cache[1] = ($event) => $options.preview($props.message)),
        onLoad: _cache[2] || (_cache[2] = (...args) => $options.onImageLoaded && $options.onImageLoaded(...args)),
        draggable: "true",
        src: $props.message.messageContent.remotePath
      }, null, 40, ["src"]), [
        [vue.vShow, $data.imageLoaded]
      ])
    ]);
  }
  const ImageMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$1c, [["render", _sfc_render$1b], ["__scopeId", "data-v-98f58e83"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/content/ImageMessageContentView.vue"]]);
  const _sfc_main$1b = {
    name: "VideoMessageContentView",
    props: {
      message: {
        type: Message,
        required: true
      },
      isInCompositeView: {
        default: false,
        type: Boolean,
        required: false
      }
    },
    methods: {
      thumbnailUri() {
        if (this.message.status === MessageStatus.Sending) {
          return Config.DEFAULT_VIDEO_POSTER;
        } else {
          return "data:video/jpeg;base64," + this.message.messageContent.thumbnail;
        }
      },
      preview() {
        let message2 = this.message;
        if (this.isInCompositeView) {
          this.$parent.previewCompositeMessage(message2.messageUid);
        } else {
          formatAppLog("log", "at pages/conversation/message/content/VideoMessageContentView.vue:45", "preview", message2.messageContent.remotePath);
          uni.navigateTo({
            url: `/pages/misc/PreviewVideoPage?url=${encodeURIComponent(message2.messageContent.remotePath)}`,
            fail: (e) => {
              formatAppLog("log", "at pages/conversation/message/content/VideoMessageContentView.vue:49", "navigate to PreviewVideoPage error", e);
            }
          });
        }
      }
    }
  };
  function _sfc_render$1a(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "video-content-container" }, [
      vue.createElementVNode("image", {
        controls: "",
        onClick: _cache[0] || (_cache[0] = (...args) => $options.preview && $options.preview(...args)),
        src: $options.thumbnailUri()
      }, null, 8, ["src"]),
      vue.createElementVNode("view", {
        class: "wxfont play play-button",
        onClick: _cache[1] || (_cache[1] = (...args) => $options.preview && $options.preview(...args))
      })
    ]);
  }
  const VideoMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$1b, [["render", _sfc_render$1a], ["__scopeId", "data-v-344f8ed5"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/content/VideoMessageContentView.vue"]]);
  const _sfc_main$1a = {
    name: "UnsupportMessageContentView",
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    mounted() {
      formatAppLog("log", "at pages/conversation/message/content/UnsupportMessageContentView.vue:21", "UnsupportMessageContentView", this.message);
    }
  };
  function _sfc_render$19(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock(
      "div",
      {
        class: vue.normalizeClass(["text-message-container", { out: $props.message.direction === 0 }])
      },
      [
        vue.createElementVNode(
          "p",
          { class: "text" },
          vue.toDisplayString($props.message.messageContent.digest($props.message)),
          1
          /* TEXT */
        )
      ],
      2
      /* CLASS */
    );
  }
  const UnsupportMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$1a, [["render", _sfc_render$19], ["__scopeId", "data-v-c1fb531c"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/content/UnsupportMessageContentView.vue"]]);
  const _sfc_main$19 = {
    name: "FileMessageContentView",
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    data() {
      return {
        sharedConversationState: store.state.conversation
      };
    },
    methods: {
      clickFile() {
        uni.downloadFile({
          url: this.message.messageContent.remotePath,
          success: (res) => {
            let filePath = res.tempFilePath;
            formatAppLog("log", "at pages/conversation/message/content/FileMessageContentView.vue:40", "download file success", filePath);
            uni.openDocument({
              filePath,
              showMenu: true,
              success: (res2) => {
                formatAppLog("log", "at pages/conversation/message/content/FileMessageContentView.vue:45", "打开文档成功");
              },
              fail: (res2) => {
                formatAppLog("log", "at pages/conversation/message/content/FileMessageContentView.vue:48", "打开文档失败", res2);
                uni.showToast({
                  title: "打开文档失败",
                  icon: "none"
                });
              }
            });
          }
        });
      },
      dragFile(event) {
        let file = this.message.messageContent;
        let fileObj = {
          url: file.remotePath,
          name: file.name,
          size: file.size
        };
        event.dataTransfer.setData("text", JSON.stringify(fileObj));
      },
      isDownloading() {
        return store.isDownloadingMessage(this.message.messageId);
      }
    },
    computed: {
      size() {
        let fileMsgContent = this.message.messageContent;
        return helper.humanSize(fileMsgContent.size);
      },
      fileIcon() {
        let fileName = this.message.messageContent.name;
        let icon = helper.getFiletypeIcon(fileName.substring(fileName.lastIndexOf(".") + 1));
        return "/static/image/filetypes/" + icon;
      },
      downloadStats() {
        let dm = store.getDownloadingMessageStatus(this.message.messageId);
        return dm;
      }
    }
  };
  function _sfc_render$18(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock(
      "div",
      {
        class: vue.normalizeClass(["file-message-container", { out: $props.message.direction === 0 }]),
        onClick: _cache[1] || (_cache[1] = (...args) => $options.clickFile && $options.clickFile(...args))
      },
      [
        vue.createElementVNode("img", {
          src: $options.fileIcon,
          alt: ""
        }, null, 8, ["src"]),
        vue.createElementVNode(
          "div",
          {
            class: "flex-column flex-align-start",
            draggable: "true",
            onDragstart: _cache[0] || (_cache[0] = ($event) => $options.dragFile($event))
          },
          [
            vue.createElementVNode(
              "p",
              { class: "file-name" },
              vue.toDisplayString(this.message.messageContent.name),
              1
              /* TEXT */
            ),
            vue.createElementVNode(
              "p",
              { class: "file-size single-line" },
              vue.toDisplayString($options.size),
              1
              /* TEXT */
            )
          ],
          32
          /* NEED_HYDRATION */
        ),
        $props.message.direction === 1 && $options.downloadStats ? (vue.openBlock(), vue.createElementBlock(
          "div",
          {
            key: 0,
            style: vue.normalizeStyle([{ "height": "5px", "background": "#4168e0a0", "position": "absolute", "left": "0", "bottom": "0" }, { width: $options.downloadStats.receivedBytes / $options.downloadStats.totalBytes * 100 + "%" }])
          },
          null,
          4
          /* STYLE */
        )) : vue.createCommentVNode("v-if", true)
      ],
      2
      /* CLASS */
    );
  }
  const FileMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$19, [["render", _sfc_render$18], ["__scopeId", "data-v-676fc298"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/content/FileMessageContentView.vue"]]);
  const _sfc_main$18 = {
    name: "StickerMessageContentView",
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    data() {
      return {
        imageLoaded: false
      };
    },
    methods: {
      preview(message2) {
        formatAppLog("log", "at pages/conversation/message/content/StickerMessageContentView.vue:29", "TODO, preview sticker collection");
      },
      onImageLoaded() {
        this.imageLoaded = true;
      }
    }
  };
  function _sfc_render$17(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "sticker-content-container" }, [
      vue.withDirectives(vue.createElementVNode("img", {
        onClick: _cache[0] || (_cache[0] = ($event) => $options.preview($props.message)),
        src: "data:video/jpeg;base64," + $props.message.messageContent.thumbnail
      }, null, 8, ["src"]), [
        [vue.vShow, $data.imageLoaded === false]
      ]),
      vue.withDirectives(vue.createElementVNode("img", {
        onClick: _cache[1] || (_cache[1] = ($event) => $options.preview($props.message)),
        onLoad: _cache[2] || (_cache[2] = (...args) => $options.onImageLoaded && $options.onImageLoaded(...args)),
        src: $props.message.messageContent.remotePath
      }, null, 40, ["src"]), [
        [vue.vShow, $data.imageLoaded]
      ])
    ]);
  }
  const StickerMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$18, [["render", _sfc_render$17], ["__scopeId", "data-v-15236c72"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/content/StickerMessageContentView.vue"]]);
  const _sfc_main$17 = {
    name: "CallStartMessageContentView",
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    mounted() {
    },
    computed: {
      textContent() {
        let voip2 = this.message.messageContent;
        let desc = this.$t("voip.desc");
        if (voip2.status === 0) {
          desc = this.$t("voip.not_answer");
        } else if (voip2.status === 1) {
          desc = this.$t("voip.ongoing");
        } else {
          if (voip2.connectTime && voip2.connectedTime > 0) {
            let duration = (voip2.endTime - voip2.connectTime()) / 1e3;
            desc = this.$t("voip.duration") + ` : ${duration}`;
          } else {
            desc = this.$t("voip.desc");
          }
        }
        return desc;
      }
    }
  };
  function _sfc_render$16(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock(
      "div",
      {
        class: vue.normalizeClass(["call-start-message-container", { out: $props.message.direction === 0 }])
      },
      [
        vue.createElementVNode("i", { class: "icon-ion-android-call" }),
        vue.createElementVNode("p", {
          class: "text",
          innerHTML: this.textContent
        }, null, 8, ["innerHTML"])
      ],
      2
      /* CLASS */
    );
  }
  const CallStartMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$17, [["render", _sfc_render$16], ["__scopeId", "data-v-3a6d23e2"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/content/CallStartMessageContentView.vue"]]);
  const _sfc_main$16 = {
    name: "AudioMessageContentView",
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    data() {
      return {
        widthStyle: {
          width: "100px"
        }
      };
    },
    mounted() {
      if (this.duration) {
        let width = Math.ceil(this.duration / 60 * 300);
        width = width < 100 ? 100 : width;
        this.widthStyle.width = width + "px";
        formatAppLog("log", "at pages/conversation/message/content/AudioMessageContentViewAMR.vue:36", "audio message Content", width);
      }
    },
    methods: {
      playVoice() {
        this.$set(this.message, "_isPlaying", !this.message._isPlaying);
        if (this.message._isPlaying) {
          store.playVoice(this.message);
        } else {
          store.playVoice(null);
        }
      }
    },
    computed: {
      duration() {
        let voice = this.message.messageContent;
        let times = voice.duration * 1e3;
        let seconds = 0;
        if (times <= 60 * 1e3) {
          seconds = Math.ceil(times / 1e3);
        } else {
          seconds = 60;
        }
        return seconds;
      },
      playingDesc() {
      }
    },
    components: {}
  };
  function _sfc_render$15(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock(
      "div",
      {
        ref: "container",
        class: "audio-message-container",
        style: vue.normalizeStyle($data.widthStyle),
        onClick: _cache[0] || (_cache[0] = vue.withModifiers((...args) => $options.playVoice && $options.playVoice(...args), ["prevent"]))
      },
      [
        $props.message.direction === 0 ? (vue.openBlock(), vue.createElementBlock(
          "p",
          {
            key: 0,
            class: "duration"
          },
          vue.toDisplayString($options.duration) + '"',
          1
          /* TEXT */
        )) : vue.createCommentVNode("v-if", true),
        vue.createElementVNode("div", { class: "volume-container" }, [
          vue.withDirectives(vue.createElementVNode(
            "i",
            { class: "icon-ion-android-volume-up" },
            null,
            512
            /* NEED_PATCH */
          ), [
            [vue.vShow, !$props.message._isPlaying]
          ]),
          vue.withDirectives(vue.createElementVNode(
            "i",
            { class: "icon-ion-pause" },
            null,
            512
            /* NEED_PATCH */
          ), [
            [vue.vShow, $props.message._isPlaying]
          ])
        ]),
        $props.message.direction === 1 ? (vue.openBlock(), vue.createElementBlock(
          "p",
          {
            key: 1,
            class: "duration"
          },
          vue.toDisplayString($options.duration) + '"',
          1
          /* TEXT */
        )) : vue.createCommentVNode("v-if", true)
      ],
      4
      /* STYLE */
    );
  }
  const AudioMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$16, [["render", _sfc_render$15], ["__scopeId", "data-v-45bd7476"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/content/AudioMessageContentViewAMR.vue"]]);
  const _sfc_main$15 = {
    name: "CompositeMessageContentView",
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    computed: {
      title() {
        let compositeMessageContent = this.message.messageContent;
        return compositeMessageContent.title;
      },
      content() {
        let compositeMessageContent = this.message.messageContent;
        let messages2 = compositeMessageContent.messages;
        let str = "";
        let conversation2 = messages2[0].conversation;
        let groupId = conversation2.type === ConversationType.Group ? conversation2.target : "";
        for (let i2 = 0; i2 < messages2.length && i2 < 4; i2++) {
          str += wfc.getGroupMemberDisplayName(groupId, messages2[i2].from) + ": " + parser(messages2[i2].messageContent.digest(messages2[i2]));
          str += "\n";
        }
        return str;
      }
    },
    methods: {
      showCompositePageC() {
        formatAppLog("log", "at pages/conversation/message/content/CompositeMessageContentView.vue:47", "showCompositePageC");
        this.showCompositePage();
      },
      showCompositePage() {
        formatAppLog("log", "at pages/conversation/message/content/CompositeMessageContentView.vue:51", "to navigate to CompositeMessagePage", this.message);
        uni.navigateTo({
          url: `/pages/conversation/message/CompositeMessagePage`,
          success: (res) => {
            formatAppLog("log", "at pages/conversation/message/content/CompositeMessageContentView.vue:55", "navigate to CompositeMessagePage success");
            res.eventChannel.emit("options", {
              message: this.message
            });
          },
          fail: (e) => {
            formatAppLog("log", "at pages/conversation/message/content/CompositeMessageContentView.vue:61", "navigate to CompositeMessagePage error", e);
          }
        });
      }
    }
  };
  function _sfc_render$14(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock(
      "div",
      {
        class: vue.normalizeClass(["composite-message-container", { out: $props.message.direction === 0 }]),
        onClick: _cache[1] || (_cache[1] = (...args) => $options.showCompositePage && $options.showCompositePage(...args))
      },
      [
        vue.createElementVNode(
          "p",
          { class: "title" },
          vue.toDisplayString($options.title),
          1
          /* TEXT */
        ),
        vue.createElementVNode("p", {
          onClick: _cache[0] || (_cache[0] = (...args) => $options.showCompositePageC && $options.showCompositePageC(...args)),
          class: "content",
          innerHTML: this.content
        }, null, 8, ["innerHTML"]),
        vue.createElementVNode(
          "p",
          { class: "desc" },
          vue.toDisplayString(_ctx.$t("message.records")),
          1
          /* TEXT */
        )
      ],
      2
      /* CLASS */
    );
  }
  const CompositeMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$15, [["render", _sfc_render$14], ["__scopeId", "data-v-c6af3edd"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/content/CompositeMessageContentView.vue"]]);
  const _sfc_main$14 = {
    name: "UserCardMessageContentView",
    props: {
      message: {
        required: true,
        type: Message
      }
    },
    components: {
      UserCardView
    },
    methods: {
      closeUserCard() {
        formatAppLog("log", "at pages/conversation/message/content/UserCardMessageContentView.vue:44", "closeUserCard");
        this.$refs["userCardTippy"]._tippy.hide();
      },
      userInfo() {
        let userCard = this.message.messageContent;
        if (userCard.cardType === 0) {
          return wfc.getUserInfo(userCard.target);
        }
      }
    }
  };
  function _sfc_render$13(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_UserCardView = vue.resolveComponent("UserCardView");
    const _component_tippy = vue.resolveComponent("tippy");
    return vue.openBlock(), vue.createElementBlock("div", {
      ref: "userCardTippy",
      name: "userCardInfoTrigger" + $props.message.messageId,
      class: "user-card-content-container"
    }, [
      vue.createElementVNode("div", { class: "portrait-name-container" }, [
        vue.createElementVNode("img", {
          src: $props.message.messageContent.portrait
        }, null, 8, ["src"]),
        vue.createElementVNode(
          "p",
          null,
          vue.toDisplayString($props.message.messageContent.displayName),
          1
          /* TEXT */
        )
      ]),
      vue.createElementVNode("p", { class: "desc single-line" }, "个人名片"),
      vue.createVNode(_component_tippy, {
        to: "userCardInfoTrigger" + $props.message.messageId,
        interactive: "",
        "animate-fill": false,
        placement: "left",
        distant: "7",
        theme: "light",
        animation: "fade",
        trigger: "click"
      }, {
        default: vue.withCtx(() => [
          vue.createVNode(_component_UserCardView, {
            onClose: $options.closeUserCard,
            "user-info": $options.userInfo()
          }, null, 8, ["onClose", "user-info"])
        ]),
        _: 1
        /* STABLE */
      }, 8, ["to"])
    ], 8, ["name"]);
  }
  const UserCardMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$14, [["render", _sfc_render$13], ["__scopeId", "data-v-84be12b6"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/content/UserCardMessageContentView.vue"]]);
  const _sfc_main$13 = {
    name: "ConferenceInviteMessageContentView",
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    mounted() {
    },
    methods: {
      showConferenceInfo() {
        if (self$2.isSupportConference()) {
          let cmc = this.message.messageContent;
          this.$navigateToPage("/pages/voip/conference/ConferenceInfoPage", {
            conferenceId: cmc.callId,
            password: cmc.pin
          });
        } else {
          formatAppLog("log", "at pages/conversation/message/content/ConferenceInviteMessageContentView.vue:43", "not support conference");
          uni.showToast({
            title: "不支持会议功能",
            icon: "none"
          });
        }
      }
    },
    computed: {
      textContent() {
        let conferenceInviteMessageContent = this.message.messageContent;
        return "会议邀请 " + conferenceInviteMessageContent.title + " " + conferenceInviteMessageContent.desc;
      },
      portrait() {
        let content = this.message.messageContent;
        let groupId = this.message.conversation.type === ConversationType.Group ? this.message.conversation.target : "";
        let userInfos = store.getUserInfos([content.host], groupId);
        return userInfos[0].portrait;
      }
    }
  };
  function _sfc_render$12(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock(
      "div",
      {
        class: vue.normalizeClass(["conference-invite-message-container", { out: $props.message.direction === 0 }]),
        onClick: _cache[0] || (_cache[0] = (...args) => $options.showConferenceInfo && $options.showConferenceInfo(...args))
      },
      [
        vue.createElementVNode("div", { class: "flex-row flex-align-center" }, [
          vue.createElementVNode("img", {
            class: "avatar",
            alt: "host",
            src: $options.portrait
          }, null, 8, ["src"]),
          vue.createElementVNode("div", { class: "flex-1" }, [
            vue.createElementVNode(
              "p",
              { class: "single-line title" },
              vue.toDisplayString($props.message.messageContent.title),
              1
              /* TEXT */
            ),
            vue.createElementVNode(
              "p",
              { class: "single-line desc" },
              vue.toDisplayString($props.message.messageContent.desc),
              1
              /* TEXT */
            )
          ])
        ]),
        vue.createElementVNode("p", { class: "type" }, "会议邀请")
      ],
      2
      /* CLASS */
    );
  }
  const ConferenceInviteMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$13, [["render", _sfc_render$12], ["__scopeId", "data-v-1e3ac39f"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/content/ConferenceInviteMessageContentView.vue"]]);
  const _sfc_main$12 = {
    name: "UnknownMessageContentView",
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    mounted() {
      formatAppLog("log", "at pages/conversation/message/content/UnknownMessageContentView.vue:21", "UnknownMessageContentView", this.message);
    }
  };
  function _sfc_render$11(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock(
      "div",
      {
        class: vue.normalizeClass(["text-message-container", { out: $props.message.direction === 0 }])
      },
      [
        vue.createElementVNode(
          "p",
          { class: "text" },
          vue.toDisplayString(_ctx.$t("message.unsupport_message_desc")),
          1
          /* TEXT */
        )
      ],
      2
      /* CLASS */
    );
  }
  const UnknowntMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$12, [["render", _sfc_render$11], ["__scopeId", "data-v-c5cd18c6"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/content/UnknownMessageContentView.vue"]]);
  const _sfc_main$11 = {
    name: "LoadingView"
  };
  function _sfc_render$10(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "loading" }, [
      vue.createElementVNode("div", { class: "line" }, [
        vue.createElementVNode("div"),
        vue.createElementVNode("div"),
        vue.createElementVNode("div"),
        vue.createElementVNode("div"),
        vue.createElementVNode("div"),
        vue.createElementVNode("div")
      ]),
      vue.createElementVNode("div", { class: "circlebg" })
    ]);
  }
  const LoadingView = /* @__PURE__ */ _export_sfc(_sfc_main$11, [["render", _sfc_render$10], ["__scopeId", "data-v-88408487"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/common/LoadingView.vue"]]);
  const _sfc_main$10 = {
    name: "StreamingTextMessageContentView",
    components: { LoadingView },
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    data() {
      return {
        textSelected: false
      };
    },
    mounted() {
    },
    methods: {
      escapeHtml(text) {
        return text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/ /g, "&nbsp;").replace(/<script/gi, "&lt;script").replace(/<iframe/gi, "&lt;iframe");
      }
    },
    computed: {
      textContent() {
        let content = this.message.messageContent.digest(this.message);
        let lines = content.split("\n");
        if (lines.length > 1) {
          content = lines.map((line) => `<span>${this.escapeHtml(line)}</span>
`).reduce((total, cv, ci, arr) => total + cv, "");
        } else {
          content = this.escapeHtml(content);
        }
        content = parser(content);
        if (content.indexOf("<img") >= 0) {
          content = content.replace(/<img/g, '<img style="max-width:400px;"');
          return content;
        }
        return content;
      }
    }
  };
  function _sfc_render$$(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_LoadingView = vue.resolveComponent("LoadingView");
    return vue.openBlock(), vue.createElementBlock(
      "div",
      {
        class: vue.normalizeClass(["streaming-text-message-container", { out: $props.message.direction === 0 }])
      },
      [
        vue.createElementVNode("p", {
          class: "text",
          innerHTML: this.textContent
        }, null, 8, ["innerHTML"]),
        $props.message.messageContent.type === 14 ? (vue.openBlock(), vue.createBlock(_component_LoadingView, { key: 0 })) : vue.createCommentVNode("v-if", true)
      ],
      2
      /* CLASS */
    );
  }
  const StreamingTextMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$10, [["render", _sfc_render$$], ["__scopeId", "data-v-44a6ed1b"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/content/StreamingTextMessageContentView.vue"]]);
  const _sfc_main$$ = {
    name: "TestCustomMessageContentView",
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    data() {
      return {
        textSelected: false
      };
    },
    mounted() {
    },
    methods: {
      escapeHtml(text) {
        return text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/ /g, "&nbsp;").replace(/<script/gi, "&lt;script").replace(/<iframe/gi, "&lt;iframe");
      }
    },
    computed: {
      textContent() {
        let content = this.message.messageContent.digest(this.message);
        let lines = content.split("\n");
        if (lines.length > 1) {
          content = lines.map((line) => `<span>${this.escapeHtml(line)}</span>
`).reduce((total, cv, ci, arr) => total + cv, "");
        } else {
          content = this.escapeHtml(content);
        }
        content = parser(content);
        if (content.indexOf("<img") >= 0) {
          content = content.replace(/<img/g, '<img style="max-width:400px;"');
          return content;
        }
        return content;
      }
    }
  };
  function _sfc_render$_(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock(
      "div",
      {
        class: vue.normalizeClass(["text-message-container", { out: $props.message.direction === 0 }])
      },
      [
        vue.createElementVNode("p", {
          class: "text",
          innerHTML: this.textContent
        }, null, 8, ["innerHTML"])
      ],
      2
      /* CLASS */
    );
  }
  const TestCustomMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$$, [["render", _sfc_render$_], ["__scopeId", "data-v-56860826"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/content/TestCustomMessageContentView.vue"]]);
  class CustomMessageContentType {
  }
  // 1000 以下为内部消息保留，自定义消息需使用 1000 以上的数字
  __publicField(CustomMessageContentType, "MESSAGE_CONTENT_TYPE_CUSTOM_MESSAGE_TEST", 1001);
  __publicField(CustomMessageContentType, "MESSAGE_CONTENT_TYPE_CUSTOM_MESSAGE_TEST_NOTIFICATION", 1002);
  const _sfc_main$_ = {
    name: "MessageContentContainerView",
    computed: {
      CustomMessageContentType() {
        return CustomMessageContentType;
      }
    },
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    components: {
      TestCustomMessageContentView,
      StreamingTextMessageContentView,
      UnknownMessageContentView: UnknowntMessageContentView,
      ConferenceInviteMessageContentView,
      CompositeMessageContentView,
      AudioMessageContentView,
      CallStartMessageContentView,
      UnsupportMessageContentView,
      TextMessageContentView,
      ImageMessageContentView,
      VideoMessageContentView,
      FileMessageContentView,
      StickerMessageContentView,
      UserCardMessageContentView
    }
  };
  function _sfc_render$Z(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_TextMessageContentView = vue.resolveComponent("TextMessageContentView");
    const _component_StreamingTextMessageContentView = vue.resolveComponent("StreamingTextMessageContentView");
    const _component_AudioMessageContentView = vue.resolveComponent("AudioMessageContentView");
    const _component_ImageMessageContentView = vue.resolveComponent("ImageMessageContentView");
    const _component_FileMessageContentView = vue.resolveComponent("FileMessageContentView");
    const _component_VideoMessageContentView = vue.resolveComponent("VideoMessageContentView");
    const _component_StickerMessageContentView = vue.resolveComponent("StickerMessageContentView");
    const _component_CompositeMessageContentView = vue.resolveComponent("CompositeMessageContentView");
    const _component_CallStartMessageContentView = vue.resolveComponent("CallStartMessageContentView");
    const _component_ConferenceInviteMessageContentView = vue.resolveComponent("ConferenceInviteMessageContentView");
    const _component_UserCardMessageContentView = vue.resolveComponent("UserCardMessageContentView");
    const _component_UnsupportMessageContentView = vue.resolveComponent("UnsupportMessageContentView");
    const _component_TestCustomMessageContentView = vue.resolveComponent("TestCustomMessageContentView");
    const _component_UnknownMessageContentView = vue.resolveComponent("UnknownMessageContentView");
    return vue.openBlock(), vue.createElementBlock(
      vue.Fragment,
      null,
      [
        vue.createCommentVNode(" 如果不添加一个层级的话，直接子 view 上的 @click不生效，原因未知 "),
        vue.createElementVNode("div", null, [
          $props.message.messageContent.type === 1 ? (vue.openBlock(), vue.createBlock(_component_TextMessageContentView, {
            key: 0,
            message: $props.message,
            style: { "--out-arrow-color": "#98ea70", "--in-arrow-color": "white" },
            class: vue.normalizeClass({ leftarrow: $props.message.direction === 1, rightarrow: $props.message.direction === 0 })
          }, null, 8, ["message", "class"])) : $props.message.messageContent.type === 14 || $props.message.messageContent.type === 15 ? (vue.openBlock(), vue.createBlock(_component_StreamingTextMessageContentView, {
            key: 1,
            message: $props.message,
            style: { "--out-arrow-color": "#98ea70", "--in-arrow-color": "white" },
            class: vue.normalizeClass({ leftarrow: $props.message.direction === 1, rightarrow: $props.message.direction === 0 })
          }, null, 8, ["message", "class"])) : $props.message.messageContent.type === 2 ? (vue.openBlock(), vue.createBlock(_component_AudioMessageContentView, {
            key: 2,
            message: $props.message
          }, null, 8, ["message"])) : $props.message.messageContent.type === 23 ? (vue.openBlock(), vue.createBlock(_component_AudioMessageContentView, {
            key: 3,
            message: $props.message
          }, null, 8, ["message"])) : $props.message.messageContent.type === 3 ? (vue.openBlock(), vue.createBlock(_component_ImageMessageContentView, {
            key: 4,
            message: $props.message
          }, null, 8, ["message"])) : $props.message.messageContent.type === 5 ? (vue.openBlock(), vue.createElementBlock(
            vue.Fragment,
            { key: 5 },
            [
              vue.createCommentVNode('                           v-bind:class="{leftarrow:message.direction === 1, rightarrow: message.direction === 0}"/>'),
              vue.createVNode(_component_FileMessageContentView, {
                message: $props.message,
                style: { "--out-arrow-color": "white", "--in-arrow-color": "white" },
                class: vue.normalizeClass({ leftarrow: $props.message.direction === 1, rightarrow: $props.message.direction === 0 })
              }, null, 8, ["message", "class"])
            ],
            2112
            /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */
          )) : $props.message.messageContent.type === 6 ? (vue.openBlock(), vue.createBlock(_component_VideoMessageContentView, {
            key: 6,
            message: $props.message
          }, null, 8, ["message"])) : $props.message.messageContent.type === 7 ? (vue.openBlock(), vue.createElementBlock(
            vue.Fragment,
            { key: 7 },
            [
              vue.createCommentVNode('                           v-bind:class="{leftarrow:message.direction === 1, rightarrow: message.direction === 0}"/>'),
              vue.createVNode(_component_StickerMessageContentView, { message: $props.message }, null, 8, ["message"])
            ],
            2112
            /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */
          )) : $props.message.messageContent.type === 11 ? (vue.openBlock(), vue.createBlock(_component_CompositeMessageContentView, {
            key: 8,
            message: $props.message
          }, null, 8, ["message"])) : $props.message.messageContent.type === 400 ? (vue.openBlock(), vue.createBlock(_component_CallStartMessageContentView, {
            key: 9,
            message: $props.message
          }, null, 8, ["message"])) : $props.message.messageContent.type === 408 ? (vue.openBlock(), vue.createBlock(_component_ConferenceInviteMessageContentView, {
            key: 10,
            message: $props.message
          }, null, 8, ["message"])) : $props.message.messageContent.type === 10 ? (vue.openBlock(), vue.createBlock(_component_UserCardMessageContentView, {
            key: 11,
            message: $props.message,
            style: { "--out-arrow-color": "white", "--in-arrow-color": "white" },
            class: vue.normalizeClass({ leftarrow: $props.message.direction === 1, rightarrow: $props.message.direction === 0 })
          }, null, 8, ["message", "class"])) : [
            /* todo un support message types */
          ].indexOf($props.message.messageContent.type) >= 0 ? (vue.openBlock(), vue.createBlock(_component_UnsupportMessageContentView, {
            key: 12,
            message: $props.message
          }, null, 8, ["message"])) : $props.message.messageContent.type === $options.CustomMessageContentType.MESSAGE_CONTENT_TYPE_CUSTOM_MESSAGE_TEST ? (vue.openBlock(), vue.createBlock(_component_TestCustomMessageContentView, {
            key: 13,
            message: $props.message,
            style: { "--out-arrow-color": "#a8bdff", "--in-arrow-color": "white" },
            class: vue.normalizeClass({ leftarrow: $props.message.direction === 1, rightarrow: $props.message.direction === 0 })
          }, null, 8, ["message", "class"])) : (vue.openBlock(), vue.createElementBlock(
            vue.Fragment,
            { key: 14 },
            [
              vue.createCommentVNode(" 更多自定义消息，注意 v-else-if"),
              vue.createVNode(_component_UnknownMessageContentView, {
                message: $props.message,
                class: vue.normalizeClass({ leftarrow: $props.message.direction === 1, rightarrow: $props.message.direction === 0 })
              }, null, 8, ["message", "class"])
            ],
            2112
            /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */
          ))
        ])
      ],
      2112
      /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */
    );
  }
  const MessageContentContainerView = /* @__PURE__ */ _export_sfc(_sfc_main$_, [["render", _sfc_render$Z], ["__scopeId", "data-v-8f711883"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/MessageContentContainerView.vue"]]);
  const _sfc_main$Z = {
    name: "previewQuotedMessageView",
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    computed: {
      textContent() {
        return parser(this.message.messageContent.digest(this.message));
      }
    }
  };
  function _sfc_render$Y(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "message-container" }, [
      vue.createElementVNode("p", {
        class: "text",
        innerHTML: this.textContent
      }, null, 8, ["innerHTML"])
    ]);
  }
  const PreviewQuotedMessageView = /* @__PURE__ */ _export_sfc(_sfc_main$Z, [["render", _sfc_render$Y], ["__scopeId", "data-v-eb41f80a"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/PreviewQuotedMessageView.vue"]]);
  const _sfc_main$Y = {
    name: "QuoteMessageView",
    props: {
      showCloseButton: {
        type: Boolean,
        required: false,
        default: false
      },
      // 原始消息
      message: {
        type: Message,
        required: false
      },
      // 被引用的消息
      quotedMessage: {
        type: Message,
        required: true
      },
      quotedMessageDigest: {
        type: String,
        required: false,
        default: ""
      }
    },
    data() {
      return {
        shareConversation: store.state.conversation
      };
    },
    methods: {
      cancelQuoteMessage() {
        this.$emit("cancelQuoteMessage");
      },
      onMessageClick() {
        if (!this.enableMessagePreview) {
          return;
        }
        if (this.quotedMessage) {
          switch (this.quotedMessage.messageContent.type) {
            case MessageContentType.Video:
            case MessageContentType.Image:
              store.previewMessage(this.quotedMessage, false);
              break;
            case MessageContentType.File:
              this.downloadQuotedFile(this.quotedMessage);
              break;
            case MessageContentType.Text:
              break;
            default:
              formatAppLog("log", "at pages/conversation/message/QuoteMessageView.vue:78", "TODO: preview quotedMessage");
              break;
          }
        }
      },
      downloadQuotedFile(quotedFileMessage) {
      }
    },
    computed: {
      quotedMessageStr() {
        let str = "";
        if (this.quotedMessage) {
          str = this.quotedMessage._from._displayName + ":";
          if ([MessageContentType.Image, MessageContentType.Video, MessageContentType.Sticker].indexOf(this.quotedMessage.messageContent.type) < 0) {
            str += this.quotedMessage.messageContent.digest(this.quotedMessage);
          }
          if (MessageContentType.RecallMessage_Notification === this.quotedMessage.messageContent.type) {
            str = "引用内容已撤回";
          }
        } else {
          str = this.quotedMessageDigest;
        }
        return str;
      },
      mediaSrc() {
        let src;
        let msgCnt = this.quotedMessage.messageContent;
        src = msgCnt.thumbnail ? "data:video/jpeg;base64," + msgCnt.thumbnail : msgCnt.remotePath;
        return src;
      }
    },
    components: {
      PreviewQuotedMessageView
    }
  };
  function _sfc_render$X(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "quoted-message-container" }, [
      vue.createElementVNode("div", { class: "quoted-message" }, [
        [3, 6, 7].indexOf(this.quotedMessage.messageContent.type) >= 0 ? (vue.openBlock(), vue.createElementBlock("div", {
          key: 0,
          class: "media-content"
        }, [
          vue.createElementVNode(
            "p",
            null,
            vue.toDisplayString(this.quotedMessage._from._displayName + ":"),
            1
            /* TEXT */
          ),
          vue.createElementVNode("img", {
            src: $options.mediaSrc,
            alt: "",
            onClick: _cache[0] || (_cache[0] = (...args) => $options.onMessageClick && $options.onMessageClick(...args))
          }, null, 8, ["src"])
        ])) : (vue.openBlock(), vue.createElementBlock(
          "p",
          {
            key: 1,
            onClick: _cache[1] || (_cache[1] = (...args) => $options.onMessageClick && $options.onMessageClick(...args))
          },
          vue.toDisplayString(this.quotedMessageStr),
          1
          /* TEXT */
        ))
      ]),
      $props.showCloseButton ? (vue.openBlock(), vue.createElementBlock("i", {
        key: 0,
        onClick: _cache[2] || (_cache[2] = (...args) => $options.cancelQuoteMessage && $options.cancelQuoteMessage(...args)),
        class: "icon-ion-close"
      })) : vue.createCommentVNode("v-if", true)
    ]);
  }
  const QuoteMessageView = /* @__PURE__ */ _export_sfc(_sfc_main$Y, [["render", _sfc_render$X], ["__scopeId", "data-v-12efedfc"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/QuoteMessageView.vue"]]);
  const _sfc_main$X = {
    name: "NormalOutMessageContentView",
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    data() {
      return {
        sharedConversationState: store.state.conversation,
        sharedPickState: store.state.pick,
        highLight: false,
        quotedMessage: null
      };
    },
    components: {
      QuoteMessageView,
      LoadingView,
      MessageContentContainerView,
      UserCardView
      // TextMessageContentView,
    },
    mounted() {
      if (this.message.messageContent.quoteInfo) {
        let messageUid = this.message.messageContent.quoteInfo.messageUid;
        let msg = store.getMessageByUid(messageUid);
        if (!msg) {
          wfc.loadRemoteMessage(messageUid, (ms) => {
            msg = store._patchMessage(ms[0]);
            this.quotedMessage = msg;
          }, (err) => {
            formatAppLog("log", "at pages/conversation/message/NormalOutMessageContentContainerView.vue:89", "load remote message error", messageUid, err);
          });
        } else {
          this.quotedMessage = msg;
        }
      }
    },
    methods: {
      onClickUserPortrait(userId) {
        store.setCurrentFriend(this.message._from);
        uni.navigateTo({
          url: "/pages/contact/UserDetailPage",
          success: () => {
            formatAppLog("log", "at pages/conversation/message/NormalOutMessageContentContainerView.vue:102", "nav to UserDetailPage success");
          },
          fail: (err) => {
            formatAppLog("log", "at pages/conversation/message/NormalOutMessageContentContainerView.vue:106", "nav to UserDetailPage err", err);
          }
        });
      },
      resend() {
        wfc.deleteMessage(this.message.messageId);
        wfc.sendMessage(this.message);
      },
      openMessageContextMenu(event, message2) {
        this.$eventBus.$emit("openMessageContextMenu", [event, message2]);
        this.highLight = true;
      },
      showMessageReceiptDetail() {
        let conversation2 = this.message.conversation;
        if (conversation2.type === ConversationType.Single) {
          return;
        }
        let timestamp = this.message.timestamp;
        let readEntries = this.sharedConversationState.currentConversationRead;
        if (conversation2.type === ConversationType.Group) {
          let groupMembers = wfc.getGroupMemberIds(conversation2.target, false);
          if (!groupMembers || groupMembers.length === 0)
            ;
          else {
            let readUserIds = [];
            let unreadUserIds = [];
            groupMembers.forEach((memberId) => {
              let readDt = readEntries ? readEntries.get(memberId) : 0;
              if (readDt && gte(readDt, timestamp)) {
                readUserIds.push(memberId);
              } else {
                unreadUserIds.push(memberId);
              }
            });
            store.getUserInfos(readUserIds, conversation2.target);
            store.getUserInfos(unreadUserIds, conversation2.target);
          }
        }
      }
    },
    computed: {
      messageReceipt() {
        let conversation2 = this.message.conversation;
        let timestamp = this.message.timestamp;
        let receiptDesc = "";
        let readEntries = this.sharedConversationState.currentConversationRead;
        if (conversation2.type === ConversationType.Single) {
          let readDt = readEntries ? readEntries.get(conversation2.target) : 0;
          readDt = readDt ? readDt : 0;
          if (gte(readDt, timestamp)) {
            receiptDesc = "已读";
          } else {
            receiptDesc = "未读";
          }
        } else {
          let groupMembers = wfc.getGroupMemberIds(conversation2.target, false);
          if (!groupMembers || groupMembers.length === 0) {
            receiptDesc = "";
          } else {
            let memberCount = groupMembers.length;
            let readCount = 0;
            groupMembers.forEach((memberId) => {
              let readDt = readEntries ? readEntries.get(memberId) : 0;
              if (readDt && gte(readDt, timestamp)) {
                readCount++;
              }
            });
            receiptDesc = `已读 ${readCount}/${memberCount}`;
          }
        }
        return receiptDesc;
      },
      isDownloading() {
        return store.isDownloadingMessage(this.message.messageId);
      },
      shouldShowMessageReceipt() {
        return this.sharedConversationState.isMessageReceiptEnable && ["FireRobot", Config.FILE_HELPER_ID].indexOf(this.message.conversation.target) < 0;
      },
      isMessageChecked() {
        return this.sharedPickState.messages.findIndex((m) => m.messageId === this.message.messageId) >= 0;
      }
    }
  };
  function _sfc_render$W(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_LoadingView = vue.resolveComponent("LoadingView");
    const _component_MessageContentContainerView = vue.resolveComponent("MessageContentContainerView");
    const _component_QuoteMessageView = vue.resolveComponent("QuoteMessageView");
    return vue.openBlock(), vue.createElementBlock("div", null, [
      vue.createElementVNode(
        "div",
        {
          class: vue.normalizeClass(["message-time-container", { checked: $data.sharedPickState.messages.indexOf($props.message) >= 0 }])
        },
        [
          this.message._showTime ? (vue.openBlock(), vue.createElementBlock(
            "p",
            {
              key: 0,
              class: "time"
            },
            vue.toDisplayString($props.message._timeStr),
            1
            /* TEXT */
          )) : vue.createCommentVNode("v-if", true),
          vue.createElementVNode(
            "div",
            {
              class: vue.normalizeClass(["message-content-container", { checked: $data.sharedPickState.messages.indexOf($props.message) >= 0 }])
            },
            [
              $data.sharedConversationState.enableMessageMultiSelection ? (vue.openBlock(), vue.createElementBlock("checkbox", {
                key: 0,
                id: "checkbox",
                type: "checkbox",
                class: "checkbox",
                checked: $options.isMessageChecked,
                value: $props.message,
                placeholder: ""
              }, null, 8, ["checked", "value"])) : vue.createCommentVNode("v-if", true),
              vue.createElementVNode("div", { class: "message-avatar-content-container" }, [
                vue.createCommentVNode(" 文件的进度条有点特殊，有进度的消息的进度条有点特殊 "),
                vue.createCommentVNode("          <button>progress...</button>"),
                $props.message.status === 0 || $options.isDownloading ? (vue.openBlock(), vue.createBlock(_component_LoadingView, { key: 0 })) : vue.createCommentVNode("v-if", true),
                $props.message.status === 2 ? (vue.openBlock(), vue.createElementBlock("i", {
                  key: 1,
                  class: "icon-ion-close-circled",
                  style: { "color": "red" },
                  onClick: _cache[0] || (_cache[0] = (...args) => $options.resend && $options.resend(...args))
                })) : vue.createCommentVNode("v-if", true),
                vue.createElementVNode("div", { class: "flex-column flex-align-end" }, [
                  vue.createVNode(_component_MessageContentContainerView, {
                    message: $props.message,
                    class: "message-content-container-view",
                    onContextmenu: _cache[1] || (_cache[1] = vue.withModifiers(($event) => $options.openMessageContextMenu($event, $props.message), ["prevent"]))
                  }, null, 8, ["message"]),
                  $data.quotedMessage ? (vue.openBlock(), vue.createBlock(_component_QuoteMessageView, {
                    key: 0,
                    style: { "padding": "5px 0", "max-width": "80%" },
                    message: $props.message,
                    "quoted-message": $data.quotedMessage,
                    "message-digest": this.message.messageContent.quoteInfo.messageDigest,
                    "show-close-button": false
                  }, null, 8, ["message", "quoted-message", "message-digest"])) : vue.createCommentVNode("v-if", true)
                ]),
                vue.createElementVNode("img", {
                  class: "avatar",
                  onClick: _cache[2] || (_cache[2] = ($event) => $options.onClickUserPortrait($props.message.from)),
                  draggable: "false",
                  src: $props.message._from.portrait,
                  alt: ""
                }, null, 8, ["src"])
              ])
            ],
            2
            /* CLASS */
          ),
          $options.shouldShowMessageReceipt ? (vue.openBlock(), vue.createElementBlock(
            "p",
            {
              key: 1,
              class: "receipt",
              onClick: _cache[3] || (_cache[3] = (...args) => $options.showMessageReceiptDetail && $options.showMessageReceiptDetail(...args))
            },
            vue.toDisplayString($options.messageReceipt),
            1
            /* TEXT */
          )) : vue.createCommentVNode("v-if", true)
        ],
        2
        /* CLASS */
      )
    ]);
  }
  const NormalOutMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$X, [["render", _sfc_render$W], ["__scopeId", "data-v-527e4029"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/NormalOutMessageContentContainerView.vue"]]);
  const _sfc_main$W = {
    name: "NormalInMessageContentView",
    props: {
      message: null
    },
    data() {
      return {
        sharedConversationState: store.state.conversation,
        sharedPickState: store.state.pick,
        highLight: false,
        quotedMessage: null
      };
    },
    methods: {
      onClickUserPortrait(userId) {
        store.setCurrentFriend(this.message._from);
        uni.navigateTo({
          url: "/pages/contact/UserDetailPage",
          success: () => {
            formatAppLog("log", "at pages/conversation/message/NormalInMessageContentContainerView.vue:67", "nav to UserDetailPage success");
          },
          fail: (err) => {
            formatAppLog("log", "at pages/conversation/message/NormalInMessageContentContainerView.vue:71", "nav to UserDetailPage err", err);
          }
        });
      },
      openMessageContextMenu(event, message2) {
        this.$eventBus.$emit("openMessageContextMenu", [event, message2]);
        this.highLight = true;
      }
    },
    mounted() {
      if (this.message.messageContent.quoteInfo) {
        let messageUid = this.message.messageContent.quoteInfo.messageUid;
        let msg = store.getMessageByUid(messageUid);
        if (!msg) {
          wfc.loadRemoteMessage(messageUid, (ms) => {
            msg = store._patchMessage(ms[0]);
            this.quotedMessage = msg;
          }, (err) => {
            formatAppLog("log", "at pages/conversation/message/NormalInMessageContentContainerView.vue:89", "load remote message error", messageUid, err);
          });
        } else {
          this.quotedMessage = msg;
        }
      }
    },
    computed: {
      isDownloading() {
        return store.isDownloadingMessage(this.message.messageId);
      },
      isMessageChecked() {
        return this.sharedPickState.messages.findIndex((m) => m.messageId === this.message.messageId) >= 0;
      }
    },
    components: {
      MessageContentContainerView,
      QuoteMessageView,
      LoadingView
    }
  };
  function _sfc_render$V(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_MessageContentContainerView = vue.resolveComponent("MessageContentContainerView");
    const _component_QuoteMessageView = vue.resolveComponent("QuoteMessageView");
    return vue.openBlock(), vue.createElementBlock("div", { class: "container" }, [
      vue.createElementVNode(
        "div",
        {
          class: vue.normalizeClass(["message-time-container", { checked: $data.sharedPickState.messages.indexOf($props.message) >= 0 }])
        },
        [
          this.message._showTime ? (vue.openBlock(), vue.createElementBlock(
            "p",
            {
              key: 0,
              class: "time"
            },
            vue.toDisplayString($props.message._timeStr),
            1
            /* TEXT */
          )) : vue.createCommentVNode("v-if", true),
          vue.createElementVNode("div", { class: "message-avatar-content-container" }, [
            vue.createElementVNode("div", { class: "avatar-container" }, [
              $data.sharedConversationState.enableMessageMultiSelection ? (vue.openBlock(), vue.createElementBlock("checkbox", {
                key: 0,
                id: "checkbox",
                type: "checkbox",
                value: $props.message,
                checked: $options.isMessageChecked
              }, null, 8, ["value", "checked"])) : vue.createCommentVNode("v-if", true),
              vue.createElementVNode("img", {
                onClick: _cache[0] || (_cache[0] = ($event) => $options.onClickUserPortrait($props.message.from)),
                class: "avatar",
                draggable: "false",
                src: $props.message._from.portrait,
                alt: ""
              }, null, 8, ["src"])
            ]),
            vue.createCommentVNode("消息内容 根据情况，if-else"),
            vue.createElementVNode("div", { class: "message-name-content-container" }, [
              vue.createElementVNode(
                "p",
                { class: "name" },
                vue.toDisplayString($props.message._from._displayName),
                1
                /* TEXT */
              ),
              vue.createElementVNode("div", { class: "flex-column flex-align-start" }, [
                vue.createElementVNode("div", { class: "flex-row" }, [
                  vue.createVNode(_component_MessageContentContainerView, {
                    class: "message-content-container",
                    message: $props.message,
                    onContextmenu: _cache[1] || (_cache[1] = vue.withModifiers(($event) => $options.openMessageContextMenu($event, $props.message), ["prevent"]))
                  }, null, 8, ["message"]),
                  vue.createCommentVNode('                            <LoadingView v-if="isDownloading"/>')
                ]),
                $data.quotedMessage ? (vue.openBlock(), vue.createBlock(_component_QuoteMessageView, {
                  key: 0,
                  style: { "padding": "5px 0", "max-width": "80%" },
                  message: $props.message,
                  "quoted-message": $data.quotedMessage,
                  "message-digest": this.message.messageContent.quoteInfo.messageDigest,
                  "show-close-button": false
                }, null, 8, ["message", "quoted-message", "message-digest"])) : vue.createCommentVNode("v-if", true)
              ])
            ])
          ])
        ],
        2
        /* CLASS */
      )
    ]);
  }
  const NormalInMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$W, [["render", _sfc_render$V], ["__scopeId", "data-v-fad8b9b4"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/NormalInMessageContentContainerView.vue"]]);
  const _sfc_main$V = {
    name: "NotificationMessageContentView",
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    components: {}
  };
  function _sfc_render$U(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "notification-container" }, [
      vue.createElementVNode(
        "p",
        { class: "notification" },
        vue.toDisplayString($props.message.messageContent.digest($props.message)),
        1
        /* TEXT */
      )
    ]);
  }
  const NotificationMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$V, [["render", _sfc_render$U], ["__scopeId", "data-v-7445324b"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/NotificationMessageContentView.vue"]]);
  const _sfc_main$U = {
    name: "RecallNotificationMessageContentView",
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    methods: {
      isReeditable() {
        let delta = wfc.getServerDeltaTime();
        let now2 = (/* @__PURE__ */ new Date()).getTime();
        let recallMessageContent = this.message.messageContent;
        if (recallMessageContent.originalContentType === MessageContentType.Text && recallMessageContent.fromSelf && now2 - (numberValue(this.message.timestamp) - delta) < Config.RECALL_REEDIT_TIME_LIMIT * 1e3) {
          return true;
        }
        return false;
      },
      reedit() {
        this.$parent.reedit(this.message);
      }
    },
    components: {}
  };
  function _sfc_render$T(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "notification-container" }, [
      vue.createElementVNode(
        "p",
        { class: "notification" },
        vue.toDisplayString($props.message.messageContent.digest($props.message)),
        1
        /* TEXT */
      ),
      $options.isReeditable($props.message) ? (vue.openBlock(), vue.createElementBlock("a", {
        key: 0,
        href: "#",
        onClick: _cache[0] || (_cache[0] = (...args) => $options.reedit && $options.reedit(...args))
      }, "重新编辑")) : vue.createCommentVNode("v-if", true)
    ]);
  }
  const RecallNotificationMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$U, [["render", _sfc_render$T], ["__scopeId", "data-v-d07b485c"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/RecallNotificationMessageContentView.vue"]]);
  const _sfc_main$T = {
    name: "MessageMultiSelectionActionView",
    data() {
      return {
        sharedPickState: store.state.pick
      };
    },
    methods: {
      deleteMultiMessage() {
        store.deleteSelectedMessages();
      },
      hideMultiSelectionActionView() {
        store.toggleMessageMultiSelection();
      },
      forwardOneByOne() {
        let messages2 = [...this.sharedPickState.messages];
        this.$forward({
          forwardType: ForwardType.ONE_BY_ONE,
          messages: messages2
        });
        store.toggleMessageMultiSelection();
      },
      forwardComposite() {
        let messages2 = [...this.sharedPickState.messages];
        this.$forward({
          forwardType: ForwardType.COMPOSITE,
          messages: messages2
        });
        store.toggleMessageMultiSelection();
      },
      fav() {
        let messages2 = [...this.sharedPickState.messages];
        this.$parent.favMessages(messages2);
        store.toggleMessageMultiSelection();
      }
    }
  };
  function _sfc_render$S(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "multi-selection-action-container" }, [
      vue.createElementVNode("ul", null, [
        vue.createElementVNode("li", null, [
          vue.createElementVNode("div", {
            class: "action",
            onClick: _cache[0] || (_cache[0] = (...args) => $options.forwardOneByOne && $options.forwardOneByOne(...args))
          }, [
            vue.createElementVNode("div", { class: "icon" }, [
              vue.createElementVNode("i", { class: "icon-ion-forward" })
            ]),
            vue.createElementVNode(
              "p",
              null,
              vue.toDisplayString(_ctx.$t("conversation.forward_one_by_one")),
              1
              /* TEXT */
            )
          ])
        ]),
        vue.createElementVNode("li", null, [
          vue.createElementVNode("div", {
            class: "action",
            onClick: _cache[1] || (_cache[1] = (...args) => $options.forwardComposite && $options.forwardComposite(...args))
          }, [
            vue.createElementVNode("div", { class: "icon" }, [
              vue.createElementVNode("i", { class: "icon-ion-quote" })
            ]),
            vue.createElementVNode(
              "p",
              null,
              vue.toDisplayString(_ctx.$t("conversation.forward_composite")),
              1
              /* TEXT */
            )
          ])
        ]),
        vue.createElementVNode("li", null, [
          vue.createElementVNode("div", {
            class: "action",
            onClick: _cache[2] || (_cache[2] = (...args) => $options.fav && $options.fav(...args))
          }, [
            vue.createElementVNode("div", { class: "icon" }, [
              vue.createElementVNode("i", { class: "icon-ion-android-favorite" })
            ]),
            vue.createElementVNode(
              "p",
              null,
              vue.toDisplayString(_ctx.$t("common.fav")),
              1
              /* TEXT */
            )
          ])
        ]),
        vue.createElementVNode("li", null, [
          vue.createElementVNode("div", { class: "action" }, [
            vue.createElementVNode("div", {
              onClick: _cache[3] || (_cache[3] = (...args) => $options.deleteMultiMessage && $options.deleteMultiMessage(...args)),
              class: "icon"
            }, [
              vue.createElementVNode("i", { class: "icon-ion-android-delete" })
            ]),
            vue.createElementVNode(
              "p",
              null,
              vue.toDisplayString(_ctx.$t("common.delete")),
              1
              /* TEXT */
            )
          ])
        ]),
        vue.createElementVNode("li", null, [
          vue.createElementVNode("div", { class: "action" }, [
            vue.createElementVNode("i", {
              onClick: _cache[4] || (_cache[4] = (...args) => $options.hideMultiSelectionActionView && $options.hideMultiSelectionActionView(...args)),
              class: "icon-ion-close"
            })
          ])
        ])
      ])
    ]);
  }
  const MultiSelectActionView = /* @__PURE__ */ _export_sfc(_sfc_main$T, [["render", _sfc_render$S], ["__scopeId", "data-v-442d1f59"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/MessageMultiSelectActionView.vue"]]);
  class GroupMemberType {
  }
  __publicField(GroupMemberType, "Normal", 0);
  __publicField(GroupMemberType, "Manager", 1);
  __publicField(GroupMemberType, "Owner", 2);
  __publicField(GroupMemberType, "Muted", 3);
  __publicField(GroupMemberType, "Removed", 4);
  __publicField(GroupMemberType, "Allowed", 5);
  const _sfc_main$S = {
    name: "RichNotificationMessageContentView",
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    methods: {
      onClickRichNotification() {
        formatAppLog("log", "at pages/conversation/message/RichNotificationMessageContentView.vue:34", "onClickRichNotification");
        let targetPageUrl = "/pages/workspace/WorkspaceWebViewPage";
        this.$navigateToPage(`${targetPageUrl}?url=${encodeURIComponent(this.message.messageContent.exUrl)}`);
      }
    },
    components: {}
  };
  function _sfc_render$R(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { style: { "display": "flex", "justify-content": "center" } }, [
      vue.createElementVNode("div", {
        class: "notification-container",
        onClick: _cache[0] || (_cache[0] = (...args) => $options.onClickRichNotification && $options.onClickRichNotification(...args))
      }, [
        vue.createElementVNode(
          "p",
          { class: "title" },
          vue.toDisplayString($props.message.messageContent.title),
          1
          /* TEXT */
        ),
        vue.createElementVNode(
          "p",
          { class: "desc" },
          vue.toDisplayString($props.message.messageContent.desc),
          1
          /* TEXT */
        ),
        $props.message.messageContent.datas ? (vue.openBlock(), vue.createElementBlock("div", { key: 0 }, [
          (vue.openBlock(true), vue.createElementBlock(
            vue.Fragment,
            null,
            vue.renderList($props.message.messageContent.datas, (data, index) => {
              return vue.openBlock(), vue.createElementBlock("div", {
                key: index,
                class: "data"
              }, [
                vue.createElementVNode(
                  "p",
                  { class: "key single-line" },
                  vue.toDisplayString(data.key),
                  1
                  /* TEXT */
                ),
                vue.createElementVNode(
                  "p",
                  { class: "value" },
                  vue.toDisplayString(data.value),
                  1
                  /* TEXT */
                )
              ]);
            }),
            128
            /* KEYED_FRAGMENT */
          ))
        ])) : vue.createCommentVNode("v-if", true),
        vue.createElementVNode("div", { class: "ex-info-container" }, [
          vue.createElementVNode(
            "p",
            { class: "exName" },
            vue.toDisplayString($props.message.messageContent.exName),
            1
            /* TEXT */
          )
        ])
      ])
    ]);
  }
  const RichNotificationMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$S, [["render", _sfc_render$R], ["__scopeId", "data-v-fb8a3f13"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/RichNotificationMessageContentView.vue"]]);
  const _sfc_main$R = {
    name: "ArticlesMessageContentView",
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    methods: {
      openArticle(article) {
        open(article.url);
      }
    }
  };
  function _sfc_render$Q(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("section", { class: "articles-container" }, [
      !$props.message.messageContent.subArticles || !$props.message.messageContent.subArticles.length ? (vue.openBlock(), vue.createElementBlock("div", {
        key: 0,
        class: "top-article",
        onClick: _cache[0] || (_cache[0] = ($event) => $options.openArticle($props.message.messageContent.topArticle))
      }, [
        vue.createElementVNode("image", {
          src: $props.message.messageContent.topArticle.cover
        }, null, 8, ["src"]),
        vue.createElementVNode(
          "p",
          null,
          vue.toDisplayString($props.message.messageContent.topArticle.title),
          1
          /* TEXT */
        )
      ])) : (vue.openBlock(), vue.createElementBlock("div", {
        key: 1,
        class: "top-article sub",
        onClick: _cache[1] || (_cache[1] = ($event) => $options.openArticle($props.message.messageContent.topArticle))
      }, [
        vue.createElementVNode("image", {
          src: $props.message.messageContent.topArticle.cover
        }, null, 8, ["src"]),
        vue.createElementVNode(
          "p",
          null,
          vue.toDisplayString($props.message.messageContent.topArticle.title),
          1
          /* TEXT */
        )
      ])),
      $props.message.messageContent.subArticles ? (vue.openBlock(true), vue.createElementBlock(
        vue.Fragment,
        { key: 2 },
        vue.renderList($props.message.messageContent.subArticles, (sa, si) => {
          return vue.openBlock(), vue.createElementBlock("div", {
            key: si,
            class: "sub-article",
            onClick: _cache[2] || (_cache[2] = ($event) => $options.openArticle($props.message.messageContent.topArticle))
          }, [
            vue.createElementVNode(
              "p",
              null,
              vue.toDisplayString(sa.title),
              1
              /* TEXT */
            ),
            vue.createElementVNode("image", {
              src: sa.cover
            }, null, 8, ["src"])
          ]);
        }),
        128
        /* KEYED_FRAGMENT */
      )) : vue.createCommentVNode("v-if", true)
    ]);
  }
  const ArticlesMessageContentView = /* @__PURE__ */ _export_sfc(_sfc_main$R, [["render", _sfc_render$Q], ["__scopeId", "data-v-badb3497"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/ArticlesMessageContentView.vue"]]);
  const _sfc_main$Q = {
    name: "ContextableNotificationMessageContentContainerView",
    components: { ArticlesMessageContentView, RichNotificationMessageContentView },
    props: {
      message: {
        type: Message,
        required: true
      }
    },
    data() {
      return {
        sharedConversationState: store.state.conversation,
        sharedPickState: store.state.pick,
        highLight: false
      };
    },
    methods: {
      openMessageContextMenu(event, message2) {
        this.$eventBus.$emit("openMessageContextMenu", [event, message2]);
        this.highLight = true;
      },
      onContextMenuClosed() {
        this.highLight = false;
      }
    },
    mounted() {
      this.$eventBus.$on("contextMenuClosed", this.onContextMenuClosed);
    },
    beforeUnmount() {
      this.$eventBus.$off("contextMenuClosed", this.onContextMenuClosed);
    }
  };
  function _sfc_render$P(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_RichNotificationMessageContentView = vue.resolveComponent("RichNotificationMessageContentView");
    const _component_ArticlesMessageContentView = vue.resolveComponent("ArticlesMessageContentView");
    return vue.openBlock(), vue.createElementBlock("section", null, [
      vue.createElementVNode(
        "div",
        {
          class: vue.normalizeClass(["message-time-container", { checked: $data.sharedPickState.messages.indexOf($props.message) >= 0 }])
        },
        [
          this.message._showTime ? (vue.openBlock(), vue.createElementBlock(
            "p",
            {
              key: 0,
              class: "time"
            },
            vue.toDisplayString($props.message._timeStr),
            1
            /* TEXT */
          )) : vue.createCommentVNode("v-if", true),
          vue.createElementVNode(
            "div",
            {
              class: vue.normalizeClass(["message-content-container", { checked: $data.sharedPickState.messages.indexOf($props.message) >= 0 }])
            },
            [
              $data.sharedConversationState.enableMessageMultiSelection ? (vue.openBlock(), vue.createElementBlock("checkbox", {
                key: 0,
                id: "checkbox",
                type: "checkbox",
                class: "checkbox",
                value: $props.message,
                placeholder: ""
              }, null, 8, ["value"])) : vue.createCommentVNode("v-if", true),
              $props.message.messageContent.type === 12 ? (vue.openBlock(), vue.createBlock(_component_RichNotificationMessageContentView, {
                key: 1,
                message: $props.message,
                onContextmenu: _cache[0] || (_cache[0] = vue.withModifiers(($event) => $options.openMessageContextMenu($event, $props.message), ["prevent"]))
              }, null, 8, ["message"])) : $props.message.messageContent.type === 13 ? (vue.openBlock(), vue.createBlock(_component_ArticlesMessageContentView, {
                key: 2,
                message: $props.message,
                onContextmenu: _cache[1] || (_cache[1] = vue.withModifiers(($event) => $options.openMessageContextMenu($event, $props.message), ["prevent"]))
              }, null, 8, ["message"])) : vue.createCommentVNode("v-if", true)
            ],
            2
            /* CLASS */
          )
        ],
        2
        /* CLASS */
      )
    ]);
  }
  const ContextableNotificationMessageContentContainerView = /* @__PURE__ */ _export_sfc(_sfc_main$Q, [["render", _sfc_render$P], ["__scopeId", "data-v-9d64c5ba"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/ContextableNotificationMessageContentContainerView.vue"]]);
  var innerAudioContext;
  const _sfc_main$P = {
    name: "ConversationPage",
    components: {
      ContextableNotificationMessageContentContainerView,
      MultiSelectActionView,
      NotificationMessageContentView,
      RecallNotificationMessageContentView,
      NormalInMessageContentView,
      NormalOutMessageContentView,
      MessageInputView
    },
    // props: ["conversation"],
    data() {
      return {
        conversationInfo: store.state.conversation.currentConversationInfo,
        sharedConversationState: store.state.conversation,
        sharedContactState: store.state.contact,
        sharedPickState: store.state.pick,
        sharedMiscState: store.state.misc,
        savedMessageListViewHeight: -1,
        saveMessageListViewFlexGrow: -1,
        dragAndDropEnterCount: 0,
        showContextMenu: false,
        isScroll: false,
        touchStartX: 0,
        touchStartY: 0,
        contextMenuX: 0,
        contextMenuY: 0,
        contextMenuItems: [],
        lastScrollTop: 0,
        keyboardHeight: 0,
        currentKeyboardHeight: 0,
        scrollTop: 0,
        triggered: false,
        ongoingCalls: [],
        ongoingCallTimer: 0
      };
    },
    onLoad() {
    },
    onShow() {
      this.updateConversationTitle();
    },
    onNavigationBarButtonTap(e) {
      if (this.conversationInfo.conversation.type === ConversationType.Single) {
        uni.navigateTo({
          url: "/pages/conversation/SingleConversationInfoPage",
          success: (res) => {
            res.eventChannel.emit("conversationInfo", {
              conversationInfo: this.conversationInfo
            });
          },
          fail: (err) => {
            formatAppLog("log", "at pages/conversation/ConversationPage.vue:187", "nav to SingleConversationInfoPage err", err);
          }
        });
      } else if (this.conversationInfo.conversation.type === ConversationType.Group) {
        uni.navigateTo({
          url: "/pages/conversation/GroupConversationInfoPage",
          success: (res) => {
            res.eventChannel.emit("conversationInfo", {
              conversationInfo: this.conversationInfo
            });
          },
          fail: (err) => {
            formatAppLog("log", "at pages/conversation/ConversationPage.vue:200", "nav to GroupConversationInfoPage err", err);
          }
        });
      } else {
        uni.showToast({
          title: "TODO 暂不支持该会话类型",
          icon: "none"
        });
      }
    },
    onUnload() {
      store.setCurrentConversationInfo(null);
    },
    methods: {
      toggleMessageMultiSelectionActionView(message2) {
        store.toggleMessageMultiSelection(message2);
      },
      clickMessageItem(event, message2) {
        if (message2.messageContent instanceof NotificationMessageContent) {
          return;
        }
        if (this.sharedConversationState.enableMessageMultiSelection) {
          store.selectOrDeselectMessage(message2);
          event.stopPropagation();
          event.preventDefault();
        }
      },
      isNotificationMessage(message2) {
        return message2 && message2.messageContent instanceof NotificationMessageContent && message2.messageContent.type !== MessageContentType.RecallMessage_Notification && message2.messageContent.type !== MessageContentType.Rich_Notification;
      },
      isContextableNotificationMessage(message2) {
        return message2 && (message2.messageContent instanceof RichNotificationMessageContent || message2.messageContent instanceof ArticlesMessageContent);
      },
      isRecallNotificationMessage(message2) {
        return message2 && message2.messageContent.type === MessageContentType.RecallMessage_Notification;
      },
      reedit(message2) {
        this.$refs.messageInputView.insertText(message2.messageContent.originalSearchableContent);
      },
      onScroll(e) {
      },
      onMessageSenderContextMenuClose() {
        formatAppLog("log", "at pages/conversation/ConversationPage.vue:275", "onMessageSenderContextMenuClose");
      },
      // message context menu
      isCopyable(message2) {
        return message2 && (message2.messageContent instanceof TextMessageContent || message2.messageContent instanceof ImageMessageContent);
      },
      isDownloadAble(message2) {
        return message2 && (message2.messageContent instanceof ImageMessageContent || message2.messageContent instanceof FileMessageContent || message2.messageContent instanceof VideoMessageContent);
      },
      isForwardable(message2) {
        if (message2 && message2.messageContent instanceof SoundMessageContent) {
          return false;
        }
        return true;
      },
      isFavable(message2) {
        if (!message2) {
          return false;
        }
        return [
          MessageContentType.VOIP_CONTENT_TYPE_START,
          MessageContentType.CONFERENCE_CONTENT_TYPE_INVITE
        ].indexOf(message2.messageContent.type) <= -1;
      },
      isRecallable(message2) {
        if (message2) {
          if (message2.conversation.type === ConversationType.Group) {
            let groupInfo = wfc.getGroupInfo(message2.conversation.target);
            let selfUserId = wfc.getUserId();
            if (groupInfo && groupInfo.owner === selfUserId) {
              return true;
            }
            let groupMember = wfc.getGroupMember(message2.conversation.target, selfUserId);
            if (groupMember && [GroupMemberType.Manager, GroupMemberType.Owner].indexOf(groupMember.type) > -1) {
              return true;
            }
          }
          let delta = wfc.getServerDeltaTime();
          let now2 = (/* @__PURE__ */ new Date()).getTime();
          if (message2.direction === 0 && now2 - (numberValue(message2.timestamp) - delta) < 60 * 1e3) {
            return true;
          }
        }
        return false;
      },
      isLocalFile(message2) {
        return false;
      },
      isQuotable(message2) {
        if (!message2) {
          return false;
        }
        return [
          MessageContentType.VOIP_CONTENT_TYPE_START,
          MessageContentType.Voice,
          MessageContentType.Video,
          MessageContentType.Composite_Message,
          MessageContentType.CONFERENCE_CONTENT_TYPE_INVITE
        ].indexOf(message2.messageContent.type) <= -1;
      },
      copy(message2) {
        let content = message2.messageContent;
        if (content instanceof TextMessageContent) {
          let selectedText = window.getSelection().toString();
          if (selectedText) {
            copyText(selectedText);
          } else {
            copyText(content.content);
          }
        } else {
          copyImg(content.remotePath);
        }
      },
      download(message2) {
      },
      openFile(message2) {
        message2.messageContent;
      },
      openDir(message2) {
        message2.messageContent;
      },
      recallMessage(message2) {
        wfc.recallMessage(message2.messageUid, null, null);
      },
      forward(message2) {
        this.$forward({
          forwardType: ForwardType.NORMAL,
          messages: [message2]
        });
      },
      quoteMessage(message2) {
        store.quoteMessage(message2);
      },
      // call from child
      favMessages(messages2) {
        formatAppLog("log", "at pages/conversation/ConversationPage.vue:399", "fav messages");
        let compositeMessageContent = new CompositeMessageContent();
        let title = "";
        let msgConversation = messages2[0].conversation;
        if (msgConversation.type === ConversationType.Single) {
          let users = store.getUserInfos([wfc.getUserId(), msgConversation.target], "");
          title = users[0]._displayName + "和" + users[1]._displayName + "的聊天记录";
        } else {
          title = "群的聊天记录";
        }
        compositeMessageContent.title = title;
        compositeMessageContent.messages = messages2;
        let message2 = new Message(msgConversation, compositeMessageContent);
        message2.from = wfc.getUserId();
        this.favMessage(message2);
      },
      favMessage(message2) {
        uni.showToast({
          title: "TODO ",
          icon: "none"
        });
        return;
      },
      multiSelect(message2) {
        this.toggleMessageMultiSelectionActionView(message2);
      },
      // why？
      // 用于控制，同时只能播放一个语言，如果是将逻辑放到 AudioMessageContentView 里面，控制起来会更麻烦
      playVoice(message2) {
        if (innerAudioContext) {
          innerAudioContext.stop();
        }
        let voice = message2.messageContent;
        let mp3RemotePath = Config.AMR_TO_MP3_SERVER_ADDRESS + voice.remotePath;
        innerAudioContext = uni.createInnerAudioContext();
        innerAudioContext.autoplay = false;
        innerAudioContext.src = mp3RemotePath;
        innerAudioContext.onPlay(() => {
          message2._isPlaying = true;
        });
        innerAudioContext.onError((res) => {
          message2._isPlaying = false;
          store.playVoice(null);
        });
        innerAudioContext.onEnded(() => {
          message2._isPlaying = false;
          store.playVoice(null);
        });
        innerAudioContext.play();
      },
      mentionMessageSenderTitle(message2) {
        if (!message2) {
          return "";
        }
        let displayName = wfc.getGroupMemberDisplayName(message2.conversation.target, message2.from);
        return "@" + displayName;
      },
      mentionMessageSender(message2) {
        this.$refs.messageInputView.mention(message2.conversation.target, message2.from);
      },
      onReceiveMessage(message2, hasMore) {
        if (this.conversationInfo && this.conversationInfo.conversation.equal(message2.conversation) && message2.messageContent instanceof MultiCallOngoingMessageContent && Config.ENABLE_MULTI_CALL_AUTO_JOIN) {
          if (message2.messageContent.targets.indexOf(wfc.getUserId()) >= 0) {
            return;
          }
          let index = this.ongoingCalls.findIndex((call) => call.messageContent.callId === message2.messageContent.callId);
          if (index > -1) {
            this.ongoingCalls[index] = message2;
          } else {
            this.ongoingCalls.push(message2);
          }
          if (!this.ongoingCallTimer) {
            this.ongoingCallTimer = setInterval(() => {
              this.ongoingCalls = this.ongoingCalls.filter((call) => {
                return (/* @__PURE__ */ new Date()).getTime() - (numberValue(call.timestamp) - numberValue(wfc.getServerDeltaTime())) < 3 * 1e3;
              });
              if (this.ongoingCalls.length === 0) {
                clearInterval(this.ongoingCallTimer);
                this.ongoingCallTimer = 0;
              }
              formatAppLog("log", "at pages/conversation/ConversationPage.vue:529", "ongoing calls", this.ongoingCalls.length);
            }, 1e3);
          }
        }
      },
      joinMultiCall(message2) {
        let request = new JoinCallRequestMessageContent(message2.messageContent.callId, wfc.getClientId());
        wfc.sendConversationMessage(this.conversationInfo.conversation, request);
      },
      onTouchStart(e) {
        this.isScroll = false;
        this.touchStartX = e.touches[0].clientX;
        this.touchStartY = e.touches[0].clientY;
      },
      onTouchMove(e) {
        uni.hideKeyboard();
        let delX = e.touches[0].clientX - this.touchStartX;
        let delY = e.touches[0].clientY - this.touchStartY;
        if (Math.abs(delX) > 5 || Math.abs(delY) > 5) {
          this.isScroll = true;
        }
      },
      showMessageContextMenu(e, message2) {
        if (this.isScroll) {
          return;
        }
        this.contextMenuX = e.clientX ? e.clientX : e.touches[0].clientX;
        this.contextMenuY = e.clientY ? e.clientY : e.touches[0].clientY;
        this.contextMenuItems = [];
        if (this.isCopyable(message2)) {
          this.contextMenuItems.push({
            title: "复制",
            message: message2,
            tag: "copy"
          });
        }
        if (this.isDownloadAble(message2)) {
          this.contextMenuItems.push({
            title: "下载",
            message: message2,
            tag: "copy"
          });
        }
        this.contextMenuItems.push({
          title: "本地删除",
          message: message2,
          tag: "delete"
        });
        this.contextMenuItems.push({
          title: "远程删除",
          message: message2,
          tag: "deleteRemote"
        });
        if (this.isForwardable(message2)) {
          this.contextMenuItems.push({
            title: "转发",
            message: message2,
            tag: "forward"
          });
        }
        if (this.isRecallable(message2)) {
          this.contextMenuItems.push({
            title: "撤回",
            message: message2,
            tag: "recall"
          });
        }
        if (this.isQuotable(message2)) {
          this.contextMenuItems.push({
            title: "引用",
            message: message2,
            tag: "quote"
          });
        }
        this.contextMenuItems.push({
          title: "多选",
          message: message2,
          tag: "multiSelection"
        });
        this.showContextMenu = true;
      },
      onContextMenuItemSelect(t2) {
        switch (t2.tag) {
          case "delete":
            formatAppLog("log", "at pages/conversation/ConversationPage.vue:651", "wfc delete message", t2.message.messageId);
            wfc.deleteMessage(t2.message.messageId);
            break;
          case "deleteRemote":
            wfc.deleteRemoteMessageByUid(t2.message.messageUid, () => {
              formatAppLog("log", "at pages/conversation/ConversationPage.vue:656", "delete remote message success");
            }, (err) => {
              formatAppLog("log", "at pages/conversation/ConversationPage.vue:658", "delete remote message fail", err);
            });
            break;
          case "forward":
            this.forward(t2.message);
            break;
          case "recall":
            this.recallMessage(t2.message);
            break;
          case "quote":
            store.quoteMessage(t2.message);
            break;
          case "multiSelection":
            this.multiSelect(t2.message);
            break;
          default:
            uni.showToast({
              title: "TODO " + t2.title,
              icon: "none"
            });
            break;
        }
        this.$eventBus.$emit("contextMenuClosed");
      },
      updateConversationTitle() {
        uni.setNavigationBarTitle({
          title: this.targetUserOnlineStateDesc ? this.conversationTitle + `(${this.targetUserOnlineStateDesc})` : this.conversationTitle
        });
      },
      onPulling(e) {
      },
      onRefresh() {
        formatAppLog("log", "at pages/conversation/ConversationPage.vue:693", "onRresh...");
        if (this._freshing) {
          return;
        }
        this._freshing = true;
        this.triggered = true;
        store.loadConversationHistoryMessages(() => {
          formatAppLog("log", "at pages/conversation/ConversationPage.vue:701", "onRresh... 11");
          this.triggered = false;
          this._freshing = false;
        }, () => {
          formatAppLog("log", "at pages/conversation/ConversationPage.vue:705", "onRresh... 12");
          this.triggered = false;
          this._freshing = false;
        });
      },
      onRestore() {
        this.triggered = "restore";
        formatAppLog("log", "at pages/conversation/ConversationPage.vue:712", "onRestore");
      },
      onAbort() {
        formatAppLog("log", "at pages/conversation/ConversationPage.vue:715", "onAbort");
      },
      scrollToBottom() {
        this.scrollTop = 999999 + this.lastMessageId;
      }
    },
    mounted() {
      uni.setNavigationBarTitle({
        title: this.targetUserOnlineStateDesc ? this.conversationTitle + `(${this.targetUserOnlineStateDesc})` : this.conversationTitle
      });
      this.scrollToBottom();
      store.clearConversationUnreadStatus(this.conversationInfo.conversation);
      this.keyboardHeight = getItem("keyboardHeight");
      this.$eventBus.$on("openMessageContextMenu", ([event, message2]) => {
        this.showMessageContextMenu(event, message2);
      });
      wfc.eventEmitter.on(EventType.ReceiveMessage, this.onReceiveMessage);
    },
    unmounted() {
      this.$eventBus.$off("openMessageContextMenu");
      wfc.eventEmitter.removeListener(EventType.ReceiveMessage, this.onReceiveMessage);
    },
    beforeUpdate() {
    },
    updated() {
      if (!this.sharedConversationState.currentConversationInfo) {
        return;
      }
      if (this.sharedConversationState.shouldAutoScrollToBottom) {
        this.scrollToBottom();
      }
      if (this.sharedConversationState.currentConversationInfo) {
        let unreadCount = this.sharedConversationState.currentConversationInfo.unreadCount;
        if (unreadCount.unread > 0) {
          store.clearConversationUnreadStatus(this.sharedConversationState.currentConversationInfo.conversation);
        }
      }
      this.conversationInfo = this.sharedConversationState.currentConversationInfo;
    },
    computed: {
      conversationTitle() {
        let info = this.sharedConversationState.currentConversationInfo;
        return !info ? "" : info.conversation._target._displayName;
      },
      targetUserOnlineStateDesc() {
        let info = this.sharedConversationState.currentConversationInfo;
        return info ? info.conversation._targetOnlineStateDesc : null;
      },
      loadingIdentifier() {
        let conversation2 = this.sharedConversationState.currentConversationInfo.conversation;
        return conversation2.type + "-" + conversation2.target + "-" + conversation2.line;
      },
      currentVoiceMessage() {
        let voice = this.sharedConversationState.currentVoiceMessage;
        if (voice) {
          this.playVoice(voice);
        } else {
          if (innerAudioContext) {
            innerAudioContext.stop();
            innerAudioContext = null;
          }
        }
        return null;
      },
      lastMessageId() {
        return this.conversationInfo.lastMessage ? this.conversationInfo.lastMessage.messageId : "";
      }
    },
    directives: {
      // ClickOutside
    }
  };
  function _sfc_render$O(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_NotificationMessageContentView = vue.resolveComponent("NotificationMessageContentView");
    const _component_RecallNotificationMessageContentView = vue.resolveComponent("RecallNotificationMessageContentView");
    const _component_ContextableNotificationMessageContentContainerView = vue.resolveComponent("ContextableNotificationMessageContentContainerView");
    const _component_NormalOutMessageContentView = vue.resolveComponent("NormalOutMessageContentView");
    const _component_NormalInMessageContentView = vue.resolveComponent("NormalInMessageContentView");
    const _component_chunLei_popups = resolveEasycom(vue.resolveDynamicComponent("chunLei-popups"), __easycom_0$1);
    const _component_MessageInputView = vue.resolveComponent("MessageInputView");
    const _component_MultiSelectActionView = vue.resolveComponent("MultiSelectActionView");
    return vue.openBlock(), vue.createElementBlock("view", null, [
      $data.sharedConversationState.currentConversationInfo == null ? (vue.openBlock(), vue.createElementBlock("view", {
        key: 0,
        class: "conversation-empty-container"
      }, [
        vue.createElementVNode("text", null, "^~^")
      ])) : (vue.openBlock(), vue.createElementBlock("view", {
        key: 1,
        ref: "conversationContentContainer",
        class: "conversation-content-container",
        dummy_just_for_reactive: $options.currentVoiceMessage
      }, [
        vue.createElementVNode("view", { class: "message-list-container" }, [
          $data.ongoingCalls && $data.ongoingCalls.length > 0 ? (vue.openBlock(), vue.createElementBlock("view", {
            key: 0,
            class: "ongoing-call-container"
          }, [
            (vue.openBlock(true), vue.createElementBlock(
              vue.Fragment,
              null,
              vue.renderList($data.ongoingCalls, (value, index) => {
                return vue.openBlock(), vue.createElementBlock("view", {
                  key: index,
                  class: "ongoing-call-item"
                }, [
                  vue.createElementVNode(
                    "text",
                    null,
                    vue.toDisplayString(value.messageContent.digest(value)),
                    1
                    /* TEXT */
                  ),
                  vue.createElementVNode("button", {
                    onClick: ($event) => $options.joinMultiCall(value)
                  }, "加入", 8, ["onClick"])
                ]);
              }),
              128
              /* KEYED_FRAGMENT */
            ))
          ])) : vue.createCommentVNode("v-if", true),
          vue.createElementVNode("scroll-view", {
            ref: "conversationMessageList",
            class: "message-list",
            "scroll-y": "true",
            "scroll-top": $data.scrollTop,
            "refresher-enabled": "true",
            "refresher-triggered": $data.triggered,
            "refresher-threshold": 45,
            onRefresherpulling: _cache[0] || (_cache[0] = (...args) => $options.onPulling && $options.onPulling(...args)),
            onRefresherrefresh: _cache[1] || (_cache[1] = (...args) => $options.onRefresh && $options.onRefresh(...args)),
            onRefresherrestore: _cache[2] || (_cache[2] = (...args) => $options.onRestore && $options.onRestore(...args)),
            onRefresherabort: _cache[3] || (_cache[3] = (...args) => $options.onAbort && $options.onAbort(...args)),
            onScroll: _cache[4] || (_cache[4] = (...args) => $options.onScroll && $options.onScroll(...args))
          }, [
            (vue.openBlock(true), vue.createElementBlock(
              vue.Fragment,
              null,
              vue.renderList($data.sharedConversationState.currentConversationMessageList, (message2) => {
                return vue.openBlock(), vue.createElementBlock("view", {
                  id: "id-" + message2.messageId,
                  key: message2.messageId
                }, [
                  vue.createCommentVNode("todo 不同的消息类型 notification in out"),
                  $options.isNotificationMessage(message2) ? (vue.openBlock(), vue.createBlock(_component_NotificationMessageContentView, {
                    key: 0,
                    message: message2
                  }, null, 8, ["message"])) : $options.isRecallNotificationMessage(message2) ? (vue.openBlock(), vue.createBlock(_component_RecallNotificationMessageContentView, {
                    key: 1,
                    message: message2
                  }, null, 8, ["message"])) : $options.isContextableNotificationMessage(message2) ? (vue.openBlock(), vue.createBlock(_component_ContextableNotificationMessageContentContainerView, {
                    key: 2,
                    onClickCapture: ($event) => $data.sharedConversationState.enableMessageMultiSelection ? $options.clickMessageItem($event, message2) : null,
                    message: message2
                  }, null, 8, ["onClickCapture", "message"])) : message2.direction === 0 && $data.sharedConversationState.enableMessageMultiSelection ? (vue.openBlock(), vue.createBlock(_component_NormalOutMessageContentView, {
                    key: 3,
                    onClickCapture: vue.withModifiers(($event) => $data.sharedConversationState.enableMessageMultiSelection ? $options.clickMessageItem($event, message2) : null, ["stop"]),
                    message: message2,
                    onTouchstart: $options.onTouchStart,
                    onTouchmove: $options.onTouchMove
                  }, null, 8, ["onClickCapture", "message", "onTouchstart", "onTouchmove"])) : message2.direction === 0 && !$data.sharedConversationState.enableMessageMultiSelection ? (vue.openBlock(), vue.createBlock(_component_NormalOutMessageContentView, {
                    key: 4,
                    message: message2,
                    onTouchstart: $options.onTouchStart,
                    onTouchmove: $options.onTouchMove
                  }, null, 8, ["message", "onTouchstart", "onTouchmove"])) : message2.direction === 1 && $data.sharedConversationState.enableMessageMultiSelection ? (vue.openBlock(), vue.createBlock(_component_NormalInMessageContentView, {
                    key: 5,
                    onClickCapture: vue.withModifiers(($event) => $data.sharedConversationState.enableMessageMultiSelection ? $options.clickMessageItem($event, message2) : null, ["stop"]),
                    message: message2,
                    onTouchstart: $options.onTouchStart,
                    onTouchmove: $options.onTouchMove
                  }, null, 8, ["onClickCapture", "message", "onTouchstart", "onTouchmove"])) : (vue.openBlock(), vue.createBlock(_component_NormalInMessageContentView, {
                    key: 6,
                    message: message2,
                    onTouchstart: $options.onTouchStart,
                    onTouchmove: $options.onTouchMove
                  }, null, 8, ["message", "onTouchstart", "onTouchmove"]))
                ], 8, ["id"]);
              }),
              128
              /* KEYED_FRAGMENT */
            ))
          ], 40, ["scroll-top", "refresher-triggered"])
        ]),
        vue.createCommentVNode('            <view v-show="!sharedConversationState.enableMessageMultiSelection"'),
        vue.createCommentVNode('                  class="viewider-handler"></view>'),
        vue.createVNode(_component_chunLei_popups, {
          modelValue: $data.showContextMenu,
          "onUpdate:modelValue": _cache[5] || (_cache[5] = ($event) => $data.showContextMenu = $event),
          popData: $data.contextMenuItems,
          onTapPopup: $options.onContextMenuItemSelect,
          x: $data.contextMenuX,
          y: $data.contextMenuY,
          direction: "column",
          theme: "dark",
          triangle: false,
          dynamic: ""
        }, null, 8, ["modelValue", "popData", "onTapPopup", "x", "y"]),
        vue.withDirectives(vue.createVNode(_component_MessageInputView, {
          conversationInfo: $data.sharedConversationState.currentConversationInfo,
          class: "message-input-container",
          ref: "messageInputView"
        }, null, 8, ["conversationInfo"]), [
          [vue.vShow, !$data.sharedConversationState.enableMessageMultiSelection]
        ]),
        vue.withDirectives(vue.createVNode(
          _component_MultiSelectActionView,
          null,
          null,
          512
          /* NEED_PATCH */
        ), [
          [vue.vShow, $data.sharedConversationState.enableMessageMultiSelection]
        ])
      ], 8, ["dummy_just_for_reactive"]))
    ]);
  }
  const PagesConversationConversationPage = /* @__PURE__ */ _export_sfc(_sfc_main$P, [["render", _sfc_render$O], ["__scopeId", "data-v-06e23daa"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/ConversationPage.vue"]]);
  const _sfc_main$O = {
    name: "CompositeMessagePage",
    data() {
      return {
        message: null,
        compositeMessage: null
      };
    },
    onLoad(option) {
      formatAppLog("log", "at pages/conversation/message/CompositeMessagePage.vue:83", "CompositeMessagePage onLoad");
      const eventChannel = this.getOpenerEventChannel();
      eventChannel.on("options", (options) => {
        this.message = options.message;
        store._patchMessage(this.message, 0);
        if (this.message.messageContent.remotePath) {
          this.loadMediaCompositeMessage(this.message);
        } else {
          this.compositeMessage = this.message;
        }
        uni.setNavigationBarTitle({
          title: this.message.messageContent.title
        });
      });
    },
    mounted() {
    },
    methods: {
      loadMediaCompositeMessage(msg) {
        let content = msg.messageContent;
        formatAppLog("log", "at pages/conversation/message/CompositeMessagePage.vue:113", "to load", msg, content.remotePath);
        uni.request({
          url: content.remotePath,
          dataType: "string",
          success: (res) => {
            content._decodeMessages(res.data);
            store._patchMessage(this.message, 0);
            this.compositeMessage = this.message;
            content.loaded = true;
          }
        });
      }
    },
    components: {
      UnknowntMessageContentView,
      // ConferenceInviteMessageContentView,
      CompositeMessageContentView,
      // AudioMessageContentView,
      // CallStartMessageContentView,
      UnsupportMessageContentView,
      TextMessageContentView,
      ImageMessageContentView,
      VideoMessageContentView,
      FileMessageContentView,
      StickerMessageContentView
    }
  };
  function _sfc_render$N(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_TextMessageContentView = vue.resolveComponent("TextMessageContentView");
    const _component_ImageMessageContentView = vue.resolveComponent("ImageMessageContentView");
    const _component_FileMessageContentView = vue.resolveComponent("FileMessageContentView");
    const _component_VideoMessageContentView = vue.resolveComponent("VideoMessageContentView");
    const _component_StickerMessageContentView = vue.resolveComponent("StickerMessageContentView");
    const _component_CompositeMessageContentView = vue.resolveComponent("CompositeMessageContentView");
    const _component_UnsupportMessageContentView = vue.resolveComponent("UnsupportMessageContentView");
    const _component_UnknowntMessageContentView = vue.resolveComponent("UnknowntMessageContentView");
    return vue.openBlock(), vue.createElementBlock("section", { class: "composite-page" }, [
      !$data.compositeMessage ? (vue.openBlock(), vue.createElementBlock("div", {
        key: 0,
        style: { "display": "flex", "justify-content": "center", "align-items": "center" }
      }, " 加载中... ")) : (vue.openBlock(), vue.createElementBlock("ul", { key: 1 }, [
        (vue.openBlock(true), vue.createElementBlock(
          vue.Fragment,
          null,
          vue.renderList($data.compositeMessage.messageContent.messages, (message2, index) => {
            return vue.openBlock(), vue.createElementBlock("li", {
              key: message2.uid
            }, [
              vue.createElementVNode("div", { class: "message-container" }, [
                vue.createElementVNode("div", { class: "portrait-container" }, [
                  index === 0 || message2.from !== $data.compositeMessage.messageContent.messages[index - 1].from ? (vue.openBlock(), vue.createElementBlock("img", {
                    key: 0,
                    alt: "",
                    src: message2._from.portrait
                  }, null, 8, ["src"])) : vue.createCommentVNode("v-if", true)
                ]),
                vue.createElementVNode("div", { class: "name-time-content-container" }, [
                  vue.createElementVNode("div", { class: "name-time-container" }, [
                    vue.createElementVNode(
                      "p",
                      { class: "name" },
                      vue.toDisplayString(message2._from._displayName),
                      1
                      /* TEXT */
                    ),
                    vue.createElementVNode(
                      "p",
                      { class: "time" },
                      vue.toDisplayString(message2._timeStr),
                      1
                      /* TEXT */
                    ),
                    vue.createCommentVNode('                            <p class="time"> 1223</p>')
                  ]),
                  vue.createElementVNode("div", { class: "content" }, [
                    vue.createCommentVNode("message content"),
                    message2.messageContent.type === 1 ? (vue.openBlock(), vue.createBlock(_component_TextMessageContentView, {
                      key: 0,
                      message: message2,
                      style: { "--out-arrow-color": "#98ea70", "--in-arrow-color": "white" },
                      class: vue.normalizeClass({ leftarrow: message2.direction === 1, rightarrow: message2.direction === 0 })
                    }, null, 8, ["message", "class"])) : message2.messageContent.type === 3 ? (vue.openBlock(), vue.createElementBlock(
                      vue.Fragment,
                      { key: 1 },
                      [
                        vue.createCommentVNode('                            <AudioMessageContentView :message="message"'),
                        vue.createCommentVNode('                                                     v-else-if="message.messageContent.type === 2"/>'),
                        vue.createVNode(_component_ImageMessageContentView, {
                          message: message2,
                          "is-in-composite-view": true
                        }, null, 8, ["message"])
                      ],
                      2112
                      /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */
                    )) : message2.messageContent.type === 5 ? (vue.openBlock(), vue.createElementBlock(
                      vue.Fragment,
                      { key: 2 },
                      [
                        vue.createCommentVNode('                           v-bind:class="{leftarrow:message.direction === 1, rightarrow: message.direction === 0}"/>'),
                        vue.createVNode(_component_FileMessageContentView, {
                          message: message2,
                          class: vue.normalizeClass({ leftarrow: message2.direction === 1, rightarrow: message2.direction === 0 })
                        }, null, 8, ["message", "class"])
                      ],
                      2112
                      /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */
                    )) : message2.messageContent.type === 6 ? (vue.openBlock(), vue.createBlock(_component_VideoMessageContentView, {
                      key: 3,
                      message: message2,
                      "is-in-composite-view": true
                    }, null, 8, ["message"])) : message2.messageContent.type === 7 ? (vue.openBlock(), vue.createElementBlock(
                      vue.Fragment,
                      { key: 4 },
                      [
                        vue.createCommentVNode('                           v-bind:class="{leftarrow:message.direction === 1, rightarrow: message.direction === 0}"/>'),
                        vue.createVNode(_component_StickerMessageContentView, { message: message2 }, null, 8, ["message"])
                      ],
                      2112
                      /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */
                    )) : message2.messageContent.type === 11 ? (vue.openBlock(), vue.createBlock(_component_CompositeMessageContentView, {
                      key: 5,
                      message: message2
                    }, null, 8, ["message"])) : [2, 10, 400, 408].indexOf(message2.messageContent.type) >= 0 ? (vue.openBlock(), vue.createElementBlock(
                      vue.Fragment,
                      { key: 6 },
                      [
                        vue.createCommentVNode('                            <CallStartMessageContentView :message="message"'),
                        vue.createCommentVNode('                                                         v-else-if="message.messageContent.type === 400"/>'),
                        vue.createCommentVNode('                            <ConferenceInviteMessageContentView :message="message"'),
                        vue.createCommentVNode('                                                                v-else-if="message.messageContent.type === 408"/>'),
                        vue.createVNode(_component_UnsupportMessageContentView, { message: message2 }, null, 8, ["message"])
                      ],
                      2112
                      /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */
                    )) : (vue.openBlock(), vue.createBlock(_component_UnknowntMessageContentView, {
                      key: 7,
                      message: message2,
                      class: vue.normalizeClass({ leftarrow: message2.direction === 1, rightarrow: message2.direction === 0 })
                    }, null, 8, ["message", "class"]))
                  ])
                ])
              ])
            ]);
          }),
          128
          /* KEYED_FRAGMENT */
        ))
      ]))
    ]);
  }
  const PagesConversationMessageCompositeMessagePage = /* @__PURE__ */ _export_sfc(_sfc_main$O, [["render", _sfc_render$N], ["__scopeId", "data-v-dc442ec0"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/CompositeMessagePage.vue"]]);
  const _sfc_main$N = {
    name: "UserListView",
    props: {
      users: {
        type: Array,
        required: true
      },
      currentUser: {
        type: Object,
        default: null
      },
      showCategoryLabel: {
        type: Boolean,
        required: false,
        default: true
      },
      enableCategoryLabelSticky: {
        type: Boolean,
        required: false,
        default: false
      },
      clickUserItemFunc: {
        type: Function,
        required: false
      },
      paddingLeft: {
        type: String,
        required: false,
        default: "5px"
      }
    },
    data() {
      return {
        sharedContactState: store.state.contact
      };
    },
    methods: {
      clickUserItem(user) {
        if (this.clickUserItemFunc) {
          this.clickUserItemFunc(user);
        } else {
          store.setCurrentFriend(user);
          uni.navigateTo({
            url: "/pages/contact/UserDetailPage",
            success: () => {
              formatAppLog("log", "at pages/user/UserListView.vue:84", "nav to UserDetailPage success");
            },
            fail: (err) => {
              formatAppLog("log", "at pages/user/UserListView.vue:88", "nav to UserDetailPage err", err);
            }
          });
        }
      },
      scrollActiveElementCenter() {
        let el = this.$el.getElementsByClassName("active")[0];
        el && el.scrollIntoView({ behavior: "instant", block: "center" });
      },
      imgUrlAlt(e) {
        e.target.src = Config.DEFAULT_PORTRAIT_URL;
      }
    },
    mounted() {
      formatAppLog("log", "at pages/user/UserListView.vue:106", "userList", this.users.length);
    },
    activated() {
      this.scrollActiveElementCenter();
    },
    unmounted() {
    },
    computed: {
      groupedUsers() {
        let groupedUsers = [];
        if (!this.showCategoryLabel) {
          groupedUsers.push({
            category: "not-show-category",
            users: this.users
          });
        } else {
          let current = {};
          let lastCategory = null;
          this.users.forEach((user) => {
            if (!lastCategory || lastCategory !== user._category) {
              lastCategory = user._category;
              current = {
                category: user._category,
                users: [user]
              };
              groupedUsers.push(current);
            } else {
              current.users.push(user);
            }
          });
        }
        return groupedUsers;
      },
      paddingStyle() {
        return {
          paddingLeft: this.paddingLeft
        };
      }
    },
    components: {
      UniList: __easycom_0$2,
      UserCardView
    }
  };
  function _sfc_render$M(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_uni_list = resolveEasycom(vue.resolveDynamicComponent("uni-list"), __easycom_0$2);
    return vue.openBlock(), vue.createBlock(_component_uni_list, { style: { "width": "100%" } }, {
      default: vue.withCtx(() => [
        (vue.openBlock(true), vue.createElementBlock(
          vue.Fragment,
          null,
          vue.renderList($options.groupedUsers, (groupedUser) => {
            return vue.openBlock(), vue.createElementBlock("view", {
              key: groupedUser.category
            }, [
              vue.createElementVNode(
                "div",
                {
                  ref_for: true,
                  ref: "contactItem",
                  class: "contact-item"
                },
                [
                  $props.showCategoryLabel ? (vue.openBlock(), vue.createElementBlock(
                    "div",
                    {
                      key: 0,
                      class: vue.normalizeClass(["label", { sticky: $props.enableCategoryLabelSticky }]),
                      style: vue.normalizeStyle($options.paddingStyle)
                    },
                    [
                      vue.createElementVNode(
                        "p",
                        null,
                        vue.toDisplayString(groupedUser.category.toUpperCase()),
                        1
                        /* TEXT */
                      )
                    ],
                    6
                    /* CLASS, STYLE */
                  )) : vue.createCommentVNode("v-if", true),
                  vue.createVNode(
                    _component_uni_list,
                    { style: { "width": "100%" } },
                    {
                      default: vue.withCtx(() => [
                        (vue.openBlock(true), vue.createElementBlock(
                          vue.Fragment,
                          null,
                          vue.renderList(groupedUser.users, (user) => {
                            return vue.openBlock(), vue.createElementBlock("view", {
                              key: user.uid
                            }, [
                              vue.createElementVNode("div", {
                                class: vue.normalizeClass(["content", { active: $data.sharedContactState.currentFriend && user._category === $data.sharedContactState.currentFriend._category && user.uid === $data.sharedContactState.currentFriend.uid || $props.currentUser && $props.currentUser.uid === user.uid }]),
                                name: "user-" + user.uid,
                                style: vue.normalizeStyle($options.paddingStyle),
                                onClick: vue.withModifiers(($event) => $options.clickUserItem(user), ["stop"])
                              }, [
                                vue.createElementVNode("img", {
                                  class: "avatar",
                                  src: user.portrait,
                                  alt: "",
                                  onError: _cache[0] || (_cache[0] = (...args) => $options.imgUrlAlt && $options.imgUrlAlt(...args))
                                }, null, 40, ["src"]),
                                vue.createElementVNode("div", { style: { "padding-left": "10px" } }, [
                                  vue.createElementVNode(
                                    "p",
                                    { class: "single-line" },
                                    vue.toDisplayString(user._displayName ? user._displayName : user.displayName),
                                    1
                                    /* TEXT */
                                  ),
                                  user._userOnlineStatusDesc ? (vue.openBlock(), vue.createElementBlock(
                                    "p",
                                    {
                                      key: 0,
                                      class: "single-line user-online-status"
                                    },
                                    vue.toDisplayString(user._userOnlineStatusDesc),
                                    1
                                    /* TEXT */
                                  )) : vue.createCommentVNode("v-if", true)
                                ])
                              ], 14, ["name", "onClick"])
                            ]);
                          }),
                          128
                          /* KEYED_FRAGMENT */
                        ))
                      ]),
                      _: 2
                      /* DYNAMIC */
                    },
                    1024
                    /* DYNAMIC_SLOTS */
                  )
                ],
                512
                /* NEED_PATCH */
              )
            ]);
          }),
          128
          /* KEYED_FRAGMENT */
        ))
      ]),
      _: 1
      /* STABLE */
    });
  }
  const UserListView = /* @__PURE__ */ _export_sfc(_sfc_main$N, [["render", _sfc_render$M], ["__scopeId", "data-v-7b8a04d3"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/user/UserListView.vue"]]);
  const _sfc_main$M = {
    name: "SingleConversationInfoPage",
    data() {
      return {
        conversationInfo: null,
        users: null,
        sharedContactState: store.state.contact
      };
    },
    onLoad(option) {
      formatAppLog("log", "at pages/conversation/SingleConversationInfoPage.vue:31", "SingleConversationInfoPage onLoad");
      const eventChannel = this.getOpenerEventChannel();
      eventChannel.on("conversationInfo", (options) => {
        this.conversationInfo = options.conversationInfo;
        this.users = store.getConversationMemberUsrInfos(this.conversationInfo.conversation);
        uni.setNavigationBarTitle({
          title: this.conversationInfo.conversation._target._displayName
        });
      });
    },
    components: { UserListView },
    methods: {
      showCreateConversationModal() {
        this.$pickUsers(
          {
            users: this.sharedContactState.favContactList.concat(this.sharedContactState.friendList),
            initialCheckedUsers: [this.conversationInfo.conversation._target],
            uncheckableUsers: [this.conversationInfo.conversation._target],
            confirmTitle: this.$t("common.add"),
            successCB: (users) => {
              let newPickedUsers = users;
              newPickedUsers.push(this.conversationInfo.conversation._target);
              store.createConversation(newPickedUsers);
            }
          }
        );
      },
      showUserInfo(user) {
        formatAppLog("log", "at pages/conversation/SingleConversationInfoPage.vue:65", "todo show userInfo", user);
      }
    },
    computed: {}
  };
  function _sfc_render$L(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_UserListView = vue.resolveComponent("UserListView");
    return vue.openBlock(), vue.createElementBlock("div", { class: "conversation-info" }, [
      vue.createElementVNode("div", { class: "conversation-action-container" }, [
        vue.createElementVNode("div", {
          onClick: _cache[0] || (_cache[0] = (...args) => $options.showCreateConversationModal && $options.showCreateConversationModal(...args)),
          class: "action-item"
        }, [
          vue.createElementVNode("div", { class: "icon" }, "+"),
          vue.createElementVNode(
            "p",
            null,
            vue.toDisplayString(_ctx.$t("conversation.add_member")),
            1
            /* TEXT */
          )
        ])
      ]),
      $data.users ? (vue.openBlock(), vue.createBlock(_component_UserListView, {
        key: 0,
        users: $data.users,
        "show-category-label": false,
        "padding-left": "20px"
      }, null, 8, ["users"])) : vue.createCommentVNode("v-if", true)
    ]);
  }
  const PagesConversationSingleConversationInfoPage = /* @__PURE__ */ _export_sfc(_sfc_main$M, [["render", _sfc_render$L], ["__scopeId", "data-v-4176fb07"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/SingleConversationInfoPage.vue"]]);
  const _sfc_main$L = {
    name: "ForwardMessageView",
    props: {
      forwardType: {
        // 可参考ForwardType
        type: Number,
        required: false
      },
      messages: {
        type: Array,
        required: true
      }
    },
    data() {
      return {
        extraMessageText: ""
      };
    },
    methods: {},
    computed: {
      forwardMessageStr() {
        let str;
        let firstMsg = this.messages[0];
        switch (this.forwardType) {
          case ForwardType.NORMAL:
            str = !firstMsg._from ? "" : firstMsg._from._displayName + ":";
            if ([MessageContentType.Image, MessageContentType.Video].indexOf(firstMsg.messageContent.type) < 0) {
              str += firstMsg.messageContent.digest(this.quotedMessage);
            }
            break;
          case ForwardType.ONE_BY_ONE:
            str = "[" + this.$t("conversation.forward_one_by_one") + "]";
            if (firstMsg.conversation.type === ConversationType.Single) {
              str += this.$t("conversation.user_message_records", [firstMsg._from._displayName]);
            } else {
              str += this.$t("conversation.group_message_records");
            }
            break;
          case ForwardType.COMPOSITE:
            str = "[" + this.$t("conversation.forward_composite") + "]";
            if (firstMsg.conversation.type === ConversationType.Single) {
              str += this.$t("conversation.user_message_records", [firstMsg._from._displayName]);
            } else {
              str += this.$t("conversation.group_message_records");
            }
            break;
        }
        return str;
      }
    }
  };
  function _sfc_render$K(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "forward-message-container" }, [
      vue.createElementVNode("div", { class: "forward-message" }, [
        $props.forwardType === 0 ? (vue.openBlock(), vue.createElementBlock("div", { key: 0 }, [
          [3, 6].indexOf($props.messages[0].messageContent.type) >= 0 ? (vue.openBlock(), vue.createElementBlock("img", {
            key: 0,
            src: "data:video/jpeg;base64," + $props.messages[0].messageContent.thumbnail,
            alt: ""
          }, null, 8, ["src"])) : (vue.openBlock(), vue.createElementBlock(
            "p",
            { key: 1 },
            vue.toDisplayString(this.forwardMessageStr),
            1
            /* TEXT */
          ))
        ])) : (vue.openBlock(), vue.createElementBlock("div", { key: 1 }, [
          vue.createElementVNode(
            "p",
            null,
            vue.toDisplayString(this.forwardMessageStr),
            1
            /* TEXT */
          )
        ]))
      ]),
      vue.createElementVNode("label", null, [
        vue.withDirectives(vue.createElementVNode("input", {
          type: "text",
          placeholder: _ctx.$t("conversation.forward_extra"),
          "onUpdate:modelValue": _cache[0] || (_cache[0] = ($event) => $data.extraMessageText = $event)
        }, null, 8, ["placeholder"]), [
          [vue.vModelText, $data.extraMessageText]
        ])
      ])
    ]);
  }
  const ForwardMessageView = /* @__PURE__ */ _export_sfc(_sfc_main$L, [["render", _sfc_render$K], ["__scopeId", "data-v-aae82120"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/forward/ForwardMessageView.vue"]]);
  const _sfc_main$K = {
    name: "ForwardMessageByPickConversationView",
    props: {
      forwardType: {
        // 可参考ForwardType
        type: Number,
        required: false
      },
      messages: {
        type: Array,
        required: false
      }
    },
    data() {
      return {
        sharedConversation: store.state.conversation,
        sharedPickState: store.state.pick,
        query: "",
        sharedSearchState: store.state.search
      };
    },
    methods: {
      onConversationItemClick(conversation2) {
        store.pickOrUnpickConversation(conversation2, true);
      },
      unpConversation(conversation2) {
        store.pickOrUnpickConversation(conversation2, false);
      },
      isConversationChecked(conversation2) {
        let index = this.sharedPickState.conversations.findIndex((conv) => conv.equal(conversation2));
        return index >= 0;
      },
      showForwardByCreateConversationModal() {
        this.sharedPickState.conversations.length = 0;
        this.$emit("forward-target-type", "createConversation");
      },
      confirm() {
        let pickedConversations = [...this.sharedPickState.conversations];
        this.sharedPickState.conversations.length = 0;
        let extraMessageText = this.$refs["forwardMessageView"].extraMessageText;
        store.forwardMessage(this.forwardType, pickedConversations, this.messages, extraMessageText);
        uni.navigateBack();
      }
    },
    computed: {
      conversationInfos() {
        if (this.query && this.query.trim()) {
          return store.filterConversation(this.query);
        } else {
          return this.sharedConversation.conversationInfoList;
        }
      }
    },
    components: { ForwardMessageView }
  };
  function _sfc_render$J(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_ForwardMessageView = vue.resolveComponent("ForwardMessageView");
    return vue.openBlock(), vue.createElementBlock("div", { class: "pick-conversation-container" }, [
      vue.createElementVNode("div", { class: "conversation-list-panel" }, [
        vue.createElementVNode("div", { class: "input-container" }, [
          vue.withDirectives(vue.createElementVNode("input", {
            type: "text",
            placeholder: _ctx.$t("common.search"),
            "onUpdate:modelValue": _cache[0] || (_cache[0] = ($event) => $data.query = $event)
          }, null, 8, ["placeholder"]), [
            [vue.vModelText, $data.query]
          ])
        ]),
        vue.createElementVNode("div", { class: "conversation-list-container" }, [
          vue.createElementVNode("div", {
            class: "create-group",
            onClick: _cache[1] || (_cache[1] = (...args) => $options.showForwardByCreateConversationModal && $options.showForwardByCreateConversationModal(...args))
          }, [
            vue.createElementVNode(
              "p",
              null,
              vue.toDisplayString(_ctx.$t("conversation.create_group")),
              1
              /* TEXT */
            )
          ]),
          vue.createElementVNode(
            "p",
            null,
            vue.toDisplayString(_ctx.$t("conversation.recent_conversation")),
            1
            /* TEXT */
          ),
          $options.conversationInfos.length ? (vue.openBlock(), vue.createElementBlock("ul", {
            key: 0,
            class: "conversation-list"
          }, [
            (vue.openBlock(true), vue.createElementBlock(
              vue.Fragment,
              null,
              vue.renderList($options.conversationInfos, (conversationInfo, index) => {
                return vue.openBlock(), vue.createElementBlock("li", { key: index }, [
                  vue.createElementVNode("div", {
                    class: "conversation-item",
                    onClick: vue.withModifiers(($event) => $options.onConversationItemClick(conversationInfo.conversation), ["stop"])
                  }, [
                    vue.createElementVNode("checkbox", {
                      class: "checkbox",
                      value: conversationInfo.conversation,
                      type: "checkbox",
                      checked: $options.isConversationChecked(conversationInfo.conversation),
                      placeholder: ""
                    }, null, 8, ["value", "checked"]),
                    vue.createElementVNode("div", { class: "header" }, [
                      vue.createElementVNode("img", {
                        class: "avatar",
                        src: conversationInfo.conversation._target.portrait,
                        alt: ""
                      }, null, 8, ["src"])
                    ]),
                    vue.createElementVNode(
                      "p",
                      { class: "title single-line" },
                      vue.toDisplayString(conversationInfo.conversation._target._displayName),
                      1
                      /* TEXT */
                    )
                  ], 8, ["onClick"])
                ]);
              }),
              128
              /* KEYED_FRAGMENT */
            ))
          ])) : vue.createCommentVNode("v-if", true)
        ])
      ]),
      vue.createElementVNode("div", { class: "checked-conversation-list-container" }, [
        vue.createElementVNode("header", null, [
          vue.createElementVNode(
            "h2",
            null,
            vue.toDisplayString(_ctx.$t("conversation.forward_title")),
            1
            /* TEXT */
          ),
          $data.sharedPickState.conversations.length === 0 ? (vue.openBlock(), vue.createElementBlock(
            "span",
            { key: 0 },
            vue.toDisplayString(_ctx.$t("conversation.not_select_conversation")),
            1
            /* TEXT */
          )) : (vue.openBlock(), vue.createElementBlock(
            "span",
            { key: 1 },
            vue.toDisplayString(_ctx.$t("conversation.select_conversation_desc", [this.sharedPickState.conversations.length])),
            1
            /* TEXT */
          )),
          vue.createElementVNode(
            "button",
            {
              size: "mini",
              onClick: _cache[2] || (_cache[2] = (...args) => $options.confirm && $options.confirm(...args)),
              class: "confirm"
            },
            vue.toDisplayString(_ctx.$t("common.send")),
            1
            /* TEXT */
          )
        ]),
        vue.createElementVNode("div", { class: "content" }, [
          (vue.openBlock(true), vue.createElementBlock(
            vue.Fragment,
            null,
            vue.renderList($data.sharedPickState.conversations, (conversation2, index) => {
              return vue.openBlock(), vue.createElementBlock("div", {
                class: "picked-user-container",
                key: index
              }, [
                vue.createElementVNode("div", {
                  class: "picked-user",
                  onClick: ($event) => $options.unpConversation(conversation2)
                }, [
                  vue.createElementVNode("img", {
                    class: "avatar",
                    src: conversation2._target.portrait,
                    alt: ""
                  }, null, 8, ["src"]),
                  vue.createCommentVNode('                        <view @click="unpConversation(conversation)" class="unpick-button">X</view>')
                ], 8, ["onClick"]),
                vue.createElementVNode(
                  "span",
                  { class: "name single-line" },
                  vue.toDisplayString(conversation2._target._displayName),
                  1
                  /* TEXT */
                )
              ]);
            }),
            128
            /* KEYED_FRAGMENT */
          ))
        ]),
        vue.createVNode(_component_ForwardMessageView, {
          ref: "forwardMessageView",
          "forward-type": $props.forwardType,
          messages: $props.messages
        }, null, 8, ["forward-type", "messages"]),
        vue.createCommentVNode("            <footer>"),
        vue.createCommentVNode(`                <button @click="cancel" class="cancel">{{ $t('common.cancel') }}</button>`),
        vue.createCommentVNode(`                <button @click="confirm" class="confirm">{{ $t('common.send') }}</button>`),
        vue.createCommentVNode("            </footer>")
      ])
    ]);
  }
  const ForwardMessageByPickConversationView = /* @__PURE__ */ _export_sfc(_sfc_main$K, [["render", _sfc_render$J], ["__scopeId", "data-v-f30a00ba"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/forward/ForwardMessageByPickConversationView.vue"]]);
  const _sfc_main$J = {
    name: "CheckableUserListView",
    props: {
      enablePick: {
        type: Boolean,
        default: false
      },
      users: {
        type: Array,
        required: true
      },
      initialCheckedUsers: {
        type: Array,
        required: false,
        default: null
      },
      uncheckableUsers: {
        type: Array,
        required: false,
        default: null
      },
      showCategoryLabel: {
        type: Boolean,
        required: false,
        default: true
      },
      enableCategoryLabelSticky: {
        type: Boolean,
        required: false,
        default: false
      },
      paddingLeft: {
        type: String,
        required: false,
        default: "5px"
      }
    },
    data() {
      return {
        sharedPickState: store.state.pick,
        sharedContactState: store.state.contact
      };
    },
    methods: {
      clickUserItem(user) {
        if (this.isUserUncheckable(user)) {
          return;
        }
        store.pickOrUnpickUser(user);
      },
      isUserInitialChecked(user) {
        return this.initialCheckedUsers && this.initialCheckedUsers.findIndex((u) => u.uid === user.uid) >= 0;
      },
      isUserUncheckable(user) {
        return this.uncheckableUsers && this.uncheckableUsers.findIndex((u) => u.uid === user.uid) >= 0;
      },
      isUserChecked(user) {
        return store.isUserPicked(user);
      }
    },
    mounted() {
      if (this.initialCheckedUsers) {
        let oriCUs = this.users.filter((u) => this.initialCheckedUsers.findIndex((iu) => iu.uid === u.uid) > -1);
        oriCUs.forEach((u) => store.pickOrUnpickUser(u));
      }
    },
    computed: {
      groupedUsers() {
        let groupedUsers = [];
        if (!this.showCategoryLabel) {
          groupedUsers.push({
            category: "",
            users: this.users
          });
          return groupedUsers;
        }
        let current = {};
        let lastCategory = null;
        this.users.forEach((user) => {
          if (!lastCategory || lastCategory !== user._category) {
            lastCategory = user._category;
            current = {
              category: user._category,
              users: [user]
            };
            groupedUsers.push(current);
          } else {
            current.users.push(user);
          }
        });
        return groupedUsers;
      },
      paddingStyle() {
        return {
          paddingLeft: this.paddingLeft
        };
      }
    }
  };
  function _sfc_render$I(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", null, [
      vue.createElementVNode("ul", null, [
        (vue.openBlock(true), vue.createElementBlock(
          vue.Fragment,
          null,
          vue.renderList($options.groupedUsers, (groupedUser) => {
            return vue.openBlock(), vue.createElementBlock("li", {
              key: groupedUser.category
            }, [
              vue.createElementVNode(
                "div",
                {
                  ref_for: true,
                  ref: "contactItem",
                  class: "contact-item"
                },
                [
                  $props.showCategoryLabel ? (vue.openBlock(), vue.createElementBlock(
                    "div",
                    {
                      key: 0,
                      class: vue.normalizeClass(["label", { sticky: $props.enableCategoryLabelSticky }]),
                      style: vue.normalizeStyle($options.paddingStyle)
                    },
                    [
                      vue.createElementVNode(
                        "p",
                        null,
                        vue.toDisplayString(groupedUser.category.toUpperCase()),
                        1
                        /* TEXT */
                      )
                    ],
                    6
                    /* CLASS, STYLE */
                  )) : vue.createCommentVNode("v-if", true),
                  vue.createElementVNode("ul", null, [
                    (vue.openBlock(true), vue.createElementBlock(
                      vue.Fragment,
                      null,
                      vue.renderList(groupedUser.users, (user) => {
                        return vue.openBlock(), vue.createElementBlock("li", {
                          key: user.uid
                        }, [
                          vue.createElementVNode("div", {
                            class: vue.normalizeClass(["content", { disabled: $options.isUserUncheckable(user) }]),
                            name: "user-" + user.uid,
                            style: vue.normalizeStyle($options.paddingStyle),
                            onClick: vue.withModifiers(($event) => $options.clickUserItem(user), ["stop"])
                          }, [
                            vue.createElementVNode("checkbox-group", {
                              onChange: ($event) => $options.clickUserItem(user)
                            }, [
                              vue.createElementVNode("checkbox", {
                                class: "checkbox",
                                value: user.uid,
                                disabled: $options.isUserUncheckable(user),
                                type: "checkbox",
                                checked: $options.isUserChecked(user)
                              }, null, 8, ["value", "disabled", "checked"])
                            ], 40, ["onChange"]),
                            vue.createElementVNode("img", {
                              class: "avatar",
                              src: user.portrait,
                              alt: ""
                            }, null, 8, ["src"]),
                            vue.createElementVNode(
                              "span",
                              { class: "single-line" },
                              vue.toDisplayString(user._displayName || (user.groupAlias ? user.groupAlias : user.friendAlias ? user.friendAlias : user.displayName ? user.displayName : "用户")),
                              1
                              /* TEXT */
                            )
                          ], 14, ["name", "onClick"])
                        ]);
                      }),
                      128
                      /* KEYED_FRAGMENT */
                    ))
                  ])
                ],
                512
                /* NEED_PATCH */
              )
            ]);
          }),
          128
          /* KEYED_FRAGMENT */
        ))
      ])
    ]);
  }
  const CheckableUserListView = /* @__PURE__ */ _export_sfc(_sfc_main$J, [["render", _sfc_render$I], ["__scopeId", "data-v-394c372f"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/user/CheckableUserListView.vue"]]);
  const _sfc_main$I = {
    name: "ForwardMessageByCreateConversationView",
    props: {
      forwardType: {
        // 可参考ForwardType
        type: Number,
        required: false
      },
      messages: {
        type: Array,
        required: true
      }
    },
    data() {
      return {
        users: store.state.contact.friendList,
        sharedPickState: store.state.pick,
        query: ""
      };
    },
    methods: {
      unpick(user) {
        store.pickOrUnpickUser(user, false);
      },
      backPickConversation() {
        this.sharedPickState.users.length = 0;
        this.$emit("forward-target-type", "pickConversation");
      },
      confirm() {
        let pickedUsers = [...this.sharedPickState.users];
        this.sharedPickState.users.length = 0;
        let extraMessageText = this.$refs["forwardMessageView"].extraMessageText;
        store.forwardByCreateConversation(this.forwardType, pickedUsers, this.messages, extraMessageText);
        uni.navigateBack();
      }
    },
    computed: {
      filteredUsers() {
        let result;
        if (this.query && this.query.trim()) {
          result = store.filterContact(this.query);
        } else {
          result = this.users;
        }
        return result.filter((u) => u.uid !== Config.FILE_HELPER_ID);
      }
    },
    components: {
      CheckableUserListView,
      ForwardMessageView
    }
  };
  function _sfc_render$H(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_CheckableUserListView = vue.resolveComponent("CheckableUserListView");
    const _component_ForwardMessageView = vue.resolveComponent("ForwardMessageView");
    return vue.openBlock(), vue.createElementBlock("div", { class: "pick-user-container" }, [
      vue.createElementVNode("div", { class: "user-list-panel" }, [
        vue.createElementVNode("div", { class: "input-container" }, [
          vue.withDirectives(vue.createElementVNode("input", {
            type: "text",
            placeholder: _ctx.$t("common.search"),
            "onUpdate:modelValue": _cache[0] || (_cache[0] = ($event) => $data.query = $event)
          }, null, 8, ["placeholder"]), [
            [vue.vModelText, $data.query]
          ])
        ]),
        vue.createElementVNode("div", { class: "user-list-container" }, [
          vue.createElementVNode("div", {
            class: "back",
            onClick: _cache[1] || (_cache[1] = (...args) => $options.backPickConversation && $options.backPickConversation(...args))
          }, [
            vue.createElementVNode(
              "p",
              null,
              vue.toDisplayString(_ctx.$t("common.back")),
              1
              /* TEXT */
            )
          ]),
          vue.createVNode(_component_CheckableUserListView, {
            class: "user-list",
            "enable-pick": true,
            users: $options.filteredUsers,
            "padding-left": "20px",
            "enable-category-label-sticky": true
          }, null, 8, ["users"])
        ])
      ]),
      vue.createElementVNode("div", { class: "checked-user-list-container" }, [
        vue.createElementVNode("header", null, [
          vue.createElementVNode(
            "h2",
            null,
            vue.toDisplayString(_ctx.$t("conversation.forward_title")),
            1
            /* TEXT */
          ),
          $data.sharedPickState.users.length === 0 ? (vue.openBlock(), vue.createElementBlock(
            "span",
            { key: 0 },
            vue.toDisplayString(_ctx.$t("conversation.picked_contact")),
            1
            /* TEXT */
          )) : (vue.openBlock(), vue.createElementBlock(
            "span",
            { key: 1 },
            vue.toDisplayString(_ctx.$t("conversation.picked_contact") + this.sharedPickState.users.length),
            1
            /* TEXT */
          )),
          vue.createElementVNode(
            "button",
            {
              size: "mini",
              onClick: _cache[2] || (_cache[2] = (...args) => $options.confirm && $options.confirm(...args)),
              class: "confirm"
            },
            vue.toDisplayString(_ctx.$t("common.send")),
            1
            /* TEXT */
          )
        ]),
        vue.createElementVNode("div", { class: "content" }, [
          (vue.openBlock(true), vue.createElementBlock(
            vue.Fragment,
            null,
            vue.renderList($data.sharedPickState.users, (user, index) => {
              return vue.openBlock(), vue.createElementBlock("div", {
                class: "picked-user-container",
                key: index
              }, [
                vue.createElementVNode("div", {
                  class: "picked-user",
                  onClick: ($event) => $options.unpick(user)
                }, [
                  vue.createElementVNode("img", {
                    class: "avatar",
                    src: user.portrait,
                    alt: user + index
                  }, null, 8, ["src", "alt"]),
                  vue.createCommentVNode('                        <button @click="unpick(user)" class="unpick-button">x</button>')
                ], 8, ["onClick"]),
                vue.createElementVNode(
                  "span",
                  { class: "name single-line" },
                  vue.toDisplayString(user.displayName),
                  1
                  /* TEXT */
                )
              ]);
            }),
            128
            /* KEYED_FRAGMENT */
          ))
        ]),
        vue.createVNode(_component_ForwardMessageView, {
          ref: "forwardMessageView",
          "forward-type": $props.forwardType,
          messages: $props.messages
        }, null, 8, ["forward-type", "messages"]),
        vue.createCommentVNode("            <footer>"),
        vue.createCommentVNode(`                <button @click="cancel" class="cancel">{{ $t('common.cancel') }}</button>`),
        vue.createCommentVNode(`                <button @click="confirm" class="confirm">{{ $t('common.send') }}</button>`),
        vue.createCommentVNode("            </footer>")
      ])
    ]);
  }
  const ForwardMessageByCreateConversationView = /* @__PURE__ */ _export_sfc(_sfc_main$I, [["render", _sfc_render$H], ["__scopeId", "data-v-249d0aa4"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/forward/ForwardMessageByCreateConversationView.vue"]]);
  const _sfc_main$H = {
    name: "ForwardMessagePage",
    components: {
      ForwardMessageByCreateConversationView,
      ForwardMessageByPickConversationView
    },
    data() {
      return {
        forwardType: ForwardType.NORMAL,
        messages: [],
        sharedPickState: store.state.pick,
        forwardTargetType: "pickConversation"
      };
    },
    onLoad(option) {
      formatAppLog("log", "at pages/conversation/message/forward/ForwardMessagePage.vue:37", "ForwardMessageByPickConversationView onLoad");
      const eventChannel = this.getOpenerEventChannel();
      eventChannel.on("forwardOptions", (options) => {
        this.forwardType = options.forwardType;
        this.messages = options.messages;
        formatAppLog("log", "at pages/conversation/message/forward/ForwardMessagePage.vue:48", "to forward messagse", this.messages);
      });
    },
    onUnload() {
      this.sharedPickState.conversations = [];
      this.sharedPickState.messages = [];
      this.sharedPickState.users = [];
    },
    methods: {
      changeForwardTargetType(type) {
        this.forwardTargetType = type;
      }
    }
  };
  function _sfc_render$G(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_ForwardMessageByPickConversationView = vue.resolveComponent("ForwardMessageByPickConversationView");
    const _component_ForwardMessageByCreateConversationView = vue.resolveComponent("ForwardMessageByCreateConversationView");
    return vue.openBlock(), vue.createElementBlock("div", null, [
      $data.forwardTargetType === "pickConversation" && $data.messages.length > 0 ? (vue.openBlock(), vue.createBlock(_component_ForwardMessageByPickConversationView, {
        key: 0,
        messages: $data.messages,
        onForwardTargetType: $options.changeForwardTargetType,
        "forward-type": $data.forwardType
      }, null, 8, ["messages", "onForwardTargetType", "forward-type"])) : vue.createCommentVNode("v-if", true),
      $data.forwardTargetType !== "pickConversation" && $data.messages.length > 0 ? (vue.openBlock(), vue.createBlock(_component_ForwardMessageByCreateConversationView, {
        key: 1,
        messages: $data.messages,
        onForwardTargetType: $options.changeForwardTargetType,
        "forward-type": $data.forwardType
      }, null, 8, ["messages", "onForwardTargetType", "forward-type"])) : vue.createCommentVNode("v-if", true)
    ]);
  }
  const PagesConversationMessageForwardForwardMessagePage = /* @__PURE__ */ _export_sfc(_sfc_main$H, [["render", _sfc_render$G], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/message/forward/ForwardMessagePage.vue"]]);
  class ModifyGroupInfoType {
  }
  __publicField(ModifyGroupInfoType, "Modify_Group_Name", 0);
  __publicField(ModifyGroupInfoType, "Modify_Group_Portrait", 1);
  __publicField(ModifyGroupInfoType, "Modify_Group_Extra", 2);
  __publicField(ModifyGroupInfoType, "Modify_Group_Mute", 3);
  __publicField(ModifyGroupInfoType, "Modify_Group_JoinType", 4);
  __publicField(ModifyGroupInfoType, "Modify_Group_PrivateChat", 5);
  __publicField(ModifyGroupInfoType, "Modify_Group_Searchable", 6);
  const _sfc_main$G = {
    name: "GroupConversationInfoPage",
    data() {
      return {
        conversationInfo: null,
        groupMemberUserInfos: null,
        filterQuery: "",
        sharedContactState: store.state.contact,
        groupAnnouncement: "",
        newGroupName: "",
        newGroupAnnouncement: ""
      };
    },
    onLoad(option) {
      formatAppLog("log", "at pages/conversation/GroupConversationInfoPage.vue:85", "GroupConversationInfoPage onLoad");
      const eventChannel = this.getOpenerEventChannel();
      eventChannel.on("conversationInfo", (options) => {
        this.conversationInfo = options.conversationInfo;
        this.groupMemberUserInfos = store.getConversationMemberUsrInfos(this.conversationInfo.conversation);
        uni.setNavigationBarTitle({
          title: this.conversationInfo.conversation._target._displayName
        });
        this.getGroupAnnouncement();
      });
    },
    mounted() {
      wfc.eventEmitter.on(EventType.UserInfosUpdate, this.onConversationMembersUpdate);
      wfc.eventEmitter.on(EventType.GroupMembersUpdate, this.onConversationMembersUpdate);
    },
    beforeUnmount() {
      wfc.eventEmitter.removeListener(EventType.UserInfosUpdate, this.onConversationMembersUpdate);
      wfc.eventEmitter.removeListener(EventType.GroupMembersUpdate, this.onConversationMembersUpdate);
    },
    methods: {
      onConversationMembersUpdate() {
        this.groupMemberUserInfos = store.getConversationMemberUsrInfos(this.conversationInfo.conversation);
      },
      showCreateConversationModal() {
        let beforeClose = (users) => {
          let ids = users.map((u) => u.uid);
          wfc.addGroupMembers(this.conversationInfo.conversation.target, ids, null, [0], null, () => {
            this.groupMemberUserInfos = store.getConversationMemberUsrInfos(this.conversationInfo.conversation);
          }, (err) => {
            uni.showToast({
              title: "邀请新成员失败 " + err
            });
          });
        };
        let groupMemberUserInfos = store.getGroupMemberUserInfos(this.conversationInfo.conversation.target, false);
        this.$pickUsers(
          {
            users: this.sharedContactState.favContactList.concat(this.sharedContactState.friendList),
            initialCheckedUsers: groupMemberUserInfos,
            uncheckableUsers: groupMemberUserInfos,
            confirmTitle: this.$t("common.add"),
            successCB: beforeClose
          }
        );
      },
      showRemoveGroupMemberModal() {
        let beforeClose = (users) => {
          let ids = users.map((u) => u.uid);
          wfc.kickoffGroupMembers(this.conversationInfo.conversation.target, ids, [0], null, () => {
            this.groupMemberUserInfos = store.getConversationMemberUsrInfos(this.conversationInfo.conversation);
          }, (err) => {
            uni.showToast({
              title: "踢除群成员失败" + err
            });
          });
        };
        let groupMemberUserInfos = store.getGroupMemberUserInfos(this.conversationInfo.conversation.target, false, false);
        this.$pickUsers(
          {
            users: groupMemberUserInfos,
            confirmTitle: this.$t("common.remove"),
            showCategoryLabel: false,
            successCB: beforeClose
          }
        );
      },
      showUserInfo(user) {
        formatAppLog("log", "at pages/conversation/GroupConversationInfoPage.vue:164", "todo show userInfo", user);
      },
      async getGroupAnnouncement() {
        let url = Config.APP_SERVER + "/get_group_announcement";
        formatAppLog("log", "at pages/conversation/GroupConversationInfoPage.vue:169", "to getGroupAnnouncement", url, this.conversationInfo.conversation.target);
        appServerApi.getGroupAnnouncement(this.conversationInfo.conversation.target).then((result) => {
          if (result.text) {
            this.groupAnnouncement = result.text;
          } else {
            if (this.enableEditGroupNameOrAnnouncement) {
              this.groupAnnouncement = this.$t("conversation.click_to_edit_group_announcement");
            }
          }
        });
      },
      updateGroupName() {
        let groupId = this.conversationInfo.conversation.target;
        if (!this.newGroupName || this.newGroupName === this.conversationInfo.conversation._target._displayName) {
          return;
        }
        wfc.modifyGroupInfo(groupId, ModifyGroupInfoType.Modify_Group_Name, this.newGroupName, [0], null, () => {
          this.conversationInfo.conversation._target._displayName = this.newGroupName;
          uni.setNavigationBarTitle({
            title: this.conversationInfo.conversation._target._displayName
          });
        }, (err) => {
          formatAppLog("log", "at pages/conversation/GroupConversationInfoPage.vue:195", "err", err);
        });
      },
      async updateGroupAnnouncement() {
        if (!this.newGroupAnnouncement || this.newGroupAnnouncement === this.groupAnnouncement) {
          return;
        }
        formatAppLog("log", "at pages/conversation/GroupConversationInfoPage.vue:203", "updateGroupAnnouncement");
        appServerApi.updateGroupAnnouncement(wfc.getUserId(), this.conversationInfo.conversation.target, this.newGroupAnnouncement).then((result) => {
          this.groupAnnouncement = this.newGroupAnnouncement;
        });
      },
      quitGroup(dismiss) {
        if (dismiss) {
          store.dismissGroup(this.conversationInfo.conversation.target);
        } else {
          store.quitGroup(this.conversationInfo.conversation.target);
        }
        uni.switchTab({
          url: "/pages/conversationList/ConversationListPage",
          success: () => {
            formatAppLog("log", "at pages/conversation/GroupConversationInfoPage.vue:219", "to conversation list success");
          },
          fail: (e) => {
            formatAppLog("log", "at pages/conversation/GroupConversationInfoPage.vue:222", "to conversation list error", e);
          },
          complete: () => {
            formatAppLog("log", "at pages/conversation/GroupConversationInfoPage.vue:225", "switch tab complete");
          }
        });
      },
      setFavGroup(groupId, fav2) {
        formatAppLog("log", "at pages/conversation/GroupConversationInfoPage.vue:231", "setFavGroup", groupId, fav2);
        wfc.setFavGroup(groupId, fav2, () => {
          this.conversationInfo.conversation._target._isFav = fav2;
          store.reloadFavGroupList();
        }, (err) => {
          formatAppLog("log", "at pages/conversation/GroupConversationInfoPage.vue:236", "setFavGroup error", err);
        });
      }
    },
    components: { UserListView },
    created() {
    },
    computed: {
      enableAddGroupMember() {
        let selfUid = wfc.getUserId();
        let groupInfo = this.conversationInfo.conversation._target;
        if (groupInfo.type === GroupType.Restricted) {
          if (groupInfo.joinType === 0 || groupInfo.joinType === 1) {
            return true;
          } else if (groupInfo.joinType === 2) {
            let groupMember = wfc.getGroupMember(this.conversationInfo.conversation.target, selfUid);
            return [GroupMemberType.Manager, GroupMemberType.Owner].indexOf(groupMember.type) >= 0;
          }
        }
        return true;
      },
      enableRemoveGroupMember() {
        let selfUid = wfc.getUserId();
        let groupMember = wfc.getGroupMember(this.conversationInfo.conversation.target, selfUid);
        let t2 = false;
        if (groupMember) {
          t2 = [GroupMemberType.Manager, GroupMemberType.Owner].indexOf(groupMember.type) >= 0;
        }
        return t2;
      },
      enableEditGroupNameOrAnnouncement() {
        let selfUid = wfc.getUserId();
        let groupMember = wfc.getGroupMember(this.conversationInfo.conversation.target, selfUid);
        if (groupMember) {
          return [GroupMemberType.Manager, GroupMemberType.Owner].indexOf(groupMember.type) >= 0;
        }
        return false;
      },
      users() {
        if (this.filterQuery) {
          return store.filterUsers(this.groupMemberUserInfos, this.filterQuery);
        } else {
          return this.groupMemberUserInfos;
        }
      },
      isOwner() {
        let selfUid = wfc.getUserId();
        let groupInfo = this.conversationInfo.conversation._target;
        return groupInfo.owner === selfUid;
      }
    }
  };
  function _sfc_render$F(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_UserListView = vue.resolveComponent("UserListView");
    return $data.conversationInfo ? (vue.openBlock(), vue.createElementBlock("div", {
      key: 0,
      class: "conversation-info"
    }, [
      vue.createElementVNode("header", null, [
        vue.createElementVNode("label", null, [
          vue.createTextVNode(
            vue.toDisplayString(_ctx.$t("conversation.group_name")) + " ",
            1
            /* TEXT */
          ),
          vue.withDirectives(vue.createElementVNode("input", {
            type: "text",
            ref: "groupNameInput",
            disabled: !$options.enableEditGroupNameOrAnnouncement,
            "onUpdate:modelValue": _cache[0] || (_cache[0] = ($event) => $data.newGroupName = $event),
            onConfirm: _cache[1] || (_cache[1] = (...args) => $options.updateGroupName && $options.updateGroupName(...args)),
            placeholder: $data.conversationInfo.conversation._target._displayName
          }, null, 40, ["disabled", "placeholder"]), [
            [vue.vModelText, $data.newGroupName]
          ])
        ]),
        vue.createElementVNode("label", null, [
          vue.createTextVNode(
            vue.toDisplayString(_ctx.$t("conversation.group_announcement")) + " ",
            1
            /* TEXT */
          ),
          vue.withDirectives(vue.createElementVNode("input", {
            type: "text",
            ref: "groupAnnouncementInput",
            disabled: !$options.enableEditGroupNameOrAnnouncement,
            onConfirm: _cache[2] || (_cache[2] = (...args) => $options.updateGroupAnnouncement && $options.updateGroupAnnouncement(...args)),
            "onUpdate:modelValue": _cache[3] || (_cache[3] = ($event) => $data.newGroupAnnouncement = $event),
            placeholder: $data.groupAnnouncement
          }, null, 40, ["disabled", "placeholder"]), [
            [vue.vModelText, $data.newGroupAnnouncement]
          ])
        ]),
        vue.createElementVNode("label", { class: "switch" }, [
          vue.createTextVNode(" 保存到通讯录 "),
          vue.createElementVNode(
            "checkbox-group",
            {
              onChange: _cache[4] || (_cache[4] = ($event) => $options.setFavGroup($data.conversationInfo.conversation.target, $event.target.value.length === 1))
            },
            [
              vue.createElementVNode("checkbox", {
                value: "fav",
                checked: $data.conversationInfo.conversation._target._isFav
              }, null, 8, ["checked"])
            ],
            32
            /* NEED_HYDRATION */
          ),
          vue.createElementVNode("span", { class: "slider" })
        ])
      ]),
      vue.createElementVNode("div", { class: "search-item" }, [
        vue.withDirectives(vue.createElementVNode("input", {
          type: "text",
          "onUpdate:modelValue": _cache[5] || (_cache[5] = ($event) => $data.filterQuery = $event),
          placeholder: _ctx.$t("common.search")
        }, null, 8, ["placeholder"]), [
          [vue.vModelText, $data.filterQuery]
        ]),
        vue.createElementVNode("i", { class: "icon-ion-ios-search" })
      ]),
      vue.createElementVNode("div", { class: "member-container" }, [
        $options.enableAddGroupMember && !$data.filterQuery ? (vue.openBlock(), vue.createElementBlock("div", {
          key: 0,
          onClick: _cache[6] || (_cache[6] = (...args) => $options.showCreateConversationModal && $options.showCreateConversationModal(...args)),
          class: "action-item"
        }, [
          vue.createElementVNode("div", { class: "icon" }, "+"),
          vue.createElementVNode(
            "p",
            null,
            vue.toDisplayString(_ctx.$t("conversation.add_member")),
            1
            /* TEXT */
          )
        ])) : vue.createCommentVNode("v-if", true),
        $options.enableRemoveGroupMember && !$data.filterQuery ? (vue.openBlock(), vue.createElementBlock("div", {
          key: 1,
          onClick: _cache[7] || (_cache[7] = (...args) => $options.showRemoveGroupMemberModal && $options.showRemoveGroupMemberModal(...args)),
          class: "action-item"
        }, [
          vue.createElementVNode("div", { class: "icon" }, "-"),
          vue.createElementVNode(
            "p",
            null,
            vue.toDisplayString(_ctx.$t("conversation.remove_member")),
            1
            /* TEXT */
          )
        ])) : vue.createCommentVNode("v-if", true),
        vue.createVNode(_component_UserListView, {
          users: $options.users,
          "show-category-label": false,
          "padding-left": "20px"
        }, null, 8, ["users"])
      ]),
      vue.createElementVNode(
        "div",
        {
          onClick: _cache[8] || (_cache[8] = ($event) => $options.quitGroup(false)),
          class: "quit-group-item"
        },
        vue.toDisplayString(_ctx.$t("conversation.quit_group")),
        1
        /* TEXT */
      ),
      $options.isOwner ? (vue.openBlock(), vue.createElementBlock("div", {
        key: 0,
        onClick: _cache[9] || (_cache[9] = ($event) => $options.quitGroup(true)),
        class: "quit-group-item"
      }, " 解散群组 ")) : vue.createCommentVNode("v-if", true)
    ])) : vue.createCommentVNode("v-if", true);
  }
  const PagesConversationGroupConversationInfoPage = /* @__PURE__ */ _export_sfc(_sfc_main$G, [["render", _sfc_render$F], ["__scopeId", "data-v-e2223d49"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/conversation/GroupConversationInfoPage.vue"]]);
  const _sfc_main$F = {
    name: "SearchUserPage",
    components: { UserListView },
    data() {
      return {
        keyword: "",
        users: null
      };
    },
    methods: {
      searchUser() {
        if (!this.keyword.trim()) {
          this.users = null;
          return;
        }
        formatAppLog("log", "at pages/contact/SearchUserPage.vue:37", "search user", this.keyword);
        wfc.searchUser(this.keyword, SearchType.General, 0, (keyword, users) => {
          formatAppLog("log", "at pages/contact/SearchUserPage.vue:39", "searchUser success", keyword, users);
          this.users = users;
        }, (err) => {
          formatAppLog("log", "at pages/contact/SearchUserPage.vue:42", " searchUser err", err);
        });
      }
    }
  };
  function _sfc_render$E(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_UserListView = vue.resolveComponent("UserListView");
    return vue.openBlock(), vue.createElementBlock("view", { class: "search-user-container" }, [
      vue.withDirectives(vue.createElementVNode("input", {
        class: "input",
        type: "text",
        "onUpdate:modelValue": _cache[0] || (_cache[0] = ($event) => $data.keyword = $event),
        placeholder: _ctx.$t("common.search"),
        onInput: _cache[1] || (_cache[1] = (...args) => $options.searchUser && $options.searchUser(...args))
      }, null, 40, ["placeholder"]), [
        [vue.vModelText, $data.keyword]
      ]),
      $data.users && $data.users.length ? (vue.openBlock(), vue.createElementBlock("view", { key: 0 }, [
        vue.createElementVNode("text", { class: "category" }, "搜索结果"),
        vue.createVNode(_component_UserListView, {
          class: "result",
          "enable-pick": false,
          users: $data.users,
          "show-category-label": false,
          "padding-left": "10px"
        }, null, 8, ["users"])
      ])) : vue.createCommentVNode("v-if", true),
      $data.keyword && !$data.users.length ? (vue.openBlock(), vue.createElementBlock("text", {
        key: 1,
        class: "tip"
      }, "没有搜索到用户")) : vue.createCommentVNode("v-if", true)
    ]);
  }
  const PagesContactSearchUserPage = /* @__PURE__ */ _export_sfc(_sfc_main$F, [["render", _sfc_render$E], ["__scopeId", "data-v-bfa12f83"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/contact/SearchUserPage.vue"]]);
  const _sfc_main$E = {
    name: "OrganizationTreeView",
    props: {},
    components: {
      UserCardView
    },
    data() {
      return {
        sharedContactState: store.state.contact,
        subOrganizations: [],
        employees: [],
        currentOrganizationPathList: [],
        defaultDepartmentPortraitUrl: Config.DEFAULT_DEPARTMENT_PORTRAIT_URL,
        defaultEmployeePortraitUrl: Config.DEFAULT_PORTRAIT_URL
      };
    },
    mounted() {
      this.loadAndShowOrganization(this.sharedContactState.currentOrganization);
    },
    methods: {
      loadAndShowOrganization(org) {
        organizationServerApi.getOrganizationEx(org.id).then((res) => {
          this.subOrganizations = res.subOrganizations;
          this.employees = res.employees;
        });
        organizationServerApi.getOrganizationPath(org.id).then((orgs) => {
          this.currentOrganizationPathList = orgs.reverse();
        });
      },
      employeeToUserInfo(employee) {
        return organizationServerApi.employeeToUserInfo(employee);
      },
      showUserInfo(employee) {
        wfc.getUserInfoEx(employee.employeeId, false, (userInfo) => {
          store.setCurrentFriend(userInfo);
          uni.navigateTo({
            url: "/pages/contact/UserDetailPage",
            success: () => {
              formatAppLog("log", "at pages/contact/OrganizationTreePage.vue:81", "nav to UserDetailPage success");
            },
            fail: (err) => {
              formatAppLog("log", "at pages/contact/OrganizationTreePage.vue:84", "nav to UserDetailPage err", err);
            }
          });
        }, (err) => {
        });
      }
    }
  };
  function _sfc_render$D(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("section", { class: "organization-tree-container" }, [
      vue.createElementVNode("nav", { class: "breadcrumb" }, [
        vue.createElementVNode("ul", null, [
          (vue.openBlock(true), vue.createElementBlock(
            vue.Fragment,
            null,
            vue.renderList($data.currentOrganizationPathList, (org) => {
              return vue.openBlock(), vue.createElementBlock("li", {
                key: org.id
              }, [
                vue.createElementVNode("a", {
                  href: "#",
                  onClick: ($event) => $options.loadAndShowOrganization(org)
                }, vue.toDisplayString(org.name), 9, ["onClick"])
              ]);
            }),
            128
            /* KEYED_FRAGMENT */
          ))
        ])
      ]),
      vue.createElementVNode("div", { class: "member-list-container" }, [
        vue.createElementVNode("ul", null, [
          (vue.openBlock(true), vue.createElementBlock(
            vue.Fragment,
            null,
            vue.renderList($data.subOrganizations, (org, index) => {
              return vue.openBlock(), vue.createElementBlock("li", {
                key: org.id
              }, [
                vue.createElementVNode("div", {
                  class: "organization-item",
                  onClick: ($event) => $options.loadAndShowOrganization(org)
                }, [
                  vue.createElementVNode("img", {
                    src: org.portrait ? org.portrait : $data.defaultDepartmentPortraitUrl
                  }, null, 8, ["src"]),
                  vue.createElementVNode(
                    "p",
                    { class: "name" },
                    vue.toDisplayString(org.name),
                    1
                    /* TEXT */
                  )
                ], 8, ["onClick"])
              ]);
            }),
            128
            /* KEYED_FRAGMENT */
          )),
          (vue.openBlock(true), vue.createElementBlock(
            vue.Fragment,
            null,
            vue.renderList($data.employees, (employee, index) => {
              return vue.openBlock(), vue.createElementBlock("li", {
                key: employee.employeeId
              }, [
                vue.createElementVNode("div", {
                  ref_for: true,
                  ref: "ref-employee-" + employee.employeeId,
                  class: "organization-item",
                  onClick: ($event) => $options.showUserInfo(employee)
                }, [
                  vue.createElementVNode("img", {
                    src: employee.portrait ? employee.portrait : $data.defaultEmployeePortraitUrl
                  }, null, 8, ["src"]),
                  vue.createElementVNode(
                    "p",
                    { class: "name" },
                    vue.toDisplayString(employee.name),
                    1
                    /* TEXT */
                  )
                ], 8, ["onClick"])
              ]);
            }),
            128
            /* KEYED_FRAGMENT */
          ))
        ])
      ])
    ]);
  }
  const PagesContactOrganizationTreePage = /* @__PURE__ */ _export_sfc(_sfc_main$E, [["render", _sfc_render$D], ["__scopeId", "data-v-0a6ca894"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/contact/OrganizationTreePage.vue"]]);
  const _sfc_main$D = {
    name: "GroupListView",
    props: {},
    data() {
      return {
        sharedContactState: store.state.contact
      };
    },
    methods: {
      showChannel(channelInfo) {
        let conversation2 = new Conversation(ConversationType.Channel, channelInfo.channelId, 0);
        store.setCurrentConversation(conversation2);
        this.$go2ConversationPage();
      }
    }
  };
  function _sfc_render$C(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", null, [
      (vue.openBlock(true), vue.createElementBlock(
        vue.Fragment,
        null,
        vue.renderList($data.sharedContactState.channelList, (channel, index) => {
          return vue.openBlock(), vue.createElementBlock("div", {
            key: index,
            onClick: ($event) => $options.showChannel(channel)
          }, [
            vue.createElementVNode("div", { class: "channel-item" }, [
              vue.createElementVNode("img", {
                class: "avatar",
                src: channel.portrait
              }, null, 8, ["src"]),
              vue.createElementVNode(
                "span",
                { class: "single-line" },
                vue.toDisplayString(channel.name),
                1
                /* TEXT */
              )
            ])
          ], 8, ["onClick"]);
        }),
        128
        /* KEYED_FRAGMENT */
      ))
    ]);
  }
  const PagesContactChannelListPage = /* @__PURE__ */ _export_sfc(_sfc_main$D, [["render", _sfc_render$C], ["__scopeId", "data-v-09f99ef0"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/contact/ChannelListPage.vue"]]);
  const _sfc_main$C = {
    name: "SearchResultView",
    props: {
      query: {
        required: false,
        type: String,
        default: ""
      },
      options: {
        required: false,
        type: Object,
        default: () => {
          return {
            user: true,
            contact: true,
            conversation: true,
            group: true
          };
        }
      }
    },
    data() {
      return {
        sharedSearchState: store.state.search,
        sharedMiscState: store.state.misc,
        shouldShowAllUser: false,
        shouldShowAllContact: false,
        shouldShowAllGroup: false,
        shouldShowAllConversation: false
      };
    },
    mounted() {
      let enableCount = 0;
      for (const key in this.options) {
        if (this.options[key]) {
          enableCount++;
        }
      }
      if (enableCount === 1) {
        this.shouldShowAllUser = this.options.user;
        this.shouldShowAllContact = this.options.contact;
        this.shouldShowAllGroup = this.options.group;
        this.shouldShowAllConversation = this.options.conversation;
      }
    },
    beforeUnmount() {
      store.setSearchQuery("");
    },
    watch: {
      // "query":function (val, oldVal){
      //   __f__('log','at pages/search/SearchResultView.vue:142','searchView query changed:', val, oldVal)
      // }
      // or
      query() {
        formatAppLog("log", "at pages/search/SearchResultView.vue:146", "searchView query changed:", this.query, this.options);
      }
    },
    methods: {
      isFriend(user) {
        return user.uid === wfc.getUserId() || wfc.isMyFriend(user.uid);
      },
      addFriend(user) {
        formatAppLog("log", "at pages/search/SearchResultView.vue:156", "add friend", user);
        wfc.sendFriendRequest(user.uid, "你好", "", () => {
          uni.showToast({
            title: "发送好友请求成功",
            icon: "none"
          });
        }, (err) => {
          formatAppLog("log", "at pages/search/SearchResultView.vue:163", "sendFriendRequest fail", err);
          uni.showToast({
            title: " 发送好友请求失败",
            icon: "none"
          });
        });
      },
      showAllUser() {
        this.shouldShowAllUser = true;
      },
      showAllContact() {
        this.shouldShowAllContact = true;
      },
      showAllGroup() {
        this.shouldShowAllGroup = true;
      },
      showAllConversation() {
        this.shouldShowAllConversation = true;
      },
      chatToContact(contact2) {
        let conversation2 = new Conversation(ConversationType.Single, contact2.uid, 0);
        store.setCurrentConversation(conversation2);
        this.$go2ConversationPage();
      },
      chatToGroup(group2) {
        let conversation2 = new Conversation(ConversationType.Group, group2.target, 0);
        store.setCurrentConversation(conversation2);
        this.$go2ConversationPage();
      },
      onClickConversationSearchResultItem(result) {
        if (result.matchMessage) {
          store.setCurrentConversation(result.conversation);
          this.$go2ConversationPage();
        } else {
          store.state.search.conversation = result.conversation;
          uni.navigateTo(
            {
              url: "/pages/search/SearchConversationMessagePage"
            }
          );
        }
      },
      showMessageHistoryPage() {
        let hash = window.location.hash;
        let url = window.location.origin;
        if (hash) {
          url = window.location.href.replace(hash, "#/message-history");
        } else {
          url += "/message-history";
        }
        ipcRenderer.send(IPCRendererEventType.showMessageHistoryPage, {
          url
        });
        formatAppLog("log", "at pages/search/SearchResultView.vue:232", IPCRendererEventType.showMessageHistoryPage, url);
      },
      conversationMatchDesc(convSearchResult) {
      }
    },
    computed: {
      toShowUserList: function() {
        return !this.shouldShowAllUser && this.sharedSearchState.userSearchResult.length > 5 ? this.sharedSearchState.userSearchResult.slice(0, 4) : this.sharedSearchState.userSearchResult;
      },
      toShowContactList: function() {
        return !this.shouldShowAllContact && this.sharedSearchState.contactSearchResult.length > 5 ? this.sharedSearchState.contactSearchResult.slice(0, 4) : this.sharedSearchState.contactSearchResult;
      },
      toShowGroupList: function() {
        return !this.shouldShowAllGroup && this.sharedSearchState.groupSearchResult.length > 5 ? this.sharedSearchState.groupSearchResult.slice(0, 4) : this.sharedSearchState.groupSearchResult;
      },
      toShowConversationList: function() {
        return !this.shouldShowAllConversation && this.sharedSearchState.conversationSearchResult.length > 5 ? this.sharedSearchState.conversationSearchResult.slice(0, 4) : this.sharedSearchState.conversationSearchResult;
      },
      showEmptyView() {
        const { userSearchResult, contactSearchResult, groupSearchResult, conversationSearchResult } = this.sharedSearchState;
        return userSearchResult.length + contactSearchResult.length + groupSearchResult.length + conversationSearchResult.length === 0;
      }
    },
    directives: {}
  };
  function _sfc_render$B(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("section", { class: "search-result-container" }, [
      !$options.showEmptyView ? (vue.openBlock(), vue.createElementBlock("div", {
        key: 0,
        class: "search-result"
      }, [
        vue.createElementVNode("ul", { style: { "display": "block" } }, [
          $props.options.user && $data.sharedSearchState.userSearchResult.length > 0 ? (vue.openBlock(), vue.createElementBlock("li", {
            key: 0,
            class: "search-result-category-container"
          }, [
            vue.createElementVNode(
              "label",
              null,
              vue.toDisplayString(_ctx.$t("search.new_user")),
              1
              /* TEXT */
            ),
            vue.createElementVNode("ul", null, [
              (vue.openBlock(true), vue.createElementBlock(
                vue.Fragment,
                null,
                vue.renderList($options.toShowUserList, (user, index) => {
                  return vue.openBlock(), vue.createElementBlock("li", { key: index }, [
                    vue.createElementVNode("div", { class: "search-result-item contact" }, [
                      vue.createElementVNode("img", {
                        src: user.portrait
                      }, null, 8, ["src"]),
                      vue.createElementVNode(
                        "span",
                        null,
                        vue.toDisplayString(user.displayName),
                        1
                        /* TEXT */
                      ),
                      !$options.isFriend(user) ? (vue.openBlock(), vue.createElementBlock("button", {
                        key: 0,
                        style: { "margin-right": "0", "margin-left": "auto", "border": "none" },
                        size: "mini",
                        onClick: vue.withModifiers(($event) => $options.addFriend(user), ["stop"])
                      }, vue.toDisplayString(_ctx.$t("common.add")), 9, ["onClick"])) : vue.createCommentVNode("v-if", true)
                    ])
                  ]);
                }),
                128
                /* KEYED_FRAGMENT */
              ))
            ]),
            !$data.shouldShowAllUser && this.sharedSearchState.userSearchResult.length > 5 ? (vue.openBlock(), vue.createElementBlock(
              "div",
              {
                key: 0,
                class: "show-all",
                onClick: _cache[0] || (_cache[0] = vue.withModifiers((...args) => $options.showAllUser && $options.showAllUser(...args), ["stop"]))
              },
              vue.toDisplayString(_ctx.$t("search.view_all") + this.sharedSearchState.userSearchResult.length),
              1
              /* TEXT */
            )) : vue.createCommentVNode("v-if", true)
          ])) : vue.createCommentVNode("v-if", true),
          $props.options.contact && $data.sharedSearchState.contactSearchResult.length > 0 ? (vue.openBlock(), vue.createElementBlock("li", {
            key: 1,
            class: "search-result-category-container"
          }, [
            vue.createElementVNode(
              "label",
              null,
              vue.toDisplayString(_ctx.$t("common.contact")),
              1
              /* TEXT */
            ),
            vue.createElementVNode("ul", null, [
              (vue.openBlock(true), vue.createElementBlock(
                vue.Fragment,
                null,
                vue.renderList($options.toShowContactList, (contact2, index) => {
                  return vue.openBlock(), vue.createElementBlock("li", { key: index }, [
                    vue.createElementVNode("div", {
                      class: "search-result-item",
                      onClick: vue.withModifiers(($event) => $options.chatToContact(contact2), ["stop"])
                    }, [
                      vue.createElementVNode("img", {
                        src: contact2.portrait
                      }, null, 8, ["src"]),
                      vue.createElementVNode(
                        "span",
                        null,
                        vue.toDisplayString(contact2._displayName),
                        1
                        /* TEXT */
                      )
                    ], 8, ["onClick"])
                  ]);
                }),
                128
                /* KEYED_FRAGMENT */
              ))
            ]),
            !$data.shouldShowAllContact && this.sharedSearchState.contactSearchResult.length > 5 ? (vue.openBlock(), vue.createElementBlock(
              "div",
              {
                key: 0,
                class: "show-all",
                onClick: _cache[1] || (_cache[1] = vue.withModifiers((...args) => $options.showAllContact && $options.showAllContact(...args), ["stop"]))
              },
              vue.toDisplayString(_ctx.$t("search.view_all") + this.sharedSearchState.contactSearchResult.length),
              1
              /* TEXT */
            )) : vue.createCommentVNode("v-if", true)
          ])) : vue.createCommentVNode("v-if", true),
          $props.options.group && $data.sharedSearchState.groupSearchResult.length > 0 ? (vue.openBlock(), vue.createElementBlock("li", {
            key: 2,
            class: "search-result-category-container"
          }, [
            vue.createElementVNode(
              "label",
              null,
              vue.toDisplayString(_ctx.$t("contact.group")),
              1
              /* TEXT */
            ),
            vue.createElementVNode("ul", null, [
              (vue.openBlock(true), vue.createElementBlock(
                vue.Fragment,
                null,
                vue.renderList($options.toShowGroupList, (group2, index) => {
                  return vue.openBlock(), vue.createElementBlock("li", { key: index }, [
                    vue.createElementVNode("div", {
                      class: "search-result-item",
                      onClick: ($event) => $options.chatToGroup(group2)
                    }, [
                      vue.createElementVNode("img", {
                        src: group2.portrait,
                        alt: ""
                      }, null, 8, ["src"]),
                      vue.createElementVNode(
                        "span",
                        null,
                        vue.toDisplayString(group2.remark ? group2.remark : group2.name),
                        1
                        /* TEXT */
                      )
                    ], 8, ["onClick"])
                  ]);
                }),
                128
                /* KEYED_FRAGMENT */
              ))
            ]),
            !$data.shouldShowAllGroup && this.sharedSearchState.groupSearchResult.length > 5 ? (vue.openBlock(), vue.createElementBlock(
              "div",
              {
                key: 0,
                class: "show-all",
                onClick: _cache[2] || (_cache[2] = vue.withModifiers((...args) => $options.showAllGroup && $options.showAllGroup(...args), ["stop"]))
              },
              vue.toDisplayString(_ctx.$t("search.view_all") + this.sharedSearchState.groupSearchResult.length),
              1
              /* TEXT */
            )) : vue.createCommentVNode("v-if", true)
          ])) : vue.createCommentVNode("v-if", true),
          $props.options.conversation && $data.sharedSearchState.conversationSearchResult.length > 0 ? (vue.openBlock(), vue.createElementBlock("li", {
            key: 3,
            class: "search-result-category-container"
          }, [
            vue.createElementVNode("label", null, "聊天记录"),
            vue.createElementVNode("ul", null, [
              (vue.openBlock(true), vue.createElementBlock(
                vue.Fragment,
                null,
                vue.renderList($options.toShowConversationList, (convR, index) => {
                  return vue.openBlock(), vue.createElementBlock("li", { key: index }, [
                    vue.createElementVNode("div", {
                      class: "search-result-item conversation",
                      onClick: ($event) => $options.onClickConversationSearchResultItem(convR)
                    }, [
                      vue.createElementVNode("img", {
                        src: convR._conversationInfo.conversation._target.portrait,
                        alt: ""
                      }, null, 8, ["src"]),
                      vue.createElementVNode("div", { class: "title-desc" }, [
                        vue.createElementVNode(
                          "span",
                          null,
                          vue.toDisplayString(convR._conversationInfo.conversation._target._displayName),
                          1
                          /* TEXT */
                        ),
                        vue.createElementVNode(
                          "span",
                          { class: "desc" },
                          vue.toDisplayString($options.conversationMatchDesc(convR)),
                          1
                          /* TEXT */
                        )
                      ])
                    ], 8, ["onClick"])
                  ]);
                }),
                128
                /* KEYED_FRAGMENT */
              ))
            ]),
            !$data.shouldShowAllConversation && this.sharedSearchState.conversationSearchResult.length > 5 ? (vue.openBlock(), vue.createElementBlock(
              "div",
              {
                key: 0,
                class: "show-all",
                onClick: _cache[3] || (_cache[3] = vue.withModifiers((...args) => $options.showAllConversation && $options.showAllConversation(...args), ["stop"]))
              },
              vue.toDisplayString(_ctx.$t("search.view_all") + this.sharedSearchState.conversationSearchResult.length),
              1
              /* TEXT */
            )) : vue.createCommentVNode("v-if", true)
          ])) : vue.createCommentVNode("v-if", true)
        ])
      ])) : (vue.openBlock(), vue.createElementBlock("div", {
        key: 1,
        class: "empty-container"
      }, [
        vue.createElementVNode("text", null, "没有搜索结果")
      ]))
    ]);
  }
  const SearchResultView = /* @__PURE__ */ _export_sfc(_sfc_main$C, [["render", _sfc_render$B], ["__scopeId", "data-v-770e6af6"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/search/SearchResultView.vue"]]);
  const _sfc_main$B = {
    name: "SearchPortalPage",
    components: { SearchResultView },
    data() {
      return {
        keyword: "",
        type: "all",
        options: {
          user: true,
          contact: true,
          conversation: true,
          group: true
        }
      };
    },
    onLoad(option) {
      let queryOption = (query) => option[query] ? option[query] === "true" : true;
      this.options.user = queryOption("user");
      this.options.group = queryOption("group");
      this.options.contact = queryOption("contact");
      this.options.conversation = queryOption("conversation");
    },
    methods: {
      search() {
        store.setSearchQuery(this.keyword, this.options);
      }
    }
  };
  function _sfc_render$A(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_SearchResultView = vue.resolveComponent("SearchResultView");
    return vue.openBlock(), vue.createElementBlock("view", { class: "search-portal-container" }, [
      vue.withDirectives(vue.createElementVNode("input", {
        class: "input",
        type: "text",
        "onUpdate:modelValue": _cache[0] || (_cache[0] = ($event) => $data.keyword = $event),
        placeholder: _ctx.$t("common.search"),
        onInput: _cache[1] || (_cache[1] = (...args) => $options.search && $options.search(...args))
      }, null, 40, ["placeholder"]), [
        [vue.vModelText, $data.keyword]
      ]),
      $data.keyword && $data.keyword.trim() ? (vue.openBlock(), vue.createBlock(_component_SearchResultView, {
        key: 0,
        query: $data.keyword,
        options: $data.options
      }, null, 8, ["query", "options"])) : (vue.openBlock(), vue.createElementBlock("view", {
        key: 1,
        class: "tip-container"
      }, [
        vue.createElementVNode("text", null, "请输入关键字进行搜索")
      ]))
    ]);
  }
  const PagesSearchSearchPortalPage = /* @__PURE__ */ _export_sfc(_sfc_main$B, [["render", _sfc_render$A], ["__scopeId", "data-v-f93be52b"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/search/SearchPortalPage.vue"]]);
  const _sfc_main$A = {
    name: "SearchResultView",
    data() {
      return {
        query: store.state.search.query,
        conversationInfo: store.getConversationInfo(store.state.search.conversation),
        messages: []
      };
    },
    mounted() {
      this.search();
    },
    beforeUnmount() {
      store.state.search.conversation = null;
    },
    methods: {
      search() {
        if (this.query && this.query.trim()) {
          this.messages = store.searchMessage(this.conversationInfo.conversation, this.query);
        } else {
          this.messages = [];
        }
      },
      onClickMessage(msg) {
        store.setCurrentConversation(msg.conversation);
        this.$go2ConversationPage();
      }
    },
    directives: {}
  };
  function _sfc_render$z(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("section", { class: "search-conversation-message-container" }, [
      vue.withDirectives(vue.createElementVNode("input", {
        class: "input",
        type: "text",
        "onUpdate:modelValue": _cache[0] || (_cache[0] = ($event) => $data.query = $event),
        placeholder: _ctx.$t("common.search"),
        onInput: _cache[1] || (_cache[1] = (...args) => $options.search && $options.search(...args))
      }, null, 40, ["placeholder"]), [
        [vue.vModelText, $data.query]
      ]),
      vue.createElementVNode("label", { class: "category" }, "聊天记录"),
      vue.createElementVNode("ul", null, [
        (vue.openBlock(true), vue.createElementBlock(
          vue.Fragment,
          null,
          vue.renderList($data.messages, (msg, index) => {
            return vue.openBlock(), vue.createElementBlock("li", { key: index }, [
              vue.createElementVNode("div", {
                class: "search-result-item",
                onClick: ($event) => $options.onClickMessage(msg)
              }, [
                vue.createElementVNode("img", {
                  src: $data.conversationInfo.conversation._target.portrait,
                  alt: ""
                }, null, 8, ["src"]),
                vue.createElementVNode("div", { class: "title-desc" }, [
                  vue.createElementVNode(
                    "span",
                    null,
                    vue.toDisplayString(msg._from._displayName),
                    1
                    /* TEXT */
                  ),
                  vue.createElementVNode(
                    "span",
                    { class: "desc" },
                    vue.toDisplayString(msg.messageContent.digest(msg)),
                    1
                    /* TEXT */
                  )
                ])
              ], 8, ["onClick"])
            ]);
          }),
          128
          /* KEYED_FRAGMENT */
        ))
      ])
    ]);
  }
  const PagesSearchSearchConversationMessagePage = /* @__PURE__ */ _export_sfc(_sfc_main$A, [["render", _sfc_render$z], ["__scopeId", "data-v-5ff968c9"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/search/SearchConversationMessagePage.vue"]]);
  const _sfc_main$z = {
    name: "UserDetailPage",
    data() {
      return {
        sharedStateContact: store.state.contact,
        user: store.state.contact.currentFriend
      };
    },
    mounted() {
      wfc.getUserInfo(this.user.uid, true);
    },
    onUnload() {
      store.setCurrentFriend(null);
    },
    methods: {
      chat() {
        let conversation2 = new Conversation(ConversationType.Single, this.user.uid, 0);
        store.setCurrentConversation(conversation2);
        this.$go2ConversationPage();
      },
      updateFriendAlias() {
        let friendAlias = this.$refs.input.value;
        if (friendAlias.trim() && friendAlias !== this.sharedStateContact.currentFriend.friendAlias) {
          wfc.setFriendAlias(
            this.user.uid,
            friendAlias,
            () => {
              formatAppLog("log", "at pages/contact/UserDetailPage.vue:98", "setFriendAlias success", this.user, friendAlias);
            },
            (error) => {
            }
          );
        }
      },
      deleteFriend() {
        formatAppLog("log", "at pages/contact/UserDetailPage.vue:106", "start deleteFriend");
        wfc.deleteFriend(this.user.uid, () => {
          formatAppLog("log", "at pages/contact/UserDetailPage.vue:108", "deleteFriend success");
          uni.showToast({
            title: "删除好友成功",
            icon: "none"
          });
          setTimeout(() => {
            uni.navigateBack({
              delta: 1
            });
          }, 1e3);
        }, (err) => {
          formatAppLog("log", "at pages/contact/UserDetailPage.vue:119", "deleteFriend fail ", err);
          uni.showToast({
            title: "删除好友失败" + err,
            icon: "none"
          });
        });
      },
      addFriend() {
        let userInfo = wfc.getUserInfo(wfc.getUserId());
        let reason = "你好，我是" + userInfo.displayName;
        wfc.sendFriendRequest(this.user.uid, reason, "", () => {
          uni.showToast({
            title: "好友请求发送成 ",
            icon: "none"
          });
          setTimeout(() => {
            uni.navigateBack({
              delta: 1
            });
          }, 1e3);
        }, (err) => {
          uni.showToast({
            title: "好友请求发送失败 " + err,
            icon: "none"
          });
        });
      },
      startAudioCall() {
        let callSession = self$2.startSingleCall(this.user.uid, true);
        if (callSession) {
          let url = `/pages/voip/Single?session=${JSON.stringify(callSession)}`;
          this.$navigateToPage(url);
        }
      },
      startVideoCall() {
        let callSession = self$2.startSingleCall(this.user.uid, false);
        if (callSession) {
          let url = `/pages/voip/Single?session=${JSON.stringify(callSession)}`;
          this.$navigateToPage(url);
        }
      }
    },
    computed: {
      name: function() {
        let name;
        let friend = this.sharedStateContact.currentFriend;
        if (!friend) {
          return null;
        }
        if (friend.displayName) {
          name = friend.displayName;
        } else {
          name = friend.name;
        }
        return name;
      },
      isFriend() {
        return wfc.isMyFriend(this.user.uid);
      },
      isSelf() {
        return this.user.uid === wfc.getUserId();
      }
    }
  };
  function _sfc_render$y(_ctx, _cache, $props, $setup, $data, $options) {
    return $data.sharedStateContact.currentFriend ? (vue.openBlock(), vue.createElementBlock("div", {
      key: 0,
      class: "user-detail-container"
    }, [
      vue.createElementVNode("div", { class: "header" }, [
        vue.createElementVNode("div", null, [
          vue.createElementVNode(
            "h2",
            null,
            vue.toDisplayString($options.name),
            1
            /* TEXT */
          ),
          vue.createElementVNode("p", null, "你好，野火")
        ]),
        vue.createElementVNode("div", null, [
          vue.createElementVNode("img", {
            class: "avatar",
            src: $data.sharedStateContact.currentFriend.portrait
          }, null, 8, ["src"])
        ])
      ]),
      vue.createElementVNode("div", { class: "content" }, [
        vue.createElementVNode("ul", null, [
          vue.createElementVNode("li", null, [
            vue.createElementVNode(
              "label",
              null,
              vue.toDisplayString(_ctx.$t("common.alias")),
              1
              /* TEXT */
            ),
            vue.createElementVNode("div", { class: "alias" }, [
              vue.createElementVNode("input", {
                type: "text",
                ref: "input",
                value: $data.sharedStateContact.currentFriend.friendAlias,
                placeholder: "备注名",
                onKeyup: _cache[0] || (_cache[0] = vue.withKeys((...args) => $options.updateFriendAlias && $options.updateFriendAlias(...args), ["enter"]))
              }, null, 40, ["value"])
            ])
          ]),
          vue.createElementVNode("li", null, [
            vue.createElementVNode(
              "label",
              null,
              vue.toDisplayString(_ctx.$t("common.wfc_id")),
              1
              /* TEXT */
            ),
            vue.createElementVNode(
              "p",
              { class: "single-line" },
              vue.toDisplayString($data.user.name),
              1
              /* TEXT */
            )
          ]),
          vue.createElementVNode("li", null, [
            vue.createElementVNode(
              "label",
              null,
              vue.toDisplayString(_ctx.$t("common.area")),
              1
              /* TEXT */
            ),
            vue.createElementVNode(
              "p",
              null,
              vue.toDisplayString(_ctx.$t("common.unknown")),
              1
              /* TEXT */
            )
          ]),
          vue.createElementVNode("li", null, [
            vue.createElementVNode(
              "label",
              null,
              vue.toDisplayString(_ctx.$t("common.label")),
              1
              /* TEXT */
            ),
            vue.createElementVNode(
              "p",
              null,
              vue.toDisplayString(_ctx.$t("misc.test_user")),
              1
              /* TEXT */
            )
          ])
        ])
      ]),
      vue.createElementVNode("div", { class: "footer" }, [
        vue.createElementVNode("div", {
          class: "action",
          onClick: _cache[1] || (_cache[1] = (...args) => $options.chat && $options.chat(...args))
        }, [
          vue.createElementVNode("i", { class: "icon-ion-ios-chatboxes-outline" }),
          vue.createElementVNode(
            "a",
            null,
            vue.toDisplayString(_ctx.$t("message.send_message")),
            1
            /* TEXT */
          )
        ]),
        vue.createElementVNode("div", {
          class: "action",
          onClick: _cache[2] || (_cache[2] = (...args) => $options.startAudioCall && $options.startAudioCall(...args))
        }, [
          vue.createElementVNode("i", { class: "icon-ion-ios-telephone-outline" }),
          vue.createElementVNode("a", null, "语音通话")
        ]),
        vue.createElementVNode("div", {
          class: "action",
          onClick: _cache[3] || (_cache[3] = (...args) => $options.startVideoCall && $options.startVideoCall(...args))
        }, [
          vue.createElementVNode("i", { class: "icon-ion-ios-videocam-outline" }),
          vue.createElementVNode("a", null, "视频通话")
        ]),
        !$options.isFriend && !$options.isSelf ? (vue.openBlock(), vue.createElementBlock("div", {
          key: 0,
          class: "action",
          onClick: _cache[4] || (_cache[4] = (...args) => $options.addFriend && $options.addFriend(...args))
        }, [
          vue.createElementVNode("i", { class: "icon-ion-person-add" }),
          vue.createElementVNode("a", null, "添加好友")
        ])) : vue.createCommentVNode("v-if", true),
        $options.isFriend && !$options.isSelf ? (vue.openBlock(), vue.createElementBlock("div", {
          key: 1,
          class: "action",
          style: { "color": "red" },
          onClick: _cache[5] || (_cache[5] = (...args) => $options.deleteFriend && $options.deleteFriend(...args))
        }, [
          vue.createElementVNode("i", { class: "icon-ion-android-remove-circle" }),
          vue.createElementVNode("a", null, "删除好友")
        ])) : vue.createCommentVNode("v-if", true)
      ])
    ])) : vue.createCommentVNode("v-if", true);
  }
  const PagesContactUserDetailPage = /* @__PURE__ */ _export_sfc(_sfc_main$z, [["render", _sfc_render$y], ["__scopeId", "data-v-5caf9d17"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/contact/UserDetailPage.vue"]]);
  const _sfc_main$y = {
    name: "FriendRequestDetailPage",
    props: {},
    data() {
      return {
        sharedStateContact: store.state.contact
      };
    },
    methods: {
      chat() {
        let conversation2 = new Conversation(ConversationType.Single, this.sharedStateContact.currentFriendRequest.target, 0);
        store.setCurrentConversation(conversation2);
        this.$go2ConversationPage();
      }
    },
    computed: {
      name: function() {
        let name;
        let friend = this.sharedStateContact.currentFriendRequest._target;
        if (friend.friendAlias) {
          name = friend.friendAlias;
        } else if (friend.displayName) {
          name = friend.displayName;
        } else {
          name = friend.name;
        }
        return name;
      }
    }
  };
  function _sfc_render$x(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "user-detail-container" }, [
      vue.createElementVNode("div", { class: "header" }, [
        vue.createElementVNode("div", null, [
          vue.createElementVNode(
            "h2",
            null,
            vue.toDisplayString($options.name),
            1
            /* TEXT */
          ),
          vue.createElementVNode(
            "p",
            null,
            vue.toDisplayString(_ctx.$t("friend_request.intro")),
            1
            /* TEXT */
          )
        ]),
        vue.createElementVNode("div", null, [
          vue.createElementVNode("img", {
            class: "avatar",
            src: $data.sharedStateContact.currentFriendRequest._target.portrait
          }, null, 8, ["src"])
        ])
      ]),
      vue.createElementVNode("div", { class: "content" }, [
        vue.createElementVNode("ul", null, [
          vue.createElementVNode("li", null, [
            vue.createElementVNode(
              "label",
              null,
              vue.toDisplayString(_ctx.$t("common.alias")),
              1
              /* TEXT */
            ),
            vue.createElementVNode("div", { class: "alias" }, [
              vue.createElementVNode("input", {
                type: "text",
                value: $data.sharedStateContact.currentFriendRequest._target.alias,
                placeholder: "备注名"
              }, null, 8, ["value"])
            ])
          ]),
          vue.createElementVNode("li", null, [
            vue.createElementVNode(
              "label",
              null,
              vue.toDisplayString(_ctx.$t("common.area")),
              1
              /* TEXT */
            ),
            vue.createElementVNode(
              "p",
              null,
              vue.toDisplayString(_ctx.$t("common.unknown")),
              1
              /* TEXT */
            )
          ]),
          vue.createElementVNode("li", null, [
            vue.createElementVNode(
              "label",
              null,
              vue.toDisplayString(_ctx.$t("common.label")),
              1
              /* TEXT */
            ),
            vue.createElementVNode(
              "p",
              null,
              vue.toDisplayString(_ctx.$t("misc.test_user")),
              1
              /* TEXT */
            )
          ])
        ])
      ]),
      vue.createElementVNode("div", { class: "footer" }, [
        vue.createElementVNode(
          "a",
          {
            onClick: _cache[0] || (_cache[0] = (...args) => this.chat && this.chat(...args))
          },
          vue.toDisplayString(_ctx.$t("message.send_message")),
          1
          /* TEXT */
        )
      ])
    ]);
  }
  const PagesContactFriendRequestDetailPage = /* @__PURE__ */ _export_sfc(_sfc_main$y, [["render", _sfc_render$x], ["__scopeId", "data-v-13018850"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/contact/FriendRequestDetailPage.vue"]]);
  const _sfc_main$x = {
    name: "OrganizationListView",
    props: {},
    data() {
      return {
        sharedContactState: store.state.contact,
        rootOrganizations: [],
        defaultPortraitUrl: Config.DEFAULT_ORGANIZATION_PORTRAIT_URL
      };
    },
    mounted() {
      organizationServerApi.getRootOrganization().then((orgs) => {
        this.rootOrganizations = orgs;
      }).catch((reason) => {
      });
    },
    methods: {
      showOrganization(organization) {
        store.setCurrentOrganization(organization);
        uni.navigateTo({
          url: "/pages/contact/OrganizationTreePage",
          success: () => {
            formatAppLog("log", "at pages/contact/OrganizationListView.vue:45", "nav to OrganizationTreePage success 000");
          },
          fail: (err) => {
            formatAppLog("log", "at pages/contact/OrganizationListView.vue:48", "nav to OrganizationTreePage err", err);
          }
        });
      }
    }
  };
  function _sfc_render$w(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("section", null, [
      vue.createElementVNode("ul", null, [
        (vue.openBlock(true), vue.createElementBlock(
          vue.Fragment,
          null,
          vue.renderList($data.rootOrganizations, (organization, index) => {
            return vue.openBlock(), vue.createElementBlock("li", {
              key: index,
              onClick: ($event) => $options.showOrganization(organization)
            }, [
              vue.createElementVNode(
                "div",
                {
                  class: vue.normalizeClass(["organization-item", { active: $data.sharedContactState.currentOrganization && $data.sharedContactState.currentOrganization.id === organization.id }])
                },
                [
                  vue.createElementVNode("img", {
                    class: "avatar",
                    src: organization.portrait ? organization.portrait : $data.defaultPortraitUrl
                  }, null, 8, ["src"]),
                  vue.createElementVNode(
                    "span",
                    { class: "single-line" },
                    vue.toDisplayString(organization.name),
                    1
                    /* TEXT */
                  )
                ],
                2
                /* CLASS */
              )
            ], 8, ["onClick"]);
          }),
          128
          /* KEYED_FRAGMENT */
        ))
      ])
    ]);
  }
  const OrganizationListView = /* @__PURE__ */ _export_sfc(_sfc_main$x, [["render", _sfc_render$w], ["__scopeId", "data-v-766318ce"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/contact/OrganizationListView.vue"]]);
  const _imports_0$3 = "/static/image/icon/ic_new_friend.png";
  const _imports_1$3 = "/static/image/icon/ic_group_chat.png";
  const _imports_2$3 = "/static/image/icon/ic_channel_1.png";
  const _sfc_main$w = {
    name: "ContactListPage",
    components: { OrganizationListView, UniList: __easycom_0$2, UserListView },
    data() {
      return {
        sharedContactState: store.state.contact
      };
    },
    onHide() {
      formatAppLog("log", "at pages/contact/ContactListPage.vue:53", "contactList onHide");
      this.$refs.mainActionMenu.hide();
    },
    onNavigationBarButtonTap(e) {
      formatAppLog("log", "at pages/contact/ContactListPage.vue:58", "onNavigationBarButtonTap");
      switch (e.index) {
        case 0:
          this.$refs.mainActionMenu.toggle();
          break;
        case 1:
          this.$refs.mainActionMenu.hide();
          uni.navigateTo({
            url: "/pages/search/SearchPortalPage"
          });
          break;
      }
    },
    methods: {
      setCurrentUser(userInfo) {
        store.setCurrentFriend(userInfo);
        uni.navigateTo({
          url: "./UserDetailPage",
          success: () => {
            formatAppLog("log", "at pages/contact/ContactListPage.vue:79", "nav to UserDetailPage success");
          },
          fail: (err) => {
            formatAppLog("log", "at pages/contact/ContactListPage.vue:83", "nav to UserDetailPage err", err);
          }
        });
      },
      showNewFriends() {
        uni.navigateTo({
          url: "./NewFriendListPage",
          success: () => {
            formatAppLog("log", "at pages/contact/ContactListPage.vue:91", "nav to NewFriendListPage success");
          },
          fail: (err) => {
            formatAppLog("log", "at pages/contact/ContactListPage.vue:95", "nav to NewFriendListPage err", err);
          }
        });
      },
      showGroups() {
        uni.navigateTo({
          url: "./GroupListPage",
          success: () => {
            formatAppLog("log", "at pages/contact/ContactListPage.vue:103", "nav to GroupListPage success");
          },
          fail: (err) => {
            formatAppLog("log", "at pages/contact/ContactListPage.vue:107", "nav to GroupListPage err", err);
          }
        });
      },
      showChannels() {
        uni.navigateTo({
          url: "./ChannelListPage",
          success: () => {
            formatAppLog("log", "at pages/contact/ContactListPage.vue:115", "nav to ChannelListPage success");
          },
          fail: (err) => {
            formatAppLog("log", "at pages/contact/ContactListPage.vue:119", "nav to ChannelListPage err", err);
          }
        });
      },
      showContacts() {
        store.toggleFriendList();
      }
    }
  };
  function _sfc_render$v(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_OrganizationListView = vue.resolveComponent("OrganizationListView");
    const _component_UserListView = vue.resolveComponent("UserListView");
    const _component_uni_list = resolveEasycom(vue.resolveDynamicComponent("uni-list"), __easycom_0$2);
    const _component_main_action_menu = resolveEasycom(vue.resolveDynamicComponent("main-action-menu"), __easycom_1$1);
    return vue.openBlock(), vue.createElementBlock("div", { class: "contact-list" }, [
      vue.createVNode(_component_uni_list, null, {
        default: vue.withCtx(() => [
          vue.createElementVNode("view", null, [
            vue.createElementVNode("div", {
              onClick: _cache[0] || (_cache[0] = (...args) => $options.showNewFriends && $options.showNewFriends(...args)),
              class: "category-item-container"
            }, [
              vue.createElementVNode("image", { src: _imports_0$3 }),
              vue.createElementVNode("div", { class: "category-item" }, [
                vue.createElementVNode(
                  "span",
                  { class: "title" },
                  vue.toDisplayString(_ctx.$t("contact.new_friend")),
                  1
                  /* TEXT */
                ),
                $data.sharedContactState.unreadFriendRequestCount > 0 ? (vue.openBlock(), vue.createElementBlock(
                  "span",
                  {
                    key: 0,
                    class: "desc",
                    style: { "color": "red" }
                  },
                  vue.toDisplayString($data.sharedContactState.unreadFriendRequestCount),
                  1
                  /* TEXT */
                )) : vue.createCommentVNode("v-if", true)
              ])
            ]),
            vue.createElementVNode("div", {
              onClick: _cache[1] || (_cache[1] = (...args) => $options.showGroups && $options.showGroups(...args)),
              class: "category-item-container"
            }, [
              vue.createElementVNode("image", { src: _imports_1$3 }),
              vue.createElementVNode("div", { class: "category-item" }, [
                vue.createElementVNode(
                  "span",
                  { class: "title" },
                  vue.toDisplayString(_ctx.$t("contact.group")),
                  1
                  /* TEXT */
                ),
                vue.createElementVNode(
                  "span",
                  { class: "desc" },
                  vue.toDisplayString($data.sharedContactState.favGroupList.length),
                  1
                  /* TEXT */
                )
              ])
            ]),
            vue.createElementVNode("div", {
              onClick: _cache[2] || (_cache[2] = (...args) => $options.showChannels && $options.showChannels(...args)),
              class: "category-item-container"
            }, [
              vue.createElementVNode("image", { src: _imports_2$3 }),
              vue.createElementVNode("div", { class: "category-item" }, [
                vue.createElementVNode(
                  "span",
                  { class: "title" },
                  vue.toDisplayString(_ctx.$t("contact.channel")),
                  1
                  /* TEXT */
                ),
                vue.createElementVNode(
                  "span",
                  { class: "desc" },
                  vue.toDisplayString($data.sharedContactState.channelList.length),
                  1
                  /* TEXT */
                )
              ])
            ]),
            vue.createVNode(_component_OrganizationListView),
            $data.sharedContactState.expandFriendList ? (vue.openBlock(), vue.createBlock(_component_UserListView, {
              key: 0,
              "enable-pick": false,
              users: $data.sharedContactState.favContactList.concat($data.sharedContactState.friendList),
              "click-user-item-func": $options.setCurrentUser,
              "padding-left": "10px"
            }, null, 8, ["users", "click-user-item-func"])) : vue.createCommentVNode("v-if", true)
          ])
        ]),
        _: 1
        /* STABLE */
      }),
      vue.createVNode(
        _component_main_action_menu,
        { ref: "mainActionMenu" },
        null,
        512
        /* NEED_PATCH */
      )
    ]);
  }
  const PagesContactContactListPage = /* @__PURE__ */ _export_sfc(_sfc_main$w, [["render", _sfc_render$v], ["__scopeId", "data-v-8e30f42c"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/contact/ContactListPage.vue"]]);
  const _sfc_main$v = {
    name: "NewFriendListView",
    props: {
      newFriends: null
    },
    data() {
      return {
        sharedContactState: store.state.contact,
        isActive: false
      };
    },
    methods: {
      showFriendRequest(friendRequest) {
        store.setCurrentFriendRequest(friendRequest);
        uni.navigateTo({
          url: "/pages/contact/FriendRequestDetailPage",
          success: () => {
            formatAppLog("log", "at pages/contact/FriendRequestListView.vue:54", "nav to FriendRequestDetailPage success");
          },
          fail: (err) => {
            formatAppLog("log", "at pages/contact/FriendRequestListView.vue:58", "nav to FriendRequestDetailPage err", err);
          }
        });
      },
      accept(friendRequest) {
        wfc.handleFriendRequest(friendRequest.target, true, "", () => {
          friendRequest.status = 1;
        }, (err) => {
          uni.showToast({
            title: "添加好友失败 " + err,
            icon: "none"
          });
          formatAppLog("log", "at pages/contact/FriendRequestListView.vue:70", "accept friend request error", err);
        });
      },
      onFriendRequestUpdate() {
        if (this.isActive) {
          wfc.clearUnreadFriendRequestStatus();
        }
      }
    },
    activated() {
      this.isActive = true;
      wfc.clearUnreadFriendRequestStatus();
    },
    deactivated() {
      this.isActive = false;
    },
    mounted() {
      this.isActive = true;
      wfc.clearUnreadFriendRequestStatus();
      wfc.eventEmitter.on(EventType.FriendRequestUpdate, this.onFriendRequestUpdate);
    },
    beforeUnmount() {
      this.isActive = false;
      wfc.eventEmitter.removeListener(EventType.FriendRequestUpdate, this.onFriendRequestUpdate);
    }
  };
  function _sfc_render$u(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "new-friend-item-container" }, [
      (vue.openBlock(true), vue.createElementBlock(
        vue.Fragment,
        null,
        vue.renderList($data.sharedContactState.friendRequestList, (friendRequest, index) => {
          return vue.openBlock(), vue.createElementBlock("div", {
            key: index,
            onClick: ($event) => $options.showFriendRequest(friendRequest),
            class: "new-friend-item"
          }, [
            vue.createElementVNode("img", {
              class: "avatar",
              src: friendRequest._target.portrait
            }, null, 8, ["src"]),
            vue.createElementVNode("div", { class: "info" }, [
              vue.createElementVNode("div", { class: "name" }, [
                vue.createElementVNode(
                  "span",
                  { class: "single-line" },
                  vue.toDisplayString(friendRequest._target.displayName),
                  1
                  /* TEXT */
                ),
                vue.createElementVNode(
                  "p",
                  { class: "reason single-line" },
                  vue.toDisplayString(friendRequest.reason ? friendRequest.reason : _ctx.$t("friend_request.im") + friendRequest._target.displayName),
                  1
                  /* TEXT */
                )
              ]),
              friendRequest.status === 1 ? (vue.openBlock(), vue.createElementBlock(
                "span",
                {
                  key: 0,
                  class: "status"
                },
                vue.toDisplayString(_ctx.$t("friend_request.accepted")),
                1
                /* TEXT */
              )) : friendRequest.status === 0 ? (vue.openBlock(), vue.createElementBlock("button", {
                key: 1,
                class: "accept",
                size: "mini",
                onClick: ($event) => $options.accept(friendRequest)
              }, vue.toDisplayString(_ctx.$t("common.add")), 9, ["onClick"])) : friendRequest.status === 3 ? (vue.openBlock(), vue.createElementBlock(
                "span",
                {
                  key: 2,
                  class: "status"
                },
                vue.toDisplayString(_ctx.$t("friend_request.denied")),
                1
                /* TEXT */
              )) : vue.createCommentVNode("v-if", true)
            ])
          ], 8, ["onClick"]);
        }),
        128
        /* KEYED_FRAGMENT */
      ))
    ]);
  }
  const FriendRequestListView = /* @__PURE__ */ _export_sfc(_sfc_main$v, [["render", _sfc_render$u], ["__scopeId", "data-v-b657b42c"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/contact/FriendRequestListView.vue"]]);
  const _sfc_main$u = {
    name: "ContactListPage",
    components: { UniList: __easycom_0$2, FriendRequestListView },
    data() {
      return {
        sharedContactState: store.state.contact
      };
    },
    onNavigationBarButtonTap(e) {
      formatAppLog("log", "at pages/contact/NewFriendListPage.vue:26", "onNavigationBarButtonTap");
      switch (e.index) {
        case 0:
          uni.showToast({
            title: "TODO",
            icon: "none"
          });
          break;
        case 1:
          uni.navigateTo({
            url: "/pages/search/SearchPortalPage?user=true&contact=false&group=false&conversation=false"
          });
          break;
      }
    },
    methods: {}
  };
  function _sfc_render$t(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_FriendRequestListView = vue.resolveComponent("FriendRequestListView");
    const _component_uni_list = resolveEasycom(vue.resolveDynamicComponent("uni-list"), __easycom_0$2);
    return vue.openBlock(), vue.createElementBlock("view", { class: "friend-request-list" }, [
      vue.createVNode(_component_uni_list, null, {
        default: vue.withCtx(() => [
          vue.createVNode(_component_FriendRequestListView)
        ]),
        _: 1
        /* STABLE */
      })
    ]);
  }
  const PagesContactNewFriendListPage = /* @__PURE__ */ _export_sfc(_sfc_main$u, [["render", _sfc_render$t], ["__scopeId", "data-v-b4570f09"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/contact/NewFriendListPage.vue"]]);
  const _sfc_main$t = {
    name: "GroupListView",
    props: {},
    data() {
      return {
        sharedContactState: store.state.contact
      };
    },
    methods: {
      showGroup(group2) {
        let conversation2 = new Conversation(ConversationType.Group, group2.target, 0);
        store.setCurrentConversation(conversation2);
        this.$go2ConversationPage();
      }
    }
  };
  function _sfc_render$s(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", null, [
      (vue.openBlock(true), vue.createElementBlock(
        vue.Fragment,
        null,
        vue.renderList($data.sharedContactState.favGroupList, (group2, index) => {
          return vue.openBlock(), vue.createElementBlock("div", {
            class: "group-item",
            key: index,
            onClick: ($event) => $options.showGroup(group2)
          }, [
            vue.createElementVNode("img", {
              class: "avatar",
              src: group2.portrait
            }, null, 8, ["src"]),
            vue.createElementVNode(
              "span",
              { class: "single-line" },
              vue.toDisplayString(group2.name),
              1
              /* TEXT */
            )
          ], 8, ["onClick"]);
        }),
        128
        /* KEYED_FRAGMENT */
      ))
    ]);
  }
  const GroupListView = /* @__PURE__ */ _export_sfc(_sfc_main$t, [["render", _sfc_render$s], ["__scopeId", "data-v-38ebad1d"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/contact/GroupListView.vue"]]);
  const _sfc_main$s = {
    name: "ContactListPage",
    components: { GroupListView, UniList: __easycom_0$2 },
    data() {
      return {
        sharedContactState: store.state.contact
      };
    },
    onNavigationBarButtonTap(e) {
      formatAppLog("log", "at pages/contact/GroupListPage.vue:22", "onNavigationBarButtonTap");
      switch (e.index) {
        case 0:
          break;
        case 1:
          uni.navigateTo({
            url: "/pages/search/SearchPortalPage"
          });
          break;
      }
    },
    methods: {}
  };
  function _sfc_render$r(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_GroupListView = vue.resolveComponent("GroupListView");
    const _component_uni_list = resolveEasycom(vue.resolveDynamicComponent("uni-list"), __easycom_0$2);
    return vue.openBlock(), vue.createBlock(_component_uni_list, null, {
      default: vue.withCtx(() => [
        vue.createVNode(_component_GroupListView)
      ]),
      _: 1
      /* STABLE */
    });
  }
  const PagesContactGroupListPage = /* @__PURE__ */ _export_sfc(_sfc_main$s, [["render", _sfc_render$r], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/contact/GroupListPage.vue"]]);
  const _sfc_main$r = {
    name: "PickUserPage",
    props: {},
    data() {
      return {
        users: null,
        initialCheckedUsers: null,
        uncheckableUsers: null,
        title: null,
        confirmTitle: null,
        showCategoryLabel: null,
        sharedPickState: store.state.pick,
        filterQuery: "",
        scrollLeft: 0
      };
    },
    onLoad(option) {
      formatAppLog("log", "at pages/pick/PickUserPage.vue:64", "PickUserPage onLoad");
      const eventChannel = this.getOpenerEventChannel();
      eventChannel.on("pickOptions", (options) => {
        this.users = options.users;
        this.initialCheckedUsers = options.initialCheckedUsers;
        this.uncheckableUsers = options.uncheckableUsers;
        this.showCategoryLabel = options.showCategoryLabel;
        this.confirmTitle = options.confirmTitle;
      });
    },
    onUnload() {
      this.sharedPickState.users.length = 0;
    },
    methods: {
      unpick(user) {
        if (this.isUserUncheckable(user)) {
          return;
        }
        store.pickOrUnpickUser(user);
      },
      isUserUncheckable(user) {
        return this.uncheckableUsers && this.uncheckableUsers.findIndex((u) => u.uid === user.uid) >= 0;
      },
      /**
       * 不包含默认选中的用户
       */
      confirm() {
        let pickedUsers = this.sharedPickState.users;
        if (this.initialCheckedUsers) {
          pickedUsers = this.sharedPickState.users.filter((u) => this.initialCheckedUsers.findIndex((iu) => iu.uid === u.uid) === -1);
        } else {
          pickedUsers = this.sharedPickState.users;
        }
        let users = [...pickedUsers];
        this.sharedPickState.users.length = 0;
        const eventChannel = this.getOpenerEventChannel();
        eventChannel.emit("pickedUsers", users);
        uni.navigateBack();
      }
    },
    computed: {
      checkedUsers() {
        let users = this.sharedPickState.users;
        if (!this.initialCheckedUsers || this.initialCheckedUsers.length === 0) {
          return users;
        }
        return users.filter((u) => {
          return this.initialCheckedUsers.findIndex((iu) => iu.uid === u.uid) === -1;
        });
      },
      filterUsers() {
        formatAppLog("log", "at pages/pick/PickUserPage.vue:133", "filterUsers", this.filterQuery);
        if (this.filterQuery) {
          return store.filterUsers(this.users, this.filterQuery);
        } else {
          return this.users;
        }
      }
    },
    watch: {
      checkedUsers() {
        this.$nextTick(() => {
          this.$refs.pickedUserContainer.scrollLeft = this.$refs.pickedUserContainer.scrollWidth;
          this.scrollLeft = this.$refs.pickedUserContainer.scrollWidth;
        });
      }
    },
    components: { CheckableUserListView }
  };
  function _sfc_render$q(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_CheckableUserListView = vue.resolveComponent("CheckableUserListView");
    return vue.openBlock(), vue.createElementBlock("div", { class: "pick-contact-container" }, [
      $data.users ? (vue.openBlock(), vue.createElementBlock("section", {
        key: 0,
        class: "contact-list-container"
      }, [
        vue.createElementVNode("div", { class: "input-container" }, [
          vue.withDirectives(vue.createElementVNode("input", {
            type: "text",
            placeholder: _ctx.$t("common.search"),
            "onUpdate:modelValue": _cache[0] || (_cache[0] = ($event) => $data.filterQuery = $event)
          }, null, 8, ["placeholder"]), [
            [vue.vModelText, $data.filterQuery]
          ]),
          vue.createElementVNode("i", { class: "icon-ion-ios-search" })
        ]),
        vue.createElementVNode("div", { class: "friend-list-container" }, [
          vue.createVNode(_component_CheckableUserListView, {
            "enable-pick": true,
            users: $options.filterUsers,
            "initial-checked-users": $data.initialCheckedUsers,
            "uncheckable-users": $data.uncheckableUsers,
            "show-category-label": $data.showCategoryLabel && !$data.filterQuery,
            "padding-left": "20px",
            "enable-category-label-sticky": ""
          }, null, 8, ["users", "initial-checked-users", "uncheckable-users", "show-category-label"])
        ])
      ])) : vue.createCommentVNode("v-if", true),
      vue.createElementVNode("section", { class: "checked-contact-list-container" }, [
        vue.createElementVNode("header", null, [
          $options.checkedUsers.length === 0 ? (vue.openBlock(), vue.createElementBlock(
            "span",
            { key: 0 },
            vue.toDisplayString(_ctx.$t("pick.picked_contact")),
            1
            /* TEXT */
          )) : (vue.openBlock(), vue.createElementBlock(
            "span",
            { key: 1 },
            vue.toDisplayString(_ctx.$t("pick.picked_contact") + this.checkedUsers.length),
            1
            /* TEXT */
          )),
          vue.createElementVNode("button", {
            size: "mini",
            class: vue.normalizeClass({ disabled: $options.checkedUsers.length === 0 }),
            disabled: $options.checkedUsers.length === 0,
            onClick: _cache[1] || (_cache[1] = (...args) => $options.confirm && $options.confirm(...args))
          }, vue.toDisplayString($data.confirmTitle), 11, ["disabled"])
        ]),
        vue.createElementVNode(
          "div",
          {
            class: "content",
            ref: "pickedUserContainer"
          },
          [
            (vue.openBlock(true), vue.createElementBlock(
              vue.Fragment,
              null,
              vue.renderList($options.checkedUsers, (user, index) => {
                return vue.openBlock(), vue.createElementBlock("div", {
                  class: "picked-user",
                  key: index,
                  onClick: ($event) => $options.unpick(user)
                }, [
                  vue.createElementVNode("div", { class: "avatar-container" }, [
                    vue.createElementVNode("img", {
                      class: "avatar",
                      src: user.portrait,
                      alt: ""
                    }, null, 8, ["src"])
                  ]),
                  vue.createElementVNode(
                    "span",
                    { class: "name single-line" },
                    vue.toDisplayString(user.displayName),
                    1
                    /* TEXT */
                  )
                ], 8, ["onClick"]);
              }),
              128
              /* KEYED_FRAGMENT */
            ))
          ],
          512
          /* NEED_PATCH */
        ),
        vue.createCommentVNode("            <footer>"),
        vue.createCommentVNode(`                <button @click="cancel" class="cancel">{{ $t('common.cancel') }}</button>`),
        vue.createCommentVNode('                <button @click="confirm" class="confirm" v-bind:class="{disable:checkedUsers.length === 0}">'),
        vue.createCommentVNode("                    {{ confirmTitle }}"),
        vue.createCommentVNode("                </button>"),
        vue.createCommentVNode("            </footer>")
      ])
    ]);
  }
  const PagesPickPickUserPage = /* @__PURE__ */ _export_sfc(_sfc_main$r, [["render", _sfc_render$q], ["__scopeId", "data-v-cd12c8d6"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/pick/PickUserPage.vue"]]);
  const _sfc_main$q = {
    name: "PickSingleUserPage",
    props: {},
    data() {
      return {
        sharedPickState: store.state.pick,
        filterQuery: "",
        scrollLeft: 0,
        users: [],
        showCategoryLabel: true
      };
    },
    onLoad(option) {
      formatAppLog("log", "at pages/pick/PickSingleUserPage.vue:40", "PickSingleUserPage onLoad");
      const eventChannel = this.getOpenerEventChannel();
      eventChannel.on("pickOptions", (options) => {
        formatAppLog("log", "at pages/pick/PickSingleUserPage.vue:49", "pickOptions", options);
        this.users = options.users;
        this.showCategoryLabel = options.showCategoryLabel;
        this.confirmTitle = options.confirmTitle;
      });
    },
    methods: {
      onClickUser(user) {
        formatAppLog("log", "at pages/pick/PickSingleUserPage.vue:59", "onClick user", user);
        const eventChannel = this.getOpenerEventChannel();
        eventChannel.emit("pickedUser", user);
        uni.navigateBack();
      }
    },
    computed: {
      filterUsers() {
        formatAppLog("log", "at pages/pick/PickSingleUserPage.vue:73", "filterUsers", this.filterQuery);
        if (this.filterQuery) {
          return store.filterUsers(this.users, this.filterQuery);
        } else {
          return this.users;
        }
      }
    },
    components: { UserListView }
  };
  function _sfc_render$p(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_UserListView = vue.resolveComponent("UserListView");
    return vue.openBlock(), vue.createElementBlock("div", { class: "pick-contact-container" }, [
      $data.users ? (vue.openBlock(), vue.createElementBlock("section", {
        key: 0,
        class: "contact-list-container"
      }, [
        vue.createElementVNode("div", { class: "input-container" }, [
          vue.withDirectives(vue.createElementVNode("input", {
            type: "text",
            placeholder: _ctx.$t("common.search"),
            "onUpdate:modelValue": _cache[0] || (_cache[0] = ($event) => $data.filterQuery = $event)
          }, null, 8, ["placeholder"]), [
            [vue.vModelText, $data.filterQuery]
          ]),
          vue.createElementVNode("i", { class: "icon-ion-ios-search" })
        ]),
        vue.createElementVNode("div", { class: "friend-list-container" }, [
          vue.createVNode(_component_UserListView, {
            "enable-pick": true,
            users: $options.filterUsers,
            "click-user-item-func": $options.onClickUser,
            "show-category-label": $data.showCategoryLabel && !$data.filterQuery,
            "padding-left": "20px",
            "enable-category-label-sticky": ""
          }, null, 8, ["users", "click-user-item-func", "show-category-label"])
        ])
      ])) : vue.createCommentVNode("v-if", true)
    ]);
  }
  const PagesPickPickSingleUserPage = /* @__PURE__ */ _export_sfc(_sfc_main$q, [["render", _sfc_render$p], ["__scopeId", "data-v-b51ec2f5"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/pick/PickSingleUserPage.vue"]]);
  let handlers;
  let _webView;
  let mApp;
  let mWfc;
  function init(app2, webView) {
    mApp = app2;
    mWfc = app2.wfc;
    _webView = webView;
    handlers = {
      "toast": toast,
      "openUrl": openUrl,
      "getAuthCode": getAuthCode,
      "config": config,
      "chooseContacts": chooseContacts,
      "close": close
    };
  }
  let __messageFromWebView = (data) => {
    let obj = data;
    try {
      obj = JSON.parse(data);
    } catch (e) {
      formatAppLog("error", "at pages/workspace/bridgeServerImpl.js:37", "parse ws data error", e);
      return;
    }
    formatAppLog("log", "at pages/workspace/bridgeServerImpl.js:41", "wf-op-request", obj);
    if (obj.type === "wf-op-request") {
      if (handlers[obj.handlerName]) {
        handlers[obj.handlerName](obj.args, obj.appUrl, obj.requestId);
      } else {
        formatAppLog("log", "at pages/workspace/bridgeServerImpl.js:46", "wf-op-request, unknown handlerName", obj.handlerName);
      }
    }
  };
  let openUrl = (url) => {
    formatAppLog("log", "at pages/workspace/bridgeServerImpl.js:52", "openUrl", url);
    let targetPageUrl;
    targetPageUrl = "/pages/workspace/WorkspaceWebViewPage";
    mApp.$navigateToPage(`${targetPageUrl}?url=${encodeURIComponent(url)}`);
  };
  let getAuthCode = (args, appUrl, requestId) => {
    let host = appUrl.substring(appUrl.indexOf("//") + 2);
    host = host.substring(0, host.indexOf("/"));
    if (host.indexOf(":") > 0) {
      host = host.substring(0, host.indexOf(":"));
    }
    mWfc.getAuthCode(args.appId, args.appType, host, (authCode) => {
      formatAppLog("log", "at pages/workspace/bridgeServerImpl.js:65", "authCode", authCode);
      _response("getAuthCode", appUrl, requestId, 0, authCode);
    }, (err) => {
      formatAppLog("log", "at pages/workspace/bridgeServerImpl.js:68", "getAuthCode error", err);
      _response("getAuthCode", appUrl, requestId, err);
    });
  };
  let config = (args, appUrl) => {
    mWfc.configApplication(args.appId, args.appType, args.timestamp, args.nonceStr, args.signature, () => {
      formatAppLog("log", "at pages/workspace/bridgeServerImpl.js:76", "config success");
      _notify("ready", appUrl);
    }, (err) => {
      formatAppLog("log", "at pages/workspace/bridgeServerImpl.js:80", "config failed");
      _notify("error", appUrl, err);
    });
  };
  let chooseContacts = (args, appUrl, requestId) => {
    formatAppLog("log", "at pages/workspace/bridgeServerImpl.js:88", "xxxx ooo", mApp.store.state.contact);
    mApp.$pickUsers(
      {
        users: mApp.store.state.contact.friendList,
        confirmTitle: "确定",
        successCB: (users) => {
          formatAppLog("log", "at pages/workspace/bridgeServerImpl.js:94", "picked user", users);
          _response("chooseContacts", appUrl, requestId, 0, users);
        }
      }
    );
  };
  let close = (args, appUrl) => {
    uni.navigateBack({
      delta: 1,
      fail: (err) => {
        formatAppLog("log", "at pages/workspace/bridgeServerImpl.js:105", "nav back err", err);
      }
    });
  };
  let toast = (text) => {
    uni.showToast({
      title: text,
      icon: "none"
    });
  };
  function _response(handlerName, appUrl, requestId, code, data) {
    let obj = {
      type: "wf-op-response",
      handlerName,
      appUrl,
      requestId,
      args: {
        code,
        data
      }
    };
    formatAppLog("log", "at pages/workspace/bridgeServerImpl.js:128", "send response", obj);
    _webView.evalJs(`__messageFromUni('${JSON.stringify(obj)}')`);
  }
  function _notify(handlerName, appUrl, args) {
    let obj = {
      type: "wf-op-event",
      handlerName,
      appUrl,
      args
    };
    formatAppLog("log", "at pages/workspace/bridgeServerImpl.js:139", "send event", obj);
    _webView.evalJs(`__messageFromUni('${JSON.stringify(obj)}')`);
  }
  const _sfc_main$p = {
    name: "WorkspacePage",
    data() {
      return {
        url: Config.WORKSPACE_URL
      };
    },
    onLoad(option) {
      formatAppLog("log", "at pages/workspace/WorkspacePage.nvue:18", "onLoad option url", option.url);
      if (option.url) {
        this.url = option.url;
      }
    },
    created() {
    },
    mounted() {
      formatAppLog("log", "at pages/workspace/WorkspacePage.nvue:28", "init ", getApp().wfc, this.$refs.webview);
      init(getApp(), this.$refs.webview);
    },
    methods: {
      // TODO
      // fixme
      // harmony next 下，尚不支持 @onPostMessage
      // https://uniapp.dcloud.net.cn/component/web-view.html#web-view
      handlePostMessage(event) {
        let data = event.detail.data[0];
        formatAppLog("log", "at pages/workspace/WorkspacePage.nvue:39", "onWebViewMessage data", data.obj);
        __messageFromWebView(data.obj);
      }
    }
  };
  function _sfc_render$o(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("web-view", {
      ref: "webview",
      style: { "flex": "1" },
      src: $data.url,
      "on:onPostMessage": _cache[0] || (_cache[0] = (...args) => $options.handlePostMessage && $options.handlePostMessage(...args))
    }, null, 40, ["src"]);
  }
  const PagesWorkspaceWorkspacePage = /* @__PURE__ */ _export_sfc(_sfc_main$p, [["render", _sfc_render$o], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/workspace/WorkspacePage.nvue"]]);
  const _sfc_main$o = {
    name: "WorkspacePage",
    data() {
      return {
        url: ""
      };
    },
    onLoad(option) {
      formatAppLog("log", "at pages/workspace/WorkspaceWebViewPage.nvue:17", "onLoad option url", option.url);
      this.url = decodeURIComponent(option.url);
    },
    created() {
    },
    mounted() {
      formatAppLog("log", "at pages/workspace/WorkspaceWebViewPage.nvue:25", "init ", getApp().wfc, this.$refs.webview);
      init(getApp(), this.$refs.webview);
    },
    methods: {
      onPostMessage(event) {
        let data = event.detail.data[0];
        formatAppLog("log", "at pages/workspace/WorkspaceWebViewPage.nvue:32", "onWebViewMessage data", data.obj);
        __messageFromWebView(data.obj);
      },
      onReceiveTitle(event) {
        let title = event.detail.title;
        uni.setNavigationBarTitle({
          title
        });
      }
    }
  };
  function _sfc_render$n(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("web-view", {
      ref: "webview",
      style: { "flex": "1" },
      src: $data.url,
      "on:onPostMessage": _cache[0] || (_cache[0] = (...args) => $options.onPostMessage && $options.onPostMessage(...args)),
      onReceivedtitle: _cache[1] || (_cache[1] = (...args) => $options.onReceiveTitle && $options.onReceiveTitle(...args))
    }, null, 40, ["src"]);
  }
  const PagesWorkspaceWorkspaceWebViewPage = /* @__PURE__ */ _export_sfc(_sfc_main$o, [["render", _sfc_render$n], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/workspace/WorkspaceWebViewPage.nvue"]]);
  const _imports_0$2 = "/static/image/icon/ic_chatroom.png";
  const _imports_1$2 = "/static/image/icon/ic_robot.png";
  const _imports_2$2 = "/static/image/icon/ic_channel.png";
  const _imports_3$2 = "/static/image/icon/ic_conference.png";
  const _imports_4$1 = "/static/image/icon/ic_dev_docs.png";
  const _sfc_main$n = {
    name: "DiscoveryPage",
    data() {
      return {
        user: store.state.contact.selfUserInfo,
        supportConference: false
      };
    },
    methods: {
      todo() {
        uni.showToast({
          title: "TODO",
          icon: "none"
        });
      },
      showChatroomList() {
        uni.navigateTo({
          url: "/pages/discovery/ChatroomListPage",
          fail: (e) => {
            formatAppLog("log", "at pages/discovery/DiscoveryPage.vue:57", e);
          }
        });
      },
      showRobotConversation() {
        let conversation2 = new Conversation(ConversationType.Single, "FireRobot", 0);
        store.setCurrentConversation(conversation2);
        this.$go2ConversationPage();
      },
      showChannelList() {
        uni.navigateTo({
          url: "/pages/contact/ChannelListPage",
          fail: (e) => {
            formatAppLog("log", "at pages/discovery/DiscoveryPage.vue:70", e);
          }
        });
      },
      showConferencePortal() {
        uni.navigateTo({
          url: "/pages/voip/conference/ConferencePortalPage",
          fail: (e) => {
            formatAppLog("log", "at pages/discovery/DiscoveryPage.vue:78", e);
          }
        });
      },
      showDevGuide() {
        uni.navigateTo({
          url: "/pages/misc/WebViewPage?url=https://docs.wildfirechat.cn/",
          fail: (e) => {
            formatAppLog("log", "at pages/discovery/DiscoveryPage.vue:86", e);
          }
        });
      }
    }
  };
  function _sfc_render$m(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "discovery-container" }, [
      vue.createElementVNode("div", {
        class: "item",
        onClick: _cache[0] || (_cache[0] = (...args) => $options.showChatroomList && $options.showChatroomList(...args))
      }, [
        vue.createElementVNode("image", { src: _imports_0$2 }),
        vue.createElementVNode("text", null, "聊天室"),
        vue.createElementVNode("i", { class: "icon-ion-ios-arrow-right" })
      ]),
      vue.createElementVNode("div", {
        class: "item",
        onClick: _cache[1] || (_cache[1] = (...args) => $options.showRobotConversation && $options.showRobotConversation(...args))
      }, [
        vue.createElementVNode("image", { src: _imports_1$2 }),
        vue.createElementVNode("text", null, "机器人"),
        vue.createElementVNode("i", { class: "icon-ion-ios-arrow-right" })
      ]),
      vue.createElementVNode("div", {
        class: "item",
        onClick: _cache[2] || (_cache[2] = (...args) => $options.showChannelList && $options.showChannelList(...args))
      }, [
        vue.createElementVNode("image", { src: _imports_2$2 }),
        vue.createElementVNode("text", null, "频道"),
        vue.createElementVNode("i", { class: "icon-ion-ios-arrow-right" })
      ]),
      $data.supportConference ? (vue.openBlock(), vue.createElementBlock("div", {
        key: 0,
        class: "item",
        onClick: _cache[3] || (_cache[3] = (...args) => $options.showConferencePortal && $options.showConferencePortal(...args))
      }, [
        vue.createElementVNode("image", { src: _imports_3$2 }),
        vue.createElementVNode("text", null, "会议"),
        vue.createElementVNode("i", { class: "icon-ion-ios-arrow-right" })
      ])) : vue.createCommentVNode("v-if", true),
      vue.createElementVNode("div", {
        class: "item",
        onClick: _cache[4] || (_cache[4] = (...args) => $options.showDevGuide && $options.showDevGuide(...args))
      }, [
        vue.createElementVNode("image", { src: _imports_4$1 }),
        vue.createElementVNode("text", null, "开发手册"),
        vue.createElementVNode("i", { class: "icon-ion-ios-arrow-right" })
      ])
    ]);
  }
  const PagesDiscoveryDiscoveryPage = /* @__PURE__ */ _export_sfc(_sfc_main$n, [["render", _sfc_render$m], ["__scopeId", "data-v-7164f316"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/discovery/DiscoveryPage.vue"]]);
  const _sfc_main$m = {
    name: "ChatroomListPage",
    data() {
      return {
        user: store.state.contact.selfUserInfo
      };
    },
    methods: {
      go2Chatroom(index) {
        let conversation2 = new Conversation(ConversationType.ChatRoom, `chatroom${index}`, 0);
        store.setCurrentConversation(conversation2);
        this.$go2ConversationPage();
      }
    }
  };
  function _sfc_render$l(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "chatroom-container" }, [
      vue.createElementVNode("div", {
        class: "item",
        onClick: _cache[0] || (_cache[0] = ($event) => $options.go2Chatroom(1))
      }, [
        vue.createElementVNode("text", null, "野火聊天室1")
      ]),
      vue.createElementVNode("div", {
        class: "item",
        onClick: _cache[1] || (_cache[1] = ($event) => $options.go2Chatroom(2))
      }, [
        vue.createElementVNode("text", null, "野火聊天室1")
      ]),
      vue.createElementVNode("div", {
        class: "item",
        onClick: _cache[2] || (_cache[2] = ($event) => $options.go2Chatroom(3))
      }, [
        vue.createElementVNode("text", null, "野火聊天室2")
      ])
    ]);
  }
  const PagesDiscoveryChatroomListPage = /* @__PURE__ */ _export_sfc(_sfc_main$m, [["render", _sfc_render$l], ["__scopeId", "data-v-5fca8d1f"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/discovery/ChatroomListPage.vue"]]);
  const _sfc_main$l = {
    name: "MePage",
    data() {
      return {
        user: store.state.contact.selfUserInfo,
        info: ""
      };
    },
    mounted() {
      if (self$2.isAVEngineKitEnable()) {
        if (self$2.isSupportConference()) {
          this.info += "高级版音视频\n";
        } else {
          this.info += "多人版音视频\n";
          Config.ICE_SERVERS.forEach((obj) => {
            this.info += obj.uri + " " + obj.userName + " " + obj.password;
          });
        }
      }
    },
    methods: {
      showUserInfo() {
        store.setCurrentFriend(this.user);
        uni.navigateTo({
          url: "/pages/contact/UserDetailPage",
          success: () => {
            formatAppLog("log", "at pages/me/MePage.vue:56", "nav to UserDetailPage success");
          },
          fail: (err) => {
            formatAppLog("log", "at pages/me/MePage.vue:60", "nav to UserDetailPage err", err);
          }
        });
      },
      logout() {
        wfc.disconnect(true, false);
        clear();
        uni.reLaunch(
          {
            url: "/pages/login/login"
          }
        );
      },
      showAbout() {
        uni.navigateTo({
          url: "/pages/misc/WebViewPage?url=https://wildfirechat.cn/",
          fail: (e) => {
            formatAppLog("log", "at pages/me/MePage.vue:78", e);
          }
        });
      },
      showApiTest() {
        uni.navigateTo({
          url: "/pages/misc/ApiTestPage",
          fail: (e) => {
            formatAppLog("log", "at pages/me/MePage.vue:86", e);
          }
        });
      }
    }
  };
  function _sfc_render$k(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "me-container" }, [
      vue.createElementVNode("div", {
        class: "user-info",
        onClick: _cache[0] || (_cache[0] = (...args) => $options.showUserInfo && $options.showUserInfo(...args))
      }, [
        vue.createElementVNode("image", {
          class: "portrait",
          src: $data.user.portrait
        }, null, 8, ["src"]),
        vue.createElementVNode(
          "text",
          { class: "name" },
          vue.toDisplayString($data.user.displayName),
          1
          /* TEXT */
        )
      ]),
      vue.createElementVNode("div", {
        class: "about",
        onClick: _cache[1] || (_cache[1] = (...args) => $options.showAbout && $options.showAbout(...args))
      }, [
        vue.createElementVNode("text", null, "关于")
      ]),
      vue.createElementVNode("div", {
        class: "about",
        onClick: _cache[2] || (_cache[2] = (...args) => $options.showApiTest && $options.showApiTest(...args))
      }, [
        vue.createElementVNode("text", null, "API测试")
      ]),
      vue.createElementVNode("div", null, [
        vue.createElementVNode(
          "text",
          null,
          vue.toDisplayString($data.info),
          1
          /* TEXT */
        )
      ]),
      vue.createElementVNode("button", {
        class: "logout-button",
        onClick: _cache[3] || (_cache[3] = (...args) => $options.logout && $options.logout(...args))
      }, "退出登录")
    ]);
  }
  const PagesMeMePage = /* @__PURE__ */ _export_sfc(_sfc_main$l, [["render", _sfc_render$k], ["__scopeId", "data-v-491d9929"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/me/MePage.vue"]]);
  const _sfc_main$k = {
    name: "WebViewPage",
    data() {
      return {
        url: ""
      };
    },
    onLoad(option) {
      formatAppLog("log", "at pages/misc/WebViewPage.vue:15", "onLoad option url", decodeURIComponent(option.url));
      this.url = decodeURIComponent(option.url);
    }
  };
  function _sfc_render$j(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("web-view", { src: $data.url }, null, 8, ["src"]);
  }
  const PagesMiscWebViewPage = /* @__PURE__ */ _export_sfc(_sfc_main$k, [["render", _sfc_render$j], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/misc/WebViewPage.vue"]]);
  const _sfc_main$j = {
    name: "PreviewVideoPage",
    data() {
      return {
        url: ""
      };
    },
    onLoad(option) {
      formatAppLog("log", "at pages/misc/PreviewVideoPage.vue:19", "onLoad option url", decodeURIComponent(option.url));
      this.url = decodeURIComponent(option.url);
    }
  };
  function _sfc_render$i(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("view", { class: "video-container" }, [
      vue.createElementVNode("video", {
        src: $data.url,
        autoplay: "true",
        controls: "false"
      }, null, 8, ["src"])
    ]);
  }
  const PagesMiscPreviewVideoPage = /* @__PURE__ */ _export_sfc(_sfc_main$j, [["render", _sfc_render$i], ["__scopeId", "data-v-79c50a46"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/misc/PreviewVideoPage.vue"]]);
  class CallState {
  }
  __publicField(CallState, "STATUS_IDLE", 0);
  __publicField(CallState, "STATUS_OUTGOING", 1);
  __publicField(CallState, "STATUS_INCOMING", 2);
  __publicField(CallState, "STATUS_CONNECTING", 3);
  __publicField(CallState, "STATUS_CONNECTED", 4);
  class VideoType {
  }
  // 不订阅视频流
  __publicField(VideoType, "NONE", 0);
  // 订阅大流
  __publicField(VideoType, "BIG_STREAM", 1);
  // 订阅小流
  __publicField(VideoType, "SMALL_STREAM", 2);
  class CallSessionCallback {
    /**
     *  自己挂断回调
     * @param {number} reason 挂断原因，参考{@link CallEndReason}
     */
    didCallEndWithReason(reason) {
      formatAppLog("log", "at wfc/av/engine/callSessionCallback.js:12", "didCallEndWithReason", reason);
    }
    /**
     * 可用来实现响铃相关
     * 1. outgoing -> connecting: 开始 -> 结束播放呼出铃声
     * 2. incoming -> connecting: 开始 -> 结束播放呼入铃声
     *  自己通话状态变化时调用
     * @param {CallState} state 状态
     */
    didChangeState(state) {
      formatAppLog("log", "at wfc/av/engine/callSessionCallback.js:24", "didChangeState", state);
    }
    /**
     * 新参与者加入回调
     * @param {string} userId 用户 id
     * @param {boolean} screenSharing 是否是屏幕共享
     */
    didParticipantJoined(userId, screenSharing = false) {
      formatAppLog("log", "at wfc/av/engine/callSessionCallback.js:33", "didParticipantJoined", userId, screenSharing);
    }
    /**
     * 参与者连接成功
     * @param {string} userId 用户 id
     * @param {boolean} screenSharing 是否是屏幕共享
     */
    didParticipantConnected(userId, screenSharing = false) {
      formatAppLog("log", "at wfc/av/engine/callSessionCallback.js:43", "didParticipantConnected", userId, screenSharing);
    }
    /**
     * 参与者挂断回调
     * @param {string} userId 用户 id
     * @param {CallEndReason} callEndReason 挂断原因
     * @param {boolean} screenSharing 是否是屏幕共享
     */
    didParticipantLeft(userId, callEndReason, screenSharing = false) {
      formatAppLog("log", "at wfc/av/engine/callSessionCallback.js:53", "didParticipantLeft", userId, callEndReason, screenSharing);
    }
    /**
     * 视频通话切换到语音通话回调
     * @param {boolean} audioOnly 目前都是 true
     */
    didChangeMode(audioOnly) {
      formatAppLog("log", "at wfc/av/engine/callSessionCallback.js:61", "didChangeMode", audioOnly);
    }
    /**
     * 发起者变更回调，多人通话过程中，原始发起者退出通话，会触发选举新的发起者
     * @param {string} initiator 新的发起者
     */
    didChangeInitiator(initiator) {
      formatAppLog("log", "at wfc/av/engine/callSessionCallback.js:69", "didChangeInitiator", initiator);
    }
    /**
     * 本地音视频流创建成功回调
     * @param {boolean} screenSharing 是否是屏幕共享
     */
    didCreateLocalVideoTrack(screenSharing) {
      formatAppLog("log", "at wfc/av/engine/callSessionCallback.js:77", "didCreateLocalVideoTrack", screenSharing);
    }
    /**
     *  收到用户远程视频流回调
     * @param {String} userId 用户 id
     * @param {boolean} screenSharing 是否是屏幕共享
     */
    didReceiveRemoteVideoTrack(userId, screenSharing) {
      formatAppLog("log", "at wfc/av/engine/callSessionCallback.js:86", "didReceiveRemoteVideoTrack", userId, screenSharing);
    }
    /**
     * 用户视频流被移除回调
     * @param {String} userId
     */
    didRemoveRemoteVideoTrack(userId) {
      formatAppLog("log", "at wfc/av/engine/callSessionCallback.js:94", "didRemoveRemoteVideoTrack", userId);
    }
    didAudioDeviceChanged(audioDevice) {
      formatAppLog("log", "at wfc/av/engine/callSessionCallback.js:99", "didAudioDeviceChanged", audioDevice);
    }
    didError(error) {
      formatAppLog("log", "at wfc/av/engine/callSessionCallback.js:103", "didError", error);
    }
    didGetStats(reports) {
    }
    /**
     * 单人、多人音视频通话时生效，会议时调用的是 {@link didMuteStateChanged}
     * @param {string} userId
     * @param {boolean} muted
     */
    didVideoMuted(userId, muted) {
      formatAppLog("log", "at wfc/av/engine/callSessionCallback.js:116", "didVideoMuted", userId, muted);
    }
    /**
     * 高级版生效，多人版调用的是 {@link didVideoMuted}
     * @param {[string]} participants
     */
    didMuteStateChanged(participants) {
      formatAppLog("log", "at wfc/av/engine/callSessionCallback.js:125", "didMuteStateChanged", participants);
    }
    /**
     * 当前用户发送媒体丢包回调
     * @param media 媒体类型，audio 或 video
     * @param lostPacket 丢包数
     * @param {boolean} screenSharing
     */
    didMediaLostPacket(media, lostPacket, screenSharing = false) {
      formatAppLog("log", "at wfc/av/engine/callSessionCallback.js:135", "didMediaLostPacket", media, lostPacket, screenSharing);
    }
    /**
     * 接收用户媒体丢包回调
     * @param userId 用户id
     * @param media 媒体类型，audio 或 video
     * @param lostPacket 丢包数
     * @param uplink 方向，true是对方丢的，false是己方丢的
     * @param {boolean} screenSharing
     */
    didUserMediaLostPacket(userId, media, lostPacket, uplink, screenSharing = false) {
      formatAppLog("log", "at wfc/av/engine/callSessionCallback.js:147", "didUserMediaLostPacket", userId, media, lostPacket, uplink, screenSharing);
    }
    /**
     * 会议时有效
     * 听众或互动者角色变更回调
     * @param {string} userId
     * @param {boolean} audience
     * @param {boolean} screenSharing
     */
    didChangeType(userId, audience, screenSharing = false) {
      formatAppLog("log", "at wfc/av/engine/callSessionCallback.js:158", "didChangeType", userId, audience, screenSharing);
    }
    /**
     * 音量回调
     * @param {string} userId 用户 id
     * @param {number} volume 音量
     */
    didReportAudioVolume(userId, volume) {
    }
    /**
     * 会议时有效
     * 听众和互动者角色切换回调
     * @param {boolean} audience 是否是切换为听众
     */
    onRequestChangeMode(audience) {
      formatAppLog("log", "at wfc/av/engine/callSessionCallback.js:176", "onRequestChangeMode", audience);
    }
  }
  const _imports_2$1 = "/static/image/av/av_hang_up.png";
  const _imports_0$1 = "/static/image/av/av_video_answer.png";
  const _imports_3$1 = "/static/image/av/av_mute.png";
  const _imports_4 = "/static/image/av/av_mute_hover.png";
  const _imports_7$1 = "/static/image/av/av_share.png";
  const _imports_2 = "/static/image/av/av_conference_video.png";
  const _imports_3 = "/static/image/av/av_conference_video_mute.png";
  const _imports_1$1 = "/static/image/av/av_float_audio.png";
  const _imports_10 = "/static/image/av/av_minimize.png";
  const _sfc_main$i = {
    name: "Single",
    data() {
      return {
        // why? 直接引入 wfc 会报 require not defined 错误
        wfc: getApp().wfc,
        session: null,
        audioOnly: false,
        audioMuted: false,
        videoMuted: false,
        callState: 0,
        startTimestamp: 0,
        currentTimestamp: 0,
        showWebrtcTip: false,
        ringAudio: null,
        targetUserId: null
      };
    },
    onLoad(option) {
      formatAppLog("log", "at pages/voip/Single.nvue:138", "voip/Single onLoad", option);
      this.session = JSON.parse(option.session);
      this.targetUserId = this.session.conversation.target;
      this.callState = Number(this.session.state);
      this.audioOnly = this.session.audioOnly;
      if (this.session.connectedTime) {
        this.startTimestamp = this.session.connectedTime;
      }
    },
    onUnload() {
    },
    methods: {
      switchVideoType() {
        if (!this.session) {
          return;
        }
        let userId = this.participantUserInfo.uid;
        let videoType = VideoType.NONE;
        {
          videoType = VideoType.SMALL_STREAM;
        }
        formatAppLog("log", "at pages/voip/Single.nvue:166", "setParticipantVideoType", userId, videoType);
        self$2.setParticipantVideoType(this.session.callId, userId, false, videoType);
      },
      setupSessionCallback() {
        let sessionCallback = new CallSessionCallback();
        sessionCallback.didChangeState = (state) => {
          formatAppLog("log", "at pages/voip/Single.nvue:174", "didChangeState", typeof state, state, this.callState);
          this.callState = state;
          if (state === CallState.STATUS_CONNECTED) {
            this.onVoipConnected();
          } else if (state === CallState.STATUS_IDLE) {
            if (this.timer) {
              clearInterval(this.timer);
            }
          }
          formatAppLog("log", "at pages/voip/Single.nvue:185", "callState change", state, this.callState);
        };
        sessionCallback.didChangeMode = (audioOnly) => {
          this.audioOnly = audioOnly;
        };
        sessionCallback.didCreateLocalVideoTrack = () => {
          formatAppLog("log", "at pages/voip/Single.nvue:193", "didCreateLocalVideoTrack");
        };
        sessionCallback.didReceiveRemoteVideoTrack = (userId) => {
          formatAppLog("log", "at pages/voip/Single.nvue:200", "didReceiveRemoteVideoTrack", userId);
          if (this.$refs.remoteVideo) {
            self$2.setRemoteVideoView(this.session.callId, userId, this.$refs.remoteVideo.ref);
          }
          if (self$2.isSupportConference()) {
            self$2.setParticipantVideoType(this.session.callId, userId, false, VideoType.BIG_STREAM);
          }
        };
        sessionCallback.didCallEndWithReason = (reason) => {
          formatAppLog("log", "at pages/voip/Single.nvue:210", "callEndWithReason", reason);
          this.session = null;
        };
        sessionCallback.didVideoMuted = (userId, muted) => {
          formatAppLog("log", "at pages/voip/Single.nvue:215", "didVideoMuted", userId, muted);
          if (userId === this.wfc.getUserId()) {
            this.videoMuted = muted;
            this.$nextTick(() => {
              self$2.setLocalVideoView(this.session.callId, this.$refs.localVideo.ref);
            });
          } else {
            if (!muted) {
              this.$nextTick(() => {
                self$2.setRemoteVideoView(this.session.callId, this.targetUserId, this.$refs.remoteVideo.ref);
              });
            }
          }
        };
        sessionCallback.didMediaLostPacket = (media, lostPacket) => {
          if (lostPacket > 6) {
            formatAppLog("log", "at pages/voip/Single.nvue:232", "您的网络不好");
          }
        };
        sessionCallback.didUserMediaLostPacket = (userId, media, lostPacket, uplink) => {
          if (lostPacket > 10) {
            if (uplink) {
              formatAppLog("log", "at pages/voip/Single.nvue:241", "对方网络不好");
            } else {
              formatAppLog("log", "at pages/voip/Single.nvue:243", "您的网络不好");
            }
          }
        };
        sessionCallback.didParticipantConnected = (userId) => {
          formatAppLog("log", "at pages/voip/Single.nvue:249", "didParticipantConnected", userId);
        };
        sessionCallback.didReportAudioVolume = (userId, volume) => {
        };
        formatAppLog("log", "at pages/voip/Single.nvue:256", "single setSessionCallback");
        getApp().avengineKit.setSessionCallback(sessionCallback);
      },
      async answer() {
        formatAppLog("log", "at pages/voip/Single.nvue:266", "answer");
        if (!await checkVoipPermissions(this.session.audioOnly)) {
          formatAppLog("log", "at pages/voip/Single.nvue:268", "no permission, hangup");
          return;
        }
        self$2.answerCall(this.session.callId, false);
      },
      hangup() {
        formatAppLog("log", "at pages/voip/Single.nvue:275", "hangup");
        let callId = this.session.callId;
        self$2.endCall(callId);
        this.session = null;
      },
      switchCamera() {
        if (!this.session) {
          return;
        }
        self$2.switchCamera(this.session.callId);
      },
      mute() {
        this.audioMuted = !this.audioMuted;
        self$2.muteAudio(this.session.callId, this.audioMuted);
      },
      muteVideo() {
        this.videoMuted = !this.videoMuted;
        self$2.muteVideo(this.session.callId, this.videoMuted);
      },
      down2voice() {
        self$2.downgrade2Voice(this.session.callId);
      },
      screenShare() {
      },
      onVoipConnected() {
        if (!this.timer) {
          if (!this.startTimestamp) {
            this.startTimestamp = (/* @__PURE__ */ new Date()).getTime();
          }
          this.timer = setInterval(() => {
            this.currentTimestamp = (/* @__PURE__ */ new Date()).getTime();
          }, 1e3);
        }
        if (!this.audioOnly) {
          setTimeout(() => {
            formatAppLog("log", "at pages/voip/Single.nvue:318", "setLocalVideoView", this.wfc.getUserId(), this.$refs.localVideo.ref);
            self$2.setLocalVideoView(this.session.callId, this.$refs.localVideo.ref);
            self$2.setRemoteVideoView(this.session.callId, this.targetUserId, this.$refs.remoteVideo.ref);
            formatAppLog("log", "at pages/voip/Single.nvue:321", "setRemoteVideoView", this.targetUserId, this.$refs.remoteVideo.ref);
          }, 100);
        }
      },
      timestampFormat(timestamp) {
        timestamp = ~~(timestamp / 1e3);
        let str = "";
        let hour = ~~(timestamp / 3600);
        str = hour > 0 ? (hour < 10 ? "0" : "") + hour + ":" : "";
        let min = ~~(timestamp % 3600 / 60);
        str += (min < 10 ? "0" : "") + min + ":";
        let sec = ~~(timestamp % 60);
        str += (sec < 10 ? "0" : "") + sec;
        return str;
      },
      minimize() {
        let granted = getApp().avengineKit.checkOverlayPermission();
        formatAppLog("log", "at pages/voip/Single.nvue:340", "overlayPermission granted", granted);
        if (granted) {
          getApp().avengineKit.minimize(this.session.callId);
          uni.navigateBack({
            delta: 1,
            fail: (err) => {
              formatAppLog("log", "at pages/voip/Single.nvue:346", "nav back to err", err);
            }
          });
        } else {
          uni.showToast({
            title: "需要悬浮窗权限",
            icon: "none"
          });
        }
      }
    },
    mounted() {
      let curSession = self$2.currentCallSession();
      formatAppLog("log", "at pages/voip/Single.nvue:360", "voip/Single mounted", curSession);
      if (!curSession || curSession.state === 0) {
        formatAppLog("log", "at pages/voip/Single.nvue:362", "av call already hangup");
        uni.navigateBack({
          delta: 1,
          fail: (err) => {
            formatAppLog("log", "at pages/voip/Single.nvue:366", "nav back to conversationView err", err);
          }
        });
        return;
      }
      this.session = curSession;
      this.setupSessionCallback();
      if (this.callState === CallState.STATUS_CONNECTED) {
        this.onVoipConnected();
      }
    },
    onBackPress(event) {
      formatAppLog("log", "at pages/voip/Single.nvue:406", "conferencePage, onBackPress", event);
      if (event.from === "navigateBack") {
        return false;
      }
      return true;
    },
    beforeUnmount() {
    },
    computed: {
      participantUserInfo() {
        let conversaiton = this.session.conversation;
        let userInfo = this.wfc.getUserInfo(conversaiton.target, false);
        return userInfo;
      },
      selfUserInfo() {
        let userInfo = this.wfc.getUserInfo(this.wfc.getUserId(), false);
        return userInfo;
      },
      duration() {
        if (this.currentTimestamp <= 0) {
          return "00:00";
        }
        let escapeMillis = this.currentTimestamp - this.startTimestamp;
        return this.timestampFormat(escapeMillis);
      },
      computedLocalMediaContainerStyle() {
        if (!this.audioOnly && this.callState === CallState.STATUS_CONNECTED) {
          return {
            top: 0,
            right: 0,
            paddingTop: "88rpx"
          };
        }
        return {
          top: 0,
          left: 0,
          marginLeft: "20px",
          paddingTop: "80rpx"
        };
      },
      computedLocalAvatarStyle() {
        if (this.callState === CallState.STATUS_CONNECTED && this.videoMuted) {
          return {
            width: "150px",
            height: "200px",
            borderRadius: "5px",
            marginRight: "5px"
          };
        }
        return {
          width: "60px",
          height: "60px",
          borderRadius: "3px"
        };
      }
    }
  };
  function _sfc_render$h(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { style: { "flex": "1", "display": "flex" } }, [
      $data.session ? (vue.openBlock(), vue.createElementBlock("div", {
        key: 0,
        class: "container"
      }, [
        vue.createCommentVNode("audio"),
        $data.audioOnly ? (vue.openBlock(), vue.createElementBlock("div", {
          key: 0,
          class: "content-container"
        }, [
          vue.createElementVNode(
            "div",
            {
              class: "local-media-container",
              style: vue.normalizeStyle($options.computedLocalMediaContainerStyle)
            },
            [
              vue.createElementVNode("image", {
                class: "avatar",
                src: $options.selfUserInfo.portrait
              }, null, 8, ["src"])
            ],
            4
            /* STYLE */
          ),
          vue.createElementVNode("div", { class: "remote-media-container" }, [
            vue.createElementVNode("image", {
              class: "avatar",
              src: $options.participantUserInfo.portrait
            }, null, 8, ["src"]),
            vue.createElementVNode(
              "text",
              { class: "desc" },
              vue.toDisplayString($options.participantUserInfo.displayName),
              1
              /* TEXT */
            ),
            $data.callState === 1 ? (vue.openBlock(), vue.createElementBlock("text", {
              key: 0,
              class: "desc"
            }, "等待对方接听")) : $data.callState === 2 ? (vue.openBlock(), vue.createElementBlock("text", {
              key: 1,
              class: "desc"
            }, "邀请你语音聊天")) : $data.callState === 3 ? (vue.openBlock(), vue.createElementBlock("text", {
              key: 2,
              class: "desc"
            }, "接听中...")) : vue.createCommentVNode("v-if", true)
          ])
        ])) : (vue.openBlock(), vue.createElementBlock(
          vue.Fragment,
          { key: 1 },
          [
            vue.createCommentVNode("video"),
            vue.createElementVNode("div", { class: "content-container" }, [
              vue.createElementVNode("div", { class: "remote-media-container" }, [
                $data.callState === 4 ? (vue.openBlock(), vue.createElementBlock(
                  "UIKit-Video-CallView",
                  {
                    key: 0,
                    onClick: _cache[0] || (_cache[0] = ($event) => $options.switchVideoType()),
                    ref: "remoteVideo",
                    class: "video"
                  },
                  null,
                  512
                  /* NEED_PATCH */
                )) : vue.createCommentVNode("v-if", true),
                $data.callState !== 4 ? (vue.openBlock(), vue.createElementBlock("div", {
                  key: 1,
                  class: "flex-column flex-justify-center flex-align-center"
                }, [
                  vue.createElementVNode("image", {
                    class: "avatar",
                    src: $options.participantUserInfo.portrait
                  }, null, 8, ["src"]),
                  vue.createElementVNode(
                    "text",
                    { class: "desc" },
                    vue.toDisplayString($options.participantUserInfo.displayName),
                    1
                    /* TEXT */
                  ),
                  $data.callState === 1 ? (vue.openBlock(), vue.createElementBlock("text", {
                    key: 0,
                    class: "desc"
                  }, "等待对方接听")) : $data.callState === 2 ? (vue.openBlock(), vue.createElementBlock("text", {
                    key: 1,
                    class: "desc"
                  }, "邀请你视频聊天")) : $data.callState === 3 ? (vue.openBlock(), vue.createElementBlock("text", {
                    key: 2,
                    class: "desc"
                  }, "接听中...")) : vue.createCommentVNode("v-if", true)
                ])) : vue.createCommentVNode("v-if", true)
              ]),
              vue.createElementVNode(
                "div",
                {
                  class: "local-media-container",
                  style: vue.normalizeStyle($options.computedLocalMediaContainerStyle)
                },
                [
                  $data.callState === 4 && !$data.videoMuted ? (vue.openBlock(), vue.createElementBlock(
                    "UIKit-Video-CallView",
                    {
                      key: 0,
                      ref: "localVideo",
                      class: "localVideo"
                    },
                    null,
                    512
                    /* NEED_PATCH */
                  )) : vue.createCommentVNode("v-if", true),
                  $data.callState !== 4 || $data.videoMuted ? (vue.openBlock(), vue.createElementBlock("image", {
                    key: 1,
                    style: vue.normalizeStyle($options.computedLocalAvatarStyle),
                    src: $options.selfUserInfo.portrait
                  }, null, 12, ["src"])) : vue.createCommentVNode("v-if", true)
                ],
                4
                /* STYLE */
              )
            ])
          ],
          2112
          /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */
        )),
        vue.createCommentVNode("actions"),
        vue.createCommentVNode("incoming"),
        $data.callState === 2 ? (vue.openBlock(), vue.createElementBlock("div", {
          key: 2,
          class: "action-container"
        }, [
          vue.createElementVNode("div", { class: "action" }, [
            vue.createElementVNode("image", {
              onClick: _cache[1] || (_cache[1] = (...args) => $options.hangup && $options.hangup(...args)),
              class: "action-img",
              src: _imports_2$1
            })
          ]),
          vue.createElementVNode("div", { class: "action" }, [
            vue.createElementVNode("image", {
              onClick: _cache[2] || (_cache[2] = (...args) => $options.answer && $options.answer(...args)),
              class: "action-img",
              src: _imports_0$1
            })
          ]),
          vue.createCommentVNode('          <div v-if="!audioOnly" class="action">'),
          vue.createCommentVNode(`            <image @click="down2voice" class="action-img" src='/static/image/av/av_float_audio.png'/>`),
          vue.createCommentVNode("            <p>切换到语音聊天</p>"),
          vue.createCommentVNode("          </div>")
        ])) : vue.createCommentVNode("v-if", true),
        vue.createCommentVNode("outgoing"),
        $data.callState === 1 ? (vue.openBlock(), vue.createElementBlock("div", {
          key: 3,
          class: "action-container"
        }, [
          vue.createElementVNode("div", { class: "action" }, [
            vue.createElementVNode("image", {
              onClick: _cache[3] || (_cache[3] = (...args) => $options.hangup && $options.hangup(...args)),
              class: "action-img",
              src: _imports_2$1
            })
          ])
        ])) : vue.createCommentVNode("v-if", true),
        vue.createCommentVNode("connected"),
        $data.callState === 4 ? (vue.openBlock(), vue.createElementBlock("div", {
          key: 4,
          class: "action-container"
        }, [
          vue.createElementVNode("div", { class: "action" }, [
            !$data.audioMuted ? (vue.openBlock(), vue.createElementBlock("image", {
              key: 0,
              onClick: _cache[4] || (_cache[4] = (...args) => $options.mute && $options.mute(...args)),
              class: "action-img",
              src: _imports_3$1
            })) : (vue.openBlock(), vue.createElementBlock("image", {
              key: 1,
              onClick: _cache[5] || (_cache[5] = (...args) => $options.mute && $options.mute(...args)),
              class: "action-img",
              src: _imports_4
            })),
            vue.createElementVNode("text", { class: "desc" }, "静音")
          ]),
          !$data.audioOnly && false ? (vue.openBlock(), vue.createElementBlock("div", {
            key: 0,
            class: "action"
          }, [
            vue.createElementVNode("image", {
              onClick: _cache[6] || (_cache[6] = (...args) => $options.screenShare && $options.screenShare(...args)),
              class: "action-img",
              src: _imports_7$1
            })
          ])) : vue.createCommentVNode("v-if", true),
          !$data.audioOnly && false ? (vue.openBlock(), vue.createElementBlock("div", {
            key: 1,
            class: "action"
          }, [
            !$data.videoMuted ? (vue.openBlock(), vue.createElementBlock("image", {
              key: 0,
              onClick: _cache[7] || (_cache[7] = (...args) => $options.muteVideo && $options.muteVideo(...args)),
              class: "action-img",
              src: _imports_2
            })) : (vue.openBlock(), vue.createElementBlock("image", {
              key: 1,
              onClick: _cache[8] || (_cache[8] = (...args) => $options.muteVideo && $options.muteVideo(...args)),
              class: "action-img",
              src: _imports_3
            })),
            vue.createElementVNode("text", { class: "desc" }, "关闭摄像头")
          ])) : vue.createCommentVNode("v-if", true),
          !$data.audioOnly && true ? (vue.openBlock(), vue.createElementBlock("div", {
            key: 2,
            class: "action"
          }, [
            vue.createElementVNode("image", {
              onClick: _cache[9] || (_cache[9] = (...args) => $options.switchCamera && $options.switchCamera(...args)),
              class: "action-img",
              src: "//static/image/av/av_camera.png"
            }),
            vue.createElementVNode("text", { class: "desc" }, "切换摄像头")
          ])) : vue.createCommentVNode("v-if", true),
          !$data.audioOnly && false ? (vue.openBlock(), vue.createElementBlock("div", {
            key: 3,
            class: "action"
          }, [
            vue.createElementVNode("image", {
              onClick: _cache[10] || (_cache[10] = (...args) => $options.down2voice && $options.down2voice(...args)),
              class: "action-img",
              src: _imports_1$1
            }),
            vue.createElementVNode("text", { class: "desc" }, "切换到语音聊天")
          ])) : vue.createCommentVNode("v-if", true),
          vue.createElementVNode("div", { class: "action" }, [
            vue.createElementVNode("image", {
              onClick: _cache[11] || (_cache[11] = (...args) => $options.hangup && $options.hangup(...args)),
              class: "action-img",
              src: _imports_2$1
            }),
            vue.createElementVNode("text", { class: "desc" }, "挂断")
          ])
        ])) : vue.createCommentVNode("v-if", true),
        vue.createElementVNode("div", { class: "voip-title-container" }, [
          vue.createElementVNode("div", { class: "title" }, [
            $data.callState === 4 ? (vue.openBlock(), vue.createElementBlock(
              "text",
              {
                key: 0,
                class: "desc"
              },
              vue.toDisplayString($options.duration),
              1
              /* TEXT */
            )) : vue.createCommentVNode("v-if", true)
          ]),
          vue.createElementVNode("image", {
            onClick: _cache[12] || (_cache[12] = (...args) => $options.minimize && $options.minimize(...args)),
            style: { "width": "30px", "height": "30px" },
            src: _imports_10
          })
        ])
      ])) : vue.createCommentVNode("v-if", true)
    ]);
  }
  const PagesVoipSingle = /* @__PURE__ */ _export_sfc(_sfc_main$i, [["render", _sfc_render$h], ["__scopeId", "data-v-10473c79"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/voip/Single.nvue"]]);
  const _imports_9$1 = "/static/image/av/add.png";
  const _sfc_main$h = {
    name: "Multi",
    data() {
      return {
        wfc: getApp().wfc,
        session: null,
        audioOnly: false,
        callState: 1,
        initiatorUserInfo: null,
        participantUserInfos: [],
        groupMemberUserInfos: [],
        startTimestamp: 0,
        currentTimestamp: 0,
        videoInputDeviceIndex: 0,
        broadcastMultiCallOngoingTimer: 0,
        autoPlayInterval: 0,
        showWebrtcTip: false,
        ringAudio: null,
        setupVideoViewsTimer: 0
      };
    },
    onLoad(option) {
      formatAppLog("log", "at pages/voip/Multi.nvue:147", "voip/Multi onLoad", option);
      this.session = JSON.parse(option.session);
      this.callState = this.session.state;
      this.audioOnly = this.session.audioOnly;
      if (this.session.connectedTime) {
        this.startTimestamp = this.session.connectedTime;
      }
    },
    methods: {
      switchVideoType(userId, screenSharing) {
        let videoType = VideoType.NONE;
        {
          videoType = VideoType.SMALL_STREAM;
        }
        self$2.setParticipantVideoType(this.session.callId, userId, screenSharing, videoType);
      },
      setupSessionCallback() {
        let sessionCallback = new CallSessionCallback();
        sessionCallback.didChangeState = (state) => {
          formatAppLog("log", "at pages/voip/Multi.nvue:173", "didChangeState", typeof state, state, this.callState);
          this.callState = state;
          if (state === CallState.STATUS_CONNECTED) {
            this.onVoipConnected();
            if (Config.ENABLE_MULTI_CALL_AUTO_JOIN && this.selfUserInfo.uid === this.session.initiator) {
              this.broadcastMultiCallOngoingTimer = setInterval(this.broadcastMultiCallOngoing, 1e3);
            }
          } else if (state === CallState.STATUS_IDLE) {
            if (this.timer) {
              clearInterval(this.timer);
            }
          }
        };
        sessionCallback.didChangeMode = (audioOnly) => {
          this.audioOnly = audioOnly;
        };
        sessionCallback.didCreateLocalVideoTrack = (stream) => {
        };
        sessionCallback.didParticipantConnected = (userId, screenSharing) => {
        };
        sessionCallback.didReceiveRemoteVideoTrack = (userId, screenSharing) => {
          formatAppLog("log", "at pages/voip/Multi.nvue:200", "didReceiveRemoteVideoTrack", userId, screenSharing);
          this.participantUserInfos.forEach((u) => {
            if (u.uid === userId) {
              u._state = CallState.STATUS_CONNECTED;
            }
          });
          if (this.callState === CallState.STATUS_CONNECTED) {
            setTimeout(() => {
              this.$nextTick(() => {
                formatAppLog("log", "at pages/voip/Multi.nvue:211", "setRemoteVideoView", userId, this.$refs["remoteVideo-" + userId][0].ref);
                self$2.setRemoteVideoView(this.session.callId, userId, this.$refs["remoteVideo-" + userId][0].ref, false);
              });
            }, 1e3);
          }
        };
        sessionCallback.didParticipantJoined = (userId, screenSharing) => {
          let profile = self$2.getParticipantProfile(this.session.callId, userId, screenSharing);
          let userInfo = this.wfc.getUserInfo(userId);
          userInfo._isVideoMuted = profile.videoMuted;
          userInfo._isAudioMuted = profile.audioMuted;
          userInfo._isAudience = profile.audience;
          this.participantUserInfos.push(userInfo);
          formatAppLog("log", "at pages/voip/Multi.nvue:226", "didParticipantJoined", userInfo, this.callState);
        };
        sessionCallback.didParticipantLeft = (userId) => {
          formatAppLog("log", "at pages/voip/Multi.nvue:230", "didParticipantLeft", userId, this.participantUserInfos.length);
          this.participantUserInfos = this.participantUserInfos.filter((p) => p.uid !== userId);
        };
        sessionCallback.didCallEndWithReason = (reason) => {
          formatAppLog("log", "at pages/voip/Multi.nvue:235", "callEndWithReason", reason);
          this.session = null;
        };
        sessionCallback.didVideoMuted = (userId, muted) => {
          formatAppLog("log", "at pages/voip/Multi.nvue:240", "didVideoMuted", userId, muted);
          if (userId === this.wfc.getUserId()) {
            this.selfUserInfo._isVideoMuted = muted;
          } else {
            this.participantUserInfos.forEach((u) => {
              if (u.uid === userId) {
                u._isVideoMuted = muted;
              }
            });
          }
          this.setupVideoViews();
        };
        sessionCallback.didMediaLostPacket = (media, lostPacket) => {
          if (lostPacket > 6) {
            formatAppLog("log", "at pages/voip/Multi.nvue:255", "您的网络不好");
          }
        };
        sessionCallback.didUserMediaLostPacket = (userId, media, lostPacket, uplink) => {
          if (lostPacket > 10) {
            if (uplink) {
              let userInfos = this.participantUserInfos.filter((u) => u.uid === userId);
              if (userInfos && userInfos.length > 0) {
                formatAppLog("log", "at pages/voip/Multi.nvue:266", userInfos[0].displayName, "网络不好");
              }
            } else {
              formatAppLog("log", "at pages/voip/Multi.nvue:269", "您的网络不好");
            }
          }
        };
        sessionCallback.didChangeInitiator = (initiator) => {
          this.initiatorUserInfo = this.wfc.getUserInfo(initiator);
          if (this.selfUserInfo.uid === initiator) {
            if (!this.broadcastMultiCallOngoingTimer) {
              this.broadcastMultiCallOngoingTimer = setInterval(this.broadcastMultiCallOngoing, 200);
            }
          }
        };
        getApp().avengineKit.sessionCallback = sessionCallback;
      },
      async answer() {
        if (!await checkVoipPermissions(this.session.audioOnly)) {
          formatAppLog("log", "at pages/voip/Multi.nvue:287", "no permission, hangup");
          this.hangup();
          return;
        }
        self$2.answerCall(this.session.callId, false);
      },
      hangup() {
        self$2.endCall(this.session.callId);
        this.session = null;
      },
      switchCamera() {
        if (!this.session) {
          return;
        }
        self$2.switchCamera(this.session.callId);
      },
      mute() {
        let toMute = !this.session.audioMuted;
        this.session.audioMuted = toMute;
        this.selfUserInfo._isAudioMuted = toMute;
        self$2.muteAudio(this.session.callId, toMute);
      },
      muteVideo() {
        let toMute = !this.session.videoMuted;
        this.session.videoMuted = toMute;
        this.selfUserInfo._isVideoMuted = toMute;
        this.session._selfVideoViewSet = false;
        self$2.muteVideo(this.session.callId, toMute);
      },
      down2voice() {
        this.session.downgrade2Voice(this.session.callId);
      },
      screenShare() {
      },
      invite() {
        let beforeClose = (users) => {
          let ids = users.map((u) => u.uid);
          formatAppLog("log", "at pages/voip/Multi.nvue:331", "picked users", ids);
          self$2.inviteNewParticipant(this.session.callId, ids);
        };
        let groupMemberUserInfos = getApp().store.getGroupMemberUserInfos(this.session.conversation.target, false);
        getApp().$pickUsers(
          {
            users: groupMemberUserInfos,
            initialCheckedUsers: [...this.participantUserInfos, this.selfUserInfo],
            uncheckableUsers: [...this.participantUserInfos, this.selfUserInfo],
            confirmTitle: "确定",
            successCB: beforeClose
          }
        );
      },
      userName(user) {
        let name;
        if (user.groupAlias) {
          name = user.groupAlias;
        } else if (user.friendAlias) {
          name = user.friendAlias;
        } else if (user.displayName) {
          name = user.displayName;
        } else {
          name = user.name;
        }
        return name;
      },
      setupVideoViews() {
        formatAppLog("log", "at pages/voip/Multi.nvue:360", "setupVideoViews", this.audioOnly);
        if (!this.audioOnly) {
          this.$nextTick(() => {
            let allVideoViewsReady = true;
            if (this.$refs.localVideo && !this.session._selfVideoViewSet) {
              self$2.setLocalVideoView(this.session.callId, this.$refs.localVideo.ref);
              this.session._selfVideoViewSet = true;
            } else {
              allVideoViewsReady = false;
            }
            this.participantUserInfos.forEach((u) => {
              if (!u._isVideoMuted && this.$refs["remoteVideo-" + u.uid] && this.$refs["remoteVideo-" + u.uid][0] && !u._videoViewSet) {
                self$2.setRemoteVideoView(this.session.callId, u.uid, this.$refs["remoteVideo-" + u.uid][0].ref, false);
                u._videoViewSet = true;
              } else {
                formatAppLog("log", "at pages/voip/Multi.nvue:377", `${u.uid} isVideoMuted or not connected`);
                allVideoViewsReady = false;
              }
            });
            if (allVideoViewsReady) {
              if (this.setupVideoViewsTimer) {
                clearTimeout(this.setupVideoViewsTimer);
                this.setupVideoViewsTimer = 0;
              }
            } else {
              formatAppLog("log", "at pages/voip/Multi.nvue:388", "allVideoViews are not ready, setTimeout");
              clearTimeout(this.setupVideoViewsTimer);
              this.setupVideoViewsTimer = setTimeout(this.setupVideoViews, 100);
            }
          });
        }
      },
      onVoipConnected() {
        if (!this.timer) {
          if (!this.startTimestamp) {
            this.startTimestamp = (/* @__PURE__ */ new Date()).getTime();
          }
          this.timer = setInterval(() => {
            this.currentTimestamp = (/* @__PURE__ */ new Date()).getTime();
          }, 1e3);
        }
        this.setupVideoViews();
      },
      timestampFormat(timestamp) {
        timestamp = ~~(timestamp / 1e3);
        let str = "";
        let hour = ~~(timestamp / 3600);
        str = hour > 0 ? (hour < 10 ? "0" : "") + hour + ":" : "";
        let min = ~~(timestamp % 3600 / 60);
        str += (min < 10 ? "0" : "") + min + ":";
        let sec = ~~(timestamp % 60);
        str += (sec < 10 ? "0" : "") + sec;
        return str;
      },
      broadcastMultiCallOngoing() {
        if (this.callState === CallState.STATUS_CONNECTED) {
          let participants = this.participantUserInfos.map((pu) => pu.uid).filter((uid) => uid !== this.selfUserInfo.uid);
          let ongoing = new MultiCallOngoingMessageContent(this.session.callId, this.session.initiator, this.session.audioOnly, participants);
          wfc.sendConversationMessage(this.session.conversation, ongoing);
        }
      },
      minimize() {
        let granted = getApp().avengineKit.checkOverlayPermission();
        formatAppLog("log", "at pages/voip/Multi.nvue:431", "overlayPermission granted", granted);
        if (granted) {
          getApp().avengineKit.minimize(this.session.callId);
          uni.navigateBack({
            delta: 1,
            fail: (err) => {
              formatAppLog("log", "at pages/voip/Multi.nvue:437", "nav back to err", err);
            }
          });
        } else {
          uni.showToast({
            title: "需要悬浮窗权限",
            icon: "none"
          });
        }
      }
    },
    mounted() {
      let session = self$2.currentCallSession();
      formatAppLog("log", "at pages/voip/Multi.nvue:451", "voip/Multi mounted", session);
      if (!session || session.state === 0) {
        formatAppLog("log", "at pages/voip/Multi.nvue:453", "av call already hangup");
        uni.navigateBack({
          delta: 1,
          fail: (err) => {
            formatAppLog("log", "at pages/voip/Multi.nvue:457", "nav back to conversationView err", err);
          }
        });
        return;
      }
      this.session = session;
      let supportConference = self$2.startConference !== void 0;
      if (!supportConference) {
        let host = window.location.host;
        if (host.indexOf("wildfirechat.cn") === -1 && host.indexOf("localhost") === -1) {
          for (const ice of Config.ICE_SERVERS) {
            if (ice[0].indexOf("turn.wildfirechat.net") >= 0) {
              this.showWebrtcTip = true;
              setTimeout(() => {
                this.showWebrtcTip = false;
              }, 10 * 1e3);
              break;
            }
          }
        }
      }
      this.setupSessionCallback();
      if (session) {
        formatAppLog("log", "at pages/voip/Multi.nvue:483", "current session", session.state, session);
        this.session = session;
        this.callState = session.state;
      }
      let participantProfiles = self$2.getParticipantProfiles(this.session.callId);
      for (const p of participantProfiles) {
        let userInfo = this.wfc.getUserInfo(p.userId);
        userInfo._isVideoMuted = p.videoMuted;
        userInfo._isAudioMuted = p.audioMuted;
        userInfo._isAudience = p.audience;
        userInfo._state = p.state;
        this.participantUserInfos.push(userInfo);
      }
      if (this.callState === CallState.STATUS_CONNECTED) {
        this.onVoipConnected();
      }
    },
    onBackPress(event) {
      formatAppLog("log", "at pages/voip/Multi.nvue:504", "conferencePage, onBackPress", event);
      if (event.from === "navigateBack") {
        return false;
      }
      return true;
    },
    beforeUnmount() {
      if (this.broadcastMultiCallOngoingTimer) {
        clearInterval(this.broadcastMultiCallOngoingTimer);
      }
    },
    computed: {
      duration() {
        if (this.currentTimestamp <= 0) {
          return "00:00";
        }
        let escapeMillis = this.currentTimestamp - this.startTimestamp;
        return this.timestampFormat(escapeMillis);
      },
      selfUserInfo() {
        let userInfo = this.wfc.getUserInfo(this.wfc.getUserId(), false);
        return userInfo;
      },
      computedParticipantSizeStyle() {
        let width;
        let height;
        if (this.participantUserInfos.length < 4) {
          width = "375rpx";
          height = "375rpx";
        } else {
          width = "250rpx";
          height = "250rpx";
        }
        return {
          width,
          maxWidth: width,
          height,
          maxHeight: height
        };
      }
    }
  };
  function _sfc_render$g(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { style: { "flex": "1", "display": "flex", "flex-direction": "column" } }, [
      $data.session ? (vue.openBlock(), vue.createElementBlock("div", {
        key: 0,
        class: "container"
      }, [
        vue.createElementVNode("div", { class: "content-container" }, [
          vue.createCommentVNode("self"),
          vue.createElementVNode(
            "div",
            {
              class: "participant-container",
              style: vue.normalizeStyle($options.computedParticipantSizeStyle)
            },
            [
              $data.audioOnly || $data.callState !== 4 || $options.selfUserInfo._isVideoMuted ? (vue.openBlock(), vue.createElementBlock(
                "div",
                {
                  key: 0,
                  class: "participant-item",
                  style: vue.normalizeStyle($options.computedParticipantSizeStyle)
                },
                [
                  vue.createElementVNode("image", {
                    class: "avatar",
                    style: vue.normalizeStyle($options.computedParticipantSizeStyle),
                    src: $options.selfUserInfo.portrait
                  }, null, 12, ["src"]),
                  vue.createElementVNode("text", { class: "desc" }, "我")
                ],
                4
                /* STYLE */
              )) : (vue.openBlock(), vue.createElementBlock(
                "UIKit-Video-CallView",
                {
                  key: 1,
                  style: vue.normalizeStyle($options.computedParticipantSizeStyle),
                  class: "video me",
                  ref: "localVideo"
                },
                null,
                4
                /* STYLE */
              ))
            ],
            4
            /* STYLE */
          ),
          vue.createCommentVNode("participants"),
          (vue.openBlock(true), vue.createElementBlock(
            vue.Fragment,
            null,
            vue.renderList($data.participantUserInfos, (participant) => {
              return vue.openBlock(), vue.createElementBlock(
                "div",
                {
                  key: participant.uid,
                  class: "participant-container",
                  style: vue.normalizeStyle($options.computedParticipantSizeStyle)
                },
                [
                  $data.audioOnly || $data.callState !== 4 || participant._isVideoMuted || participant._state !== 4 ? (vue.openBlock(), vue.createElementBlock(
                    "div",
                    {
                      key: 0,
                      style: vue.normalizeStyle($options.computedParticipantSizeStyle),
                      class: "participant-item"
                    },
                    [
                      vue.createElementVNode("image", {
                        class: "avatar",
                        style: vue.normalizeStyle($options.computedParticipantSizeStyle),
                        src: participant.portrait,
                        alt: participant
                      }, null, 12, ["src", "alt"]),
                      vue.createElementVNode(
                        "text",
                        { class: "desc" },
                        vue.toDisplayString($options.userName(participant)),
                        1
                        /* TEXT */
                      )
                    ],
                    4
                    /* STYLE */
                  )) : (vue.openBlock(), vue.createElementBlock("UIKit-Video-CallView", {
                    key: 1,
                    class: "video",
                    style: vue.normalizeStyle($options.computedParticipantSizeStyle),
                    ref_for: true,
                    ref: "remoteVideo-" + participant.uid,
                    onClick: ($event) => $options.switchVideoType(participant.uid, participant._isScreenSharing)
                  }, null, 12, ["onClick"]))
                ],
                4
                /* STYLE */
              );
            }),
            128
            /* KEYED_FRAGMENT */
          ))
        ]),
        vue.createCommentVNode("actions"),
        vue.createCommentVNode("incoming"),
        $data.callState === 2 ? (vue.openBlock(), vue.createElementBlock("div", {
          key: 0,
          class: "action-container"
        }, [
          vue.createElementVNode("div", { class: "action" }, [
            vue.createElementVNode("image", {
              onClick: _cache[0] || (_cache[0] = (...args) => $options.answer && $options.answer(...args)),
              class: "action-img",
              src: _imports_0$1
            }),
            vue.createElementVNode("text", { class: "desc" }, "接听")
          ]),
          !$data.audioOnly ? (vue.openBlock(), vue.createElementBlock("div", {
            key: 0,
            class: "action"
          }, [
            vue.createElementVNode("image", {
              onClick: _cache[1] || (_cache[1] = (...args) => $options.down2voice && $options.down2voice(...args)),
              class: "action-img",
              src: _imports_1$1
            }),
            vue.createElementVNode("text", { class: "desc" }, "切换到语音聊天")
          ])) : vue.createCommentVNode("v-if", true),
          vue.createElementVNode("div", { class: "action" }, [
            vue.createElementVNode("image", {
              onClick: _cache[2] || (_cache[2] = (...args) => $options.hangup && $options.hangup(...args)),
              class: "action-img",
              src: _imports_2$1
            }),
            vue.createElementVNode("text", { class: "desc" }, "挂断")
          ])
        ])) : vue.createCommentVNode("v-if", true),
        vue.createCommentVNode("outgoing"),
        $data.callState === 1 || $data.callState === 3 ? (vue.openBlock(), vue.createElementBlock("div", {
          key: 1,
          class: "action-container"
        }, [
          vue.createElementVNode("div", { class: "action" }, [
            vue.createElementVNode("image", {
              onClick: _cache[3] || (_cache[3] = (...args) => $options.hangup && $options.hangup(...args)),
              class: "action-img",
              src: _imports_2$1
            }),
            vue.createElementVNode("text", { class: "desc" }, "挂断")
          ])
        ])) : vue.createCommentVNode("v-if", true),
        vue.createCommentVNode("connected"),
        $data.callState === 4 ? (vue.openBlock(), vue.createElementBlock("div", {
          key: 2,
          class: "duration-action-container"
        }, [
          vue.createElementVNode(
            "text",
            { class: "desc" },
            vue.toDisplayString($options.duration),
            1
            /* TEXT */
          ),
          vue.createElementVNode("div", { class: "actions" }, [
            vue.createElementVNode("div", { class: "action" }, [
              !$data.session.audioMuted ? (vue.openBlock(), vue.createElementBlock("image", {
                key: 0,
                onClick: _cache[4] || (_cache[4] = (...args) => $options.mute && $options.mute(...args)),
                class: "action-img",
                src: _imports_3$1
              })) : (vue.openBlock(), vue.createElementBlock("image", {
                key: 1,
                onClick: _cache[5] || (_cache[5] = (...args) => $options.mute && $options.mute(...args)),
                class: "action-img",
                src: _imports_4
              })),
              vue.createElementVNode("text", { class: "desc" }, "静音")
            ]),
            !$data.audioOnly && true ? (vue.openBlock(), vue.createElementBlock("div", {
              key: 0,
              class: "action"
            }, [
              vue.createElementVNode("image", {
                onClick: _cache[6] || (_cache[6] = (...args) => $options.switchCamera && $options.switchCamera(...args)),
                class: "action-img",
                src: "//static/image/av/av_camera.png"
              }),
              vue.createElementVNode("text", { class: "desc" }, "切换摄像头")
            ])) : vue.createCommentVNode("v-if", true),
            !$data.session.audioOnly ? (vue.openBlock(), vue.createElementBlock("div", {
              key: 1,
              class: "action"
            }, [
              !$data.session.videoMuted ? (vue.openBlock(), vue.createElementBlock("image", {
                key: 0,
                onClick: _cache[7] || (_cache[7] = (...args) => $options.muteVideo && $options.muteVideo(...args)),
                class: "action-img",
                src: _imports_2
              })) : (vue.openBlock(), vue.createElementBlock("image", {
                key: 1,
                onClick: _cache[8] || (_cache[8] = (...args) => $options.muteVideo && $options.muteVideo(...args)),
                class: "action-img",
                src: _imports_3
              })),
              vue.createElementVNode("text", { class: "desc" }, "关闭摄像头")
            ])) : vue.createCommentVNode("v-if", true),
            !$data.audioOnly && false ? (vue.openBlock(), vue.createElementBlock("div", {
              key: 2,
              class: "action"
            }, [
              vue.createElementVNode("image", {
                onClick: _cache[9] || (_cache[9] = (...args) => $options.screenShare && $options.screenShare(...args)),
                class: "action-img",
                src: _imports_7$1
              })
            ])) : vue.createCommentVNode("v-if", true),
            vue.createElementVNode("div", { class: "action" }, [
              vue.createElementVNode("image", {
                onClick: _cache[10] || (_cache[10] = (...args) => $options.hangup && $options.hangup(...args)),
                class: "action-img",
                src: _imports_2$1
              }),
              vue.createElementVNode("text", { class: "desc" }, "挂断")
            ])
          ])
        ])) : vue.createCommentVNode("v-if", true),
        vue.createElementVNode("div", { class: "voip-title-container" }, [
          vue.createElementVNode("div", { class: "title" }, [
            $data.callState === 4 ? (vue.openBlock(), vue.createElementBlock(
              "text",
              {
                key: 0,
                class: "desc"
              },
              vue.toDisplayString($options.duration),
              1
              /* TEXT */
            )) : vue.createCommentVNode("v-if", true)
          ]),
          vue.createElementVNode("image", {
            onClick: _cache[11] || (_cache[11] = (...args) => $options.minimize && $options.minimize(...args)),
            style: { "width": "30px", "height": "30px" },
            src: _imports_10
          }),
          vue.createCommentVNode("通话建立成功之后，才允许邀请新参与者"),
          $data.callState === 4 ? (vue.openBlock(), vue.createElementBlock("image", {
            key: 0,
            onClick: _cache[12] || (_cache[12] = (...args) => $options.invite && $options.invite(...args)),
            style: { "width": "30px", "height": "30px" },
            src: _imports_9$1
          })) : vue.createCommentVNode("v-if", true)
        ])
      ])) : vue.createCommentVNode("v-if", true)
    ]);
  }
  const PagesVoipMulti = /* @__PURE__ */ _export_sfc(_sfc_main$h, [["render", _sfc_render$g], ["__scopeId", "data-v-427f5f70"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/voip/Multi.nvue"]]);
  class ConferenceApi extends AppServerApi {
    constructor() {
      super();
    }
    /**
     *
     * @return {Promise<string>}
     */
    getMyPrivateConferenceId() {
      return this._post("/conference/get_my_id");
    }
    /**
     *
     * @param conferenceInfo
     * @return {Promise<string>}
     */
    createConference(conferenceInfo) {
      return this._post("/conference/create", conferenceInfo);
    }
    /**
     *
     * @param conferenceId
     * @param password
     * @return {Promise<Object>}
     */
    queryConferenceInfo(conferenceId, password) {
      let obj;
      if (password) {
        obj = { conferenceId, password };
      } else {
        obj = { conferenceId };
      }
      return this._post("/conference/info", obj);
    }
    destroyConference(conferenceId) {
      return this._post("/conference/destroy/" + conferenceId);
    }
    favConference(conferenceId) {
      return this._post("/conference/fav/" + conferenceId);
    }
    unfavConference(conferenceId) {
      return this._post("/conference/unfav/" + conferenceId);
    }
    isFavConference(conferenceId) {
      return this._post("/conference/is_fav/" + conferenceId);
    }
    getFavConferences() {
      return this._post("/conference/fav_conferences");
    }
    updateConference(conferenceInfo) {
      return this._post("/conference/put_info", conferenceInfo);
    }
    recordConference(conferenceId, record2) {
      return this._post("/conference/recording/" + conferenceId, { recording: record2 });
    }
    setConferenceFocusUserId(conferenceId, userId) {
      return this._post("/conference/focus/" + conferenceId, { userId: userId ? userId : "" });
    }
  }
  const conferenceApi = new ConferenceApi();
  class ConferenceManager {
    constructor() {
      __publicField(this, "vueInstance");
      __publicField(this, "conferenceInfo", {});
      __publicField(this, "applyingUnmuteAudioMembers", []);
      __publicField(this, "applyingUnmuteVideoMembers", []);
      __publicField(this, "isApplyingUnmuteAudio", false);
      __publicField(this, "isApplyingUnmuteVideo", false);
      __publicField(this, "handUpMembers", []);
      __publicField(this, "isHandUp", false);
      __publicField(this, "isMuteAll", false);
      __publicField(this, "allowUnmuteAudio", false);
      __publicField(this, "allowUnmuteVideo", false);
      __publicField(this, "currentFocusUser", null);
      __publicField(this, "localFocusUser", null);
      __publicField(this, "selfUserId", null);
      __publicField(this, "onReceiveMessage", (msg) => {
        formatAppLog("log", "at pages/voip/conference/conferenceManager.js:79", "conferenceManager onReceiveMessage 000", msg, this.conferenceInfo);
        if (!this.conferenceInfo) {
          return;
        }
        if (msg.messageContent.type === MessageContentType.CONFERENCE_CONTENT_TYPE_COMMAND && this.conferenceInfo.conferenceId === msg.messageContent.conferenceId) {
          let command = msg.messageContent;
          let senderName;
          switch (command.commandType) {
            case ConferenceCommandMessageContent.ConferenceCommandType.MUTE_ALL_AUDIO:
              this._reloadCurrentConferenceInfo();
              this.onMuteAll(true);
              this.allowUnmuteAudio = command.boolValue;
              break;
            case ConferenceCommandMessageContent.ConferenceCommandType.MUTE_ALL_VIDEO:
              this._reloadCurrentConferenceInfo();
              this.onMuteAll(false);
              this.allowUnmuteVideo = command.boolValue;
              break;
            case ConferenceCommandMessageContent.ConferenceCommandType.CANCEL_MUTE_ALL_AUDIO:
              this._reloadCurrentConferenceInfo();
              this.onCancelMuteAll(true, command.boolValue);
              break;
            case ConferenceCommandMessageContent.ConferenceCommandType.CANCEL_MUTE_ALL_VIDEO:
              this._reloadCurrentConferenceInfo();
              this.onCancelMuteAll(false, command.boolValue);
              break;
            case ConferenceCommandMessageContent.ConferenceCommandType.REQUEST_MUTE_AUDIO:
              if (command.targetUserId === this.selfUserId) {
                this.onRequestMute(true, command.boolValue);
              }
              break;
            case ConferenceCommandMessageContent.ConferenceCommandType.REQUEST_MUTE_VIDEO:
              if (command.targetUserId === this.selfUserId) {
                this.onRequestMute(false, command.boolValue);
              }
              break;
            case ConferenceCommandMessageContent.ConferenceCommandType.REJECT_UNMUTE_AUDIO_REQUEST:
              this.vueInstance.$notify({
                text: "主持人拒绝了你的发言请求",
                type: "info"
              });
              break;
            case ConferenceCommandMessageContent.ConferenceCommandType.REJECT_UNMUTE_VIDEO_REQUEST:
              this.vueInstance.$notify({
                text: "主持人拒绝了你的打开摄像头请求",
                type: "info"
              });
              break;
            case ConferenceCommandMessageContent.ConferenceCommandType.APPLY_UNMUTE_AUDIO:
              senderName = wfc.getUserDisplayName(msg.from);
              if (command.boolValue) {
                this.applyingUnmuteAudioMembers.filter((uid) => uid !== msg.from);
              } else {
                let index = this.applyingUnmuteAudioMembers.findIndex((uid) => uid === msg.from);
                if (index === -1) {
                  this.applyingUnmuteAudioMembers.push(msg.from);
                }
                this.vueInstance.$notify({
                  text: senderName + "请求发言",
                  type: "info"
                });
              }
              break;
            case ConferenceCommandMessageContent.ConferenceCommandType.APPLY_UNMUTE_VIDEO:
              senderName = wfc.getUserDisplayName(msg.from);
              if (command.boolValue) {
                this.applyingUnmuteVideoMembers.filter((uid) => uid !== msg.from);
              } else {
                let index = this.applyingUnmuteVideoMembers.findIndex((uid) => uid === msg.from);
                if (index === -1) {
                  this.applyingUnmuteVideoMembers.push(msg.from);
                }
                this.vueInstance.$notify({
                  text: senderName + "请求打开摄像头",
                  type: "info"
                });
              }
              break;
            case ConferenceCommandMessageContent.ConferenceCommandType.APPROVE_UNMUTE_AUDIO:
            case ConferenceCommandMessageContent.ConferenceCommandType.APPROVE_ALL_UNMUTE_AUDIO:
              if (this.isApplyingUnmuteAudio) {
                this.isApplyingUnmuteAudio = false;
                if (command.boolValue) {
                  this.conferencePage.enableAudio(true);
                  this.vueInstance.$notify({
                    text: "主持人已同意了你的发言请求",
                    type: "info"
                  });
                }
              }
              break;
            case ConferenceCommandMessageContent.ConferenceCommandType.APPROVE_UNMUTE_VIDEO:
            case ConferenceCommandMessageContent.ConferenceCommandType.APPROVE_ALL_UNMUTE_VIDEO:
              if (this.isApplyingUnmuteVideo) {
                this.isApplyingUnmuteVideo = false;
                if (command.boolValue) {
                  this.conferencePage.enableVideo(true);
                  this.vueInstance.$notify({
                    text: "主持人已同意了你的打开摄像头请求",
                    type: "info"
                  });
                }
              }
              break;
            case ConferenceCommandMessageContent.ConferenceCommandType.HANDUP:
              if (command.boolValue) {
                let index = this.handUpMembers.findIndex((uid) => uid === msg.from);
                if (index === -1) {
                  this.handUpMembers.push(msg.from);
                }
              } else {
                this.handUpMembers = this.handUpMembers.filter((uid) => uid !== msg.from);
              }
              senderName = wfc.getUserDisplayName(msg.from);
              this.vueInstance.$notify({
                text: command.boolValue ? senderName + "举手" : senderName + "放下举手",
                type: "info"
              });
              break;
            case ConferenceCommandMessageContent.ConferenceCommandType.PUT_HAND_DOWN:
            case ConferenceCommandMessageContent.ConferenceCommandType.PUT_ALL_HAND_DOWN:
              if (this.isHandUp) {
                this.isHandUp = false;
                this.vueInstance.$notify({
                  text: "主持人放下了你的举手",
                  type: "info"
                });
              }
              break;
            case ConferenceCommandMessageContent.ConferenceCommandType.RECORDING:
              this.conferenceInfo.recording = command.boolValue;
              this.vueInstance.$notify({
                text: command.boolValue ? "主持人开始录制" : "主持人结束录制",
                type: "info"
              });
              break;
            case ConferenceCommandMessageContent.ConferenceCommandType.FOCUS:
              this.conferenceInfo.focus = command.targetUserId;
              this.vueInstance.$notify({
                text: "主持人锁定焦点用户",
                type: "info"
              });
              break;
            case ConferenceCommandMessageContent.ConferenceCommandType.CANCEL_FOCUS:
              this.conferenceInfo.focus = null;
              this.vueInstance.$notify({
                text: "主持人取消锁定焦点用户",
                type: "info"
              });
              break;
          }
        }
      });
    }
    setup(app2, conferencePage) {
      this.vueInstance = app2;
      this.conferencePage = conferencePage;
      this.selfUserId = app2.wfc.getUserId();
      this.vueInstance.wfc.eventEmitter.on(EventType.ReceiveMessage, this.onReceiveMessage);
    }
    destroy() {
      if (!this.vueInstance) {
        return;
      }
      formatAppLog("log", "at pages/voip/conference/conferenceManager.js:45", "conferenceManager destroy");
      this.vueInstance.wfc.eventEmitter.removeListener(EventType.ReceiveMessage, this.onReceiveMessage);
      if (this.conferenceInfo) {
        this.vueInstance.wfc.quitChatroom(this.conferenceInfo.conferenceId);
      }
      this.conferencePage = null;
      this.vueInstance = null;
      this.conferenceInfo = null;
      this.applyingUnmuteAudioMembers = [];
      this.applyingUnmuteVideoMembers = [];
    }
    setConferenceInfo(conferenceInfo) {
      this.conferenceInfo = conferenceInfo;
      this.vueInstance.wfc.joinChatroom(this.conferenceInfo.conferenceId, () => {
        formatAppLog("log", "at pages/voip/conference/conferenceManager.js:60", "join conference chatroom success");
      }, (err) => {
        formatAppLog("log", "at pages/voip/conference/conferenceManager.js:62", "join conference chatroom error", err);
      });
    }
    getConferenceInfo(conferenceId) {
      conferenceApi.queryConferenceInfo(conferenceId, "").then((info) => {
        this.conferenceInfo = info;
      }).catch((err) => {
        formatAppLog("log", "at pages/voip/conference/conferenceManager.js:73", err);
      });
    }
    /**
     * 申请解除打开麦克风或摄摄像头
     * @param {boolean} audio true，麦克风；false，摄像头
     * @param isCancel true，取消之前的申请；false，发起申请
     */
    applyUnmute(audio, isCancel) {
      if (audio) {
        this.isApplyingUnmuteAudio = !isCancel;
      } else {
        this.isApplyingUnmuteVideo = !isCancel;
      }
      let type = audio ? ConferenceCommandMessageContent.ConferenceCommandType.APPLY_UNMUTE_AUDIO : ConferenceCommandMessageContent.ConferenceCommandType.APPLY_UNMUTE_VIDEO;
      this._sendCommandMessage(type, null, isCancel);
    }
    /**
     * 批准用户打开麦克风/摄像头请求
     * @param {string} userId 用户 id
     * @param {boolean} audio true，麦克风；false，摄像头
     * @param {boolean} isAllow 是否批准
     */
    approveUnmute(userId, audio, isAllow) {
      if (!this.isOwner()) {
        return;
      }
      if (audio) {
        this.applyingUnmuteAudioMembers = this.applyingUnmuteAudioMembers.filter((uid) => uid !== userId);
      } else {
        this.applyingUnmuteVideoMembers = this.applyingUnmuteVideoMembers.filter((uid) => uid !== userId);
      }
      let type = audio ? ConferenceCommandMessageContent.ConferenceCommandType.APPROVE_UNMUTE_AUDIO : ConferenceCommandMessageContent.ConferenceCommandType.APPROVE_UNMUTE_VIDEO;
      this._sendCommandMessage(type, userId, isAllow);
    }
    /**
     * 批准所有打开麦克风/摄像头请求
     * @param {boolean} audio true，麦克风；false，摄像头
     * @param {boolean} isAllow 是否批准
     */
    approveAllUnmute(audio, isAllow) {
      if (!this.isOwner()) {
        return;
      }
      if (audio) {
        this.applyingUnmuteAudioMembers.length = 0;
      } else {
        this.applyingUnmuteVideoMembers.length = 0;
      }
      let type = audio ? ConferenceCommandMessageContent.ConferenceCommandType.APPROVE_ALL_UNMUTE_AUDIO : ConferenceCommandMessageContent.ConferenceCommandType.APPROVE_ALL_UNMUTE_VIDEO;
      this._sendCommandMessage(type, null, isAllow);
    }
    /**
     * 主持人邀请打开/关闭麦克风或摄像
     * @param {string} userId
     * @param {boolean} audio true，麦克风；false，摄像头
     * @param {boolean} mute true，打开；false，关闭
     */
    requestMemberMute(userId, audio, mute) {
      if (!this.isOwner()) {
        return;
      }
      let type = audio ? ConferenceCommandMessageContent.ConferenceCommandType.REQUEST_MUTE_AUDIO : ConferenceCommandMessageContent.ConferenceCommandType.REQUEST_MUTE_VIDEO;
      this._sendCommandMessage(type, userId, mute);
    }
    /**
     * 主持人关闭所有人的麦克风或摄像头
     * @param {boolean} audio true 麦克风， false 摄像头
     * @param {boolean} allowMemberUnmute 允许成员主动开启麦克风或摄像头
     */
    requestMuteAll(audio, allowMemberUnmute) {
      if (!this.isOwner()) {
        return;
      }
      this.isMuteAll = true;
      this.conferenceInfo.audience = true;
      this.conferenceInfo.allowSwitchMode = allowMemberUnmute;
      conferenceApi.updateConference(this.conferenceInfo).then((r) => {
        let type = audio ? ConferenceCommandMessageContent.ConferenceCommandType.MUTE_ALL_AUDIO : ConferenceCommandMessageContent.ConferenceCommandType.MUTE_ALL_VIDEO;
        this._sendCommandMessage(type, null, allowMemberUnmute);
      }).catch((err) => {
        formatAppLog("log", "at pages/voip/conference/conferenceManager.js:320", "updateConference error", err);
      });
    }
    /**
     * 主持人取消所有人关闭麦克风或摄像头
     * @param {boolean} audio true 麦克风， false 摄像头
     * @param {boolean} unmute 是否提示成员打开麦克风或摄像头
     */
    requestUnmuteAll(audio, unmute) {
      if (!this.isOwner()) {
        return;
      }
      this.isMuteAll = false;
      this.conferenceInfo.audience = false;
      this.conferenceInfo.allowSwitchMode = true;
      conferenceApi.updateConference(this.conferenceInfo).then((r) => {
        let type = audio ? ConferenceCommandMessageContent.ConferenceCommandType.CANCEL_MUTE_ALL_AUDIO : ConferenceCommandMessageContent.ConferenceCommandType.CANCEL_MUTE_ALL_VIDEO;
        this._sendCommandMessage(type, null, unmute);
      }).catch((err) => {
        formatAppLog("log", "at pages/voip/conference/conferenceManager.js:343", "updateConference error", err);
      });
    }
    /**
     * 举手
     * @param {boolean} isHandUp
     */
    handUp(isHandUp) {
      this.isHandUp = isHandUp;
      this._sendCommandMessage(ConferenceCommandMessageContent.ConferenceCommandType.HANDUP, null, isHandUp);
      this.vueInstance.$notify({
        text: isHandUp ? "已举手，等待管理员处理" : "已放下举手",
        type: "info"
      });
    }
    /**
     * 主持人放下成员举手
     * @param {string} memberId
     */
    putMemberHandDown(memberId) {
      if (!this.isOwner()) {
        return;
      }
      this.handUpMembers = this.handUpMembers.filter((uid) => uid !== memberId);
      this._sendCommandMessage(ConferenceCommandMessageContent.ConferenceCommandType.PUT_HAND_DOWN, memberId, false);
    }
    /**
     * 主持人放下所有人举手
     */
    putAllHandDown() {
      if (!this.isOwner()) {
        return;
      }
      this.handUpMembers.length = 0;
      this._sendCommandMessage(ConferenceCommandMessageContent.ConferenceCommandType.PUT_ALL_HAND_DOWN, null, false);
    }
    requestRecord(record2) {
      if (!this.isOwner()) {
        return;
      }
      conferenceApi.recordConference(this.conferenceInfo.conferenceId, record2).then((r) => {
        this.conferenceInfo.isRecording = record2;
      }).catch((err) => {
        formatAppLog("log", "at pages/voip/conference/conferenceManager.js:392", "recordConference error", err);
      });
    }
    /**
     * 主持人设置焦点用户
     * @param {string} userId
     */
    requestFocus(userId) {
      if (!this.isOwner()) {
        return;
      }
      conferenceApi.setConferenceFocusUserId(this.conferenceInfo.conferenceId, userId).then((r) => {
        this.conferenceInfo.focus = userId;
      }).catch((err) => {
        formatAppLog("log", "at pages/voip/conference/conferenceManager.js:409", "requestFocus err", err);
      });
    }
    requestCancelFocus() {
      this.requestFocus(null);
    }
    /**
     * 主任任请求全员静音
     */
    onMuteAll(audio) {
      let desc;
      if (audio) {
        desc = "管理员将全体成员静音了";
        this.conferencePage.enableAudio(false);
      } else {
        desc = "管理员关闭了所有人的摄像头";
        this.conferencePage.enableVideo(false);
      }
      this.vueInstance.$notify({
        text: desc,
        type: "info"
      });
    }
    /**
     * 主持人取消全员静音
     * @param audio
     * @param requestUnmute
     */
    onCancelMuteAll(audio, requestUnmute) {
      if (requestUnmute && this.vueInstance.selfUserInfo._isAudience) {
        this.conferencePage.alert({
          showIcon: false,
          title: audio ? "主持人关闭了全员静音，是否要打开麦克风" : "管理员取消了全体成员关闭摄像头，是否打开摄像头",
          content: audio ? "主持人关闭了全员静音，是否要打开麦克风" : "管理员取消了全体成员关闭摄像头，是否打开摄像头",
          confirmText: "打开",
          onClose: () => {
          },
          onConfirm: () => {
            if (audio) {
              this.conferencePage.enableAudio(true);
            } else {
              this.conferencePage.enableVideo(true);
            }
          }
        });
      }
      let desc = audio ? "管理员取消了全体成员静音" : "管理员取消了全体成员关闭摄像";
      this.vueInstance.$notify({
        text: desc,
        type: "info"
      });
    }
    /**
     * 主持人请求 mute 操作
     * @param audio
     * @param mute
     */
    onRequestMute(audio, mute) {
      if (!mute) {
        this.conferencePage.alert({
          showIcon: false,
          title: audio ? "主持人邀请你发言" : "主持人邀请你打开摄像头",
          content: audio ? "主持人邀请你发言" : "主持人邀请你打开摄像头",
          confirmText: "接受",
          onClose: () => {
          },
          onConfirm: () => {
            if (audio) {
              this.conferencePage.enableAudio(true);
            } else {
              this.conferencePage.enableVideo(true);
            }
          }
        });
      } else {
        if (audio) {
          this.conferencePage.enableAudio(false);
        } else {
          this.conferencePage.enableVideo(false);
        }
        this.vueInstance.$notify({
          text: audio ? "管理员关闭了你的发言" : "管理员关闭了你的摄像头",
          type: "info"
        });
      }
    }
    addHistory(conferenceInfo, durationMS) {
      formatAppLog("log", "at pages/voip/conference/conferenceManager.js:505", "addHistory", conferenceInfo, durationMS);
      let tmp = getItem("historyConfList");
      let historyList = [];
      if (tmp) {
        historyList = JSON.parse(tmp);
      }
      conferenceInfo.endTime = Math.ceil(conferenceInfo.startTime + durationMS / 1e3);
      let index = historyList.findIndex((info) => info.conferenceId === conferenceInfo.conferenceId);
      if (index >= 0) {
        historyList[index] = conferenceInfo;
      } else {
        historyList.push(conferenceInfo);
        if (historyList.length > 10) {
          historyList = historyList.shift();
        }
      }
      setItem("historyConfList", JSON.stringify(historyList, null, ""));
    }
    getHistoryConference() {
      let tmp = getItem("historyConfList");
      let historyList = [];
      if (tmp) {
        historyList = JSON.parse(tmp);
      }
      return historyList;
    }
    _fixLongSerializedIssue(msg) {
      if (typeof msg !== "string") {
        return msg;
      }
      msg = JSON.parse(msg);
      if (typeof msg === "string") {
        msg = JSON.parse(msg);
      }
      return msg;
    }
    _reloadCurrentConferenceInfo() {
      conferenceApi.queryConferenceInfo(this.conferenceInfo.conferenceId, this.conferenceInfo.password).then((info) => {
        this.conferenceInfo = info;
      }).catch((err) => {
        formatAppLog("log", "at pages/voip/conference/conferenceManager.js:550", err);
      });
    }
    isOwner() {
      return this.conferenceInfo.owner === this.selfUserId;
    }
    _sendCommandMessage(commandType, targetUser, boolValue) {
      let content = new ConferenceCommandMessageContent(this.conferenceInfo.conferenceId, commandType, targetUser, boolValue);
      let conversation2 = new Conversation(ConversationType.ChatRoom, this.conferenceInfo.conferenceId, 0);
      wfc.sendConversationMessage(conversation2, content);
    }
  }
  let self$1 = new ConferenceManager();
  const _sfc_main$g = {
    name: "ConferencePortalPage",
    data() {
      return {
        favConferenceInfos: [],
        historyConferenceInfos: []
      };
    },
    mounted() {
    },
    onShow() {
      this.loadFavConferences();
      this.historyConferenceInfos = self$1.getHistoryConference();
    },
    methods: {
      loadFavConferences() {
        conferenceApi.getFavConferences().then((favConferenceInfos) => {
          this.favConferenceInfos = favConferenceInfos;
        }).catch((err) => {
          formatAppLog("log", "at pages/voip/conference/ConferencePortalPage.vue:98", "getFavConferences error", err);
        });
      },
      joinConference() {
        this.$navigateToPage("/pages/voip/conference/JoinConferencePage");
      },
      createConference() {
        this.$navigateToPage("/pages/voip/conference/CreateConferencePage");
      },
      orderConference() {
        this.$navigateToPage("/pages/voip/conference/OrderConferencePage");
      },
      showConferenceInfo(info) {
        this.$navigateToPage("/pages/voip/conference/ConferenceInfoPage", {
          conferenceInfo: info
        });
      },
      favConferenceDesc(conferenceInfo) {
        let start = new Date(conferenceInfo.startTime * 1e3).getTime();
        let end = new Date(conferenceInfo.endTime * 1e3).getTime();
        let now2 = (/* @__PURE__ */ new Date()).getTime();
        if (now2 < start) {
          return "会议尚未开始";
        } else if (start < end) {
          return "会议已开始，请尽快加入";
        } else {
          return "会议已结束";
        }
      },
      historyConferenceDesc(conferenceInfo) {
        let duration = this.formatDuration(conferenceInfo.endTime - conferenceInfo.startTime);
        let ownerDisplayName = wfc.getUserDisplayName(conferenceInfo.owner);
        let date = new Date(conferenceInfo.startTime * 1e3).toLocaleDateString();
        return `时间：${date} 发起人：${ownerDisplayName} 时长：${duration}`;
      },
      formatDuration(second) {
        let desc = "";
        if (second > 60 * 60) {
          desc = Math.floor(second / 60 / 60) + "H";
        }
        if (second > 60) {
          desc += Math.floor(second % (60 * 60) / 60) + "M";
        }
        desc += second % 60 + "S";
        return desc;
      }
    }
  };
  function _sfc_render$f(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "conference-portal-container" }, [
      vue.createElementVNode("div", { class: "left-slider" }, [
        vue.createElementVNode("div", { class: "action-container" }, [
          vue.createElementVNode("div", {
            class: "action",
            style: { "background": "#e1e9ff" },
            onClick: _cache[0] || (_cache[0] = (...args) => $options.joinConference && $options.joinConference(...args))
          }, [
            vue.createCommentVNode('                    <img :src="require(`@/assets/images/av_join_conference.png`)" alt="">'),
            vue.createElementVNode("div", { class: "icon" }, [
              vue.createElementVNode("i", {
                class: "icon-ion-android-add",
                style: { "color": "#3570fe" }
              })
            ]),
            vue.createElementVNode("p", { class: "title" }, "加入会议")
          ]),
          vue.createElementVNode("div", {
            class: "action",
            style: { "background": "#d9f3fe" },
            onClick: _cache[1] || (_cache[1] = (...args) => $options.createConference && $options.createConference(...args))
          }, [
            vue.createElementVNode("div", { class: "icon" }, [
              vue.createElementVNode("i", {
                class: "icon-ion-ios-videocam",
                style: { "color": "#3570fe" }
              })
            ]),
            vue.createCommentVNode('                    <img :src="require(`@/assets/images/av_start_conference.png`)" alt="">'),
            vue.createElementVNode("p", { class: "title" }, "发起会议")
          ]),
          vue.createElementVNode("div", {
            class: "action",
            style: { "background": "#fee9d3" },
            onClick: _cache[2] || (_cache[2] = (...args) => $options.orderConference && $options.orderConference(...args))
          }, [
            vue.createElementVNode("div", { class: "icon" }, [
              vue.createElementVNode("i", {
                class: "icon-ion-android-calendar",
                style: { "color": "#ff8700" }
              })
            ]),
            vue.createCommentVNode('                    <img :src="require(`@/assets/images/av_book_conference.png`)" alt="">'),
            vue.createElementVNode("p", { class: "title" }, "预定会议")
          ])
        ])
      ]),
      vue.createElementVNode("div", { class: "right-slider" }, [
        vue.createElementVNode("div", { class: "fav-container" }, [
          vue.createElementVNode("p", null, "即将开始"),
          $data.favConferenceInfos.length > 0 ? (vue.openBlock(), vue.createElementBlock("div", {
            key: 0,
            class: "fav-list"
          }, [
            (vue.openBlock(true), vue.createElementBlock(
              vue.Fragment,
              null,
              vue.renderList($data.favConferenceInfos, (conferenceInfo, index) => {
                return vue.openBlock(), vue.createElementBlock("div", {
                  class: "fav-conference",
                  onClick: ($event) => $options.showConferenceInfo(conferenceInfo),
                  key: index
                }, [
                  vue.createElementVNode("div", { class: "icon" }, [
                    vue.createElementVNode("i", {
                      class: "icon-ion-ios-videocam",
                      style: { "color": "#5d7ce8" }
                    })
                  ]),
                  vue.createElementVNode("div", null, [
                    vue.createElementVNode(
                      "p",
                      { class: "title single-line" },
                      vue.toDisplayString(conferenceInfo.conferenceTitle),
                      1
                      /* TEXT */
                    ),
                    vue.createElementVNode(
                      "p",
                      { class: "desc" },
                      vue.toDisplayString($options.favConferenceDesc(conferenceInfo)),
                      1
                      /* TEXT */
                    )
                  ])
                ], 8, ["onClick"]);
              }),
              128
              /* KEYED_FRAGMENT */
            ))
          ])) : (vue.openBlock(), vue.createElementBlock("div", {
            key: 1,
            class: "empty"
          }, " 没有即将开始的会议 "))
        ]),
        vue.createElementVNode("div", { class: "history-container" }, [
          vue.createElementVNode("p", null, "历史记录"),
          $data.historyConferenceInfos.length > 0 ? (vue.openBlock(), vue.createElementBlock("div", {
            key: 0,
            class: "fav-list"
          }, [
            (vue.openBlock(true), vue.createElementBlock(
              vue.Fragment,
              null,
              vue.renderList($data.historyConferenceInfos, (conferenceInfo, index) => {
                return vue.openBlock(), vue.createElementBlock("div", {
                  class: "fav-conference",
                  onClick: ($event) => $options.showConferenceInfo(conferenceInfo),
                  key: index
                }, [
                  vue.createElementVNode("div", { class: "icon" }, [
                    vue.createElementVNode("i", {
                      class: "icon-ion-ios-videocam",
                      style: { "color": "#5d7ce8" }
                    })
                  ]),
                  vue.createElementVNode("div", null, [
                    vue.createElementVNode(
                      "p",
                      { class: "title single-line" },
                      vue.toDisplayString(conferenceInfo.conferenceTitle),
                      1
                      /* TEXT */
                    ),
                    vue.createElementVNode(
                      "p",
                      { class: "desc" },
                      vue.toDisplayString($options.historyConferenceDesc(conferenceInfo)),
                      1
                      /* TEXT */
                    )
                  ])
                ], 8, ["onClick"]);
              }),
              128
              /* KEYED_FRAGMENT */
            ))
          ])) : (vue.openBlock(), vue.createElementBlock("div", {
            key: 1,
            class: "empty"
          }, " 没有即将开始的会议 "))
        ])
      ])
    ]);
  }
  const PagesVoipConferenceConferencePortalPage = /* @__PURE__ */ _export_sfc(_sfc_main$g, [["render", _sfc_render$f], ["__scopeId", "data-v-f31c2444"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/voip/conference/ConferencePortalPage.vue"]]);
  const _sfc_main$f = {
    name: "ConferenceInfoPage",
    data() {
      return {
        conferenceInfo: {},
        enableVideo: false,
        enableAudio: false,
        ownerName: ""
      };
    },
    onLoad(option) {
      formatAppLog("log", "at pages/voip/conference/ConferenceInfoPage.vue:81", "voip/conference/ConferenceInfoPage onLoad");
      const eventChannel = this.getOpenerEventChannel();
      eventChannel.on("options", (options) => {
        formatAppLog("log", "at pages/voip/conference/ConferenceInfoPage.vue:90", "options", options);
        let conferenceId = options.conferenceId;
        let password = options.password;
        if (options.conferenceInfo) {
          this.conferenceInfo = options.conferenceInfo;
        } else {
          this.getConferenceInfo(conferenceId, password);
        }
      });
    },
    mounted() {
      formatAppLog("log", "at pages/voip/conference/ConferenceInfoPage.vue:101", "conferenceInfo", this.conferenceInfo);
      this.ownerName = wfc.getUserDisplayName(this.conferenceInfo.owner);
    },
    methods: {
      getConferenceInfo(conferenceId, password) {
        conferenceApi.queryConferenceInfo(conferenceId, password).then((info) => {
          this.conferenceInfo = info;
          formatAppLog("log", "at pages/voip/conference/ConferenceInfoPage.vue:110", "conferenceInfo", info);
        }).catch((reason) => {
          formatAppLog("error", "at pages/voip/conference/ConferenceInfoPage.vue:113", "queryConferenceInfo error", reason);
          uni.navigateBack({
            delta: 1,
            fail: (err) => {
              formatAppLog("log", "at pages/voip/conference/ConferenceInfoPage.vue:117", "nav back from ConferenceInfoPage err", err);
            }
          });
        });
      },
      favConference() {
        conferenceApi.favConference(this.conferenceInfo.conferenceId).then((r) => {
          this.$refs.favButton.title = "已收藏";
          this.$refs.favButton.disabled = true;
        }).catch((err) => {
          formatAppLog("error", "at pages/voip/conference/ConferenceInfoPage.vue:130", "favConference error", err);
        });
      },
      async joinConference() {
        if (!await checkVoipPermissions()) {
          return;
        }
        let info = this.conferenceInfo;
        formatAppLog("log", "at pages/voip/conference/ConferenceInfoPage.vue:139", "joinConference", info, this.enableAudio, this.enableVideo);
        uni.redirectTo({
          url: `/pages/voip/conference/ConferencePage?conferenceInfo=${JSON.stringify(this.conferenceInfo)}&muteAudio=${!this.enableAudio}&muteVideo=${!this.enableVideo}`,
          success: (res) => {
          },
          fail: (e) => {
            formatAppLog("log", "at pages/voip/conference/ConferenceInfoPage.vue:145", "navigate to WebViewPage error", e);
          }
        });
      }
    },
    computed: {
      startTime() {
        let date = new Date(this.conferenceInfo.startTime * 1e3);
        return date.toString();
      },
      endTime() {
        if (!this.conferenceInfo.endTime) {
          return "-";
        }
        let date = new Date(this.conferenceInfo.endTime * 1e3);
        return date.toString();
      },
      audience() {
        return !(this.conferenceInfo.owner === wfc.getUserId() || !this.conferenceInfo.audience || this.conferenceInfo.allowSwitchMode);
      },
      enableDestroy() {
        return this.conferenceInfo.owner === wfc.getUserId() && (/* @__PURE__ */ new Date()).getTime() < this.conferenceInfo.startTime * 1e3;
      }
    }
  };
  function _sfc_render$e(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "conference-info-container" }, [
      vue.createElementVNode("div", { class: "item-container" }, [
        vue.createElementVNode("div", { class: "item" }, [
          vue.createElementVNode("p", { class: "title" }, "会议主题"),
          vue.createElementVNode(
            "p",
            { class: "desc" },
            vue.toDisplayString($data.conferenceInfo.conferenceTitle),
            1
            /* TEXT */
          )
        ]),
        vue.createElementVNode("div", { class: "item" }, [
          vue.createElementVNode("p", { class: "title" }, "发起人"),
          vue.createElementVNode(
            "p",
            { class: "desc" },
            vue.toDisplayString($data.ownerName),
            1
            /* TEXT */
          )
        ]),
        vue.createElementVNode("div", { class: "item" }, [
          vue.createElementVNode("p", { class: "title" }, "会议号"),
          vue.createElementVNode(
            "p",
            { class: "desc" },
            vue.toDisplayString($data.conferenceInfo.conferenceId),
            1
            /* TEXT */
          )
        ]),
        vue.createElementVNode("div", { class: "item" }, [
          vue.createElementVNode("p", { class: "title" }, "二维码"),
          vue.createElementVNode("i", null, ">")
        ])
      ]),
      vue.createElementVNode("div", { class: "item-container" }, [
        vue.createElementVNode("div", { class: "item" }, [
          vue.createElementVNode("p", { class: "title" }, "开始时间"),
          vue.createElementVNode(
            "p",
            { class: "desc" },
            vue.toDisplayString($options.startTime),
            1
            /* TEXT */
          )
        ]),
        vue.createElementVNode("div", { class: "item" }, [
          vue.createElementVNode("p", { class: "title" }, "结束时间"),
          vue.createElementVNode(
            "p",
            { class: "desc" },
            vue.toDisplayString($options.endTime),
            1
            /* TEXT */
          )
        ])
      ]),
      vue.createElementVNode("div", { class: "item-container" }, [
        vue.createElementVNode(
          "checkbox-group",
          {
            class: "item",
            onChange: _cache[0] || (_cache[0] = ($event) => $data.enableVideo = !$data.enableVideo)
          },
          [
            vue.createElementVNode("label", null, " 开启视频 "),
            vue.createElementVNode("checkbox", {
              disabled: $options.audience,
              checked: $data.enableVideo
            }, null, 8, ["disabled", "checked"])
          ],
          32
          /* NEED_HYDRATION */
        ),
        vue.createCommentVNode("            不知道为啥，下面的 class 没生效"),
        vue.createElementVNode(
          "checkbox-group",
          {
            class: "item",
            onChange: _cache[1] || (_cache[1] = ($event) => $data.enableAudio = !$data.enableAudio),
            style: { "display": "flex", "flex-direction": "row", "justify-content": "space-between", "padding": "12px 20px", "border-spacing": "20px" }
          },
          [
            vue.createElementVNode("label", null, " 开启音频 "),
            vue.createElementVNode("checkbox", {
              disabled: $options.audience,
              checked: $data.enableAudio
            }, null, 8, ["disabled", "checked"])
          ],
          32
          /* NEED_HYDRATION */
        )
      ]),
      vue.createElementVNode("div", { class: "action-container" }, [
        $options.enableDestroy ? (vue.openBlock(), vue.createElementBlock("button", {
          key: 0,
          class: "destroy"
        }, " 销毁会议 ")) : vue.createCommentVNode("v-if", true),
        (/* @__PURE__ */ new Date()).getTime() < $data.conferenceInfo.startTime * 1e3 ? (vue.openBlock(), vue.createElementBlock(
          "button",
          {
            key: 1,
            ref: "favButton",
            onClick: _cache[2] || (_cache[2] = (...args) => $options.favConference && $options.favConference(...args))
          },
          " 尚未开始，收藏会议 ",
          512
          /* NEED_PATCH */
        )) : (/* @__PURE__ */ new Date()).getTime() < $data.conferenceInfo.endTime * 1e3 ? (vue.openBlock(), vue.createElementBlock("button", {
          key: 2,
          onClick: _cache[3] || (_cache[3] = (...args) => $options.joinConference && $options.joinConference(...args))
        }, " 加入会议 ")) : (vue.openBlock(), vue.createElementBlock("button", {
          key: 3,
          disabled: true
        }, " 会议已结束 "))
      ])
    ]);
  }
  const PagesVoipConferenceConferenceInfoPage = /* @__PURE__ */ _export_sfc(_sfc_main$f, [["render", _sfc_render$e], ["__scopeId", "data-v-c4e15b0b"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/voip/conference/ConferenceInfoPage.vue"]]);
  const _sfc_main$e = {
    name: "JoinConferenceView",
    data() {
      return {
        conferenceId: "",
        password: ""
      };
    },
    methods: {
      joinConference() {
        conferenceApi.queryConferenceInfo(this.conferenceId, this.password).then((info) => {
          formatAppLog("log", "at pages/voip/conference/JoinConferencePage.vue:40", "conferenceInfo", info);
          this.$modal.show(
            PagesVoipConferenceConferenceInfoPage,
            {
              conferenceInfo: info
            },
            {
              name: "conference-info-modal",
              width: 320,
              height: 580,
              clickToClose: true
            },
            {}
          );
          this.$modal.hide("join-conference-modal");
        }).catch((reason) => {
          formatAppLog("log", "at pages/voip/conference/JoinConferencePage.vue:54", "queryConferenceInfo failed", reason);
          this.$modal.hide("join-conference-modal");
          this.$notify({
            text: "获取会议信息失败",
            type: "warn"
          });
        });
      },
      cancel() {
        this.$modal.hide("join-conference-modal");
      }
    },
    watch: {
      advance() {
        if (this.advance) {
          this.audience = false;
        }
      }
    }
  };
  function _sfc_render$d(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "join-conference-container" }, [
      vue.createElementVNode("h2", null, "加入会议"),
      vue.createElementVNode("div", { class: "conf-item" }, [
        vue.createElementVNode("p", null, "会议号"),
        vue.withDirectives(vue.createElementVNode(
          "input",
          {
            class: "conf-item input",
            "onUpdate:modelValue": _cache[0] || (_cache[0] = ($event) => $data.conferenceId = $event),
            type: "text",
            placeholder: "请输入会议号"
          },
          null,
          512
          /* NEED_PATCH */
        ), [
          [vue.vModelText, $data.conferenceId]
        ])
      ]),
      vue.createElementVNode("div", { class: "conf-item" }, [
        vue.createElementVNode("p", null, "会议密码"),
        vue.withDirectives(vue.createElementVNode(
          "input",
          {
            class: "conf-item input",
            "onUpdate:modelValue": _cache[1] || (_cache[1] = ($event) => $data.password = $event),
            type: "text",
            placeholder: "请输入会议密码，如果没有，忽略"
          },
          null,
          512
          /* NEED_PATCH */
        ), [
          [vue.vModelText, $data.password]
        ])
      ]),
      vue.createElementVNode("div", { class: "action-container" }, [
        vue.createElementVNode("button", {
          class: "join",
          disabled: $data.conferenceId.trim() === "",
          onClick: _cache[2] || (_cache[2] = (...args) => $options.joinConference && $options.joinConference(...args))
        }, " 加入会议 ", 8, ["disabled"]),
        vue.createElementVNode("button", {
          onClick: _cache[3] || (_cache[3] = (...args) => $options.cancel && $options.cancel(...args))
        }, " 取消 ")
      ])
    ]);
  }
  const PagesVoipConferenceJoinConferencePage = /* @__PURE__ */ _export_sfc(_sfc_main$e, [["render", _sfc_render$d], ["__scopeId", "data-v-0ad9b4db"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/voip/conference/JoinConferencePage.vue"]]);
  class ConferenceInfo {
    constructor() {
      __publicField(this, "conferenceId");
      __publicField(this, "conferenceTitle");
      __publicField(this, "password");
      __publicField(this, "pin");
      __publicField(this, "owner");
      __publicField(this, "managers", []);
      __publicField(this, "focus");
      // 秒
      __publicField(this, "startTime");
      __publicField(this, "endTime");
      __publicField(this, "audience");
      __publicField(this, "advance");
      //@SerializedName("allowSwitchMode")
      __publicField(this, "allowSwitchMode");
      // 其实更新allowTurnOnMic;
      __publicField(this, "noJoinBeforeStart", false);
      __publicField(this, "recording", false);
    }
    isAllowTurnOnMic() {
      return this.allowSwitchMode;
    }
  }
  const _sfc_main$d = {
    name: "CreateConferenceView",
    data() {
      return {
        title: "",
        desc: "",
        endTime: new Date((/* @__PURE__ */ new Date()).getTime() - (/* @__PURE__ */ new Date()).getTimezoneOffset() * 6e4 + 1 * 60 * 60 * 1e3).toISOString().split(".")[0],
        notAudience: true,
        advance: false,
        allowTurnOnMic: true,
        enablePassword: false,
        password: "",
        test: []
      };
    },
    methods: {
      async _createConference() {
        let info = new ConferenceInfo();
        info.conferenceTitle = this.title;
        if (this.password) {
          info.password = this.password;
        }
        info.pin = "" + Math.ceil((1 + Math.random() * 1e5) / 10);
        info.owner = wfc.getUserId();
        info.startTime = Math.ceil((/* @__PURE__ */ new Date()).getTime() / 1e3);
        info.endTime = Math.ceil(new Date(this.endTime).getTime() / 1e3);
        info.audience = !this.notAudience;
        info.allowSwitchMode = this.allowTurnOnMic;
        info.advance = this.advance;
        info.conferenceId = await conferenceApi.createConference(info);
        return info;
      },
      createConference() {
        this._createConference().then((infoo) => {
          uni.showToast({
            title: "创建会议成功",
            icon: "none"
          });
          uni.navigateBack();
        }).catch((err) => {
          uni.showToast({
            title: "创建会议失败",
            icon: "none"
          });
        });
      },
      async createAndJoinConference() {
        if (!await checkVoipPermissions()) {
          return;
        }
        this._createConference().then((info) => {
          formatAppLog("log", "at pages/voip/conference/CreateConferencePage.vue:115", "joinConference", info);
          let url = `/pages/voip/conference/ConferencePage?conferenceInfo=${JSON.stringify(info)}&muteAudio=false&muteVideo=false`;
          this.$navigateToPage(url);
        }).catch((err) => {
          uni.showToast({
            title: "创建会议失败",
            icon: "none"
          });
        });
      }
    },
    computed: {
      actionEnable() {
        let now2 = (/* @__PURE__ */ new Date()).getTime();
        return this.title && this.title.trim() && this.endTime && new Date(this.endTime).getTime() > now2;
      }
    },
    watch: {
      advance() {
        if (this.advance) {
          this.notAudience = false;
        }
      },
      endTime() {
        if (this.endTime) {
          if (new Date(this.endTime).getTime() < (/* @__PURE__ */ new Date()).getTime()) {
            this.endTime = "";
            uni.showToast({
              title: "结束时间不能小于当前时间",
              icon: "none"
            });
          }
        }
      }
    }
  };
  function _sfc_render$c(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "order-conference-container" }, [
      vue.withDirectives(vue.createElementVNode(
        "input",
        {
          "onUpdate:modelValue": _cache[0] || (_cache[0] = ($event) => $data.title = $event),
          class: "text-input",
          placeholder: "会议标题"
        },
        null,
        512
        /* NEED_PATCH */
      ), [
        [vue.vModelText, $data.title]
      ]),
      vue.createCommentVNode("v-if", true),
      vue.createElementVNode("label", null, [
        vue.createTextVNode(" 开始时间 "),
        vue.createElementVNode("span", null, "现在")
      ]),
      vue.createElementVNode("label", null, [
        vue.createTextVNode(" 结束时间 "),
        vue.withDirectives(vue.createElementVNode("input", {
          "onUpdate:modelValue": _cache[2] || (_cache[2] = ($event) => $data.endTime = $event),
          min: new Date((/* @__PURE__ */ new Date()).getTime() - (/* @__PURE__ */ new Date()).getTimezoneOffset() * 6e4).toISOString().split(".")[0]
        }, null, 8, ["min"]), [
          [vue.vModelText, $data.endTime]
        ])
      ]),
      vue.createCommentVNode("        uni-app 平台，checkbox 不支持 v-model，必须采用下面的方式实现"),
      vue.createElementVNode(
        "checkbox-group",
        {
          onChange: _cache[3] || (_cache[3] = ($event) => $data.notAudience = !$data.notAudience)
        },
        [
          vue.createElementVNode("label", null, [
            vue.createTextVNode(" 参与者开启摄像头、麦克风入会 "),
            vue.createElementVNode("checkbox", {
              value: "notAudience",
              checked: $data.notAudience
            }, null, 8, ["checked"])
          ])
        ],
        32
        /* NEED_HYDRATION */
      ),
      vue.createElementVNode(
        "checkbox-group",
        {
          onChange: _cache[4] || (_cache[4] = ($event) => $data.allowTurnOnMic = !$data.allowTurnOnMic)
        },
        [
          vue.createElementVNode("label", null, [
            vue.createTextVNode(" 允许参与者自主开启摄像头和麦克风 "),
            vue.createElementVNode("checkbox", {
              disabled: $data.notAudience,
              value: "allowTurnOnMic",
              checked: $data.allowTurnOnMic
            }, null, 8, ["disabled", "checked"])
          ])
        ],
        32
        /* NEED_HYDRATION */
      ),
      vue.createElementVNode("div", null, [
        vue.createElementVNode(
          "checkbox-group",
          {
            onChange: _cache[5] || (_cache[5] = ($event) => $data.enablePassword = !$data.enablePassword)
          },
          [
            vue.createElementVNode("label", null, [
              vue.createTextVNode(" 启用密码 "),
              vue.createElementVNode("checkbox", { checked: $data.enablePassword }, null, 8, ["checked"])
            ])
          ],
          32
          /* NEED_HYDRATION */
        ),
        $data.enablePassword ? vue.withDirectives((vue.openBlock(), vue.createElementBlock(
          "input",
          {
            key: 0,
            "onUpdate:modelValue": _cache[6] || (_cache[6] = ($event) => $data.password = $event),
            class: "text-input",
            style: { "margin-top": "10px" },
            maxlength: "4",
            placeholder: "123456"
          },
          null,
          512
          /* NEED_PATCH */
        )), [
          [vue.vModelText, $data.password]
        ]) : vue.createCommentVNode("v-if", true)
      ]),
      vue.createElementVNode("div", null, [
        vue.createElementVNode(
          "checkbox-group",
          {
            onChange: _cache[7] || (_cache[7] = ($event) => $data.advance = !$data.advance)
          },
          [
            vue.createElementVNode("label", null, [
              vue.createTextVNode(" 大规模会议 "),
              vue.createElementVNode("checkbox", { value: "advance" })
            ])
          ],
          32
          /* NEED_HYDRATION */
        ),
        vue.createElementVNode("p", { class: "advance_desc" }, "参会人数大于50人")
      ]),
      vue.createElementVNode("div", { class: "action-container" }, [
        vue.createElementVNode("button", {
          class: "create-button",
          disabled: !$options.actionEnable,
          onClick: _cache[8] || (_cache[8] = (...args) => $options.createConference && $options.createConference(...args))
        }, "创建会议", 8, ["disabled"]),
        vue.createElementVNode("button", {
          class: "join-button",
          disabled: !$options.actionEnable,
          onClick: _cache[9] || (_cache[9] = (...args) => $options.createAndJoinConference && $options.createAndJoinConference(...args))
        }, "进入会议", 8, ["disabled"])
      ])
    ]);
  }
  const PagesVoipConferenceCreateConferencePage = /* @__PURE__ */ _export_sfc(_sfc_main$d, [["render", _sfc_render$c], ["__scopeId", "data-v-2f919e49"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/voip/conference/CreateConferencePage.vue"]]);
  const _sfc_main$c = {
    name: "OrderConferenceView",
    data() {
      return {
        title: "",
        desc: "",
        startTime: "",
        endTime: "",
        audioOnly: false,
        audience: false,
        advance: false,
        allowTurnOnMic: false,
        enablePin: false,
        pin: "",
        callId: "1234567"
      };
    },
    methods: {
      orderConference() {
        formatAppLog("log", "at pages/voip/conference/OrderConferencePage.vue:66", "order Conference");
        let info = new ConferenceInfo();
        info.conferenceTitle = this.title;
        if (this.password) {
          info.password = this.password;
        }
        info.pin = "" + Math.ceil((1 + Math.random() * 1e5) / 10);
        info.owner = self$1.selfUserId;
        info.startTime = Math.ceil(new Date(this.startTime).getTime() / 1e3);
        info.endTime = Math.ceil(new Date(this.endTime).getTime() / 1e3);
        info.audience = this.audience;
        info.allowSwitchMode = this.allowTurnOnMic;
        info.advance = this.advance;
        conferenceApi.createConference(info).then((r) => {
          formatAppLog("log", "at pages/voip/conference/OrderConferencePage.vue:83", "createConference success", r);
        }).catch((err) => {
          formatAppLog("log", "at pages/voip/conference/OrderConferencePage.vue:86", "createConference error", err);
        });
        this.$modal.hide("order-conference-modal");
      }
    },
    computed: {
      actionEnable() {
        if (this.title && this.title.trim() && this.startTime && this.endTime) {
          let now2 = (/* @__PURE__ */ new Date()).getTime();
          let start = new Date(this.startTime).getTime();
          let end = new Date(this.endTime).getTime();
          return start > now2 && end > start;
        }
        return false;
      }
    },
    watch: {
      advance() {
        if (this.advance) {
          this.audience = false;
        }
      },
      startTime() {
        if (this.startTime) {
          let start = new Date(this.startTime).getTime();
          if (start < (/* @__PURE__ */ new Date()).getTime()) {
            this.$notify({
              text: "开始时间不能早于当前时间",
              type: "warn"
            });
            this.startTime = "";
          }
        }
      },
      endTime() {
        if (this.endTime) {
          let end = new Date(this.endTime).getTime();
          let now2 = (/* @__PURE__ */ new Date()).getTime();
          if (end < now2) {
            this.$notify({
              text: "开始时间不能早于当前时间",
              type: "warn"
            });
            this.endTime = "";
          }
          if (this.startTime) {
            let start = new Date(this.startTime).getTime();
            if (end < start) {
              this.$notify({
                text: "结束时间不能早于当前时间",
                type: "warn"
              });
              this.endTime = "";
            }
          }
        }
      }
    }
  };
  function _sfc_render$b(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "order-conference-container" }, [
      vue.createElementVNode("h2", null, "预定会议"),
      vue.withDirectives(vue.createElementVNode(
        "input",
        {
          "onUpdate:modelValue": _cache[0] || (_cache[0] = ($event) => $data.title = $event),
          class: "text-input",
          type: "text",
          placeholder: "会议标题"
        },
        null,
        512
        /* NEED_PATCH */
      ), [
        [vue.vModelText, $data.title]
      ]),
      vue.createCommentVNode("v-if", true),
      vue.createElementVNode("label", null, [
        vue.createTextVNode(" 开始时间 "),
        vue.withDirectives(vue.createElementVNode(
          "input",
          {
            "onUpdate:modelValue": _cache[2] || (_cache[2] = ($event) => $data.startTime = $event),
            type: "datetime-local"
          },
          null,
          512
          /* NEED_PATCH */
        ), [
          [vue.vModelText, $data.startTime]
        ])
      ]),
      vue.createElementVNode("label", null, [
        vue.createTextVNode(" 结束时间 "),
        vue.withDirectives(vue.createElementVNode(
          "input",
          {
            "onUpdate:modelValue": _cache[3] || (_cache[3] = ($event) => $data.endTime = $event),
            type: "datetime-local"
          },
          null,
          512
          /* NEED_PATCH */
        ), [
          [vue.vModelText, $data.endTime]
        ])
      ]),
      vue.createElementVNode("label", null, [
        vue.createTextVNode(" 参与者开启摄像头、麦克风入会 "),
        vue.createElementVNode("checkbox", { value: "audience" })
      ]),
      vue.createElementVNode("label", null, [
        vue.createTextVNode(" 允许参与者自主开启摄像头和麦克风 "),
        vue.createElementVNode("checkbox", {
          disabled: $data.audience,
          value: "allowTurnOnMic"
        }, null, 8, ["disabled"])
      ]),
      vue.createElementVNode("div", null, [
        vue.createElementVNode("label", null, [
          vue.createTextVNode(" 启用密码 "),
          vue.createElementVNode("checkbox", { value: "enablePin" })
        ]),
        $data.enablePin ? vue.withDirectives((vue.openBlock(), vue.createElementBlock(
          "input",
          {
            key: 0,
            "onUpdate:modelValue": _cache[4] || (_cache[4] = ($event) => $data.pin = $event),
            class: "text-input",
            style: { "margin-top": "10px" },
            type: "tel",
            maxlength: "4",
            placeholder: "123456"
          },
          null,
          512
          /* NEED_PATCH */
        )), [
          [vue.vModelText, $data.pin]
        ]) : vue.createCommentVNode("v-if", true)
      ]),
      vue.createElementVNode("div", null, [
        vue.createElementVNode("label", null, [
          vue.createTextVNode(" 大规模会议 "),
          vue.createElementVNode("checkbox", { value: "advance" })
        ]),
        vue.createElementVNode("p", { class: "advance_desc" }, "参会人数大于50人")
      ]),
      vue.createElementVNode("button", {
        disabled: !$options.actionEnable,
        onClick: _cache[5] || (_cache[5] = (...args) => $options.orderConference && $options.orderConference(...args))
      }, "预定会议", 8, ["disabled"])
    ]);
  }
  const PagesVoipConferenceOrderConferencePage = /* @__PURE__ */ _export_sfc(_sfc_main$c, [["render", _sfc_render$b], ["__scopeId", "data-v-7167c599"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/voip/conference/OrderConferencePage.vue"]]);
  const popup = {
    data() {
      return {};
    },
    created() {
      this.popup = this.getParent();
    },
    methods: {
      /**
       * 获取父元素实例
       */
      getParent(name = "uniPopup") {
        let parent = this.$parent;
        let parentName = parent.$options.name;
        while (parentName !== name) {
          parent = parent.$parent;
          if (!parent)
            return false;
          parentName = parent.$options.name;
        }
        return parent;
      }
    }
  };
  const isObject$2 = (val) => val !== null && typeof val === "object";
  const defaultDelimiters = ["{", "}"];
  class BaseFormatter {
    constructor() {
      this._caches = /* @__PURE__ */ Object.create(null);
    }
    interpolate(message2, values, delimiters = defaultDelimiters) {
      if (!values) {
        return [message2];
      }
      let tokens = this._caches[message2];
      if (!tokens) {
        tokens = parse$1(message2, delimiters);
        this._caches[message2] = tokens;
      }
      return compile(tokens, values);
    }
  }
  const RE_TOKEN_LIST_VALUE = /^(?:\d)+/;
  const RE_TOKEN_NAMED_VALUE = /^(?:\w)+/;
  function parse$1(format2, [startDelimiter, endDelimiter]) {
    const tokens = [];
    let position = 0;
    let text = "";
    while (position < format2.length) {
      let char = format2[position++];
      if (char === startDelimiter) {
        if (text) {
          tokens.push({ type: "text", value: text });
        }
        text = "";
        let sub = "";
        char = format2[position++];
        while (char !== void 0 && char !== endDelimiter) {
          sub += char;
          char = format2[position++];
        }
        const isClosed = char === endDelimiter;
        const type = RE_TOKEN_LIST_VALUE.test(sub) ? "list" : isClosed && RE_TOKEN_NAMED_VALUE.test(sub) ? "named" : "unknown";
        tokens.push({ value: sub, type });
      } else {
        text += char;
      }
    }
    text && tokens.push({ type: "text", value: text });
    return tokens;
  }
  function compile(tokens, values) {
    const compiled = [];
    let index = 0;
    const mode = Array.isArray(values) ? "list" : isObject$2(values) ? "named" : "unknown";
    if (mode === "unknown") {
      return compiled;
    }
    while (index < tokens.length) {
      const token = tokens[index];
      switch (token.type) {
        case "text":
          compiled.push(token.value);
          break;
        case "list":
          compiled.push(values[parseInt(token.value, 10)]);
          break;
        case "named":
          if (mode === "named") {
            compiled.push(values[token.value]);
          } else {
            {
              console.warn(`Type of token '${token.type}' and format of value '${mode}' don't match!`);
            }
          }
          break;
        case "unknown":
          {
            console.warn(`Detect 'unknown' type of token!`);
          }
          break;
      }
      index++;
    }
    return compiled;
  }
  const LOCALE_ZH_HANS = "zh-Hans";
  const LOCALE_ZH_HANT = "zh-Hant";
  const LOCALE_EN = "en";
  const LOCALE_FR = "fr";
  const LOCALE_ES = "es";
  const hasOwnProperty$2 = Object.prototype.hasOwnProperty;
  const hasOwn$2 = (val, key) => hasOwnProperty$2.call(val, key);
  const defaultFormatter = new BaseFormatter();
  function include(str, parts) {
    return !!parts.find((part) => str.indexOf(part) !== -1);
  }
  function startsWith(str, parts) {
    return parts.find((part) => str.indexOf(part) === 0);
  }
  function normalizeLocale(locale, messages2) {
    if (!locale) {
      return;
    }
    locale = locale.trim().replace(/_/g, "-");
    if (messages2 && messages2[locale]) {
      return locale;
    }
    locale = locale.toLowerCase();
    if (locale === "chinese") {
      return LOCALE_ZH_HANS;
    }
    if (locale.indexOf("zh") === 0) {
      if (locale.indexOf("-hans") > -1) {
        return LOCALE_ZH_HANS;
      }
      if (locale.indexOf("-hant") > -1) {
        return LOCALE_ZH_HANT;
      }
      if (include(locale, ["-tw", "-hk", "-mo", "-cht"])) {
        return LOCALE_ZH_HANT;
      }
      return LOCALE_ZH_HANS;
    }
    let locales = [LOCALE_EN, LOCALE_FR, LOCALE_ES];
    if (messages2 && Object.keys(messages2).length > 0) {
      locales = Object.keys(messages2);
    }
    const lang = startsWith(locale, locales);
    if (lang) {
      return lang;
    }
  }
  class I18n {
    constructor({ locale, fallbackLocale, messages: messages2, watcher, formater: formater2 }) {
      this.locale = LOCALE_EN;
      this.fallbackLocale = LOCALE_EN;
      this.message = {};
      this.messages = {};
      this.watchers = [];
      if (fallbackLocale) {
        this.fallbackLocale = fallbackLocale;
      }
      this.formater = formater2 || defaultFormatter;
      this.messages = messages2 || {};
      this.setLocale(locale || LOCALE_EN);
      if (watcher) {
        this.watchLocale(watcher);
      }
    }
    setLocale(locale) {
      const oldLocale = this.locale;
      this.locale = normalizeLocale(locale, this.messages) || this.fallbackLocale;
      if (!this.messages[this.locale]) {
        this.messages[this.locale] = {};
      }
      this.message = this.messages[this.locale];
      if (oldLocale !== this.locale) {
        this.watchers.forEach((watcher) => {
          watcher(this.locale, oldLocale);
        });
      }
    }
    getLocale() {
      return this.locale;
    }
    watchLocale(fn) {
      const index = this.watchers.push(fn) - 1;
      return () => {
        this.watchers.splice(index, 1);
      };
    }
    add(locale, message2, override = true) {
      const curMessages = this.messages[locale];
      if (curMessages) {
        if (override) {
          Object.assign(curMessages, message2);
        } else {
          Object.keys(message2).forEach((key) => {
            if (!hasOwn$2(curMessages, key)) {
              curMessages[key] = message2[key];
            }
          });
        }
      } else {
        this.messages[locale] = message2;
      }
    }
    f(message2, values, delimiters) {
      return this.formater.interpolate(message2, values, delimiters).join("");
    }
    t(key, locale, values) {
      let message2 = this.message;
      if (typeof locale === "string") {
        locale = normalizeLocale(locale, this.messages);
        locale && (message2 = this.messages[locale]);
      } else {
        values = locale;
      }
      if (!hasOwn$2(message2, key)) {
        console.warn(`Cannot translate the value of keypath ${key}. Use the value of keypath as default.`);
        return key;
      }
      return this.formater.interpolate(message2[key], values).join("");
    }
  }
  function watchAppLocale(appVm, i18n2) {
    if (appVm.$watchLocale) {
      appVm.$watchLocale((newLocale) => {
        i18n2.setLocale(newLocale);
      });
    } else {
      appVm.$watch(() => appVm.$locale, (newLocale) => {
        i18n2.setLocale(newLocale);
      });
    }
  }
  function getDefaultLocale() {
    if (typeof uni !== "undefined" && uni.getLocale) {
      return uni.getLocale();
    }
    if (typeof global !== "undefined" && global.getLocale) {
      return global.getLocale();
    }
    return LOCALE_EN;
  }
  function initVueI18n(locale, messages2 = {}, fallbackLocale, watcher) {
    if (typeof locale !== "string") {
      const options = [
        messages2,
        locale
      ];
      locale = options[0];
      messages2 = options[1];
    }
    if (typeof locale !== "string") {
      locale = getDefaultLocale();
    }
    if (typeof fallbackLocale !== "string") {
      fallbackLocale = typeof __uniConfig !== "undefined" && __uniConfig.fallbackLocale || LOCALE_EN;
    }
    const i18n2 = new I18n({
      locale,
      fallbackLocale,
      messages: messages2,
      watcher
    });
    let t2 = (key, values) => {
      if (typeof getApp !== "function") {
        t2 = function(key2, values2) {
          return i18n2.t(key2, values2);
        };
      } else {
        let isWatchedAppLocale = false;
        t2 = function(key2, values2) {
          const appVm = getApp().$vm;
          if (appVm) {
            appVm.$locale;
            if (!isWatchedAppLocale) {
              isWatchedAppLocale = true;
              watchAppLocale(appVm, i18n2);
            }
          }
          return i18n2.t(key2, values2);
        };
      }
      return t2(key, values);
    };
    return {
      i18n: i18n2,
      f(message2, values, delimiters) {
        return i18n2.f(message2, values, delimiters);
      },
      t(key, values) {
        return t2(key, values);
      },
      add(locale2, message2, override = true) {
        return i18n2.add(locale2, message2, override);
      },
      watch(fn) {
        return i18n2.watchLocale(fn);
      },
      getLocale() {
        return i18n2.getLocale();
      },
      setLocale(newLocale) {
        return i18n2.setLocale(newLocale);
      }
    };
  }
  const en = {
    "uni-popup.cancel": "cancel",
    "uni-popup.ok": "ok",
    "uni-popup.placeholder": "pleace enter",
    "uni-popup.title": "Hint",
    "uni-popup.shareTitle": "Share to"
  };
  const zhHans = {
    "uni-popup.cancel": "取消",
    "uni-popup.ok": "确定",
    "uni-popup.placeholder": "请输入",
    "uni-popup.title": "提示",
    "uni-popup.shareTitle": "分享到"
  };
  const zhHant = {
    "uni-popup.cancel": "取消",
    "uni-popup.ok": "確定",
    "uni-popup.placeholder": "請輸入",
    "uni-popup.title": "提示",
    "uni-popup.shareTitle": "分享到"
  };
  const messages = {
    en,
    "zh-Hans": zhHans,
    "zh-Hant": zhHant
  };
  const { t } = initVueI18n(messages);
  const _sfc_main$b = {
    name: "uniPopupDialog",
    mixins: [popup],
    emits: ["confirm", "close"],
    props: {
      inputType: {
        type: String,
        default: "text"
      },
      value: {
        type: [String, Number],
        default: ""
      },
      placeholder: {
        type: [String, Number],
        default: ""
      },
      type: {
        type: String,
        default: "error"
      },
      mode: {
        type: String,
        default: "base"
      },
      title: {
        type: String,
        default: ""
      },
      content: {
        type: String,
        default: ""
      },
      beforeClose: {
        type: Boolean,
        default: false
      },
      cancelText: {
        type: String,
        default: ""
      },
      confirmText: {
        type: String,
        default: ""
      }
    },
    data() {
      return {
        dialogType: "error",
        focus: false,
        val: ""
      };
    },
    computed: {
      okText() {
        return this.confirmText || t("uni-popup.ok");
      },
      closeText() {
        return this.cancelText || t("uni-popup.cancel");
      },
      placeholderText() {
        return this.placeholder || t("uni-popup.placeholder");
      },
      titleText() {
        return this.title || t("uni-popup.title");
      }
    },
    watch: {
      type(val) {
        this.dialogType = val;
      },
      mode(val) {
        if (val === "input") {
          this.dialogType = "info";
        }
      },
      value(val) {
        this.val = val;
      }
    },
    created() {
      this.popup.disableMask();
      if (this.mode === "input") {
        this.dialogType = "info";
        this.val = this.value;
      } else {
        this.dialogType = this.type;
      }
    },
    mounted() {
      this.focus = true;
    },
    methods: {
      /**
       * 点击确认按钮
       */
      onOk() {
        if (this.mode === "input") {
          this.$emit("confirm", this.val);
        } else {
          this.$emit("confirm");
        }
        if (this.beforeClose)
          return;
        this.popup.close();
      },
      /**
       * 点击取消按钮
       */
      closeDialog() {
        this.$emit("close");
        if (this.beforeClose)
          return;
        this.popup.close();
      },
      close() {
        this.popup.close();
      }
    }
  };
  function _sfc_render$a(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("view", { class: "uni-popup-dialog" }, [
      vue.createElementVNode("view", { class: "uni-dialog-title" }, [
        vue.createElementVNode(
          "text",
          {
            class: vue.normalizeClass(["uni-dialog-title-text", ["uni-popup__" + $data.dialogType]])
          },
          vue.toDisplayString($options.titleText),
          3
          /* TEXT, CLASS */
        )
      ]),
      $props.mode === "base" ? (vue.openBlock(), vue.createElementBlock("view", {
        key: 0,
        class: "uni-dialog-content"
      }, [
        vue.renderSlot(_ctx.$slots, "default", {}, () => [
          vue.createElementVNode(
            "text",
            { class: "uni-dialog-content-text" },
            vue.toDisplayString($props.content),
            1
            /* TEXT */
          )
        ], true)
      ])) : (vue.openBlock(), vue.createElementBlock("view", {
        key: 1,
        class: "uni-dialog-content"
      }, [
        vue.renderSlot(_ctx.$slots, "default", {}, () => [
          vue.withDirectives(vue.createElementVNode("input", {
            class: "uni-dialog-input",
            "onUpdate:modelValue": _cache[0] || (_cache[0] = ($event) => $data.val = $event),
            type: $props.inputType,
            placeholder: $options.placeholderText,
            focus: $data.focus
          }, null, 8, ["type", "placeholder", "focus"]), [
            [vue.vModelDynamic, $data.val]
          ])
        ], true)
      ])),
      vue.createElementVNode("view", { class: "uni-dialog-button-group" }, [
        vue.createElementVNode("view", {
          class: "uni-dialog-button",
          onClick: _cache[1] || (_cache[1] = (...args) => $options.closeDialog && $options.closeDialog(...args))
        }, [
          vue.createElementVNode(
            "text",
            { class: "uni-dialog-button-text" },
            vue.toDisplayString($options.closeText),
            1
            /* TEXT */
          )
        ]),
        vue.createElementVNode("view", {
          class: "uni-dialog-button uni-border-left",
          onClick: _cache[2] || (_cache[2] = (...args) => $options.onOk && $options.onOk(...args))
        }, [
          vue.createElementVNode(
            "text",
            { class: "uni-dialog-button-text uni-button-color" },
            vue.toDisplayString($options.okText),
            1
            /* TEXT */
          )
        ])
      ])
    ]);
  }
  const __easycom_1 = /* @__PURE__ */ _export_sfc(_sfc_main$b, [["render", _sfc_render$a], ["__scopeId", "data-v-d78c88b7"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/uni_modules/uni-popup/components/uni-popup-dialog/uni-popup-dialog.vue"]]);
  class MPAnimation {
    constructor(options, _this) {
      this.options = options;
      this.animation = uni.createAnimation({
        ...options
      });
      this.currentStepAnimates = {};
      this.next = 0;
      this.$ = _this;
    }
    _nvuePushAnimates(type, args) {
      let aniObj = this.currentStepAnimates[this.next];
      let styles = {};
      if (!aniObj) {
        styles = {
          styles: {},
          config: {}
        };
      } else {
        styles = aniObj;
      }
      if (animateTypes1.includes(type)) {
        if (!styles.styles.transform) {
          styles.styles.transform = "";
        }
        let unit = "";
        if (type === "rotate") {
          unit = "deg";
        }
        styles.styles.transform += `${type}(${args + unit}) `;
      } else {
        styles.styles[type] = `${args}`;
      }
      this.currentStepAnimates[this.next] = styles;
    }
    _animateRun(styles = {}, config2 = {}) {
      let ref = this.$.$refs["ani"].ref;
      if (!ref)
        return;
      return new Promise((resolve, reject) => {
        nvueAnimation.transition(ref, {
          styles,
          ...config2
        }, (res) => {
          resolve();
        });
      });
    }
    _nvueNextAnimate(animates, step = 0, fn) {
      let obj = animates[step];
      if (obj) {
        let {
          styles,
          config: config2
        } = obj;
        this._animateRun(styles, config2).then(() => {
          step += 1;
          this._nvueNextAnimate(animates, step, fn);
        });
      } else {
        this.currentStepAnimates = {};
        typeof fn === "function" && fn();
        this.isEnd = true;
      }
    }
    step(config2 = {}) {
      this.animation.step(config2);
      return this;
    }
    run(fn) {
      this.$.animationData = this.animation.export();
      this.$.timer = setTimeout(() => {
        typeof fn === "function" && fn();
      }, this.$.durationTime);
    }
  }
  const animateTypes1 = [
    "matrix",
    "matrix3d",
    "rotate",
    "rotate3d",
    "rotateX",
    "rotateY",
    "rotateZ",
    "scale",
    "scale3d",
    "scaleX",
    "scaleY",
    "scaleZ",
    "skew",
    "skewX",
    "skewY",
    "translate",
    "translate3d",
    "translateX",
    "translateY",
    "translateZ"
  ];
  const animateTypes2 = ["opacity", "backgroundColor"];
  const animateTypes3 = ["width", "height", "left", "right", "top", "bottom"];
  animateTypes1.concat(animateTypes2, animateTypes3).forEach((type) => {
    MPAnimation.prototype[type] = function(...args) {
      this.animation[type](...args);
      return this;
    };
  });
  function createAnimation(option, _this) {
    if (!_this)
      return;
    clearTimeout(_this.timer);
    return new MPAnimation(option, _this);
  }
  const _sfc_main$a = {
    name: "uniTransition",
    emits: ["click", "change"],
    props: {
      show: {
        type: Boolean,
        default: false
      },
      modeClass: {
        type: [Array, String],
        default() {
          return "fade";
        }
      },
      duration: {
        type: Number,
        default: 300
      },
      styles: {
        type: Object,
        default() {
          return {};
        }
      },
      customClass: {
        type: String,
        default: ""
      },
      onceRender: {
        type: Boolean,
        default: false
      }
    },
    data() {
      return {
        isShow: false,
        transform: "",
        opacity: 1,
        animationData: {},
        durationTime: 300,
        config: {}
      };
    },
    watch: {
      show: {
        handler(newVal) {
          if (newVal) {
            this.open();
          } else {
            if (this.isShow) {
              this.close();
            }
          }
        },
        immediate: true
      }
    },
    computed: {
      // 生成样式数据
      stylesObject() {
        let styles = {
          ...this.styles,
          "transition-duration": this.duration / 1e3 + "s"
        };
        let transform2 = "";
        for (let i2 in styles) {
          let line = this.toLine(i2);
          transform2 += line + ":" + styles[i2] + ";";
        }
        return transform2;
      },
      // 初始化动画条件
      transformStyles() {
        return "transform:" + this.transform + ";opacity:" + this.opacity + ";" + this.stylesObject;
      }
    },
    created() {
      this.config = {
        duration: this.duration,
        timingFunction: "ease",
        transformOrigin: "50% 50%",
        delay: 0
      };
      this.durationTime = this.duration;
    },
    methods: {
      /**
       *  ref 触发 初始化动画
       */
      init(obj = {}) {
        if (obj.duration) {
          this.durationTime = obj.duration;
        }
        this.animation = createAnimation(Object.assign(this.config, obj), this);
      },
      /**
       * 点击组件触发回调
       */
      onClick() {
        this.$emit("click", {
          detail: this.isShow
        });
      },
      /**
       * ref 触发 动画分组
       * @param {Object} obj
       */
      step(obj, config2 = {}) {
        if (!this.animation)
          return;
        for (let i2 in obj) {
          try {
            if (typeof obj[i2] === "object") {
              this.animation[i2](...obj[i2]);
            } else {
              this.animation[i2](obj[i2]);
            }
          } catch (e) {
            formatAppLog("error", "at uni_modules/uni-transition/components/uni-transition/uni-transition.vue:148", `方法 ${i2} 不存在`);
          }
        }
        this.animation.step(config2);
        return this;
      },
      /**
       *  ref 触发 执行动画
       */
      run(fn) {
        if (!this.animation)
          return;
        this.animation.run(fn);
      },
      // 开始过度动画
      open() {
        clearTimeout(this.timer);
        this.transform = "";
        this.isShow = true;
        let { opacity, transform: transform2 } = this.styleInit(false);
        if (typeof opacity !== "undefined") {
          this.opacity = opacity;
        }
        this.transform = transform2;
        this.$nextTick(() => {
          this.timer = setTimeout(() => {
            this.animation = createAnimation(this.config, this);
            this.tranfromInit(false).step();
            this.animation.run();
            this.$emit("change", {
              detail: this.isShow
            });
          }, 20);
        });
      },
      // 关闭过度动画
      close(type) {
        if (!this.animation)
          return;
        this.tranfromInit(true).step().run(() => {
          this.isShow = false;
          this.animationData = null;
          this.animation = null;
          let { opacity, transform: transform2 } = this.styleInit(false);
          this.opacity = opacity || 1;
          this.transform = transform2;
          this.$emit("change", {
            detail: this.isShow
          });
        });
      },
      // 处理动画开始前的默认样式
      styleInit(type) {
        let styles = {
          transform: ""
        };
        let buildStyle = (type2, mode) => {
          if (mode === "fade") {
            styles.opacity = this.animationType(type2)[mode];
          } else {
            styles.transform += this.animationType(type2)[mode] + " ";
          }
        };
        if (typeof this.modeClass === "string") {
          buildStyle(type, this.modeClass);
        } else {
          this.modeClass.forEach((mode) => {
            buildStyle(type, mode);
          });
        }
        return styles;
      },
      // 处理内置组合动画
      tranfromInit(type) {
        let buildTranfrom = (type2, mode) => {
          let aniNum = null;
          if (mode === "fade") {
            aniNum = type2 ? 0 : 1;
          } else {
            aniNum = type2 ? "-100%" : "0";
            if (mode === "zoom-in") {
              aniNum = type2 ? 0.8 : 1;
            }
            if (mode === "zoom-out") {
              aniNum = type2 ? 1.2 : 1;
            }
            if (mode === "slide-right") {
              aniNum = type2 ? "100%" : "0";
            }
            if (mode === "slide-bottom") {
              aniNum = type2 ? "100%" : "0";
            }
          }
          this.animation[this.animationMode()[mode]](aniNum);
        };
        if (typeof this.modeClass === "string") {
          buildTranfrom(type, this.modeClass);
        } else {
          this.modeClass.forEach((mode) => {
            buildTranfrom(type, mode);
          });
        }
        return this.animation;
      },
      animationType(type) {
        return {
          fade: type ? 1 : 0,
          "slide-top": `translateY(${type ? "0" : "-100%"})`,
          "slide-right": `translateX(${type ? "0" : "100%"})`,
          "slide-bottom": `translateY(${type ? "0" : "100%"})`,
          "slide-left": `translateX(${type ? "0" : "-100%"})`,
          "zoom-in": `scaleX(${type ? 1 : 0.8}) scaleY(${type ? 1 : 0.8})`,
          "zoom-out": `scaleX(${type ? 1 : 1.2}) scaleY(${type ? 1 : 1.2})`
        };
      },
      // 内置动画类型与实际动画对应字典
      animationMode() {
        return {
          fade: "opacity",
          "slide-top": "translateY",
          "slide-right": "translateX",
          "slide-bottom": "translateY",
          "slide-left": "translateX",
          "zoom-in": "scale",
          "zoom-out": "scale"
        };
      },
      // 驼峰转中横线
      toLine(name) {
        return name.replace(/([A-Z])/g, "-$1").toLowerCase();
      }
    }
  };
  function _sfc_render$9(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.withDirectives((vue.openBlock(), vue.createElementBlock("view", {
      ref: "ani",
      animation: $data.animationData,
      class: vue.normalizeClass($props.customClass),
      style: vue.normalizeStyle($options.transformStyles),
      onClick: _cache[0] || (_cache[0] = (...args) => $options.onClick && $options.onClick(...args))
    }, [
      vue.renderSlot(_ctx.$slots, "default")
    ], 14, ["animation"])), [
      [vue.vShow, $data.isShow]
    ]);
  }
  const __easycom_0 = /* @__PURE__ */ _export_sfc(_sfc_main$a, [["render", _sfc_render$9], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/uni_modules/uni-transition/components/uni-transition/uni-transition.vue"]]);
  const _sfc_main$9 = {
    name: "uniPopup",
    components: {},
    emits: ["change", "maskClick"],
    props: {
      // 开启动画
      animation: {
        type: Boolean,
        default: true
      },
      // 弹出层类型，可选值，top: 顶部弹出层；bottom：底部弹出层；center：全屏弹出层
      // message: 消息提示 ; dialog : 对话框
      type: {
        type: String,
        default: "center"
      },
      // maskClick
      isMaskClick: {
        type: Boolean,
        default: null
      },
      // TODO 2 个版本后废弃属性 ，使用 isMaskClick
      maskClick: {
        type: Boolean,
        default: null
      },
      backgroundColor: {
        type: String,
        default: "none"
      },
      safeArea: {
        type: Boolean,
        default: true
      },
      maskBackgroundColor: {
        type: String,
        default: "rgba(0, 0, 0, 0.4)"
      }
    },
    watch: {
      /**
       * 监听type类型
       */
      type: {
        handler: function(type) {
          if (!this.config[type])
            return;
          this[this.config[type]](true);
        },
        immediate: true
      },
      isDesktop: {
        handler: function(newVal) {
          if (!this.config[newVal])
            return;
          this[this.config[this.type]](true);
        },
        immediate: true
      },
      /**
       * 监听遮罩是否可点击
       * @param {Object} val
       */
      maskClick: {
        handler: function(val) {
          this.mkclick = val;
        },
        immediate: true
      },
      isMaskClick: {
        handler: function(val) {
          this.mkclick = val;
        },
        immediate: true
      },
      // H5 下禁止底部滚动
      showPopup(show) {
      }
    },
    data() {
      return {
        duration: 300,
        ani: [],
        showPopup: false,
        showTrans: false,
        popupWidth: 0,
        popupHeight: 0,
        config: {
          top: "top",
          bottom: "bottom",
          center: "center",
          left: "left",
          right: "right",
          message: "top",
          dialog: "center",
          share: "bottom"
        },
        maskClass: {
          position: "fixed",
          bottom: 0,
          top: 0,
          left: 0,
          right: 0,
          backgroundColor: "rgba(0, 0, 0, 0.4)"
        },
        transClass: {
          position: "fixed",
          left: 0,
          right: 0
        },
        maskShow: true,
        mkclick: true,
        popupstyle: this.isDesktop ? "fixforpc-top" : "top"
      };
    },
    computed: {
      isDesktop() {
        return this.popupWidth >= 500 && this.popupHeight >= 500;
      },
      bg() {
        if (this.backgroundColor === "" || this.backgroundColor === "none") {
          return "transparent";
        }
        return this.backgroundColor;
      }
    },
    mounted() {
      const fixSize = () => {
        const {
          windowWidth,
          windowHeight,
          windowTop,
          safeArea,
          screenHeight,
          safeAreaInsets
        } = uni.getSystemInfoSync();
        this.popupWidth = windowWidth;
        this.popupHeight = windowHeight + (windowTop || 0);
        if (safeArea && this.safeArea) {
          this.safeAreaInsets = safeAreaInsets.bottom;
        } else {
          this.safeAreaInsets = 0;
        }
      };
      fixSize();
    },
    // TODO vue3
    unmounted() {
      this.setH5Visible();
    },
    created() {
      if (this.isMaskClick === null && this.maskClick === null) {
        this.mkclick = true;
      } else {
        this.mkclick = this.isMaskClick !== null ? this.isMaskClick : this.maskClick;
      }
      if (this.animation) {
        this.duration = 300;
      } else {
        this.duration = 0;
      }
      this.messageChild = null;
      this.clearPropagation = false;
      this.maskClass.backgroundColor = this.maskBackgroundColor;
    },
    methods: {
      setH5Visible() {
      },
      /**
       * 公用方法，不显示遮罩层
       */
      closeMask() {
        this.maskShow = false;
      },
      /**
       * 公用方法，遮罩层禁止点击
       */
      disableMask() {
        this.mkclick = false;
      },
      // TODO nvue 取消冒泡
      clear(e) {
        e.stopPropagation();
        this.clearPropagation = true;
      },
      open(direction) {
        if (this.showPopup) {
          return;
        }
        let innerType = ["top", "center", "bottom", "left", "right", "message", "dialog", "share"];
        if (!(direction && innerType.indexOf(direction) !== -1)) {
          direction = this.type;
        }
        if (!this.config[direction]) {
          formatAppLog("error", "at uni_modules/uni-popup/components/uni-popup/uni-popup.vue:279", "缺少类型：", direction);
          return;
        }
        this[this.config[direction]]();
        this.$emit("change", {
          show: true,
          type: direction
        });
      },
      close(type) {
        this.showTrans = false;
        this.$emit("change", {
          show: false,
          type: this.type
        });
        clearTimeout(this.timer);
        this.timer = setTimeout(() => {
          this.showPopup = false;
        }, 300);
      },
      // TODO 处理冒泡事件，头条的冒泡事件有问题 ，先这样兼容
      touchstart() {
        this.clearPropagation = false;
      },
      onTap() {
        if (this.clearPropagation) {
          this.clearPropagation = false;
          return;
        }
        this.$emit("maskClick");
        if (!this.mkclick)
          return;
        this.close();
      },
      /**
       * 顶部弹出样式处理
       */
      top(type) {
        this.popupstyle = this.isDesktop ? "fixforpc-top" : "top";
        this.ani = ["slide-top"];
        this.transClass = {
          position: "fixed",
          left: 0,
          right: 0,
          backgroundColor: this.bg
        };
        if (type)
          return;
        this.showPopup = true;
        this.showTrans = true;
        this.$nextTick(() => {
          if (this.messageChild && this.type === "message") {
            this.messageChild.timerClose();
          }
        });
      },
      /**
       * 底部弹出样式处理
       */
      bottom(type) {
        this.popupstyle = "bottom";
        this.ani = ["slide-bottom"];
        this.transClass = {
          position: "fixed",
          left: 0,
          right: 0,
          bottom: 0,
          paddingBottom: this.safeAreaInsets + "px",
          backgroundColor: this.bg
        };
        if (type)
          return;
        this.showPopup = true;
        this.showTrans = true;
      },
      /**
       * 中间弹出样式处理
       */
      center(type) {
        this.popupstyle = "center";
        this.ani = ["zoom-out", "fade"];
        this.transClass = {
          position: "fixed",
          display: "flex",
          flexDirection: "column",
          bottom: 0,
          left: 0,
          right: 0,
          top: 0,
          justifyContent: "center",
          alignItems: "center"
        };
        if (type)
          return;
        this.showPopup = true;
        this.showTrans = true;
      },
      left(type) {
        this.popupstyle = "left";
        this.ani = ["slide-left"];
        this.transClass = {
          position: "fixed",
          left: 0,
          bottom: 0,
          top: 0,
          backgroundColor: this.bg,
          display: "flex",
          flexDirection: "column"
        };
        if (type)
          return;
        this.showPopup = true;
        this.showTrans = true;
      },
      right(type) {
        this.popupstyle = "right";
        this.ani = ["slide-right"];
        this.transClass = {
          position: "fixed",
          bottom: 0,
          right: 0,
          top: 0,
          backgroundColor: this.bg,
          display: "flex",
          flexDirection: "column"
        };
        if (type)
          return;
        this.showPopup = true;
        this.showTrans = true;
      }
    }
  };
  function _sfc_render$8(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_uni_transition = resolveEasycom(vue.resolveDynamicComponent("uni-transition"), __easycom_0);
    return $data.showPopup ? (vue.openBlock(), vue.createElementBlock(
      "view",
      {
        key: 0,
        class: vue.normalizeClass(["uni-popup", [$data.popupstyle, $options.isDesktop ? "fixforpc-z-index" : ""]])
      },
      [
        vue.createElementVNode(
          "view",
          {
            onTouchstart: _cache[1] || (_cache[1] = (...args) => $options.touchstart && $options.touchstart(...args))
          },
          [
            $data.maskShow ? (vue.openBlock(), vue.createBlock(_component_uni_transition, {
              key: "1",
              name: "mask",
              "mode-class": "fade",
              styles: $data.maskClass,
              duration: $data.duration,
              show: $data.showTrans,
              onClick: $options.onTap
            }, null, 8, ["styles", "duration", "show", "onClick"])) : vue.createCommentVNode("v-if", true),
            vue.createVNode(_component_uni_transition, {
              key: "2",
              "mode-class": $data.ani,
              name: "content",
              styles: $data.transClass,
              duration: $data.duration,
              show: $data.showTrans,
              onClick: $options.onTap
            }, {
              default: vue.withCtx(() => [
                vue.createElementVNode(
                  "view",
                  {
                    class: vue.normalizeClass(["uni-popup__wrapper", [$data.popupstyle]]),
                    style: vue.normalizeStyle({ backgroundColor: $options.bg }),
                    onClick: _cache[0] || (_cache[0] = (...args) => $options.clear && $options.clear(...args))
                  },
                  [
                    vue.renderSlot(_ctx.$slots, "default", {}, void 0, true)
                  ],
                  6
                  /* CLASS, STYLE */
                )
              ]),
              _: 3
              /* FORWARDED */
            }, 8, ["mode-class", "styles", "duration", "show", "onClick"])
          ],
          32
          /* NEED_HYDRATION */
        )
      ],
      2
      /* CLASS */
    )) : vue.createCommentVNode("v-if", true);
  }
  const __easycom_2 = /* @__PURE__ */ _export_sfc(_sfc_main$9, [["render", _sfc_render$8], ["__scopeId", "data-v-4dd3c44b"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/uni_modules/uni-popup/components/uni-popup/uni-popup.vue"]]);
  class CallEndReason {
  }
  __publicField(CallEndReason, "REASON_Unknown", 0);
  __publicField(CallEndReason, "REASON_Busy", 1);
  __publicField(CallEndReason, "REASON_SignalError", 2);
  __publicField(CallEndReason, "REASON_Hangup", 3);
  __publicField(CallEndReason, "REASON_MediaError", 4);
  __publicField(CallEndReason, "REASON_RemoteHangup", 5);
  __publicField(CallEndReason, "REASON_OpenCameraFailure", 6);
  __publicField(CallEndReason, "REASON_Timeout", 7);
  __publicField(CallEndReason, "REASON_AcceptByOtherClient", 8);
  __publicField(CallEndReason, "REASON_AllLeft", 9);
  __publicField(CallEndReason, "RemoteBusy", 10);
  __publicField(CallEndReason, "RemoteTimeout", 11);
  __publicField(CallEndReason, "RemoteNetworkError", 12);
  __publicField(CallEndReason, "RoomDestroyed", 13);
  __publicField(CallEndReason, "RoomNotExist", 14);
  __publicField(CallEndReason, "RoomParticipantsFull", 15);
  __publicField(CallEndReason, "Interrupted", 16);
  __publicField(CallEndReason, "RemoteInterrupted", 17);
  const _sfc_main$8 = {
    name: "ConferenceParticipantVideoView",
    props: {
      currentPageParticipants: {
        type: Object,
        required: true
      },
      participant: {
        type: Object,
        required: true
      },
      session: {
        type: Object,
        required: true
      },
      selfUserInfo: {
        type: Object,
        required: true
      }
    },
    data() {
      return {
        status: CallState.STATUS_CONNECTING,
        setupVideoViewTimer: 0
      };
    },
    created() {
      formatAppLog("log", "at pages/voip/conference/ConferenceParticipantVideoView.nvue:59", "videoView created", this.participant);
      if (this.selfUserId !== this.participant.uid) {
        if (!this.participant._isVideoMuted) {
          self$2.setParticipantVideoType(this.session.callId, this.participant.uid, this.participant._isScreenSharing, VideoType.BIG_STREAM);
        }
      }
    },
    unmounted() {
      formatAppLog("log", "at pages/voip/conference/ConferenceParticipantVideoView.nvue:67", "videoView unmounted", this.participant.uid);
      if (this.selfUserInfo.uid !== this.participant.uid) {
        if (!this.participant._isVideoMuted) {
          self$2.setParticipantVideoType(this.session.callId, this.participant.uid, this.participant._isScreenSharing, VideoType.NONE);
        }
      }
    },
    mounted() {
      this.setupVideoView();
    },
    updated() {
      formatAppLog("log", "at pages/voip/conference/ConferenceParticipantVideoView.nvue:79", "view updated, re-setupVideoView");
      this.$nextTick(() => {
        this.setupVideoView();
      });
    },
    methods: {
      // onDbClickVideo() {
      //     if (conferenceManager.isOwner()) {
      //         conferenceManager.requestFocus(this.participant.uid);
      //     } else {
      //         if (conferenceManager.conferenceInfo.focus) {
      //             this.$notify({
      //                 text: '主持人已设置了焦点用户',
      //                 type: 'warn'
      //             });
      //         } else {
      //             conferenceManager.localFocusUser = this.participant;
      //         }
      //     }
      // },
      setupVideoView() {
        if (this.participant._isAudience || this.participant._isVideoMuted) {
          return;
        }
        let videoViewReady = false;
        if (this.$refs.remoteVideoView) {
          videoViewReady = true;
        }
        if (videoViewReady) {
          formatAppLog("log", "at pages/voip/conference/ConferenceParticipantVideoView.nvue:110", "videoViews are ready, setup");
          if (this.setupVideoViewTimer) {
            clearTimeout(this.setupVideoViewTimer);
            this.setupVideoViewTimer = 0;
          }
          if (!this.participant._isVideoMuted) {
            if (this.participant.uid === this.selfUserInfo.uid) {
              self$2.setLocalVideoView(this.session.callId, this.$refs.remoteVideoView.ref);
            } else {
              self$2.setRemoteVideoView(this.session.callId, this.participant.uid, this.$refs.remoteVideoView.ref, false);
            }
          }
        } else {
          formatAppLog("log", "at pages/voip/conference/ConferenceParticipantVideoView.nvue:123", "videoViews are not ready, setTimeout");
          clearTimeout(this.setupVideoViewTimer);
          this.setupVideoViewTimer = setTimeout(this.setupVideoView, 100);
        }
      },
      switchVideoType(userId, screenSharing) {
        if (!this.session) {
          return;
        }
        let videoType = VideoType.NONE;
        {
          videoType = VideoType.SMALL_STREAM;
        }
        self$2.setParticipantVideoType(this.session.callId, userId, screenSharing, videoType);
      }
    },
    computed: {
      userName() {
        let name = "";
        let user = this.participant;
        if (user.groupAlias) {
          name = user.groupAlias;
        } else if (user.friendAlias) {
          name = user.friendAlias;
        } else if (user.displayName) {
          name = user.displayName;
        } else {
          name = user.name;
        }
        return name;
      },
      // FYI: https://stackoverflow.com/questions/62729380/vue-watch-outputs-same-oldvalue-and-newvalue
      isVideoMuted() {
        return this.participant._isAudience || this.participant._isVideoMuted;
      },
      computedParticipantSizeStyle() {
        let width;
        let height;
        if (this.currentPageParticipants.length === 1) {
          width = "750rpx";
          height = "400rpx";
        } else if (this.currentPageParticipants.length <= 4) {
          width = "375rpx";
          height = "375rpx";
        } else {
          width = "250rpx";
          height = "250rpx";
        }
        return {
          width,
          height
        };
      }
    },
    watch: {
      isVideoMuted: {
        // deep: true,
        handler(newValue, oldValue) {
          formatAppLog("log", "at pages/voip/conference/ConferenceParticipantVideoView.nvue:188", "watch participant", oldValue, newValue);
          if (oldValue && !newValue) {
            this.$nextTick(() => {
              formatAppLog("log", "at pages/voip/conference/ConferenceParticipantVideoView.nvue:191", "watch participant setupVideoView", this.$refs.remoteVideoView.ref);
              this.setupVideoView();
            });
          }
        }
      }
    }
  };
  function _sfc_render$7(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock(
      "div",
      {
        class: vue.normalizeClass(["participant-video-item", { highlight: $props.participant._volume > 0 }]),
        style: vue.normalizeStyle($options.computedParticipantSizeStyle)
      },
      [
        !$props.participant._isAudience && !$props.participant._isVideoMuted ? (vue.openBlock(), vue.createElementBlock(
          "UIKit-Video-CallView",
          {
            key: 0,
            onDblclick: _cache[0] || (_cache[0] = (...args) => _ctx.onDbClickVideo && _ctx.onDbClickVideo(...args)),
            ref: "remoteVideoView",
            style: vue.normalizeStyle($options.computedParticipantSizeStyle),
            class: "video"
          },
          null,
          36
          /* STYLE, NEED_HYDRATION */
        )) : (vue.openBlock(), vue.createElementBlock("div", {
          key: 1,
          class: "avatar-container"
        }, [
          vue.createElementVNode("image", {
            class: "avatar",
            src: $props.participant.portrait,
            alt: $props.participant
          }, null, 8, ["src", "alt"])
        ])),
        vue.createCommentVNode("v-if", true),
        vue.createElementVNode("div", { class: "info-container" }, [
          $props.participant._isHost ? (vue.openBlock(), vue.createElementBlock("text", {
            key: 0,
            class: "iconfont icon-ion-person"
          }, "")) : vue.createCommentVNode("v-if", true),
          $props.participant._isAudioMuted ? (vue.openBlock(), vue.createElementBlock("text", {
            key: 1,
            class: "iconfont icon-ion-ios-mic-off",
            style: { "color": "white" }
          }, "")) : (vue.openBlock(), vue.createElementBlock("text", {
            key: 2,
            class: "iconfont icon-ion-ios-mic"
          }, "")),
          vue.createElementVNode(
            "text",
            { class: "name" },
            vue.toDisplayString($options.userName),
            1
            /* TEXT */
          )
        ])
      ],
      6
      /* CLASS, STYLE */
    );
  }
  const ConferenceParticipantVideoView = /* @__PURE__ */ _export_sfc(_sfc_main$8, [["render", _sfc_render$7], ["__scopeId", "data-v-2a59d2e7"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/voip/conference/ConferenceParticipantVideoView.nvue"]]);
  const _imports_0 = "/static/image/av/av_conference_audio.png";
  const _imports_1 = "/static/image/av/av_conference_audio_mute.png";
  const _imports_6 = "/static/image/av/av_conference_handup.png";
  const _imports_7 = "/static/image/av/av_conference_handup_hover.png";
  const _imports_8 = "/static/image/av/av_conference_members.png";
  const _imports_9 = "/static/image/av/av_conference_end_call.png";
  const _sfc_main$7 = {
    name: "ConferencePage",
    data() {
      return {
        wfc: getApp().wfc,
        conferenceId: null,
        password: "",
        conferenceManager: getApp().conferenceManager,
        session: {},
        conferenceInfo: null,
        audioOnly: true,
        status: 1,
        selfUserInfo: null,
        // 包含自己
        participantUserInfos: [],
        startTimestamp: 0,
        currentTimestamp: 0,
        showSlider: false,
        showConversationView: false,
        videoInputDeviceIndex: 0,
        refreshUserInfoInternal: 0,
        endReason: void 0,
        // 宫格布局；0, 宫格视图；1，演讲者视图
        currentLayout: 0,
        // 宫格视图
        currentGridPageIndex: 0,
        participantCountPerGridPage: 9,
        // 演讲者视图
        speakingVideoParticipant: null,
        hideFocusLayoutParticipantListVideoView: false,
        showConferenceSimpleInfoView: false,
        showChooseLayoutView: false,
        alertDialogOptions: {}
      };
    },
    components: {
      ConferenceParticipantVideoView
    },
    onLoad(option) {
      formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:184", "voip/Conference onLoad", option);
      if (option.session) {
        this.session = JSON.parse(option.session);
        this.callState = Number(this.session.state);
        if (this.session.connectedTime) {
          this.startTimestamp = this.session.connectedTime;
        }
        this.conferenceInfo = this.conferenceManager.conferenceInfo;
      } else {
        this.$nextTick(() => {
          this.conferenceInfo = JSON.parse(option.conferenceInfo);
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:197", "conferencePage parameters", this.conferenceInfo, option.muteAudio, option.muteVideo);
          let muteAudio = option.muteAudio;
          let muteVideo = option.muteVideo;
          this.conferenceManager.setConferenceInfo(this.conferenceInfo);
          this.joinConference(this.conferenceInfo, muteAudio, muteVideo);
        });
      }
    },
    created() {
      let dom = weex.requireModule("dom");
      dom.addRule("fontFace", {
        fontFamily: "icomoon",
        //src: "url('file:/" + fontSrc + "')"
        src: "url('/static/iconfonts/icomoon/fonts/icomoon.ttf')"
      });
      this.refreshUserInfoInternal = setInterval(() => {
      }, 3 * 1e3);
      this.conferenceManager.setup(getApp(), this);
    },
    mounted() {
      if (this.callState === CallState.STATUS_CONNECTED) {
        this.setupParticipants();
        this.setupSessionCallback();
        this.onVoipConnected();
      }
    },
    methods: {
      profile2UserInfo(profile) {
        let userInfo = this.wfc.getUserInfo(profile.userId);
        userInfo._isAudience = profile.audience;
        userInfo._isHost = this.session.host === profile.userId;
        userInfo._isVideoMuted = profile.videoMuted;
        userInfo._isAudioMuted = profile.audioMuted;
        userInfo._volume = 0;
        userInfo._isScreenSharing = !!profile.screenSharing;
        return userInfo;
      },
      joinConference(conferenceInfo, muteAudio, muteVideo) {
        let audience = muteAudio && muteVideo;
        let audioOnly = false;
        let callExtra = "";
        formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:255", "join conference", conferenceInfo.conferenceId, audioOnly, conferenceInfo.pin, conferenceInfo.owner, conferenceInfo.conferenceTitle, "", audience, conferenceInfo.advance, muteAudio, muteVideo, callExtra);
        let session = self$2.joinConference(conferenceInfo.conferenceId, audioOnly, conferenceInfo.pin, conferenceInfo.owner, conferenceInfo.conferenceTitle, "", audience, conferenceInfo.advance, muteAudio, muteVideo, callExtra);
        if (session) {
          this.session = session;
          this.setupSessionCallback();
        } else {
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:262", "joinConference failed, session is null");
          uni.navigateBack({
            delta: 1,
            fail: (err) => {
              formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:266", "nav back from ConferencePage err", err);
            }
          });
        }
      },
      setupSessionCallback() {
        let sessionCallback = new CallSessionCallback();
        sessionCallback.didChangeState = (state) => {
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:276", "didChangeState", state);
          if (this.callState === state) {
            return;
          }
          this.callState = state;
          if (state === CallState.STATUS_CONNECTED) {
            this.onVoipConnected();
          } else if (state === CallState.STATUS_IDLE) {
            if (this.timer) {
              clearInterval(this.timer);
            }
          }
        };
        sessionCallback.didCreateLocalVideoTrack = (screenShare) => {
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:292", "didCreateLocalVideoTrack 00", screenShare);
        };
        sessionCallback.didRotateLocalVideoTrack = (stream) => {
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:298", "didRotateLocalVideoTrack", stream.getAudioTracks());
        };
        sessionCallback.didScreenShareEnded = () => {
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:302", "didScreenShareEnded", this.session.videoMuted, this.session.audioMuted);
        };
        sessionCallback.didCreateLocalVideoTrackError = () => {
        };
        sessionCallback.didReceiveRemoteVideoTrack = (userId, screenSharing) => {
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:314", "didReceiveRemoteVideoTrack", userId, screenSharing);
          for (let i2 = 0; i2 < this.participantUserInfos.length; i2++) {
            let p = this.participantUserInfos[i2];
            if (p.uid === userId && p._isScreenSharing === screenSharing) {
              p._isVideoMuted = false;
              break;
            }
          }
        };
        sessionCallback.didRemoveRemoteVideoTrack = (userId) => {
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:325", "didRemoveRemoteVideoTrack", userId);
        };
        sessionCallback.didParticipantJoined = (userId, screenSharing) => {
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:329", "didParticipantJoined", userId, screenSharing);
          let profile = self$2.getParticipantProfile(this.session.callId, userId, screenSharing);
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:331", "didParticipantJoined profile", profile);
          let userInfo = this.profile2UserInfo(profile);
          this.participantUserInfos.push(userInfo);
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:334", "joined", userInfo, profile.audience, this.participantUserInfos.length);
        };
        sessionCallback.didParticipantLeft = (userId, endReason, screenSharing) => {
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:338", "didParticipantLeft", userId, endReason, screenSharing, JSON.stringify(this.participantUserInfos), this.participantUserInfos.length);
          this.participantUserInfos = this.participantUserInfos.filter((p) => {
            return !(p.uid === userId && p._isScreenSharing === screenSharing);
          });
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:344", "didParticipantLeft d", userId, endReason, screenSharing, this.participantUserInfos.length);
        };
        sessionCallback.didCallEndWithReason = (reason) => {
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:348", "callEndWithReason", reason);
          this.conferenceManager.addHistory(this.conferenceManager.conferenceInfo, (/* @__PURE__ */ new Date()).getTime() - this.conferenceManager.conferenceInfo.startTime * 1e3);
          this.endReason = reason;
          if (reason === CallEndReason.REASON_MediaError) {
            return;
          }
          if (reason === CallEndReason.RoomNotExist) {
            formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:358", "join conference failed", reason, this.session);
            ({ reason, session: this.session });
          }
          this.conferenceManager.destroy();
          this.session = null;
        };
        sessionCallback.onRequestChangeMode = (audience) => {
        };
        sessionCallback.didChangeType = (userId, audience, screenSharing) => {
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:388", "didChangeType", userId, audience, screenSharing);
          let found = false;
          let profile = self$2.getParticipantProfile(this.session.callId, userId, screenSharing);
          if (this.selfUserInfo.uid === userId) {
            this.session.audience = audience;
            this.session.videoMuted = profile.videoMuted;
            this.session.audioMuted = profile.audioMuted;
          }
          for (const u of this.participantUserInfos) {
            if (u.uid === userId && u._isScreenSharing === screenSharing) {
              u._isAudience = audience;
              u._isVideoMuted = profile.videoMuted;
              u._isAudioMuted = profile.audioMuted;
              if (this.speakingVideoParticipant && this.speakingVideoParticipant.uid === u.uid) {
                this.speakingVideoParticipant = null;
              }
              found = true;
              break;
            }
          }
          if (!found) {
            let userInfo = this.profile2UserInfo(profile);
            this.participantUserInfos.push(userInfo);
          }
        };
        sessionCallback.didReportAudioVolume = (userId, volume) => {
          if (volume < 100) {
            return;
          }
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:418", "didReportAudioVolume", userId, volume);
          let userInfo;
          if (userId === this.selfUserInfo.uid) {
            this.selfUserInfo._volume = volume;
            userInfo = this.selfUserInfo;
          } else {
            this.participantUserInfos.forEach((u) => {
              if (u.uid === userId && u._isScreenSharing === false) {
                u._volume = volume;
                userInfo = u;
              }
            });
          }
          if (this.currentLayout === 0) {
            return;
          }
          if (userInfo._isVideoMuted) {
            return;
          }
          if (this.conferenceFocusUser) {
            return this.conferenceFocusUser;
          }
          if (!this.speakingVideoParticipant) {
            this.speakingVideoParticipant = userInfo;
          } else if (userInfo._volume > this.speakingVideoParticipant._volume) {
            this.speakingVideoParticipant = userInfo;
          }
        };
        sessionCallback.didMuteStateChanged = (participants) => {
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:451", "conference", "didMuteStateChanged", participants);
          participants.forEach((p) => {
            let profile = self$2.getParticipantProfile(this.session.callId, p, false);
            if (!profile) {
              return;
            }
            formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:457", "conference", "didMuteStateChanged", p, profile, profile.videoMuted, profile.audioMuted);
            this.participantUserInfos.forEach((u) => {
              if (u.uid === p && !u._isScreenSharing) {
                u._isVideoMuted = profile.videoMuted;
                u._isAudioMuted = profile.audioMuted;
                if (this.speakingVideoParticipant && this.speakingVideoParticipant.uid === u.uid) {
                  this.speakingVideoParticipant = null;
                }
              }
              if (profile.userId === this.selfUserInfo.uid) {
                this.session.videoMuted = profile.videoMuted;
                this.session.audioMuted = profile.audioMuted;
              }
            });
          });
        };
        sessionCallback.didMediaLostPacket = (media, lostPacket, screenSharing) => {
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:477", "didMediaLostPacket", media, lostPacket, screenSharing);
          if (lostPacket > 6) {
            formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:479", "您的网络不好");
          }
        };
        sessionCallback.didUserMediaLostPacket = (userId, media, lostPacket, uplink, screenSharing) => {
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:484", "didUserMediaLostPacket", userId, media, lostPacket, uplink, screenSharing);
          if (lostPacket > 10) {
            if (uplink) {
              let userInfos = this.participantUserInfos.filter((u) => u.uid === userId && u._isScreenSharing === screenSharing);
              if (userInfos && userInfos.length > 0) {
                formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:491", userInfos[0].displayName, "网络不好");
              }
            } else {
              formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:494", "您的网络不好");
            }
          }
        };
        getApp().avengineKit.sessionCallback = sessionCallback;
      },
      showAlertDialog(options) {
        this.alertDialogOptions = {
          cancelText: options.cancelText,
          confirmText: options.confirmText,
          title: options.title,
          content: options.content,
          onConfirm: () => {
            options.onConfirm && options.onConfirm();
          },
          onClose: () => {
            options.onClose && options.onClose();
            this.alertDialogOptions = {};
          }
        };
        this.$refs.alertDialog.open();
      },
      hangup() {
        self$2.leaveConference(this.session.callId, false);
        this.session = null;
        this.conferenceManager.destroy();
        uni.navigateBack({
          delta: 1,
          fail: (err) => {
            formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:527", "nav back from ConferencePage err", err);
          }
        });
      },
      muteAudio() {
        let enable = this.session.audioMuted ? true : false;
        if (enable && this.session.audience && !this.conferenceManager.isOwner() && !this.conferenceManager.conferenceInfo.allowSwitchMode) {
          this.requestUnmute(true);
          return;
        }
        this.enableAudio(enable);
      },
      // fixme
      // 这个这个方法应当叫 setAudioEnable，参数也是enable audio 的意思
      async enableAudio(enable) {
        self$2.muteAudio(this.session.callId, !enable);
        formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:546", "enableAudio", this.selfUserInfo._isAudioMuted, this.session.audience, enable);
        if (enable) {
          if (this.session.audience) {
            self$2.switchAudience(this.session.callId, false);
          }
        } else {
          if (this.session.videoMuted && !this.session.audience) {
            self$2.switchAudience(this.session.callId, true);
          }
        }
      },
      muteVideo() {
        let enable = this.session.videoMuted ? true : false;
        formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:567", "muteVideo", this.session, this.session.videoMuted, this.session.audience);
        if (enable && this.session.audience && !this.conferenceManager.isOwner() && !this.conferenceManager.conferenceInfo.allowSwitchMode) {
          this.requestUnmute(false);
          return;
        }
        this.enableVideo(enable);
      },
      async enableVideo(enable) {
        formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:576", "enableVideo", !enable);
        self$2.muteVideo(this.session.callId, !enable);
        if (enable) {
          if (this.session.audience) {
            let result = self$2.switchAudience(this.session.callId, false);
            formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:582", "switchAudience ", false, result);
          }
        } else {
          if (this.session.audioMuted && !this.session.audience) {
            let result = self$2.switchAudience(this.session.callId, true);
            formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:591", "switchAudience ", true, result);
          }
        }
        formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:598", "_muteVideo", this.selfUserInfo, this.participantUserInfos);
      },
      requestUnmute(audio) {
        this.alert({
          title: "提示",
          content: "主持人不允许解除静音，您可以向主持人申请解除静音",
          confirmText: "申请",
          onClose: () => {
          },
          onConfirm: () => {
            this.conferenceManager.applyUnmute(audio, false);
          }
        });
      },
      members() {
        uni.navigateTo({
          url: "/pages/voip/conference/ConferenceManagePage",
          success: () => {
            formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:623", "nav to ConferenceManagePage success");
          },
          fail: (err) => {
            formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:627", "nav to ConferenceManagePage err", err);
          }
        });
      },
      chat() {
        let conversation2 = new Conversation(ConversationType.ChatRoom, this.session.callId, 0);
        getApp().store.setCurrentConversation(conversation2);
        let chatroomInfo = new ChatRoomInfo();
        chatroomInfo.chatRoomId = this.session.callId;
        chatroomInfo.title = this.conferenceInfo.conferenceTitle;
        chatroomInfo._displayName = this.conferenceInfo.conferenceTitle;
        getApp().store.state.conversation.currentConversationInfo.conversation._target = chatroomInfo;
        uni.navigateTo({
          url: "/pages/conversation/ConversationPage",
          success: () => {
            formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:645", "nav to conversationPage success");
          },
          fail: (err) => {
            formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:649", "nav to conversationPage err", err);
          }
        });
      },
      toggleSliderView() {
      },
      async screenShare() {
      },
      // 设置音频输出设备
      setAudioOutputDeviceId(deviceId) {
        let audioEls = this.$el.getElementsByTagName("audio");
        for (const audioEl of audioEls) {
          audioEl.setSinkId(deviceId);
        }
        let videoEls = this.$el.getElementsByTagName("video");
        for (const videoEl of videoEls) {
          videoEl.setSinkId(deviceId);
        }
      },
      handup() {
        this.conferenceManager.handUp(!this.conferenceManager.isHandUp);
      },
      userName(user) {
        let name = "";
        if (user.groupAlias) {
          name = user.groupAlias;
        } else if (user.friendAlias) {
          name = user.friendAlias;
        } else if (user.displayName) {
          name = user.displayName;
        } else {
          name = user.name;
        }
        return name;
      },
      setupParticipants() {
        this.participantUserInfos.length = 0;
        let selfProfile = self$2.getMyProfile(this.session.callId);
        let selfUserInfo = this.profile2UserInfo(selfProfile);
        formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:756", "selfProfile", selfProfile);
        this.selfUserInfo = selfUserInfo;
        this.participantUserInfos.push(selfUserInfo);
        let participantProfiles = self$2.getParticipantProfiles(this.session.callId);
        formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:761", "participantProfiles", participantProfiles);
        for (const p of participantProfiles) {
          let userInfo = this.profile2UserInfo(p);
          this.participantUserInfos.push(userInfo);
        }
      },
      onVoipConnected() {
        this.setupParticipants();
        if (!this.timer) {
          if (!this.startTimestamp) {
            this.startTimestamp = (/* @__PURE__ */ new Date()).getTime();
          }
          this.timer = setInterval(() => {
            this.currentTimestamp = (/* @__PURE__ */ new Date()).getTime();
          }, 1e3);
        }
      },
      timestampFormat(timestamp) {
        timestamp = ~~(timestamp / 1e3);
        let str = "";
        let hour = ~~(timestamp / 3600);
        str = hour > 0 ? (hour < 10 ? "0" : "") + hour + ":" : "";
        let min = ~~(timestamp % 3600 / 60);
        str += (min < 10 ? "0" : "") + min + ":";
        let sec = ~~(timestamp % 60);
        str += (sec < 10 ? "0" : "") + sec;
        return str;
      },
      minimize() {
        let granted = getApp().avengineKit.checkOverlayPermission();
        formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:794", "overlayPermission granted", granted);
        if (granted) {
          getApp().avengineKit.minimize(this.session.callId);
          uni.navigateBack({
            delta: 1,
            fail: (err) => {
              formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:800", "nav back to err", err);
            }
          });
        } else {
          uni.showToast({
            title: "需要悬浮窗权限",
            icon: "none"
          });
        }
      },
      prePage() {
        this.currentGridPageIndex--;
        if (this.currentGridPageIndex < 0) {
          this.currentGridPageIndex = Math.ceil(this.participantUserInfos.length / this.participantCountPerGridPage) - 1;
        }
      },
      nextPage() {
        if (this.participantUserInfos.length / this.participantCountPerGridPage > this.currentGridPageIndex + 1) {
          this.currentGridPageIndex++;
        } else {
          this.currentGridPageIndex = 0;
        }
      },
      updateCountPerPage(count) {
        this.participantCountPerGridPage = count;
      },
      setCurrentLayout(layout) {
        if (this.currentLayout === layout) {
          return;
        }
        if (layout === 1) {
          this.participantUserInfos.forEach((u) => {
            if (u.uid !== this.selfUserInfo.uid && !u._isAudience && !u._isVideoMuted) {
              self$2.setParticipantVideoType(this.session.callId, u.uid, u._isScreenSharing, VideoType.SMALL_STREAM);
            }
          });
        } else {
          this.currentGridPageIndex = 0;
          this.conferenceManager.currentFocusUser = null;
        }
        this.currentLayout = layout;
        this.showChooseLayoutView = false;
      },
      toggleParticipantListVideoView() {
        this.hideFocusLayoutParticipantListVideoView = !this.hideFocusLayoutParticipantListVideoView;
      },
      hideConferenceSimpleInfoView(event) {
        if (event.target.id === "info-icon") {
          return;
        }
        this.showConferenceSimpleInfoView = false;
      },
      hideChooseLayoutView(event) {
        if (event.target.id === "grid-icon") {
          return;
        }
        this.showChooseLayoutView = false;
      },
      alert(options) {
        formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:868", "alert", options);
        this.showAlertDialog(options);
      }
    },
    computed: {
      duration() {
        if (this.currentTimestamp <= 0) {
          return "00:00";
        }
        let escapeMillis = this.currentTimestamp - this.startTimestamp;
        return this.timestampFormat(escapeMillis);
      },
      speakingUserName() {
        if (!this.selfUserInfo) {
          return "";
        }
        let maxVolume = this.selfUserInfo._volume;
        let speakingUserInfo = this.selfUserInfo;
        this.participantUserInfos.forEach((u) => {
          if (u._volume > maxVolume) {
            speakingUserInfo = u;
            maxVolume = u._volume;
          }
        });
        if (!maxVolume) {
          return "";
        }
        return this.userName(speakingUserInfo);
      },
      currentPageParticipants() {
        if (this.currentLayout === 1) {
          return [];
        }
        let focusUser = this.conferenceFocusUser;
        let sortedParticipantUserInfos = [...this.participantUserInfos].sort((o1, o2) => {
          if (focusUser) {
            if (o1.uid === focusUser.uid && o1._isScreenSharing === focusUser._isScreenSharing) {
              return -1;
            }
            if (o2.uid === focusUser.uid && o2._isScreenSharing === focusUser._isScreenSharing) {
              return 1;
            }
          }
          if (o1._isAudience && !o2._isAudience) {
            return 1;
          } else if (!o1._isAudience && o2._isAudience) {
            return -1;
          } else if (o1._isAudience && o2._isAudience) {
            return o1.uid.localeCompare(o2.uid);
          } else {
            if (o1._isScreenSharing && !o2._isScreenSharing) {
              return -1;
            }
            if (!o1._isScreenSharing && o2._isScreenSharing) {
              return 1;
            }
            if (!o1._isVideoMuted && o2._isVideoMuted) {
              return -1;
            }
            if (o1._isVideoMuted && !o2._isVideoMuted) {
              return 1;
            }
            return o1.uid.localeCompare(o2.uid);
          }
        });
        let start = this.currentGridPageIndex * this.participantCountPerGridPage;
        let end = start + this.participantCountPerGridPage > sortedParticipantUserInfos.length ? sortedParticipantUserInfos.length : start + this.participantCountPerGridPage;
        return sortedParticipantUserInfos.slice(start, end);
      },
      gridPageCount() {
        return Math.ceil(this.participantUserInfos.length / this.participantCountPerGridPage);
      },
      conferenceFocusUser() {
        let focus = this.conferenceManager.conferenceInfo.focus;
        if (!focus) {
          return null;
        }
        let focusUser = this.participantUserInfos.find((u) => u.uid === focus && u._isScreenSharing === true);
        if (!focusUser) {
          focusUser = this.participantUserInfos.find((u) => u.uid === focus);
        }
        return focusUser;
      },
      conferenceLocalFocusUser() {
        return this.conferenceManager.localFocusUser;
      },
      // 以用户手动选择的为准
      computedCurrentLayout() {
        if (this.currentLayout === -1 && this.conferenceFocusUser) {
          return 0;
        }
        return this.currentLayout;
      },
      // TODO 可以缓存到 conferenceManager 里面
      computedFocusVideoParticipant() {
        if (this.currentLayout === 0) {
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:993", "computedSpeakingParticipant null");
          return null;
        }
        let sp;
        if (this.conferenceFocusUser && !this.conferenceFocusUser._isVideoMuted) {
          sp = this.conferenceFocusUser;
        } else if (this.conferenceLocalFocusUser && !this.conferenceLocalFocusUser._isVideoMuted) {
          sp = this.conferenceLocalFocusUser;
        } else if (this.speakingVideoParticipant) {
          sp = this.speakingVideoParticipant;
        } else {
          sp = this.participantUserInfos.find((u) => !u._isAudience && !u._isVideoMuted && u._isScreenSharing === true);
          if (!sp) {
            sp = this.participantUserInfos.find((u) => !u._isAudience && !u._isVideoMuted);
          }
        }
        formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:1010", "computedFocusVideoParticipant", this.conferenceManager.currentFocusUser);
        if (this.conferenceManager.currentFocusUser) {
          self$2.setParticipantVideoType(this.session.callId, this.conferenceManager.currentFocusUser.uid, this.conferenceManager.currentFocusUser._isScreenSharing, VideoType.SMALL_STREAM);
        }
        if (sp) {
          this.conferenceManager.currentFocusUser = sp;
          self$2.setParticipantVideoType(this.session.callId, this.conferenceManager.currentFocusUser.uid, this.conferenceManager.currentFocusUser._isScreenSharing, VideoType.BIG_STREAM);
        } else {
          if (this.session.screenSharing) {
            sp = this.selfUserInfo;
          }
        }
        formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:1022", "computedSpeakingParticipant", sp);
        return sp;
      }
    },
    watch: {
      participantUserInfos: {
        deep: true,
        handler(infos) {
          let audioOnly = true;
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:1032", "watchParticipantUserInfos");
          if (this.session.screenSharing) {
            audioOnly = false;
          } else {
            for (let i2 = 0; i2 < this.participantUserInfos.length; i2++) {
              let u = this.participantUserInfos[i2];
              if (!u._isAudience && !u._isVideoMuted) {
                formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:1040", "audioOnly false", u, u._isAudience, u._isVideoMuted);
                audioOnly = false;
                break;
              }
            }
          }
          this.audioOnly = audioOnly;
          formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:1047", "audioOly ", audioOnly);
          this.wfc.eventEmitter.emit("conferenceParticipantUpdated", "");
        }
      }
    },
    directives: {},
    onBackPress(event) {
      formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:1057", "conferencePage, onBackPress", event);
      if (event.from === "navigateBack") {
        return false;
      }
      return true;
    },
    beforeUnmount() {
      formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:1067", "conferencePage, beforeUnmount");
    },
    onShow() {
      formatAppLog("log", "at pages/voip/conference/ConferencePage.nvue:1071", "conferencePage, onShow");
    },
    unmounted() {
      clearInterval(this.refreshUserInfoInternal);
    }
  };
  function _sfc_render$6(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_ConferenceParticipantVideoView = vue.resolveComponent("ConferenceParticipantVideoView");
    const _component_uni_popup_dialog = resolveEasycom(vue.resolveDynamicComponent("uni-popup-dialog"), __easycom_1);
    const _component_uni_popup = resolveEasycom(vue.resolveDynamicComponent("uni-popup"), __easycom_2);
    return vue.openBlock(), vue.createElementBlock(
      "div",
      {
        style: { "flex": "1", "display": "flex", "flex-direction": "column" },
        ref: "rootContainer"
      },
      [
        $data.session ? (vue.openBlock(), vue.createElementBlock("div", {
          key: 0,
          class: "main-slider-container",
          style: { "display": "flex", "flex": "1" }
        }, [
          vue.createCommentVNode("main"),
          vue.createCommentVNode("video"),
          !$data.audioOnly ? (vue.openBlock(), vue.createElementBlock("div", {
            key: 0,
            style: { "width": "750rpx", "flex": "1", "position": "relative" }
          }, [
            vue.createCommentVNode("                    宫格布局"),
            vue.createElementVNode("section", { class: "content-container grid" }, [
              vue.createCommentVNode("participants include self"),
              (vue.openBlock(true), vue.createElementBlock(
                vue.Fragment,
                null,
                vue.renderList($options.currentPageParticipants, (participant) => {
                  return vue.openBlock(), vue.createBlock(_component_ConferenceParticipantVideoView, {
                    key: participant.uid + "-" + participant._isScreenSharing,
                    participant,
                    currentPageParticipants: $options.currentPageParticipants,
                    "self-user-info": $data.selfUserInfo,
                    session: $data.session
                  }, null, 8, ["participant", "currentPageParticipants", "self-user-info", "session"]);
                }),
                128
                /* KEYED_FRAGMENT */
              ))
            ]),
            $options.computedCurrentLayout === 0 && $data.currentGridPageIndex > 0 ? (vue.openBlock(), vue.createElementBlock("text", {
              key: 0,
              style: { "position": "absolute", "top": "300px", "left": "0", "color": "#c8cacc", "z-index": "1000", "font-size": "40px", "padding": "0 10px" },
              class: "iconfont icon-ion-arrow-left-c",
              onClick: _cache[0] || (_cache[0] = (...args) => $options.prePage && $options.prePage(...args))
            }, " ")) : vue.createCommentVNode("v-if", true),
            $options.computedCurrentLayout === 0 && $data.currentGridPageIndex < $options.gridPageCount - 1 ? (vue.openBlock(), vue.createElementBlock("text", {
              key: 1,
              style: { "position": "absolute", "top": "300px", "right": "0", "color": "#c8cacc", "z-index": "1000", "font-size": "40px", "padding": "0 10px" },
              class: "iconfont icon-ion-arrow-right-c",
              onClick: _cache[1] || (_cache[1] = (...args) => $options.nextPage && $options.nextPage(...args))
            }, " ")) : vue.createCommentVNode("v-if", true)
          ])) : (vue.openBlock(), vue.createElementBlock(
            vue.Fragment,
            { key: 1 },
            [
              vue.createCommentVNode("audio"),
              vue.createElementVNode("div", { style: { "width": "750rpx", "flex": "1" } }, [
                vue.createElementVNode("section", { class: "content-container audio" }, [
                  vue.createCommentVNode("participants"),
                  (vue.openBlock(true), vue.createElementBlock(
                    vue.Fragment,
                    null,
                    vue.renderList($data.participantUserInfos, (participant) => {
                      return vue.openBlock(), vue.createElementBlock("div", {
                        key: participant.uid,
                        style: { "position": "relative" },
                        class: "participant-audio-item"
                      }, [
                        vue.createElementVNode("div", { style: { "position": "relative" } }, [
                          vue.createElementVNode("image", {
                            class: vue.normalizeClass(["avatar", { highlight: participant._volume > 0 }]),
                            src: participant.portrait,
                            alt: participant
                          }, null, 10, ["src", "alt"]),
                          participant._isHost ? (vue.openBlock(), vue.createElementBlock("text", {
                            key: 0,
                            class: "indicator iconfont icon-ion-person",
                            style: { "background": "#FD802E" }
                          }, "")) : vue.createCommentVNode("v-if", true),
                          participant._isAudience ? (vue.openBlock(), vue.createElementBlock("text", {
                            key: 1,
                            class: "indicator iconfont icon-ion-ios-mic-off",
                            style: { "color": "red" }
                          }, "")) : vue.createCommentVNode("v-if", true)
                        ]),
                        vue.createElementVNode(
                          "text",
                          { class: "desc" },
                          vue.toDisplayString($options.userName(participant)),
                          1
                          /* TEXT */
                        )
                      ]);
                    }),
                    128
                    /* KEYED_FRAGMENT */
                  ))
                ]),
                vue.createElementVNode("div", { style: { "height": "50px", "width": "750rpx", "position": "absolute", "left": "0", "top": "70px", "display": "flex", "justify-content": "center", "align-items": "center" } }, [
                  vue.createElementVNode("div", { style: { "background": "gray", "width": "300px", "height": "40px", "padding": "0 5px", "border-radius": "3px", "display": "flex", "flex-direction": "column", "justify-content": "center" } }, [
                    vue.createElementVNode(
                      "text",
                      { class: "desc" },
                      vue.toDisplayString("正在讲话: " + $options.speakingUserName),
                      1
                      /* TEXT */
                    )
                  ])
                ])
              ])
            ],
            2112
            /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */
          )),
          vue.createCommentVNode("actions"),
          vue.createElementVNode("div", { class: "duration-action-container" }, [
            vue.createCommentVNode("v-if", true),
            vue.createElementVNode("div", { class: "action-container" }, [
              vue.createElementVNode("div", { class: "action" }, [
                !$data.session.audience && !$data.session.audioMuted ? (vue.openBlock(), vue.createElementBlock("image", {
                  key: 0,
                  onClick: _cache[2] || (_cache[2] = (...args) => $options.muteAudio && $options.muteAudio(...args)),
                  class: "action-img",
                  src: _imports_0
                })) : (vue.openBlock(), vue.createElementBlock("image", {
                  key: 1,
                  onClick: _cache[3] || (_cache[3] = (...args) => $options.muteAudio && $options.muteAudio(...args)),
                  class: "action-img",
                  src: _imports_1
                })),
                vue.createElementVNode("p", null, "静音")
              ]),
              !$data.session.screenSharing ? (vue.openBlock(), vue.createElementBlock("div", {
                key: 0,
                class: "action"
              }, [
                !$data.session.audience && !$data.session.videoMuted ? (vue.openBlock(), vue.createElementBlock("image", {
                  key: 0,
                  onClick: _cache[4] || (_cache[4] = (...args) => $options.muteVideo && $options.muteVideo(...args)),
                  class: "action-img",
                  src: _imports_2
                })) : (vue.openBlock(), vue.createElementBlock("image", {
                  key: 1,
                  onClick: _cache[5] || (_cache[5] = (...args) => $options.muteVideo && $options.muteVideo(...args)),
                  class: "action-img",
                  src: _imports_3
                })),
                vue.createElementVNode("p", null, "视频")
              ])) : vue.createCommentVNode("v-if", true),
              vue.createCommentVNode("v-if", true),
              vue.createElementVNode("div", {
                class: "action",
                onClick: _cache[8] || (_cache[8] = (...args) => $options.chat && $options.chat(...args))
              }, [
                vue.createElementVNode(
                  "text",
                  {
                    class: "iconfont icon-ion-ios-chatboxes",
                    style: vue.normalizeStyle([{ "width": "40px", "height": "40px", "font-size": "40px", "color": "black" }, { color: $data.showConversationView ? "white" : "black" }])
                  },
                  " ",
                  4
                  /* STYLE */
                ),
                vue.createElementVNode("p", null, "聊天")
              ]),
              $data.selfUserInfo && $data.selfUserInfo.uid !== $data.conferenceManager.conferenceInfo.owner ? (vue.openBlock(), vue.createElementBlock("div", {
                key: 2,
                class: "action"
              }, [
                !$data.conferenceManager.isHandUp ? (vue.openBlock(), vue.createElementBlock("image", {
                  key: 0,
                  onClick: _cache[9] || (_cache[9] = (...args) => $options.handup && $options.handup(...args)),
                  class: "action-img",
                  src: _imports_6
                })) : (vue.openBlock(), vue.createElementBlock("image", {
                  key: 1,
                  onClick: _cache[10] || (_cache[10] = (...args) => $options.handup && $options.handup(...args)),
                  class: "action-img",
                  src: _imports_7
                })),
                vue.createElementVNode("p", { class: "single-line" }, "举手")
              ])) : vue.createCommentVNode("v-if", true),
              vue.createElementVNode("div", { class: "action" }, [
                vue.createElementVNode("image", {
                  onClick: _cache[11] || (_cache[11] = vue.withModifiers((...args) => $options.members && $options.members(...args), ["stop"])),
                  class: "action-img",
                  src: _imports_8
                }),
                vue.createElementVNode("p", null, "管理")
              ]),
              vue.createElementVNode("div", { class: "action" }, [
                vue.createElementVNode("image", {
                  onClick: _cache[12] || (_cache[12] = (...args) => $options.hangup && $options.hangup(...args)),
                  class: "action-img",
                  src: _imports_9
                }),
                vue.createElementVNode("p", null, "结束")
              ])
            ])
          ]),
          vue.createElementVNode("div", { class: "voip-title-container" }, [
            vue.createElementVNode("div", { class: "title" }, [
              (vue.openBlock(), vue.createElementBlock(
                "text",
                {
                  key: 0,
                  class: "desc"
                },
                vue.toDisplayString($options.duration),
                1
                /* TEXT */
              ))
            ]),
            vue.createElementVNode("image", {
              onClick: _cache[13] || (_cache[13] = (...args) => $options.minimize && $options.minimize(...args)),
              style: { "width": "30px", "height": "30px" },
              src: _imports_10
            })
          ])
        ])) : vue.createCommentVNode("v-if", true),
        vue.createVNode(
          _component_uni_popup,
          {
            ref: "alertDialog",
            type: "dialog"
          },
          {
            default: vue.withCtx(() => [
              vue.createVNode(_component_uni_popup_dialog, {
                cancelText: $data.alertDialogOptions.cancelText,
                confirmText: $data.alertDialogOptions.confirmText,
                title: $data.alertDialogOptions.title,
                onConfirm: $data.alertDialogOptions.onConfirm,
                onClose: $data.alertDialogOptions.onClose
              }, null, 8, ["cancelText", "confirmText", "title", "onConfirm", "onClose"])
            ]),
            _: 1
            /* STABLE */
          },
          512
          /* NEED_PATCH */
        )
      ],
      512
      /* NEED_PATCH */
    );
  }
  const PagesVoipConferenceConferencePage = /* @__PURE__ */ _export_sfc(_sfc_main$7, [["render", _sfc_render$6], ["__scopeId", "data-v-b3fbeb70"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/voip/conference/ConferencePage.nvue"]]);
  const _sfc_main$6 = {
    name: "ConferenceParticipantListView",
    props: {
      participants: {
        type: Array,
        required: true
      },
      session: {
        type: Object,
        required: true
      }
    },
    data() {
      return {
        conferenceManager: self$1,
        selfUserId: self$1.selfUserId,
        isContextMenuShow: false,
        currentParticipant: {},
        contextMenuItems: [],
        contextMenuX: 0,
        contextMenuY: 0,
        alertDialogOptions: {}
      };
    },
    mounted() {
    },
    components: {},
    methods: {
      invite() {
        let defaultAudience = false;
        let callSession = this.session;
        let conferenceInfo = self$1.conferenceInfo;
        let inviteMessageContent = new ConferenceInviteMessageContent(callSession.callId, conferenceInfo.owner, conferenceInfo.conferenceTitle, callSession.desc, callSession.startTime, callSession.audioOnly, defaultAudience, callSession.advance, callSession.pin);
        formatAppLog("log", "at pages/voip/conference/ConferenceParticipantListView.vue:88", "invite", inviteMessageContent, callSession, conferenceInfo);
        let message2 = new Message(null, inviteMessageContent);
        this.$forward({
          forwardType: ForwardType.NORMAL,
          messages: [message2]
        });
        this.showParticipantList = false;
      },
      requestChangeMode(user) {
        if (user.uid === this.selfUserInfo.uid) {
          return;
        }
        this.showAlertDialog({
          content: user._isAudience ? `邀请${this.participantName(user)}参与互动?` : `取消${this.participantName(user)}参与互动?`,
          onClose: () => {
          },
          onConfirm: () => {
            this.session.requestChangeMode(user.uid, !user._isAudience);
          }
        });
      },
      kickoff(user) {
        this.showAlertDialog({
          showIcon: true,
          content: `确认将${this.participantName(user)}移除会议?`,
          onClose: () => {
          },
          onConfirm: () => {
            self$2.kickoffParticipant(this.session.callId, user.uid);
          }
        });
      },
      participantName(user) {
        let name = "";
        if (user.groupAlias) {
          name = user.groupAlias;
        } else if (user.friendAlias) {
          name = user.friendAlias;
        } else if (user.displayName) {
          name = user.displayName;
        } else {
          name = user.name;
        }
        return name;
      },
      participantDesc(user) {
        let desc = "";
        if (user.uid === self$1.selfUserId) {
          desc = "我";
          if (user.uid === self$1.conferenceInfo.owner) {
            desc += "、主持人";
          }
        } else if (user.uid === self$1.conferenceInfo.owner) {
          desc = "主持人";
        } else if (user._isScreenSharing) {
          desc = "屏幕共享";
        }
        return desc;
      },
      // fixme
      // TODO 操作之后，需要更新participant
      buildParticipantContextMenu(participant) {
        let selfUid = self$1.selfUserId;
        let items = [];
        if (!participant) {
          return items;
        }
        items.push({
          title: "查看用户信息",
          tag: "aa",
          handler: () => {
            this.showUserCard(participant);
          }
        });
        if (selfUid === participant.uid) {
          if (participant._isAudience) {
            if (participant._isAudioMuted) {
              items.push({
                title: "开启音频",
                handler: () => {
                  self$2.switchAudience(false);
                  self$2.muteAudio(false);
                }
              });
            }
            if (participant._isVideoMuted) {
              items.push({
                title: "开启视频",
                handler: () => {
                  self$2.switchAudience(false);
                  self$2.muteVideo(false);
                }
              });
            }
          } else {
            if (!participant._isAudioMuted) {
              items.push({
                title: "关闭音频",
                handler: () => {
                  self$2.muteAudio(true);
                  if (participant._isVideoMuted) {
                    self$2.switchAudience(true);
                  }
                },
                styleObject: {
                  color: "red"
                }
              });
            }
            if (!participant._isVideoMuted) {
              items.push({
                title: "关闭视频",
                handler: () => {
                  self$2.muteVideo(true);
                  if (participant._isAudioMuted) {
                    self$2.switchAudience(true);
                  }
                },
                styleObject: {
                  color: "red"
                }
              });
            }
            if (!participant._isVideoMuted && !participant._isAudioMuted) {
              items.push({
                title: "关闭音视频",
                handler: () => {
                  self$2.muteAudio(true);
                  self$2.muteVideo(true);
                  self$2.switchAudience(true);
                },
                styleObject: {
                  color: "red"
                }
              });
            }
          }
        }
        if (selfUid === self$1.conferenceInfo.owner) {
          if (participant.uid !== selfUid) {
            if (participant._isAudience || participant._isAudioMuted) {
              items.push({
                title: "邀请发言",
                handler: () => {
                  self$1.requestMemberMute(participant.uid, true, false);
                }
              });
            } else if (!participant._isAudience && !participant._isAudioMuted) {
              items.push({
                title: "取消发言",
                handler: () => {
                  self$1.requestMemberMute(participant.uid, true, true);
                }
              });
            }
            if (participant._isAudience || participant._isVideoMuted) {
              items.push({
                title: "邀请打开摄像头",
                handler: () => {
                  self$1.requestMemberMute(participant.uid, false, false);
                }
              });
            } else if (!participant._isAudience && !participant._isVideoMuted) {
              items.push({
                title: "关闭摄像头",
                handler: () => {
                  self$1.requestMemberMute(participant.uid, false, true);
                }
              });
            }
          }
          if (participant.uid !== selfUid) {
            items.push({
              title: " 移除成员",
              handler: () => {
                this.kickoff(participant);
              }
            });
          }
          if (self$1.conferenceInfo.focus === participant.uid) {
            items.push({
              title: "取消焦点用户",
              handler: () => {
                self$1.requestCancelFocus();
              }
            });
          } else {
            items.push({
              title: "设置为焦点用户",
              handler: () => {
                self$1.requestFocus(participant.uid);
              }
            });
          }
        }
        this.contextMenuItems.length = 0;
        this.contextMenuItems.push(...items);
      },
      showContextMenu(event, participant) {
        if (this.isContextMenuShow) {
          this.$refs.menu.close();
          this.isContextMenuShow = false;
          this.currentParticipant = {};
          return;
        }
        this.buildParticipantContextMenu(participant);
        this.contextMenuX = event.touches[0].clientX;
        this.contextMenuY = event.touches[0].clientY;
        this.isContextMenuShow = true;
        this.currentParticipant = participant;
      },
      showUserCard(p) {
      },
      onContextMenuItemSelect(item) {
        formatAppLog("log", "at pages/voip/conference/ConferenceParticipantListView.vue:334", "onContextMenuItemSelect", item);
        item.handler && item.handler();
      },
      showAlertDialog(options) {
        this.alertDialogOptions = {
          cancelText: options.cancelText,
          confirmText: options.confirmText,
          title: options.title,
          content: options.content,
          onConfirm: () => {
            options.onConfirm && options.onConfirm();
          },
          onClose: () => {
            options.onClose && options.onClose();
            this.alertDialogOptions = {};
          }
        };
        this.$refs.alertDialog.open();
      }
    }
  };
  function _sfc_render$5(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_chunLei_popups = resolveEasycom(vue.resolveDynamicComponent("chunLei-popups"), __easycom_0$1);
    const _component_uni_popup_dialog = resolveEasycom(vue.resolveDynamicComponent("uni-popup-dialog"), __easycom_1);
    const _component_uni_popup = resolveEasycom(vue.resolveDynamicComponent("uni-popup"), __easycom_2);
    return vue.openBlock(), vue.createElementBlock(
      "div",
      {
        class: "participant-list-container",
        ref: "rootContainer"
      },
      [
        (vue.openBlock(), vue.createElementBlock("div", {
          key: 0,
          onClick: _cache[0] || (_cache[0] = (...args) => $options.invite && $options.invite(...args)),
          class: "action-item"
        }, [
          vue.createElementVNode("div", { class: "icon" }, "+"),
          vue.createElementVNode("p", null, "邀请新参与者")
        ])),
        vue.createCommentVNode("v-if", true),
        vue.createElementVNode("ul", null, [
          (vue.openBlock(true), vue.createElementBlock(
            vue.Fragment,
            null,
            vue.renderList($props.participants, (participant) => {
              return vue.openBlock(), vue.createElementBlock("li", {
                key: participant.uid + participant._isScreenSharing
              }, [
                vue.createElementVNode("div", {
                  class: vue.normalizeClass(["participant-user", { active: participant.uid === $data.currentParticipant.uid && participant._isScreenSharing === $data.currentParticipant._isScreenSharing }]),
                  onClick: vue.withModifiers(($event) => $options.showContextMenu($event, participant), ["stop", "prevent"]),
                  ref_for: true,
                  ref: "userCardTippy-" + participant.uid,
                  name: "user-" + participant.uid
                }, [
                  vue.createElementVNode("div", { class: "avatar-container" }, [
                    vue.createElementVNode("image", {
                      class: "avatar",
                      src: participant.portrait,
                      alt: ""
                    }, null, 8, ["src"]),
                    $data.selfUserId === $props.session.host && !participant._isHost ? (vue.openBlock(), vue.createElementBlock("div", {
                      key: 0,
                      onClick: vue.withModifiers(($event) => $options.kickoff(participant), ["stop"]),
                      class: "icon"
                    }, " - ", 8, ["onClick"])) : vue.createCommentVNode("v-if", true)
                  ]),
                  vue.createElementVNode("div", { class: "name-desc" }, [
                    vue.createElementVNode(
                      "p",
                      { class: "single-line name" },
                      vue.toDisplayString($options.participantName(participant)),
                      1
                      /* TEXT */
                    ),
                    vue.createElementVNode(
                      "p",
                      { class: "single-line desc" },
                      vue.toDisplayString($options.participantDesc(participant)),
                      1
                      /* TEXT */
                    )
                  ]),
                  vue.createElementVNode("div", { class: "audio-video" }, [
                    participant._isAudience || participant._isAudioMuted ? (vue.openBlock(), vue.createElementBlock("i", {
                      key: 0,
                      class: "icon-ion-ios-mic-outline",
                      style: { "color": "gray" }
                    })) : (vue.openBlock(), vue.createElementBlock("i", {
                      key: 1,
                      class: "icon-ion-ios-mic"
                    })),
                    participant._isAudience || participant._isVideoMuted ? (vue.openBlock(), vue.createElementBlock("i", {
                      key: 2,
                      class: "icon-ion-ios-videocam-outline",
                      style: { "color": "gray" }
                    })) : (vue.openBlock(), vue.createElementBlock("i", {
                      key: 3,
                      class: "icon-ion-ios-videocam"
                    }))
                  ])
                ], 10, ["onClick", "name"])
              ]);
            }),
            128
            /* KEYED_FRAGMENT */
          ))
        ]),
        vue.createVNode(_component_chunLei_popups, {
          modelValue: $data.isContextMenuShow,
          "onUpdate:modelValue": _cache[2] || (_cache[2] = ($event) => $data.isContextMenuShow = $event),
          popData: $data.contextMenuItems,
          onTapPopup: $options.onContextMenuItemSelect,
          x: $data.contextMenuX,
          y: $data.contextMenuY,
          direction: "column",
          theme: "dark",
          triangle: false,
          dynamic: ""
        }, null, 8, ["modelValue", "popData", "onTapPopup", "x", "y"]),
        vue.createVNode(
          _component_uni_popup,
          {
            ref: "alertDialog",
            type: "dialog"
          },
          {
            default: vue.withCtx(() => [
              vue.createVNode(_component_uni_popup_dialog, {
                cancelText: $data.alertDialogOptions.cancelText,
                confirmText: $data.alertDialogOptions.confirmText,
                title: $data.alertDialogOptions.title,
                onConfirm: $data.alertDialogOptions.onConfirm,
                onClose: $data.alertDialogOptions.onClose
              }, null, 8, ["cancelText", "confirmText", "title", "onConfirm", "onClose"])
            ]),
            _: 1
            /* STABLE */
          },
          512
          /* NEED_PATCH */
        )
      ],
      512
      /* NEED_PATCH */
    );
  }
  const ConferenceParticipantListView = /* @__PURE__ */ _export_sfc(_sfc_main$6, [["render", _sfc_render$5], ["__scopeId", "data-v-74df3956"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/voip/conference/ConferenceParticipantListView.vue"]]);
  const _sfc_main$5 = {
    name: "ConferenceApplyUnmuteListView",
    data() {
      return {
        conferenceManager: self$1
      };
    },
    computed: {
      handUpParticipantList() {
        let applyList = this.conferenceManager.handUpMembers;
        return store.getUserInfos(applyList);
      }
    }
  };
  function _sfc_render$4(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "apply-unmute-container" }, [
      vue.createElementVNode("div", { class: "apply-participant-list-container" }, [
        vue.createElementVNode("ul", null, [
          (vue.openBlock(true), vue.createElementBlock(
            vue.Fragment,
            null,
            vue.renderList($options.handUpParticipantList, (participant, i2) => {
              return vue.openBlock(), vue.createElementBlock("li", { key: i2 }, [
                vue.createElementVNode("div", { class: "participant-user" }, [
                  vue.createElementVNode("img", {
                    class: "avatar",
                    src: participant.portrait,
                    alt: ""
                  }, null, 8, ["src"]),
                  vue.createElementVNode(
                    "p",
                    { class: "single-line name" },
                    vue.toDisplayString(participant._displayName),
                    1
                    /* TEXT */
                  ),
                  vue.createElementVNode("div", { class: "action-container" }, [
                    vue.createElementVNode("button", {
                      onClick: ($event) => $data.conferenceManager.putMemberHnadDown(participant.uid)
                    }, "放下", 8, ["onClick"])
                  ])
                ])
              ]);
            }),
            128
            /* KEYED_FRAGMENT */
          ))
        ])
      ]),
      vue.createElementVNode("div", { class: "action-all-container" }, [
        vue.createElementVNode("button", {
          onClick: _cache[0] || (_cache[0] = ($event) => $data.conferenceManager.putAllHandDown())
        }, "全部放下")
      ])
    ]);
  }
  const ConferenceHandUpListView = /* @__PURE__ */ _export_sfc(_sfc_main$5, [["render", _sfc_render$4], ["__scopeId", "data-v-f0cb3afe"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/voip/conference/ConferenceHandUpListView.vue"]]);
  const _sfc_main$4 = {
    name: "ConferenceApplyUnmuteVideoListView",
    data() {
      return {
        conferenceManager: self$1
      };
    },
    computed: {
      applyUnmuteParticipantList() {
        let applyList = this.conferenceManager.applyingUnmuteVideoMembers;
        let users = store.getUserInfos(applyList);
        formatAppLog("log", "at pages/voip/conference/ConferenceApplyUnmuteVideoListView.vue:41", "applyList", applyList, users);
        return users;
      }
    }
  };
  function _sfc_render$3(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "apply-unmute-container" }, [
      vue.createElementVNode("div", { class: "apply-participant-list-container" }, [
        vue.createElementVNode("ul", null, [
          (vue.openBlock(true), vue.createElementBlock(
            vue.Fragment,
            null,
            vue.renderList($options.applyUnmuteParticipantList, (participant, i2) => {
              return vue.openBlock(), vue.createElementBlock("li", { key: i2 }, [
                vue.createElementVNode("div", { class: "participant-user" }, [
                  vue.createElementVNode("img", {
                    class: "avatar",
                    src: participant.portrait,
                    alt: ""
                  }, null, 8, ["src"]),
                  vue.createElementVNode(
                    "p",
                    { class: "single-line name" },
                    vue.toDisplayString(participant._displayName),
                    1
                    /* TEXT */
                  ),
                  vue.createElementVNode("div", { class: "action-container" }, [
                    vue.createElementVNode("button", {
                      size: "mini",
                      onClick: ($event) => $data.conferenceManager.approveUnmute(participant.uid, false, true)
                    }, "同意", 8, ["onClick"]),
                    vue.createElementVNode("button", {
                      size: "mini",
                      onClick: ($event) => $data.conferenceManager.approveUnmute(participant.uid, false, false)
                    }, "拒绝", 8, ["onClick"])
                  ])
                ])
              ]);
            }),
            128
            /* KEYED_FRAGMENT */
          ))
        ])
      ]),
      vue.createElementVNode("div", { class: "action-all-container" }, [
        vue.createElementVNode("button", {
          size: "mini",
          onClick: _cache[0] || (_cache[0] = ($event) => $data.conferenceManager.approveAllUnmute(false, true))
        }, "全部同意"),
        vue.createElementVNode("button", {
          size: "mini",
          onClick: _cache[1] || (_cache[1] = ($event) => $data.conferenceManager.approveAllUnmute(false, false))
        }, "全部拒绝")
      ])
    ]);
  }
  const ConferenceApplyUnmuteVideoListView = /* @__PURE__ */ _export_sfc(_sfc_main$4, [["render", _sfc_render$3], ["__scopeId", "data-v-cdd36118"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/voip/conference/ConferenceApplyUnmuteVideoListView.vue"]]);
  const _sfc_main$3 = {
    name: "ConferenceApplyUnmuteAudioListView",
    data() {
      return {
        conferenceManager: self$1
      };
    },
    computed: {
      applyUnmuteParticipantList() {
        let applyList = this.conferenceManager.applyingUnmuteAudioMembers;
        let users = store.getUserInfos(applyList);
        formatAppLog("log", "at pages/voip/conference/ConferenceApplyUnmuteAudioListView.vue:41", "applyList", applyList, users);
        return users;
      }
    }
  };
  function _sfc_render$2(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", { class: "apply-unmute-container" }, [
      vue.createElementVNode("div", { class: "apply-participant-list-container" }, [
        vue.createElementVNode("ul", null, [
          (vue.openBlock(true), vue.createElementBlock(
            vue.Fragment,
            null,
            vue.renderList($options.applyUnmuteParticipantList, (participant, i2) => {
              return vue.openBlock(), vue.createElementBlock("li", { key: i2 }, [
                vue.createElementVNode("div", { class: "participant-user" }, [
                  vue.createElementVNode("img", {
                    class: "avatar",
                    src: participant.portrait,
                    alt: ""
                  }, null, 8, ["src"]),
                  vue.createElementVNode(
                    "p",
                    { class: "single-line name" },
                    vue.toDisplayString(participant._displayName),
                    1
                    /* TEXT */
                  ),
                  vue.createElementVNode("div", { class: "action-container" }, [
                    vue.createElementVNode("button", {
                      size: "mini",
                      onClick: ($event) => $data.conferenceManager.approveUnmute(participant.uid, true, true)
                    }, "同意", 8, ["onClick"]),
                    vue.createElementVNode("button", {
                      size: "mini",
                      onClick: ($event) => $data.conferenceManager.approveUnmute(participant.uid, true, false)
                    }, "拒绝", 8, ["onClick"])
                  ])
                ])
              ]);
            }),
            128
            /* KEYED_FRAGMENT */
          ))
        ])
      ]),
      vue.createElementVNode("div", { class: "action-all-container" }, [
        vue.createElementVNode("button", {
          size: "mini",
          onClick: _cache[0] || (_cache[0] = ($event) => $data.conferenceManager.approveAllUnmute(true, true))
        }, "全部同意"),
        vue.createElementVNode("button", {
          size: "mini",
          onClick: _cache[1] || (_cache[1] = ($event) => $data.conferenceManager.approveAllUnmute(true, false))
        }, "全部拒绝")
      ])
    ]);
  }
  const ConferenceApplyUnmuteAudioListView = /* @__PURE__ */ _export_sfc(_sfc_main$3, [["render", _sfc_render$2], ["__scopeId", "data-v-daf1622c"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/voip/conference/ConferenceApplyUnmuteAudioListView.vue"]]);
  const _sfc_main$2 = {
    name: "ConferenceManageView",
    data() {
      return {
        conferenceManager: self$1,
        selfUserId: self$1.selfUserId,
        isContextMenuShow: false,
        currentParticipant: {},
        showParticipantList: true,
        showAudioApplyList: false,
        showVideoApplyList: false,
        showHandUpList: false,
        session: self$2.currentCallSession(),
        conferenceParticipantUpdateTime: (/* @__PURE__ */ new Date()).getTime()
      };
    },
    components: {
      ConferenceHandUpListView,
      ConferenceApplyUnmuteAudioListView,
      ConferenceApplyUnmuteVideoListView,
      ConferenceParticipantListView
    },
    mounted() {
      wfc.eventEmitter.on("conferenceParticipantUpdated", this.onConferenceParticipantUpdated);
    },
    beforeUnmount() {
      wfc.eventEmitter.removeListener("conferenceParticipantUpdated", this.onConferenceParticipantUpdated);
    },
    methods: {
      onConferenceParticipantUpdated() {
        this.conferenceParticipantUpdateTime = (/* @__PURE__ */ new Date()).getTime();
      },
      profile2UserInfo(profile) {
        let userInfo = wfc.getUserInfo(profile.userId);
        userInfo._isAudience = profile.audience;
        userInfo._isHost = this.session.host === profile.userId;
        userInfo._isVideoMuted = profile.videoMuted;
        userInfo._isAudioMuted = profile.audioMuted;
        userInfo._volume = 0;
        userInfo._isScreenSharing = profile.screenSharing;
        return userInfo;
      }
    },
    computed: {
      handUpMembers() {
        return this.conferenceManager.handUpMembers;
      },
      handUpTip() {
        let ids = self$1.handUpMembers;
        let userInfos = wfc.getUserInfos(ids, "");
        let desc = userInfos[0].displayName;
        if (userInfos.length > 1) {
          desc += " 等";
        }
        desc += "正在举手";
        return desc;
      },
      participants() {
        let participantUserInfos = [];
        let selfProfile = self$2.getMyProfile(this.session.callId);
        let selfUserInfo = this.profile2UserInfo(selfProfile);
        selfUserInfo.__conferenceParticipantUpdateTime = this.conferenceParticipantUpdateTime;
        formatAppLog("log", "at pages/voip/conference/ConferenceManagePage.vue:128", "selfProfile", selfProfile);
        participantUserInfos.push(selfUserInfo);
        let participantProfiles = self$2.getParticipantProfiles(this.session.callId);
        formatAppLog("log", "at pages/voip/conference/ConferenceManagePage.vue:131", "participantProfiles", participantProfiles);
        for (const p of participantProfiles) {
          let userInfo = this.profile2UserInfo(p);
          participantUserInfos.push(userInfo);
        }
        formatAppLog("log", "at pages/voip/conference/ConferenceManagePage.vue:136", "participantUserInfos", participantUserInfos);
        return participantUserInfos;
      },
      audioApplyUnmuteTip() {
        let ids = self$1.applyingUnmuteAudioMembers;
        if (ids.length > 0) {
          let userInfos = wfc.getUserInfos(ids, "");
          let desc = userInfos[0].displayName;
          if (userInfos.length > 1) {
            desc += " 等";
          }
          desc += "正在申请解除静音";
          return desc;
        } else {
          return "";
        }
      },
      videoApplyUnmuteTip() {
        let ids = self$1.applyingUnmuteVideoMembers;
        if (ids.length > 0) {
          let userInfos = wfc.getUserInfos(ids, "");
          let desc = userInfos[0].displayName;
          if (userInfos.length > 1) {
            desc += " 等";
          }
          desc += "正在申请开启摄像头";
          return desc;
        } else {
          return "";
        }
      }
    },
    watch: {}
  };
  function _sfc_render$1(_ctx, _cache, $props, $setup, $data, $options) {
    const _component_ConferenceParticipantListView = vue.resolveComponent("ConferenceParticipantListView");
    const _component_ConferenceApplyUnmuteAudioListView = vue.resolveComponent("ConferenceApplyUnmuteAudioListView");
    const _component_ConferenceApplyUnmuteVideoListView = vue.resolveComponent("ConferenceApplyUnmuteVideoListView");
    const _component_ConferenceHandUpListView = vue.resolveComponent("ConferenceHandUpListView");
    return vue.openBlock(), vue.createElementBlock(
      "div",
      {
        class: "conference-manage-view-container",
        ref: "rootContainer"
      },
      [
        $data.selfUserId === $data.conferenceManager.conferenceInfo.owner ? (vue.openBlock(), vue.createElementBlock("div", {
          key: 0,
          class: "tip-container"
        }, [
          $data.showParticipantList && $data.conferenceManager.applyingUnmuteAudioMembers.length > 0 ? (vue.openBlock(), vue.createElementBlock(
            "div",
            {
              key: 0,
              onClick: _cache[0] || (_cache[0] = ($event) => {
                $data.showParticipantList = false;
                $data.showAudioApplyList = true;
              }),
              class: "action-tip"
            },
            vue.toDisplayString($options.audioApplyUnmuteTip),
            1
            /* TEXT */
          )) : vue.createCommentVNode("v-if", true),
          $data.showAudioApplyList ? (vue.openBlock(), vue.createElementBlock("div", {
            key: 1,
            class: "title-container"
          }, [
            vue.createElementVNode("i", {
              class: "icon-ion-android-arrow-back",
              onClick: _cache[1] || (_cache[1] = ($event) => {
                $data.showAudioApplyList = false;
                $data.showParticipantList = true;
              })
            }),
            vue.createElementVNode("p", null, "申请解除静音列表")
          ])) : vue.createCommentVNode("v-if", true),
          $data.showParticipantList && $data.conferenceManager.applyingUnmuteVideoMembers.length > 0 ? (vue.openBlock(), vue.createElementBlock(
            "div",
            {
              key: 2,
              onClick: _cache[2] || (_cache[2] = ($event) => {
                $data.showParticipantList = false;
                $data.showVideoApplyList = true;
              }),
              class: "action-tip"
            },
            vue.toDisplayString($options.videoApplyUnmuteTip),
            1
            /* TEXT */
          )) : vue.createCommentVNode("v-if", true),
          $data.showVideoApplyList ? (vue.openBlock(), vue.createElementBlock("div", {
            key: 3,
            class: "title-container"
          }, [
            vue.createElementVNode("i", {
              class: "icon-ion-android-arrow-back",
              onClick: _cache[3] || (_cache[3] = ($event) => {
                $data.showVideoApplyList = false;
                $data.showParticipantList = true;
              })
            }),
            vue.createElementVNode("p", null, "申请开启摄像头列表")
          ])) : vue.createCommentVNode("v-if", true),
          $data.showParticipantList && $data.conferenceManager.handUpMembers.length > 0 ? (vue.openBlock(), vue.createElementBlock(
            "div",
            {
              key: 4,
              onClick: _cache[4] || (_cache[4] = ($event) => {
                $data.showParticipantList = false;
                $data.showHandUpList = true;
              }),
              class: "action-tip"
            },
            vue.toDisplayString($options.handUpTip),
            1
            /* TEXT */
          )) : vue.createCommentVNode("v-if", true),
          $data.showHandUpList ? (vue.openBlock(), vue.createElementBlock("div", {
            key: 5,
            class: "title-container"
          }, [
            vue.createElementVNode("i", {
              class: "icon-ion-android-arrow-back",
              onClick: _cache[5] || (_cache[5] = ($event) => {
                $data.showHandUpList = false;
                $data.showParticipantList = true;
              })
            }),
            vue.createElementVNode("p", null, "举手列表")
          ])) : vue.createCommentVNode("v-if", true)
        ])) : vue.createCommentVNode("v-if", true),
        $data.showParticipantList ? (vue.openBlock(), vue.createBlock(_component_ConferenceParticipantListView, {
          key: 1,
          style: { "flex": "1" },
          participants: $options.participants,
          session: $data.session
        }, null, 8, ["participants", "session"])) : vue.createCommentVNode("v-if", true),
        $data.showAudioApplyList ? (vue.openBlock(), vue.createBlock(_component_ConferenceApplyUnmuteAudioListView, {
          key: 2,
          style: { "flex": "1" }
        })) : vue.createCommentVNode("v-if", true),
        $data.showVideoApplyList ? (vue.openBlock(), vue.createBlock(_component_ConferenceApplyUnmuteVideoListView, {
          key: 3,
          style: { "flex": "1" }
        })) : vue.createCommentVNode("v-if", true),
        $data.showHandUpList ? (vue.openBlock(), vue.createBlock(_component_ConferenceHandUpListView, { key: 4 })) : vue.createCommentVNode("v-if", true)
      ],
      512
      /* NEED_PATCH */
    );
  }
  const PagesVoipConferenceConferenceManagePage = /* @__PURE__ */ _export_sfc(_sfc_main$2, [["render", _sfc_render$1], ["__scopeId", "data-v-bc32a7c3"], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/voip/conference/ConferenceManagePage.vue"]]);
  const _sfc_main$1 = {
    name: "ApiTestPage",
    methods: {
      setUserEnableReceipt() {
        wfc.setUserEnableReceipt(true, () => {
          formatAppLog("log", "at pages/misc/ApiTestPage.vue:27", "setUserEnableReceipt success");
        }, (err) => {
          formatAppLog("log", "at pages/misc/ApiTestPage.vue:29", "setUserEnableReceipt fail", err);
        });
      },
      modifyMyInfo() {
        let entry = new ModifyMyInfoEntry();
        entry.type = ModifyMyInfoType.Modify_Gender;
        entry.value = "1";
        wfc.modifyMyInfo([entry], () => {
          formatAppLog("log", "at pages/misc/ApiTestPage.vue:37", "modifyMyInfo success");
        }, (err) => {
          formatAppLog("log", "at pages/misc/ApiTestPage.vue:39", "modifyMyInfo error", err);
        });
      },
      systemInfo() {
        formatAppLog("log", "at pages/misc/ApiTestPage.vue:43", "systemInfo", uni.getSystemInfoSync());
      },
      setHiddenGroupMemberName() {
        const groupId = "tR16v6xx";
        const isHiddenGroupMemberName = wfc.isHiddenGroupMemberName(groupId);
        formatAppLog("log", "at pages/misc/ApiTestPage.vue:48", "isHiddenGroupMemberName", isHiddenGroupMemberName);
        wfc.setHiddenGroupMemberName(groupId, !isHiddenGroupMemberName, () => {
          formatAppLog("log", "at pages/misc/ApiTestPage.vue:50", "setHiddenGroupMemberName result", groupId, wfc.isHiddenGroupMemberName(groupId));
        }, (err) => {
          formatAppLog("log", "at pages/misc/ApiTestPage.vue:52", "setHiddenGroupMemberName error", err);
        });
      },
      pttRequestTalk() {
        let conv = new Conversation(ConversationType.Group, 0, "1f7qmws2k");
        self$4.requestTalk(conv, 0, new TalkingCallback());
      }
    }
  };
  function _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {
    return vue.openBlock(), vue.createElementBlock("div", null, [
      vue.createElementVNode("button", {
        onClick: _cache[0] || (_cache[0] = (...args) => $options.setUserEnableReceipt && $options.setUserEnableReceipt(...args))
      }, "setUserEnableReceipt"),
      vue.createElementVNode("button", {
        onClick: _cache[1] || (_cache[1] = (...args) => $options.modifyMyInfo && $options.modifyMyInfo(...args))
      }, "modifyMyInfo"),
      vue.createElementVNode("button", {
        onClick: _cache[2] || (_cache[2] = (...args) => $options.systemInfo && $options.systemInfo(...args))
      }, "SystemInfo"),
      vue.createElementVNode("button", {
        onClick: _cache[3] || (_cache[3] = (...args) => $options.setHiddenGroupMemberName && $options.setHiddenGroupMemberName(...args))
      }, "setHiddenGroupMemberName"),
      vue.createElementVNode("button", {
        onClick: _cache[4] || (_cache[4] = (...args) => $options.pttRequestTalk && $options.pttRequestTalk(...args))
      }, "pttRequestTalk")
    ]);
  }
  const PagesMiscApiTestPage = /* @__PURE__ */ _export_sfc(_sfc_main$1, [["render", _sfc_render], ["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/pages/misc/ApiTestPage.vue"]]);
  __definePage("pages/SplashPage", PagesSplashPage);
  __definePage("pages/login/LoginPage", PagesLoginLoginPage);
  __definePage("pages/conversationList/ConversationListPage", PagesConversationListConversationListPage);
  __definePage("pages/conversation/ConversationPage", PagesConversationConversationPage);
  __definePage("pages/conversation/message/CompositeMessagePage", PagesConversationMessageCompositeMessagePage);
  __definePage("pages/conversation/SingleConversationInfoPage", PagesConversationSingleConversationInfoPage);
  __definePage("pages/conversation/message/forward/ForwardMessagePage", PagesConversationMessageForwardForwardMessagePage);
  __definePage("pages/conversation/GroupConversationInfoPage", PagesConversationGroupConversationInfoPage);
  __definePage("pages/contact/SearchUserPage", PagesContactSearchUserPage);
  __definePage("pages/contact/OrganizationTreePage", PagesContactOrganizationTreePage);
  __definePage("pages/contact/ChannelListPage", PagesContactChannelListPage);
  __definePage("pages/search/SearchPortalPage", PagesSearchSearchPortalPage);
  __definePage("pages/search/SearchConversationMessagePage", PagesSearchSearchConversationMessagePage);
  __definePage("pages/contact/UserDetailPage", PagesContactUserDetailPage);
  __definePage("pages/contact/FriendRequestDetailPage", PagesContactFriendRequestDetailPage);
  __definePage("pages/contact/ContactListPage", PagesContactContactListPage);
  __definePage("pages/contact/NewFriendListPage", PagesContactNewFriendListPage);
  __definePage("pages/contact/GroupListPage", PagesContactGroupListPage);
  __definePage("pages/pick/PickUserPage", PagesPickPickUserPage);
  __definePage("pages/pick/PickSingleUserPage", PagesPickPickSingleUserPage);
  __definePage("pages/workspace/WorkspacePage", PagesWorkspaceWorkspacePage);
  __definePage("pages/workspace/WorkspaceWebViewPage", PagesWorkspaceWorkspaceWebViewPage);
  __definePage("pages/discovery/DiscoveryPage", PagesDiscoveryDiscoveryPage);
  __definePage("pages/discovery/ChatroomListPage", PagesDiscoveryChatroomListPage);
  __definePage("pages/me/MePage", PagesMeMePage);
  __definePage("pages/misc/WebViewPage", PagesMiscWebViewPage);
  __definePage("pages/misc/PreviewVideoPage", PagesMiscPreviewVideoPage);
  __definePage("pages/voip/Single", PagesVoipSingle);
  __definePage("pages/voip/Multi", PagesVoipMulti);
  __definePage("pages/voip/conference/ConferencePortalPage", PagesVoipConferenceConferencePortalPage);
  __definePage("pages/voip/conference/JoinConferencePage", PagesVoipConferenceJoinConferencePage);
  __definePage("pages/voip/conference/CreateConferencePage", PagesVoipConferenceCreateConferencePage);
  __definePage("pages/voip/conference/OrderConferencePage", PagesVoipConferenceOrderConferencePage);
  __definePage("pages/voip/conference/ConferenceInfoPage", PagesVoipConferenceConferenceInfoPage);
  __definePage("pages/voip/conference/ConferencePage", PagesVoipConferenceConferencePage);
  __definePage("pages/voip/conference/ConferenceManagePage", PagesVoipConferenceConferenceManagePage);
  __definePage("pages/misc/ApiTestPage", PagesMiscApiTestPage);
  const _sfc_main = {
    data() {
      return {
        wfc: null,
        avengineKit: null,
        store: null,
        conferenceManager: null
      };
    },
    onLaunch: function() {
      formatAppLog("log", "at App.vue:21", "App Launch");
      this.wfc = wfc;
      this.avengineKit = self$2;
      this.store = store;
      this.conferenceManager = self$1;
    },
    onShow: function() {
      formatAppLog("log", "at App.vue:37", "App Show");
      store.state.misc.isAppHidden = false;
    },
    onHide: function() {
      formatAppLog("log", "at App.vue:53", "App Hide");
      store.state.misc.isAppHidden = true;
    },
    methods: {
      go2ConversationList() {
        uni.switchTab({
          url: "/pages/conversationList/ConversationListPage",
          success: () => {
            formatAppLog("log", "at App.vue:61", "to conversation list success");
          },
          fail: (e) => {
            formatAppLog("log", "at App.vue:64", "to conversation list error", e);
          },
          complete: () => {
            formatAppLog("log", "at App.vue:67", "switch tab complete");
          }
        });
      },
      forwardConferenceInviteMessage(callId, host, title, desc, startTime, audioOnly, defaultAudience, advance, pin) {
        let inviteMessageContent = new ConferenceInviteMessageContent(callId, host, title, desc, startTime, audioOnly, defaultAudience, advance, pin);
        formatAppLog("log", "at App.vue:74", "invite", inviteMessageContent);
        let message2 = new Message(null, inviteMessageContent);
        this.$forward({
          forwardType: ForwardType.NORMAL,
          messages: [message2]
        });
      }
    }
  };
  const App = /* @__PURE__ */ _export_sfc(_sfc_main, [["__file", "/Users/jiangecho/bitbucket/wildfirechat/uni-chat-uts/App.vue"]]);
  /*!
    * @intlify/shared v9.1.9
    * (c) 2021 kazuya kawaguchi
    * Released under the MIT License.
    */
  const inBrowser = typeof window !== "undefined";
  let mark;
  let measure;
  {
    const perf2 = inBrowser && window.performance;
    if (perf2 && perf2.mark && perf2.measure && perf2.clearMarks && perf2.clearMeasures) {
      mark = (tag) => perf2.mark(tag);
      measure = (name, startTag, endTag) => {
        perf2.measure(name, startTag, endTag);
        perf2.clearMarks(startTag);
        perf2.clearMarks(endTag);
      };
    }
  }
  const RE_ARGS = /\{([0-9a-zA-Z]+)\}/g;
  function format(message2, ...args) {
    if (args.length === 1 && isObject$1(args[0])) {
      args = args[0];
    }
    if (!args || !args.hasOwnProperty) {
      args = {};
    }
    return message2.replace(RE_ARGS, (match, identifier) => {
      return args.hasOwnProperty(identifier) ? args[identifier] : "";
    });
  }
  const hasSymbol = typeof Symbol === "function" && typeof Symbol.toStringTag === "symbol";
  const makeSymbol = (name) => hasSymbol ? Symbol(name) : name;
  const generateFormatCacheKey = (locale, key, source) => friendlyJSONstringify({ l: locale, k: key, s: source });
  const friendlyJSONstringify = (json) => JSON.stringify(json).replace(/\u2028/g, "\\u2028").replace(/\u2029/g, "\\u2029").replace(/\u0027/g, "\\u0027");
  const isNumber = (val) => typeof val === "number" && isFinite(val);
  const isDate = (val) => toTypeString(val) === "[object Date]";
  const isRegExp = (val) => toTypeString(val) === "[object RegExp]";
  const isEmptyObject = (val) => isPlainObject(val) && Object.keys(val).length === 0;
  function warn(msg, err) {
    if (typeof console !== "undefined") {
      console.warn(`[intlify] ` + msg);
      if (err) {
        console.warn(err.stack);
      }
    }
  }
  const assign = Object.assign;
  let _globalThis;
  const getGlobalThis = () => {
    return _globalThis || (_globalThis = typeof globalThis !== "undefined" ? globalThis : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {});
  };
  function escapeHtml(rawText) {
    return rawText.replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&apos;");
  }
  const hasOwnProperty$1 = Object.prototype.hasOwnProperty;
  function hasOwn$1(obj, key) {
    return hasOwnProperty$1.call(obj, key);
  }
  const isArray = Array.isArray;
  const isFunction = (val) => typeof val === "function";
  const isString = (val) => typeof val === "string";
  const isBoolean = (val) => typeof val === "boolean";
  const isObject$1 = (val) => (
    // eslint-disable-line
    val !== null && typeof val === "object"
  );
  const objectToString = Object.prototype.toString;
  const toTypeString = (value) => objectToString.call(value);
  const isPlainObject = (val) => toTypeString(val) === "[object Object]";
  const toDisplayString = (val) => {
    return val == null ? "" : isArray(val) || isPlainObject(val) && val.toString === objectToString ? JSON.stringify(val, null, 2) : String(val);
  };
  const RANGE = 2;
  function generateCodeFrame(source, start = 0, end = source.length) {
    const lines = source.split(/\r?\n/);
    let count = 0;
    const res = [];
    for (let i2 = 0; i2 < lines.length; i2++) {
      count += lines[i2].length + 1;
      if (count >= start) {
        for (let j = i2 - RANGE; j <= i2 + RANGE || end > count; j++) {
          if (j < 0 || j >= lines.length)
            continue;
          const line = j + 1;
          res.push(`${line}${" ".repeat(3 - String(line).length)}|  ${lines[j]}`);
          const lineLength = lines[j].length;
          if (j === i2) {
            const pad = start - (count - lineLength) + 1;
            const length = Math.max(1, end > count ? lineLength - pad : end - start);
            res.push(`   |  ` + " ".repeat(pad) + "^".repeat(length));
          } else if (j > i2) {
            if (end > count) {
              const length = Math.max(Math.min(end - count, lineLength), 1);
              res.push(`   |  ` + "^".repeat(length));
            }
            count += lineLength + 1;
          }
        }
        break;
      }
    }
    return res.join("\n");
  }
  function createEmitter() {
    const events2 = /* @__PURE__ */ new Map();
    const emitter = {
      events: events2,
      on(event, handler) {
        const handlers2 = events2.get(event);
        const added = handlers2 && handlers2.push(handler);
        if (!added) {
          events2.set(event, [handler]);
        }
      },
      off(event, handler) {
        const handlers2 = events2.get(event);
        if (handlers2) {
          handlers2.splice(handlers2.indexOf(handler) >>> 0, 1);
        }
      },
      emit(event, payload) {
        (events2.get(event) || []).slice().map((handler) => handler(payload));
        (events2.get("*") || []).slice().map((handler) => handler(event, payload));
      }
    };
    return emitter;
  }
  /*!
    * @intlify/message-resolver v9.1.9
    * (c) 2021 kazuya kawaguchi
    * Released under the MIT License.
    */
  const hasOwnProperty = Object.prototype.hasOwnProperty;
  function hasOwn(obj, key) {
    return hasOwnProperty.call(obj, key);
  }
  const isObject = (val) => (
    // eslint-disable-line
    val !== null && typeof val === "object"
  );
  const pathStateMachine = [];
  pathStateMachine[
    0
    /* BEFORE_PATH */
  ] = {
    [
      "w"
      /* WORKSPACE */
    ]: [
      0
      /* BEFORE_PATH */
    ],
    [
      "i"
      /* IDENT */
    ]: [
      3,
      0
      /* APPEND */
    ],
    [
      "["
      /* LEFT_BRACKET */
    ]: [
      4
      /* IN_SUB_PATH */
    ],
    [
      "o"
      /* END_OF_FAIL */
    ]: [
      7
      /* AFTER_PATH */
    ]
  };
  pathStateMachine[
    1
    /* IN_PATH */
  ] = {
    [
      "w"
      /* WORKSPACE */
    ]: [
      1
      /* IN_PATH */
    ],
    [
      "."
      /* DOT */
    ]: [
      2
      /* BEFORE_IDENT */
    ],
    [
      "["
      /* LEFT_BRACKET */
    ]: [
      4
      /* IN_SUB_PATH */
    ],
    [
      "o"
      /* END_OF_FAIL */
    ]: [
      7
      /* AFTER_PATH */
    ]
  };
  pathStateMachine[
    2
    /* BEFORE_IDENT */
  ] = {
    [
      "w"
      /* WORKSPACE */
    ]: [
      2
      /* BEFORE_IDENT */
    ],
    [
      "i"
      /* IDENT */
    ]: [
      3,
      0
      /* APPEND */
    ],
    [
      "0"
      /* ZERO */
    ]: [
      3,
      0
      /* APPEND */
    ]
  };
  pathStateMachine[
    3
    /* IN_IDENT */
  ] = {
    [
      "i"
      /* IDENT */
    ]: [
      3,
      0
      /* APPEND */
    ],
    [
      "0"
      /* ZERO */
    ]: [
      3,
      0
      /* APPEND */
    ],
    [
      "w"
      /* WORKSPACE */
    ]: [
      1,
      1
      /* PUSH */
    ],
    [
      "."
      /* DOT */
    ]: [
      2,
      1
      /* PUSH */
    ],
    [
      "["
      /* LEFT_BRACKET */
    ]: [
      4,
      1
      /* PUSH */
    ],
    [
      "o"
      /* END_OF_FAIL */
    ]: [
      7,
      1
      /* PUSH */
    ]
  };
  pathStateMachine[
    4
    /* IN_SUB_PATH */
  ] = {
    [
      "'"
      /* SINGLE_QUOTE */
    ]: [
      5,
      0
      /* APPEND */
    ],
    [
      '"'
      /* DOUBLE_QUOTE */
    ]: [
      6,
      0
      /* APPEND */
    ],
    [
      "["
      /* LEFT_BRACKET */
    ]: [
      4,
      2
      /* INC_SUB_PATH_DEPTH */
    ],
    [
      "]"
      /* RIGHT_BRACKET */
    ]: [
      1,
      3
      /* PUSH_SUB_PATH */
    ],
    [
      "o"
      /* END_OF_FAIL */
    ]: 8,
    [
      "l"
      /* ELSE */
    ]: [
      4,
      0
      /* APPEND */
    ]
  };
  pathStateMachine[
    5
    /* IN_SINGLE_QUOTE */
  ] = {
    [
      "'"
      /* SINGLE_QUOTE */
    ]: [
      4,
      0
      /* APPEND */
    ],
    [
      "o"
      /* END_OF_FAIL */
    ]: 8,
    [
      "l"
      /* ELSE */
    ]: [
      5,
      0
      /* APPEND */
    ]
  };
  pathStateMachine[
    6
    /* IN_DOUBLE_QUOTE */
  ] = {
    [
      '"'
      /* DOUBLE_QUOTE */
    ]: [
      4,
      0
      /* APPEND */
    ],
    [
      "o"
      /* END_OF_FAIL */
    ]: 8,
    [
      "l"
      /* ELSE */
    ]: [
      6,
      0
      /* APPEND */
    ]
  };
  const literalValueRE = /^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;
  function isLiteral(exp) {
    return literalValueRE.test(exp);
  }
  function stripQuotes(str) {
    const a = str.charCodeAt(0);
    const b = str.charCodeAt(str.length - 1);
    return a === b && (a === 34 || a === 39) ? str.slice(1, -1) : str;
  }
  function getPathCharType(ch) {
    if (ch === void 0 || ch === null) {
      return "o";
    }
    const code = ch.charCodeAt(0);
    switch (code) {
      case 91:
      case 93:
      case 46:
      case 34:
      case 39:
        return ch;
      case 95:
      case 36:
      case 45:
        return "i";
      case 9:
      case 10:
      case 13:
      case 160:
      case 65279:
      case 8232:
      case 8233:
        return "w";
    }
    return "i";
  }
  function formatSubPath(path) {
    const trimmed = path.trim();
    if (path.charAt(0) === "0" && isNaN(parseInt(path))) {
      return false;
    }
    return isLiteral(trimmed) ? stripQuotes(trimmed) : "*" + trimmed;
  }
  function parse(path) {
    const keys = [];
    let index = -1;
    let mode = 0;
    let subPathDepth = 0;
    let c2;
    let key;
    let newChar;
    let type;
    let transition;
    let action;
    let typeMap;
    const actions = [];
    actions[
      0
      /* APPEND */
    ] = () => {
      if (key === void 0) {
        key = newChar;
      } else {
        key += newChar;
      }
    };
    actions[
      1
      /* PUSH */
    ] = () => {
      if (key !== void 0) {
        keys.push(key);
        key = void 0;
      }
    };
    actions[
      2
      /* INC_SUB_PATH_DEPTH */
    ] = () => {
      actions[
        0
        /* APPEND */
      ]();
      subPathDepth++;
    };
    actions[
      3
      /* PUSH_SUB_PATH */
    ] = () => {
      if (subPathDepth > 0) {
        subPathDepth--;
        mode = 4;
        actions[
          0
          /* APPEND */
        ]();
      } else {
        subPathDepth = 0;
        if (key === void 0) {
          return false;
        }
        key = formatSubPath(key);
        if (key === false) {
          return false;
        } else {
          actions[
            1
            /* PUSH */
          ]();
        }
      }
    };
    function maybeUnescapeQuote() {
      const nextChar = path[index + 1];
      if (mode === 5 && nextChar === "'" || mode === 6 && nextChar === '"') {
        index++;
        newChar = "\\" + nextChar;
        actions[
          0
          /* APPEND */
        ]();
        return true;
      }
    }
    while (mode !== null) {
      index++;
      c2 = path[index];
      if (c2 === "\\" && maybeUnescapeQuote()) {
        continue;
      }
      type = getPathCharType(c2);
      typeMap = pathStateMachine[mode];
      transition = typeMap[type] || typeMap[
        "l"
        /* ELSE */
      ] || 8;
      if (transition === 8) {
        return;
      }
      mode = transition[0];
      if (transition[1] !== void 0) {
        action = actions[transition[1]];
        if (action) {
          newChar = c2;
          if (action() === false) {
            return;
          }
        }
      }
      if (mode === 7) {
        return keys;
      }
    }
  }
  const cache = /* @__PURE__ */ new Map();
  function resolveValue(obj, path) {
    if (!isObject(obj)) {
      return null;
    }
    let hit = cache.get(path);
    if (!hit) {
      hit = parse(path);
      if (hit) {
        cache.set(path, hit);
      }
    }
    if (!hit) {
      return null;
    }
    const len = hit.length;
    let last = obj;
    let i2 = 0;
    while (i2 < len) {
      const val = last[hit[i2]];
      if (val === void 0) {
        return null;
      }
      last = val;
      i2++;
    }
    return last;
  }
  function handleFlatJson(obj) {
    if (!isObject(obj)) {
      return obj;
    }
    for (const key in obj) {
      if (!hasOwn(obj, key)) {
        continue;
      }
      if (!key.includes(
        "."
        /* DOT */
      )) {
        if (isObject(obj[key])) {
          handleFlatJson(obj[key]);
        }
      } else {
        const subKeys = key.split(
          "."
          /* DOT */
        );
        const lastIndex = subKeys.length - 1;
        let currentObj = obj;
        for (let i2 = 0; i2 < lastIndex; i2++) {
          if (!(subKeys[i2] in currentObj)) {
            currentObj[subKeys[i2]] = {};
          }
          currentObj = currentObj[subKeys[i2]];
        }
        currentObj[subKeys[lastIndex]] = obj[key];
        delete obj[key];
        if (isObject(currentObj[subKeys[lastIndex]])) {
          handleFlatJson(currentObj[subKeys[lastIndex]]);
        }
      }
    }
    return obj;
  }
  /*!
    * @intlify/runtime v9.1.9
    * (c) 2021 kazuya kawaguchi
    * Released under the MIT License.
    */
  const DEFAULT_MODIFIER = (str) => str;
  const DEFAULT_MESSAGE = (ctx) => "";
  const DEFAULT_MESSAGE_DATA_TYPE = "text";
  const DEFAULT_NORMALIZE = (values) => values.length === 0 ? "" : values.join("");
  const DEFAULT_INTERPOLATE = toDisplayString;
  function pluralDefault(choice, choicesLength) {
    choice = Math.abs(choice);
    if (choicesLength === 2) {
      return choice ? choice > 1 ? 1 : 0 : 1;
    }
    return choice ? Math.min(choice, 2) : 0;
  }
  function getPluralIndex(options) {
    const index = isNumber(options.pluralIndex) ? options.pluralIndex : -1;
    return options.named && (isNumber(options.named.count) || isNumber(options.named.n)) ? isNumber(options.named.count) ? options.named.count : isNumber(options.named.n) ? options.named.n : index : index;
  }
  function normalizeNamed(pluralIndex, props) {
    if (!props.count) {
      props.count = pluralIndex;
    }
    if (!props.n) {
      props.n = pluralIndex;
    }
  }
  function createMessageContext(options = {}) {
    const locale = options.locale;
    const pluralIndex = getPluralIndex(options);
    const pluralRule = isObject$1(options.pluralRules) && isString(locale) && isFunction(options.pluralRules[locale]) ? options.pluralRules[locale] : pluralDefault;
    const orgPluralRule = isObject$1(options.pluralRules) && isString(locale) && isFunction(options.pluralRules[locale]) ? pluralDefault : void 0;
    const plural = (messages2) => messages2[pluralRule(pluralIndex, messages2.length, orgPluralRule)];
    const _list = options.list || [];
    const list2 = (index) => _list[index];
    const _named = options.named || {};
    isNumber(options.pluralIndex) && normalizeNamed(pluralIndex, _named);
    const named = (key) => _named[key];
    function message2(key) {
      const msg = isFunction(options.messages) ? options.messages(key) : isObject$1(options.messages) ? options.messages[key] : false;
      return !msg ? options.parent ? options.parent.message(key) : DEFAULT_MESSAGE : msg;
    }
    const _modifier = (name) => options.modifiers ? options.modifiers[name] : DEFAULT_MODIFIER;
    const normalize = isPlainObject(options.processor) && isFunction(options.processor.normalize) ? options.processor.normalize : DEFAULT_NORMALIZE;
    const interpolate = isPlainObject(options.processor) && isFunction(options.processor.interpolate) ? options.processor.interpolate : DEFAULT_INTERPOLATE;
    const type = isPlainObject(options.processor) && isString(options.processor.type) ? options.processor.type : DEFAULT_MESSAGE_DATA_TYPE;
    const ctx = {
      [
        "list"
        /* LIST */
      ]: list2,
      [
        "named"
        /* NAMED */
      ]: named,
      [
        "plural"
        /* PLURAL */
      ]: plural,
      [
        "linked"
        /* LINKED */
      ]: (key, modifier) => {
        const msg = message2(key)(ctx);
        return isString(modifier) ? _modifier(modifier)(msg) : msg;
      },
      [
        "message"
        /* MESSAGE */
      ]: message2,
      [
        "type"
        /* TYPE */
      ]: type,
      [
        "interpolate"
        /* INTERPOLATE */
      ]: interpolate,
      [
        "normalize"
        /* NORMALIZE */
      ]: normalize
    };
    return ctx;
  }
  /*!
    * @intlify/message-compiler v9.1.9
    * (c) 2021 kazuya kawaguchi
    * Released under the MIT License.
    */
  const errorMessages$2 = {
    // tokenizer error messages
    [
      0
      /* EXPECTED_TOKEN */
    ]: `Expected token: '{0}'`,
    [
      1
      /* INVALID_TOKEN_IN_PLACEHOLDER */
    ]: `Invalid token in placeholder: '{0}'`,
    [
      2
      /* UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER */
    ]: `Unterminated single quote in placeholder`,
    [
      3
      /* UNKNOWN_ESCAPE_SEQUENCE */
    ]: `Unknown escape sequence: \\{0}`,
    [
      4
      /* INVALID_UNICODE_ESCAPE_SEQUENCE */
    ]: `Invalid unicode escape sequence: {0}`,
    [
      5
      /* UNBALANCED_CLOSING_BRACE */
    ]: `Unbalanced closing brace`,
    [
      6
      /* UNTERMINATED_CLOSING_BRACE */
    ]: `Unterminated closing brace`,
    [
      7
      /* EMPTY_PLACEHOLDER */
    ]: `Empty placeholder`,
    [
      8
      /* NOT_ALLOW_NEST_PLACEHOLDER */
    ]: `Not allowed nest placeholder`,
    [
      9
      /* INVALID_LINKED_FORMAT */
    ]: `Invalid linked format`,
    // parser error messages
    [
      10
      /* MUST_HAVE_MESSAGES_IN_PLURAL */
    ]: `Plural must have messages`,
    [
      11
      /* UNEXPECTED_EMPTY_LINKED_MODIFIER */
    ]: `Unexpected empty linked modifier`,
    [
      12
      /* UNEXPECTED_EMPTY_LINKED_KEY */
    ]: `Unexpected empty linked key`,
    [
      13
      /* UNEXPECTED_LEXICAL_ANALYSIS */
    ]: `Unexpected lexical analysis in token: '{0}'`
  };
  function createCompileError(code, loc, options = {}) {
    const { domain, messages: messages2, args } = options;
    const msg = format((messages2 || errorMessages$2)[code] || "", ...args || []);
    const error = new SyntaxError(String(msg));
    error.code = code;
    if (loc) {
      error.location = loc;
    }
    error.domain = domain;
    return error;
  }
  /*!
    * @intlify/devtools-if v9.1.9
    * (c) 2021 kazuya kawaguchi
    * Released under the MIT License.
    */
  const IntlifyDevToolsHooks = {
    I18nInit: "i18n:init",
    FunctionTranslate: "function:translate"
  };
  /*!
    * @intlify/core-base v9.1.9
    * (c) 2021 kazuya kawaguchi
    * Released under the MIT License.
    */
  let devtools = null;
  function setDevToolsHook(hook) {
    devtools = hook;
  }
  function initI18nDevTools(i18n2, version, meta) {
    devtools && devtools.emit(IntlifyDevToolsHooks.I18nInit, {
      timestamp: Date.now(),
      i18n: i18n2,
      version,
      meta
    });
  }
  const translateDevTools = /* @__PURE__ */ createDevToolsHook(IntlifyDevToolsHooks.FunctionTranslate);
  function createDevToolsHook(hook) {
    return (payloads) => devtools && devtools.emit(hook, payloads);
  }
  const warnMessages$1 = {
    [
      0
      /* NOT_FOUND_KEY */
    ]: `Not found '{key}' key in '{locale}' locale messages.`,
    [
      1
      /* FALLBACK_TO_TRANSLATE */
    ]: `Fall back to translate '{key}' key with '{target}' locale.`,
    [
      2
      /* CANNOT_FORMAT_NUMBER */
    ]: `Cannot format a number value due to not supported Intl.NumberFormat.`,
    [
      3
      /* FALLBACK_TO_NUMBER_FORMAT */
    ]: `Fall back to number format '{key}' key with '{target}' locale.`,
    [
      4
      /* CANNOT_FORMAT_DATE */
    ]: `Cannot format a date value due to not supported Intl.DateTimeFormat.`,
    [
      5
      /* FALLBACK_TO_DATE_FORMAT */
    ]: `Fall back to datetime format '{key}' key with '{target}' locale.`
  };
  function getWarnMessage$1(code, ...args) {
    return format(warnMessages$1[code], ...args);
  }
  const VERSION$1 = "9.1.9";
  const NOT_REOSLVED = -1;
  const MISSING_RESOLVE_VALUE = "";
  function getDefaultLinkedModifiers() {
    return {
      upper: (val) => isString(val) ? val.toUpperCase() : val,
      lower: (val) => isString(val) ? val.toLowerCase() : val,
      // prettier-ignore
      capitalize: (val) => isString(val) ? `${val.charAt(0).toLocaleUpperCase()}${val.substr(1)}` : val
    };
  }
  let _compiler;
  let _additionalMeta = null;
  const setAdditionalMeta = (meta) => {
    _additionalMeta = meta;
  };
  const getAdditionalMeta = () => _additionalMeta;
  let _cid = 0;
  function createCoreContext(options = {}) {
    const version = isString(options.version) ? options.version : VERSION$1;
    const locale = isString(options.locale) ? options.locale : "en-US";
    const fallbackLocale = isArray(options.fallbackLocale) || isPlainObject(options.fallbackLocale) || isString(options.fallbackLocale) || options.fallbackLocale === false ? options.fallbackLocale : locale;
    const messages2 = isPlainObject(options.messages) ? options.messages : { [locale]: {} };
    const datetimeFormats = isPlainObject(options.datetimeFormats) ? options.datetimeFormats : { [locale]: {} };
    const numberFormats = isPlainObject(options.numberFormats) ? options.numberFormats : { [locale]: {} };
    const modifiers = assign({}, options.modifiers || {}, getDefaultLinkedModifiers());
    const pluralRules = options.pluralRules || {};
    const missing = isFunction(options.missing) ? options.missing : null;
    const missingWarn = isBoolean(options.missingWarn) || isRegExp(options.missingWarn) ? options.missingWarn : true;
    const fallbackWarn = isBoolean(options.fallbackWarn) || isRegExp(options.fallbackWarn) ? options.fallbackWarn : true;
    const fallbackFormat = !!options.fallbackFormat;
    const unresolving = !!options.unresolving;
    const postTranslation = isFunction(options.postTranslation) ? options.postTranslation : null;
    const processor = isPlainObject(options.processor) ? options.processor : null;
    const warnHtmlMessage = isBoolean(options.warnHtmlMessage) ? options.warnHtmlMessage : true;
    const escapeParameter = !!options.escapeParameter;
    const messageCompiler = isFunction(options.messageCompiler) ? options.messageCompiler : _compiler;
    const onWarn = isFunction(options.onWarn) ? options.onWarn : warn;
    const internalOptions = options;
    const __datetimeFormatters = isObject$1(internalOptions.__datetimeFormatters) ? internalOptions.__datetimeFormatters : /* @__PURE__ */ new Map();
    const __numberFormatters = isObject$1(internalOptions.__numberFormatters) ? internalOptions.__numberFormatters : /* @__PURE__ */ new Map();
    const __meta = isObject$1(internalOptions.__meta) ? internalOptions.__meta : {};
    _cid++;
    const context = {
      version,
      cid: _cid,
      locale,
      fallbackLocale,
      messages: messages2,
      datetimeFormats,
      numberFormats,
      modifiers,
      pluralRules,
      missing,
      missingWarn,
      fallbackWarn,
      fallbackFormat,
      unresolving,
      postTranslation,
      processor,
      warnHtmlMessage,
      escapeParameter,
      messageCompiler,
      onWarn,
      __datetimeFormatters,
      __numberFormatters,
      __meta
    };
    {
      context.__v_emitter = internalOptions.__v_emitter != null ? internalOptions.__v_emitter : void 0;
    }
    {
      initI18nDevTools(context, version, __meta);
    }
    return context;
  }
  function isTranslateFallbackWarn(fallback, key) {
    return fallback instanceof RegExp ? fallback.test(key) : fallback;
  }
  function isTranslateMissingWarn(missing, key) {
    return missing instanceof RegExp ? missing.test(key) : missing;
  }
  function handleMissing(context, key, locale, missingWarn, type) {
    const { missing, onWarn } = context;
    {
      const emitter = context.__v_emitter;
      if (emitter) {
        emitter.emit("missing", {
          locale,
          key,
          type,
          groupId: `${type}:${key}`
        });
      }
    }
    if (missing !== null) {
      const ret = missing(context, locale, key, type);
      return isString(ret) ? ret : key;
    } else {
      if (isTranslateMissingWarn(missingWarn, key)) {
        onWarn(getWarnMessage$1(0, { key, locale }));
      }
      return key;
    }
  }
  function getLocaleChain(ctx, fallback, start) {
    const context = ctx;
    if (!context.__localeChainCache) {
      context.__localeChainCache = /* @__PURE__ */ new Map();
    }
    let chain = context.__localeChainCache.get(start);
    if (!chain) {
      chain = [];
      let block = [start];
      while (isArray(block)) {
        block = appendBlockToChain(chain, block, fallback);
      }
      const defaults = isArray(fallback) ? fallback : isPlainObject(fallback) ? fallback["default"] ? fallback["default"] : null : fallback;
      block = isString(defaults) ? [defaults] : defaults;
      if (isArray(block)) {
        appendBlockToChain(chain, block, false);
      }
      context.__localeChainCache.set(start, chain);
    }
    return chain;
  }
  function appendBlockToChain(chain, block, blocks) {
    let follow = true;
    for (let i2 = 0; i2 < block.length && isBoolean(follow); i2++) {
      const locale = block[i2];
      if (isString(locale)) {
        follow = appendLocaleToChain(chain, block[i2], blocks);
      }
    }
    return follow;
  }
  function appendLocaleToChain(chain, locale, blocks) {
    let follow;
    const tokens = locale.split("-");
    do {
      const target = tokens.join("-");
      follow = appendItemToChain(chain, target, blocks);
      tokens.splice(-1, 1);
    } while (tokens.length && follow === true);
    return follow;
  }
  function appendItemToChain(chain, target, blocks) {
    let follow = false;
    if (!chain.includes(target)) {
      follow = true;
      if (target) {
        follow = target[target.length - 1] !== "!";
        const locale = target.replace(/!/g, "");
        chain.push(locale);
        if ((isArray(blocks) || isPlainObject(blocks)) && blocks[locale]) {
          follow = blocks[locale];
        }
      }
    }
    return follow;
  }
  function updateFallbackLocale(ctx, locale, fallback) {
    const context = ctx;
    context.__localeChainCache = /* @__PURE__ */ new Map();
    getLocaleChain(ctx, fallback, locale);
  }
  function createCoreError(code) {
    return createCompileError(code, null, { messages: errorMessages$1 });
  }
  const errorMessages$1 = {
    [
      14
      /* INVALID_ARGUMENT */
    ]: "Invalid arguments",
    [
      15
      /* INVALID_DATE_ARGUMENT */
    ]: "The date provided is an invalid Date object.Make sure your Date represents a valid date.",
    [
      16
      /* INVALID_ISO_DATE_ARGUMENT */
    ]: "The argument provided is not a valid ISO date string"
  };
  const NOOP_MESSAGE_FUNCTION = () => "";
  const isMessageFunction = (val) => isFunction(val);
  function translate(context, ...args) {
    const { fallbackFormat, postTranslation, unresolving, fallbackLocale, messages: messages2 } = context;
    const [key, options] = parseTranslateArgs(...args);
    const missingWarn = isBoolean(options.missingWarn) ? options.missingWarn : context.missingWarn;
    const fallbackWarn = isBoolean(options.fallbackWarn) ? options.fallbackWarn : context.fallbackWarn;
    const escapeParameter = isBoolean(options.escapeParameter) ? options.escapeParameter : context.escapeParameter;
    const resolvedMessage = !!options.resolvedMessage;
    const defaultMsgOrKey = isString(options.default) || isBoolean(options.default) ? !isBoolean(options.default) ? options.default : key : fallbackFormat ? key : "";
    const enableDefaultMsg = fallbackFormat || defaultMsgOrKey !== "";
    const locale = isString(options.locale) ? options.locale : context.locale;
    escapeParameter && escapeParams(options);
    let [format2, targetLocale, message2] = !resolvedMessage ? resolveMessageFormat(context, key, locale, fallbackLocale, fallbackWarn, missingWarn) : [
      key,
      locale,
      messages2[locale] || {}
    ];
    let cacheBaseKey = key;
    if (!resolvedMessage && !(isString(format2) || isMessageFunction(format2))) {
      if (enableDefaultMsg) {
        format2 = defaultMsgOrKey;
        cacheBaseKey = format2;
      }
    }
    if (!resolvedMessage && (!(isString(format2) || isMessageFunction(format2)) || !isString(targetLocale))) {
      return unresolving ? NOT_REOSLVED : key;
    }
    if (isString(format2) && context.messageCompiler == null) {
      warn(`The message format compilation is not supported in this build. Because message compiler isn't included. You need to pre-compilation all message format. So translate function return '${key}'.`);
      return key;
    }
    let occurred = false;
    const errorDetector = () => {
      occurred = true;
    };
    const msg = !isMessageFunction(format2) ? compileMessageFormat(context, key, targetLocale, format2, cacheBaseKey, errorDetector) : format2;
    if (occurred) {
      return format2;
    }
    const ctxOptions = getMessageContextOptions(context, targetLocale, message2, options);
    const msgContext = createMessageContext(ctxOptions);
    const messaged = evaluateMessage(context, msg, msgContext);
    const ret = postTranslation ? postTranslation(messaged) : messaged;
    {
      const payloads = {
        timestamp: Date.now(),
        key: isString(key) ? key : isMessageFunction(format2) ? format2.key : "",
        locale: targetLocale || (isMessageFunction(format2) ? format2.locale : ""),
        format: isString(format2) ? format2 : isMessageFunction(format2) ? format2.source : "",
        message: ret
      };
      payloads.meta = assign({}, context.__meta, getAdditionalMeta() || {});
      translateDevTools(payloads);
    }
    return ret;
  }
  function escapeParams(options) {
    if (isArray(options.list)) {
      options.list = options.list.map((item) => isString(item) ? escapeHtml(item) : item);
    } else if (isObject$1(options.named)) {
      Object.keys(options.named).forEach((key) => {
        if (isString(options.named[key])) {
          options.named[key] = escapeHtml(options.named[key]);
        }
      });
    }
  }
  function resolveMessageFormat(context, key, locale, fallbackLocale, fallbackWarn, missingWarn) {
    const { messages: messages2, onWarn } = context;
    const locales = getLocaleChain(context, fallbackLocale, locale);
    let message2 = {};
    let targetLocale;
    let format2 = null;
    let from = locale;
    let to = null;
    const type = "translate";
    for (let i2 = 0; i2 < locales.length; i2++) {
      targetLocale = to = locales[i2];
      if (locale !== targetLocale && isTranslateFallbackWarn(fallbackWarn, key)) {
        onWarn(getWarnMessage$1(1, {
          key,
          target: targetLocale
        }));
      }
      if (locale !== targetLocale) {
        const emitter = context.__v_emitter;
        if (emitter) {
          emitter.emit("fallback", {
            type,
            key,
            from,
            to,
            groupId: `${type}:${key}`
          });
        }
      }
      message2 = messages2[targetLocale] || {};
      let start = null;
      let startTag;
      let endTag;
      if (inBrowser) {
        start = window.performance.now();
        startTag = "intlify-message-resolve-start";
        endTag = "intlify-message-resolve-end";
        mark && mark(startTag);
      }
      if ((format2 = resolveValue(message2, key)) === null) {
        format2 = message2[key];
      }
      if (inBrowser) {
        const end = window.performance.now();
        const emitter = context.__v_emitter;
        if (emitter && start && format2) {
          emitter.emit("message-resolve", {
            type: "message-resolve",
            key,
            message: format2,
            time: end - start,
            groupId: `${type}:${key}`
          });
        }
        if (startTag && endTag && mark && measure) {
          mark(endTag);
          measure("intlify message resolve", startTag, endTag);
        }
      }
      if (isString(format2) || isFunction(format2))
        break;
      const missingRet = handleMissing(context, key, targetLocale, missingWarn, type);
      if (missingRet !== key) {
        format2 = missingRet;
      }
      from = to;
    }
    return [format2, targetLocale, message2];
  }
  function compileMessageFormat(context, key, targetLocale, format2, cacheBaseKey, errorDetector) {
    const { messageCompiler, warnHtmlMessage } = context;
    if (isMessageFunction(format2)) {
      const msg2 = format2;
      msg2.locale = msg2.locale || targetLocale;
      msg2.key = msg2.key || key;
      return msg2;
    }
    let start = null;
    let startTag;
    let endTag;
    if (inBrowser) {
      start = window.performance.now();
      startTag = "intlify-message-compilation-start";
      endTag = "intlify-message-compilation-end";
      mark && mark(startTag);
    }
    const msg = messageCompiler(format2, getCompileOptions(context, targetLocale, cacheBaseKey, format2, warnHtmlMessage, errorDetector));
    if (inBrowser) {
      const end = window.performance.now();
      const emitter = context.__v_emitter;
      if (emitter && start) {
        emitter.emit("message-compilation", {
          type: "message-compilation",
          message: format2,
          time: end - start,
          groupId: `${"translate"}:${key}`
        });
      }
      if (startTag && endTag && mark && measure) {
        mark(endTag);
        measure("intlify message compilation", startTag, endTag);
      }
    }
    msg.locale = targetLocale;
    msg.key = key;
    msg.source = format2;
    return msg;
  }
  function evaluateMessage(context, msg, msgCtx) {
    let start = null;
    let startTag;
    let endTag;
    if (inBrowser) {
      start = window.performance.now();
      startTag = "intlify-message-evaluation-start";
      endTag = "intlify-message-evaluation-end";
      mark && mark(startTag);
    }
    const messaged = msg(msgCtx);
    if (inBrowser) {
      const end = window.performance.now();
      const emitter = context.__v_emitter;
      if (emitter && start) {
        emitter.emit("message-evaluation", {
          type: "message-evaluation",
          value: messaged,
          time: end - start,
          groupId: `${"translate"}:${msg.key}`
        });
      }
      if (startTag && endTag && mark && measure) {
        mark(endTag);
        measure("intlify message evaluation", startTag, endTag);
      }
    }
    return messaged;
  }
  function parseTranslateArgs(...args) {
    const [arg1, arg2, arg3] = args;
    const options = {};
    if (!isString(arg1) && !isNumber(arg1) && !isMessageFunction(arg1)) {
      throw createCoreError(
        14
        /* INVALID_ARGUMENT */
      );
    }
    const key = isNumber(arg1) ? String(arg1) : isMessageFunction(arg1) ? arg1 : arg1;
    if (isNumber(arg2)) {
      options.plural = arg2;
    } else if (isString(arg2)) {
      options.default = arg2;
    } else if (isPlainObject(arg2) && !isEmptyObject(arg2)) {
      options.named = arg2;
    } else if (isArray(arg2)) {
      options.list = arg2;
    }
    if (isNumber(arg3)) {
      options.plural = arg3;
    } else if (isString(arg3)) {
      options.default = arg3;
    } else if (isPlainObject(arg3)) {
      assign(options, arg3);
    }
    return [key, options];
  }
  function getCompileOptions(context, locale, key, source, warnHtmlMessage, errorDetector) {
    return {
      warnHtmlMessage,
      onError: (err) => {
        errorDetector && errorDetector(err);
        {
          const message2 = `Message compilation error: ${err.message}`;
          const codeFrame = err.location && generateCodeFrame(source, err.location.start.offset, err.location.end.offset);
          const emitter = context.__v_emitter;
          if (emitter) {
            emitter.emit("compile-error", {
              message: source,
              error: err.message,
              start: err.location && err.location.start.offset,
              end: err.location && err.location.end.offset,
              groupId: `${"translate"}:${key}`
            });
          }
          console.error(codeFrame ? `${message2}
${codeFrame}` : message2);
        }
      },
      onCacheKey: (source2) => generateFormatCacheKey(locale, key, source2)
    };
  }
  function getMessageContextOptions(context, locale, message2, options) {
    const { modifiers, pluralRules } = context;
    const resolveMessage = (key) => {
      const val = resolveValue(message2, key);
      if (isString(val)) {
        let occurred = false;
        const errorDetector = () => {
          occurred = true;
        };
        const msg = compileMessageFormat(context, key, locale, val, key, errorDetector);
        return !occurred ? msg : NOOP_MESSAGE_FUNCTION;
      } else if (isMessageFunction(val)) {
        return val;
      } else {
        return NOOP_MESSAGE_FUNCTION;
      }
    };
    const ctxOptions = {
      locale,
      modifiers,
      pluralRules,
      messages: resolveMessage
    };
    if (context.processor) {
      ctxOptions.processor = context.processor;
    }
    if (options.list) {
      ctxOptions.list = options.list;
    }
    if (options.named) {
      ctxOptions.named = options.named;
    }
    if (isNumber(options.plural)) {
      ctxOptions.pluralIndex = options.plural;
    }
    return ctxOptions;
  }
  const intlDefined = typeof Intl !== "undefined";
  const Availabilities = {
    dateTimeFormat: intlDefined && typeof Intl.DateTimeFormat !== "undefined",
    numberFormat: intlDefined && typeof Intl.NumberFormat !== "undefined"
  };
  function datetime(context, ...args) {
    const { datetimeFormats, unresolving, fallbackLocale, onWarn } = context;
    const { __datetimeFormatters } = context;
    if (!Availabilities.dateTimeFormat) {
      onWarn(getWarnMessage$1(
        4
        /* CANNOT_FORMAT_DATE */
      ));
      return MISSING_RESOLVE_VALUE;
    }
    const [key, value, options, overrides] = parseDateTimeArgs(...args);
    const missingWarn = isBoolean(options.missingWarn) ? options.missingWarn : context.missingWarn;
    const fallbackWarn = isBoolean(options.fallbackWarn) ? options.fallbackWarn : context.fallbackWarn;
    const part = !!options.part;
    const locale = isString(options.locale) ? options.locale : context.locale;
    const locales = getLocaleChain(context, fallbackLocale, locale);
    if (!isString(key) || key === "") {
      return new Intl.DateTimeFormat(locale).format(value);
    }
    let datetimeFormat = {};
    let targetLocale;
    let format2 = null;
    let from = locale;
    let to = null;
    const type = "datetime format";
    for (let i2 = 0; i2 < locales.length; i2++) {
      targetLocale = to = locales[i2];
      if (locale !== targetLocale && isTranslateFallbackWarn(fallbackWarn, key)) {
        onWarn(getWarnMessage$1(5, {
          key,
          target: targetLocale
        }));
      }
      if (locale !== targetLocale) {
        const emitter = context.__v_emitter;
        if (emitter) {
          emitter.emit("fallback", {
            type,
            key,
            from,
            to,
            groupId: `${type}:${key}`
          });
        }
      }
      datetimeFormat = datetimeFormats[targetLocale] || {};
      format2 = datetimeFormat[key];
      if (isPlainObject(format2))
        break;
      handleMissing(context, key, targetLocale, missingWarn, type);
      from = to;
    }
    if (!isPlainObject(format2) || !isString(targetLocale)) {
      return unresolving ? NOT_REOSLVED : key;
    }
    let id = `${targetLocale}__${key}`;
    if (!isEmptyObject(overrides)) {
      id = `${id}__${JSON.stringify(overrides)}`;
    }
    let formatter = __datetimeFormatters.get(id);
    if (!formatter) {
      formatter = new Intl.DateTimeFormat(targetLocale, assign({}, format2, overrides));
      __datetimeFormatters.set(id, formatter);
    }
    return !part ? formatter.format(value) : formatter.formatToParts(value);
  }
  function parseDateTimeArgs(...args) {
    const [arg1, arg2, arg3, arg4] = args;
    let options = {};
    let overrides = {};
    let value;
    if (isString(arg1)) {
      if (!/\d{4}-\d{2}-\d{2}(T.*)?/.test(arg1)) {
        throw createCoreError(
          16
          /* INVALID_ISO_DATE_ARGUMENT */
        );
      }
      value = new Date(arg1);
      try {
        value.toISOString();
      } catch (e) {
        throw createCoreError(
          16
          /* INVALID_ISO_DATE_ARGUMENT */
        );
      }
    } else if (isDate(arg1)) {
      if (isNaN(arg1.getTime())) {
        throw createCoreError(
          15
          /* INVALID_DATE_ARGUMENT */
        );
      }
      value = arg1;
    } else if (isNumber(arg1)) {
      value = arg1;
    } else {
      throw createCoreError(
        14
        /* INVALID_ARGUMENT */
      );
    }
    if (isString(arg2)) {
      options.key = arg2;
    } else if (isPlainObject(arg2)) {
      options = arg2;
    }
    if (isString(arg3)) {
      options.locale = arg3;
    } else if (isPlainObject(arg3)) {
      overrides = arg3;
    }
    if (isPlainObject(arg4)) {
      overrides = arg4;
    }
    return [options.key || "", value, options, overrides];
  }
  function clearDateTimeFormat(ctx, locale, format2) {
    const context = ctx;
    for (const key in format2) {
      const id = `${locale}__${key}`;
      if (!context.__datetimeFormatters.has(id)) {
        continue;
      }
      context.__datetimeFormatters.delete(id);
    }
  }
  function number(context, ...args) {
    const { numberFormats, unresolving, fallbackLocale, onWarn } = context;
    const { __numberFormatters } = context;
    if (!Availabilities.numberFormat) {
      onWarn(getWarnMessage$1(
        2
        /* CANNOT_FORMAT_NUMBER */
      ));
      return MISSING_RESOLVE_VALUE;
    }
    const [key, value, options, overrides] = parseNumberArgs(...args);
    const missingWarn = isBoolean(options.missingWarn) ? options.missingWarn : context.missingWarn;
    const fallbackWarn = isBoolean(options.fallbackWarn) ? options.fallbackWarn : context.fallbackWarn;
    const part = !!options.part;
    const locale = isString(options.locale) ? options.locale : context.locale;
    const locales = getLocaleChain(context, fallbackLocale, locale);
    if (!isString(key) || key === "") {
      return new Intl.NumberFormat(locale).format(value);
    }
    let numberFormat = {};
    let targetLocale;
    let format2 = null;
    let from = locale;
    let to = null;
    const type = "number format";
    for (let i2 = 0; i2 < locales.length; i2++) {
      targetLocale = to = locales[i2];
      if (locale !== targetLocale && isTranslateFallbackWarn(fallbackWarn, key)) {
        onWarn(getWarnMessage$1(3, {
          key,
          target: targetLocale
        }));
      }
      if (locale !== targetLocale) {
        const emitter = context.__v_emitter;
        if (emitter) {
          emitter.emit("fallback", {
            type,
            key,
            from,
            to,
            groupId: `${type}:${key}`
          });
        }
      }
      numberFormat = numberFormats[targetLocale] || {};
      format2 = numberFormat[key];
      if (isPlainObject(format2))
        break;
      handleMissing(context, key, targetLocale, missingWarn, type);
      from = to;
    }
    if (!isPlainObject(format2) || !isString(targetLocale)) {
      return unresolving ? NOT_REOSLVED : key;
    }
    let id = `${targetLocale}__${key}`;
    if (!isEmptyObject(overrides)) {
      id = `${id}__${JSON.stringify(overrides)}`;
    }
    let formatter = __numberFormatters.get(id);
    if (!formatter) {
      formatter = new Intl.NumberFormat(targetLocale, assign({}, format2, overrides));
      __numberFormatters.set(id, formatter);
    }
    return !part ? formatter.format(value) : formatter.formatToParts(value);
  }
  function parseNumberArgs(...args) {
    const [arg1, arg2, arg3, arg4] = args;
    let options = {};
    let overrides = {};
    if (!isNumber(arg1)) {
      throw createCoreError(
        14
        /* INVALID_ARGUMENT */
      );
    }
    const value = arg1;
    if (isString(arg2)) {
      options.key = arg2;
    } else if (isPlainObject(arg2)) {
      options = arg2;
    }
    if (isString(arg3)) {
      options.locale = arg3;
    } else if (isPlainObject(arg3)) {
      overrides = arg3;
    }
    if (isPlainObject(arg4)) {
      overrides = arg4;
    }
    return [options.key || "", value, options, overrides];
  }
  function clearNumberFormat(ctx, locale, format2) {
    const context = ctx;
    for (const key in format2) {
      const id = `${locale}__${key}`;
      if (!context.__numberFormatters.has(id)) {
        continue;
      }
      context.__numberFormatters.delete(id);
    }
  }
  function getDevtoolsGlobalHook() {
    return getTarget().__VUE_DEVTOOLS_GLOBAL_HOOK__;
  }
  function getTarget() {
    return typeof navigator !== "undefined" && typeof window !== "undefined" ? window : typeof global !== "undefined" ? global : {};
  }
  const isProxyAvailable = typeof Proxy === "function";
  const HOOK_SETUP = "devtools-plugin:setup";
  const HOOK_PLUGIN_SETTINGS_SET = "plugin:settings:set";
  class ApiProxy {
    constructor(plugin, hook) {
      this.target = null;
      this.targetQueue = [];
      this.onQueue = [];
      this.plugin = plugin;
      this.hook = hook;
      const defaultSettings = {};
      if (plugin.settings) {
        for (const id in plugin.settings) {
          const item = plugin.settings[id];
          defaultSettings[id] = item.defaultValue;
        }
      }
      const localSettingsSaveId = `__vue-devtools-plugin-settings__${plugin.id}`;
      let currentSettings = { ...defaultSettings };
      try {
        const raw = localStorage.getItem(localSettingsSaveId);
        const data = JSON.parse(raw);
        Object.assign(currentSettings, data);
      } catch (e) {
      }
      this.fallbacks = {
        getSettings() {
          return currentSettings;
        },
        setSettings(value) {
          try {
            localStorage.setItem(localSettingsSaveId, JSON.stringify(value));
          } catch (e) {
          }
          currentSettings = value;
        }
      };
      hook.on(HOOK_PLUGIN_SETTINGS_SET, (pluginId, value) => {
        if (pluginId === this.plugin.id) {
          this.fallbacks.setSettings(value);
        }
      });
      this.proxiedOn = new Proxy({}, {
        get: (_target, prop) => {
          if (this.target) {
            return this.target.on[prop];
          } else {
            return (...args) => {
              this.onQueue.push({
                method: prop,
                args
              });
            };
          }
        }
      });
      this.proxiedTarget = new Proxy({}, {
        get: (_target, prop) => {
          if (this.target) {
            return this.target[prop];
          } else if (prop === "on") {
            return this.proxiedOn;
          } else if (Object.keys(this.fallbacks).includes(prop)) {
            return (...args) => {
              this.targetQueue.push({
                method: prop,
                args,
                resolve: () => {
                }
              });
              return this.fallbacks[prop](...args);
            };
          } else {
            return (...args) => {
              return new Promise((resolve) => {
                this.targetQueue.push({
                  method: prop,
                  args,
                  resolve
                });
              });
            };
          }
        }
      });
    }
    async setRealTarget(target) {
      this.target = target;
      for (const item of this.onQueue) {
        this.target.on[item.method](...item.args);
      }
      for (const item of this.targetQueue) {
        item.resolve(await this.target[item.method](...item.args));
      }
    }
  }
  function setupDevtoolsPlugin(pluginDescriptor, setupFn) {
    const target = getTarget();
    const hook = getDevtoolsGlobalHook();
    const enableProxy = isProxyAvailable && pluginDescriptor.enableEarlyProxy;
    if (hook && (target.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__ || !enableProxy)) {
      hook.emit(HOOK_SETUP, pluginDescriptor, setupFn);
    } else {
      const proxy = enableProxy ? new ApiProxy(pluginDescriptor, hook) : null;
      const list2 = target.__VUE_DEVTOOLS_PLUGINS__ = target.__VUE_DEVTOOLS_PLUGINS__ || [];
      list2.push({
        pluginDescriptor,
        setupFn,
        proxy
      });
      if (proxy)
        setupFn(proxy.proxiedTarget);
    }
  }
  /*!
    * @intlify/vue-devtools v9.1.9
    * (c) 2021 kazuya kawaguchi
    * Released under the MIT License.
    */
  const VueDevToolsLabels = {
    [
      "vue-devtools-plugin-vue-i18n"
      /* PLUGIN */
    ]: "Vue I18n devtools",
    [
      "vue-i18n-resource-inspector"
      /* CUSTOM_INSPECTOR */
    ]: "I18n Resources",
    [
      "vue-i18n-timeline"
      /* TIMELINE */
    ]: "Vue I18n"
  };
  const VueDevToolsPlaceholders = {
    [
      "vue-i18n-resource-inspector"
      /* CUSTOM_INSPECTOR */
    ]: "Search for scopes ..."
  };
  const VueDevToolsTimelineColors = {
    [
      "vue-i18n-timeline"
      /* TIMELINE */
    ]: 16764185
  };
  /*!
    * vue-i18n v9.1.9
    * (c) 2022 kazuya kawaguchi
    * Released under the MIT License.
    */
  const VERSION = "9.1.9";
  function initFeatureFlags() {
    let needWarn = false;
    {
      needWarn = true;
    }
    if (needWarn) {
      console.warn(`You are running the esm-bundler build of vue-i18n. It is recommended to configure your bundler to explicitly replace feature flag globals with boolean literals to get proper tree-shaking in the final bundle.`);
    }
  }
  const warnMessages = {
    [
      6
      /* FALLBACK_TO_ROOT */
    ]: `Fall back to {type} '{key}' with root locale.`,
    [
      7
      /* NOT_SUPPORTED_PRESERVE */
    ]: `Not supported 'preserve'.`,
    [
      8
      /* NOT_SUPPORTED_FORMATTER */
    ]: `Not supported 'formatter'.`,
    [
      9
      /* NOT_SUPPORTED_PRESERVE_DIRECTIVE */
    ]: `Not supported 'preserveDirectiveContent'.`,
    [
      10
      /* NOT_SUPPORTED_GET_CHOICE_INDEX */
    ]: `Not supported 'getChoiceIndex'.`,
    [
      11
      /* COMPONENT_NAME_LEGACY_COMPATIBLE */
    ]: `Component name legacy compatible: '{name}' -> 'i18n'`,
    [
      12
      /* NOT_FOUND_PARENT_SCOPE */
    ]: `Not found parent scope. use the global scope.`
  };
  function getWarnMessage(code, ...args) {
    return format(warnMessages[code], ...args);
  }
  function createI18nError(code, ...args) {
    return createCompileError(code, null, { messages: errorMessages, args });
  }
  const errorMessages = {
    [
      14
      /* UNEXPECTED_RETURN_TYPE */
    ]: "Unexpected return type in composer",
    [
      15
      /* INVALID_ARGUMENT */
    ]: "Invalid argument",
    [
      16
      /* MUST_BE_CALL_SETUP_TOP */
    ]: "Must be called at the top of a `setup` function",
    [
      17
      /* NOT_INSLALLED */
    ]: "Need to install with `app.use` function",
    [
      22
      /* UNEXPECTED_ERROR */
    ]: "Unexpected error",
    [
      18
      /* NOT_AVAILABLE_IN_LEGACY_MODE */
    ]: "Not available in legacy mode",
    [
      19
      /* REQUIRED_VALUE */
    ]: `Required in value: {0}`,
    [
      20
      /* INVALID_VALUE */
    ]: `Invalid value`,
    [
      21
      /* CANNOT_SETUP_VUE_DEVTOOLS_PLUGIN */
    ]: `Cannot setup vue-devtools plugin`
  };
  const DEVTOOLS_META = "__INTLIFY_META__";
  const TransrateVNodeSymbol = makeSymbol("__transrateVNode");
  const DatetimePartsSymbol = makeSymbol("__datetimeParts");
  const NumberPartsSymbol = makeSymbol("__numberParts");
  const EnableEmitter = makeSymbol("__enableEmitter");
  const DisableEmitter = makeSymbol("__disableEmitter");
  const SetPluralRulesSymbol = makeSymbol("__setPluralRules");
  const InejctWithOption = makeSymbol("__injectWithOption");
  let composerID = 0;
  function defineCoreMissingHandler(missing) {
    return (ctx, locale, key, type) => {
      return missing(locale, key, vue.getCurrentInstance() || void 0, type);
    };
  }
  function getLocaleMessages(locale, options) {
    const { messages: messages2, __i18n } = options;
    const ret = isPlainObject(messages2) ? messages2 : isArray(__i18n) ? {} : { [locale]: {} };
    if (isArray(__i18n)) {
      __i18n.forEach(({ locale: locale2, resource }) => {
        if (locale2) {
          ret[locale2] = ret[locale2] || {};
          deepCopy(resource, ret[locale2]);
        } else {
          deepCopy(resource, ret);
        }
      });
    }
    if (options.flatJson) {
      for (const key in ret) {
        if (hasOwn$1(ret, key)) {
          handleFlatJson(ret[key]);
        }
      }
    }
    return ret;
  }
  const isNotObjectOrIsArray = (val) => !isObject$1(val) || isArray(val);
  function deepCopy(src, des) {
    if (isNotObjectOrIsArray(src) || isNotObjectOrIsArray(des)) {
      throw createI18nError(
        20
        /* INVALID_VALUE */
      );
    }
    for (const key in src) {
      if (hasOwn$1(src, key)) {
        if (isNotObjectOrIsArray(src[key]) || isNotObjectOrIsArray(des[key])) {
          des[key] = src[key];
        } else {
          deepCopy(src[key], des[key]);
        }
      }
    }
  }
  const getMetaInfo = () => {
    const instance = vue.getCurrentInstance();
    return instance && instance.type[DEVTOOLS_META] ? { [DEVTOOLS_META]: instance.type[DEVTOOLS_META] } : null;
  };
  function createComposer(options = {}) {
    const { __root } = options;
    const _isGlobal = __root === void 0;
    let _inheritLocale = isBoolean(options.inheritLocale) ? options.inheritLocale : true;
    const _locale = vue.ref(
      // prettier-ignore
      __root && _inheritLocale ? __root.locale.value : isString(options.locale) ? options.locale : "en-US"
    );
    const _fallbackLocale = vue.ref(
      // prettier-ignore
      __root && _inheritLocale ? __root.fallbackLocale.value : isString(options.fallbackLocale) || isArray(options.fallbackLocale) || isPlainObject(options.fallbackLocale) || options.fallbackLocale === false ? options.fallbackLocale : _locale.value
    );
    const _messages = vue.ref(getLocaleMessages(_locale.value, options));
    const _datetimeFormats = vue.ref(isPlainObject(options.datetimeFormats) ? options.datetimeFormats : { [_locale.value]: {} });
    const _numberFormats = vue.ref(isPlainObject(options.numberFormats) ? options.numberFormats : { [_locale.value]: {} });
    let _missingWarn = __root ? __root.missingWarn : isBoolean(options.missingWarn) || isRegExp(options.missingWarn) ? options.missingWarn : true;
    let _fallbackWarn = __root ? __root.fallbackWarn : isBoolean(options.fallbackWarn) || isRegExp(options.fallbackWarn) ? options.fallbackWarn : true;
    let _fallbackRoot = __root ? __root.fallbackRoot : isBoolean(options.fallbackRoot) ? options.fallbackRoot : true;
    let _fallbackFormat = !!options.fallbackFormat;
    let _missing = isFunction(options.missing) ? options.missing : null;
    let _runtimeMissing = isFunction(options.missing) ? defineCoreMissingHandler(options.missing) : null;
    let _postTranslation = isFunction(options.postTranslation) ? options.postTranslation : null;
    let _warnHtmlMessage = isBoolean(options.warnHtmlMessage) ? options.warnHtmlMessage : true;
    let _escapeParameter = !!options.escapeParameter;
    const _modifiers = __root ? __root.modifiers : isPlainObject(options.modifiers) ? options.modifiers : {};
    let _pluralRules = options.pluralRules || __root && __root.pluralRules;
    let _context;
    function getCoreContext() {
      return createCoreContext({
        version: VERSION,
        locale: _locale.value,
        fallbackLocale: _fallbackLocale.value,
        messages: _messages.value,
        messageCompiler: function compileToFunction(source) {
          return (ctx) => {
            return ctx.normalize([source]);
          };
        },
        datetimeFormats: _datetimeFormats.value,
        numberFormats: _numberFormats.value,
        modifiers: _modifiers,
        pluralRules: _pluralRules,
        missing: _runtimeMissing === null ? void 0 : _runtimeMissing,
        missingWarn: _missingWarn,
        fallbackWarn: _fallbackWarn,
        fallbackFormat: _fallbackFormat,
        unresolving: true,
        postTranslation: _postTranslation === null ? void 0 : _postTranslation,
        warnHtmlMessage: _warnHtmlMessage,
        escapeParameter: _escapeParameter,
        __datetimeFormatters: isPlainObject(_context) ? _context.__datetimeFormatters : void 0,
        __numberFormatters: isPlainObject(_context) ? _context.__numberFormatters : void 0,
        __v_emitter: isPlainObject(_context) ? _context.__v_emitter : void 0,
        __meta: { framework: "vue" }
      });
    }
    _context = getCoreContext();
    updateFallbackLocale(_context, _locale.value, _fallbackLocale.value);
    function trackReactivityValues() {
      return [
        _locale.value,
        _fallbackLocale.value,
        _messages.value,
        _datetimeFormats.value,
        _numberFormats.value
      ];
    }
    const locale = vue.computed({
      get: () => _locale.value,
      set: (val) => {
        _locale.value = val;
        _context.locale = _locale.value;
      }
    });
    const fallbackLocale = vue.computed({
      get: () => _fallbackLocale.value,
      set: (val) => {
        _fallbackLocale.value = val;
        _context.fallbackLocale = _fallbackLocale.value;
        updateFallbackLocale(_context, _locale.value, val);
      }
    });
    const messages2 = vue.computed(() => _messages.value);
    const datetimeFormats = vue.computed(() => _datetimeFormats.value);
    const numberFormats = vue.computed(() => _numberFormats.value);
    function getPostTranslationHandler() {
      return isFunction(_postTranslation) ? _postTranslation : null;
    }
    function setPostTranslationHandler(handler) {
      _postTranslation = handler;
      _context.postTranslation = handler;
    }
    function getMissingHandler() {
      return _missing;
    }
    function setMissingHandler(handler) {
      if (handler !== null) {
        _runtimeMissing = defineCoreMissingHandler(handler);
      }
      _missing = handler;
      _context.missing = _runtimeMissing;
    }
    function isResolvedTranslateMessage(type, arg) {
      return type !== "translate" || !!arg.resolvedMessage === false;
    }
    function wrapWithDeps(fn, argumentParser, warnType, fallbackSuccess, fallbackFail, successCondition) {
      trackReactivityValues();
      let ret;
      {
        try {
          setAdditionalMeta(getMetaInfo());
          ret = fn(_context);
        } finally {
          setAdditionalMeta(null);
        }
      }
      if (isNumber(ret) && ret === NOT_REOSLVED) {
        const [key, arg2] = argumentParser();
        if (__root && isString(key) && isResolvedTranslateMessage(warnType, arg2)) {
          if (_fallbackRoot && (isTranslateFallbackWarn(_fallbackWarn, key) || isTranslateMissingWarn(_missingWarn, key))) {
            warn(getWarnMessage(6, {
              key,
              type: warnType
            }));
          }
          {
            const { __v_emitter: emitter } = _context;
            if (emitter && _fallbackRoot) {
              emitter.emit("fallback", {
                type: warnType,
                key,
                to: "global",
                groupId: `${warnType}:${key}`
              });
            }
          }
        }
        return __root && _fallbackRoot ? fallbackSuccess(__root) : fallbackFail(key);
      } else if (successCondition(ret)) {
        return ret;
      } else {
        throw createI18nError(
          14
          /* UNEXPECTED_RETURN_TYPE */
        );
      }
    }
    function t2(...args) {
      return wrapWithDeps((context) => translate(context, ...args), () => parseTranslateArgs(...args), "translate", (root) => root.t(...args), (key) => key, (val) => isString(val));
    }
    function rt(...args) {
      const [arg1, arg2, arg3] = args;
      if (arg3 && !isObject$1(arg3)) {
        throw createI18nError(
          15
          /* INVALID_ARGUMENT */
        );
      }
      return t2(...[arg1, arg2, assign({ resolvedMessage: true }, arg3 || {})]);
    }
    function d(...args) {
      return wrapWithDeps((context) => datetime(context, ...args), () => parseDateTimeArgs(...args), "datetime format", (root) => root.d(...args), () => MISSING_RESOLVE_VALUE, (val) => isString(val));
    }
    function n(...args) {
      return wrapWithDeps((context) => number(context, ...args), () => parseNumberArgs(...args), "number format", (root) => root.n(...args), () => MISSING_RESOLVE_VALUE, (val) => isString(val));
    }
    function normalize(values) {
      return values.map((val) => isString(val) ? vue.createVNode(vue.Text, null, val, 0) : val);
    }
    const interpolate = (val) => val;
    const processor = {
      normalize,
      interpolate,
      type: "vnode"
    };
    function transrateVNode(...args) {
      return wrapWithDeps(
        (context) => {
          let ret;
          const _context2 = context;
          try {
            _context2.processor = processor;
            ret = translate(_context2, ...args);
          } finally {
            _context2.processor = null;
          }
          return ret;
        },
        () => parseTranslateArgs(...args),
        "translate",
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        (root) => root[TransrateVNodeSymbol](...args),
        (key) => [vue.createVNode(vue.Text, null, key, 0)],
        (val) => isArray(val)
      );
    }
    function numberParts(...args) {
      return wrapWithDeps(
        (context) => number(context, ...args),
        () => parseNumberArgs(...args),
        "number format",
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        (root) => root[NumberPartsSymbol](...args),
        () => [],
        (val) => isString(val) || isArray(val)
      );
    }
    function datetimeParts(...args) {
      return wrapWithDeps(
        (context) => datetime(context, ...args),
        () => parseDateTimeArgs(...args),
        "datetime format",
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        (root) => root[DatetimePartsSymbol](...args),
        () => [],
        (val) => isString(val) || isArray(val)
      );
    }
    function setPluralRules(rules) {
      _pluralRules = rules;
      _context.pluralRules = _pluralRules;
    }
    function te(key, locale2) {
      const targetLocale = isString(locale2) ? locale2 : _locale.value;
      const message2 = getLocaleMessage(targetLocale);
      return resolveValue(message2, key) !== null;
    }
    function resolveMessages(key) {
      let messages22 = null;
      const locales = getLocaleChain(_context, _fallbackLocale.value, _locale.value);
      for (let i2 = 0; i2 < locales.length; i2++) {
        const targetLocaleMessages = _messages.value[locales[i2]] || {};
        const messageValue = resolveValue(targetLocaleMessages, key);
        if (messageValue != null) {
          messages22 = messageValue;
          break;
        }
      }
      return messages22;
    }
    function tm(key) {
      const messages22 = resolveMessages(key);
      return messages22 != null ? messages22 : __root ? __root.tm(key) || {} : {};
    }
    function getLocaleMessage(locale2) {
      return _messages.value[locale2] || {};
    }
    function setLocaleMessage(locale2, message2) {
      _messages.value[locale2] = message2;
      _context.messages = _messages.value;
    }
    function mergeLocaleMessage(locale2, message2) {
      _messages.value[locale2] = _messages.value[locale2] || {};
      deepCopy(message2, _messages.value[locale2]);
      _context.messages = _messages.value;
    }
    function getDateTimeFormat(locale2) {
      return _datetimeFormats.value[locale2] || {};
    }
    function setDateTimeFormat(locale2, format2) {
      _datetimeFormats.value[locale2] = format2;
      _context.datetimeFormats = _datetimeFormats.value;
      clearDateTimeFormat(_context, locale2, format2);
    }
    function mergeDateTimeFormat(locale2, format2) {
      _datetimeFormats.value[locale2] = assign(_datetimeFormats.value[locale2] || {}, format2);
      _context.datetimeFormats = _datetimeFormats.value;
      clearDateTimeFormat(_context, locale2, format2);
    }
    function getNumberFormat(locale2) {
      return _numberFormats.value[locale2] || {};
    }
    function setNumberFormat(locale2, format2) {
      _numberFormats.value[locale2] = format2;
      _context.numberFormats = _numberFormats.value;
      clearNumberFormat(_context, locale2, format2);
    }
    function mergeNumberFormat(locale2, format2) {
      _numberFormats.value[locale2] = assign(_numberFormats.value[locale2] || {}, format2);
      _context.numberFormats = _numberFormats.value;
      clearNumberFormat(_context, locale2, format2);
    }
    composerID++;
    if (__root) {
      vue.watch(__root.locale, (val) => {
        if (_inheritLocale) {
          _locale.value = val;
          _context.locale = val;
          updateFallbackLocale(_context, _locale.value, _fallbackLocale.value);
        }
      });
      vue.watch(__root.fallbackLocale, (val) => {
        if (_inheritLocale) {
          _fallbackLocale.value = val;
          _context.fallbackLocale = val;
          updateFallbackLocale(_context, _locale.value, _fallbackLocale.value);
        }
      });
    }
    const composer = {
      id: composerID,
      locale,
      fallbackLocale,
      get inheritLocale() {
        return _inheritLocale;
      },
      set inheritLocale(val) {
        _inheritLocale = val;
        if (val && __root) {
          _locale.value = __root.locale.value;
          _fallbackLocale.value = __root.fallbackLocale.value;
          updateFallbackLocale(_context, _locale.value, _fallbackLocale.value);
        }
      },
      get availableLocales() {
        return Object.keys(_messages.value).sort();
      },
      messages: messages2,
      datetimeFormats,
      numberFormats,
      get modifiers() {
        return _modifiers;
      },
      get pluralRules() {
        return _pluralRules || {};
      },
      get isGlobal() {
        return _isGlobal;
      },
      get missingWarn() {
        return _missingWarn;
      },
      set missingWarn(val) {
        _missingWarn = val;
        _context.missingWarn = _missingWarn;
      },
      get fallbackWarn() {
        return _fallbackWarn;
      },
      set fallbackWarn(val) {
        _fallbackWarn = val;
        _context.fallbackWarn = _fallbackWarn;
      },
      get fallbackRoot() {
        return _fallbackRoot;
      },
      set fallbackRoot(val) {
        _fallbackRoot = val;
      },
      get fallbackFormat() {
        return _fallbackFormat;
      },
      set fallbackFormat(val) {
        _fallbackFormat = val;
        _context.fallbackFormat = _fallbackFormat;
      },
      get warnHtmlMessage() {
        return _warnHtmlMessage;
      },
      set warnHtmlMessage(val) {
        _warnHtmlMessage = val;
        _context.warnHtmlMessage = val;
      },
      get escapeParameter() {
        return _escapeParameter;
      },
      set escapeParameter(val) {
        _escapeParameter = val;
        _context.escapeParameter = val;
      },
      t: t2,
      rt,
      d,
      n,
      te,
      tm,
      getLocaleMessage,
      setLocaleMessage,
      mergeLocaleMessage,
      getDateTimeFormat,
      setDateTimeFormat,
      mergeDateTimeFormat,
      getNumberFormat,
      setNumberFormat,
      mergeNumberFormat,
      getPostTranslationHandler,
      setPostTranslationHandler,
      getMissingHandler,
      setMissingHandler,
      [TransrateVNodeSymbol]: transrateVNode,
      [NumberPartsSymbol]: numberParts,
      [DatetimePartsSymbol]: datetimeParts,
      [SetPluralRulesSymbol]: setPluralRules,
      [InejctWithOption]: options.__injectWithOption
      // eslint-disable-line @typescript-eslint/no-explicit-any
    };
    {
      composer[EnableEmitter] = (emitter) => {
        _context.__v_emitter = emitter;
      };
      composer[DisableEmitter] = () => {
        _context.__v_emitter = void 0;
      };
    }
    return composer;
  }
  function convertComposerOptions(options) {
    const locale = isString(options.locale) ? options.locale : "en-US";
    const fallbackLocale = isString(options.fallbackLocale) || isArray(options.fallbackLocale) || isPlainObject(options.fallbackLocale) || options.fallbackLocale === false ? options.fallbackLocale : locale;
    const missing = isFunction(options.missing) ? options.missing : void 0;
    const missingWarn = isBoolean(options.silentTranslationWarn) || isRegExp(options.silentTranslationWarn) ? !options.silentTranslationWarn : true;
    const fallbackWarn = isBoolean(options.silentFallbackWarn) || isRegExp(options.silentFallbackWarn) ? !options.silentFallbackWarn : true;
    const fallbackRoot = isBoolean(options.fallbackRoot) ? options.fallbackRoot : true;
    const fallbackFormat = !!options.formatFallbackMessages;
    const modifiers = isPlainObject(options.modifiers) ? options.modifiers : {};
    const pluralizationRules = options.pluralizationRules;
    const postTranslation = isFunction(options.postTranslation) ? options.postTranslation : void 0;
    const warnHtmlMessage = isString(options.warnHtmlInMessage) ? options.warnHtmlInMessage !== "off" : true;
    const escapeParameter = !!options.escapeParameterHtml;
    const inheritLocale = isBoolean(options.sync) ? options.sync : true;
    if (options.formatter) {
      warn(getWarnMessage(
        8
        /* NOT_SUPPORTED_FORMATTER */
      ));
    }
    if (options.preserveDirectiveContent) {
      warn(getWarnMessage(
        9
        /* NOT_SUPPORTED_PRESERVE_DIRECTIVE */
      ));
    }
    let messages2 = options.messages;
    if (isPlainObject(options.sharedMessages)) {
      const sharedMessages = options.sharedMessages;
      const locales = Object.keys(sharedMessages);
      messages2 = locales.reduce((messages22, locale2) => {
        const message2 = messages22[locale2] || (messages22[locale2] = {});
        assign(message2, sharedMessages[locale2]);
        return messages22;
      }, messages2 || {});
    }
    const { __i18n, __root, __injectWithOption } = options;
    const datetimeFormats = options.datetimeFormats;
    const numberFormats = options.numberFormats;
    const flatJson = options.flatJson;
    return {
      locale,
      fallbackLocale,
      messages: messages2,
      flatJson,
      datetimeFormats,
      numberFormats,
      missing,
      missingWarn,
      fallbackWarn,
      fallbackRoot,
      fallbackFormat,
      modifiers,
      pluralRules: pluralizationRules,
      postTranslation,
      warnHtmlMessage,
      escapeParameter,
      inheritLocale,
      __i18n,
      __root,
      __injectWithOption
    };
  }
  function createVueI18n(options = {}) {
    const composer = createComposer(convertComposerOptions(options));
    const vueI18n = {
      // id
      id: composer.id,
      // locale
      get locale() {
        return composer.locale.value;
      },
      set locale(val) {
        composer.locale.value = val;
      },
      // fallbackLocale
      get fallbackLocale() {
        return composer.fallbackLocale.value;
      },
      set fallbackLocale(val) {
        composer.fallbackLocale.value = val;
      },
      // messages
      get messages() {
        return composer.messages.value;
      },
      // datetimeFormats
      get datetimeFormats() {
        return composer.datetimeFormats.value;
      },
      // numberFormats
      get numberFormats() {
        return composer.numberFormats.value;
      },
      // availableLocales
      get availableLocales() {
        return composer.availableLocales;
      },
      // formatter
      get formatter() {
        warn(getWarnMessage(
          8
          /* NOT_SUPPORTED_FORMATTER */
        ));
        return {
          interpolate() {
            return [];
          }
        };
      },
      set formatter(val) {
        warn(getWarnMessage(
          8
          /* NOT_SUPPORTED_FORMATTER */
        ));
      },
      // missing
      get missing() {
        return composer.getMissingHandler();
      },
      set missing(handler) {
        composer.setMissingHandler(handler);
      },
      // silentTranslationWarn
      get silentTranslationWarn() {
        return isBoolean(composer.missingWarn) ? !composer.missingWarn : composer.missingWarn;
      },
      set silentTranslationWarn(val) {
        composer.missingWarn = isBoolean(val) ? !val : val;
      },
      // silentFallbackWarn
      get silentFallbackWarn() {
        return isBoolean(composer.fallbackWarn) ? !composer.fallbackWarn : composer.fallbackWarn;
      },
      set silentFallbackWarn(val) {
        composer.fallbackWarn = isBoolean(val) ? !val : val;
      },
      // modifiers
      get modifiers() {
        return composer.modifiers;
      },
      // formatFallbackMessages
      get formatFallbackMessages() {
        return composer.fallbackFormat;
      },
      set formatFallbackMessages(val) {
        composer.fallbackFormat = val;
      },
      // postTranslation
      get postTranslation() {
        return composer.getPostTranslationHandler();
      },
      set postTranslation(handler) {
        composer.setPostTranslationHandler(handler);
      },
      // sync
      get sync() {
        return composer.inheritLocale;
      },
      set sync(val) {
        composer.inheritLocale = val;
      },
      // warnInHtmlMessage
      get warnHtmlInMessage() {
        return composer.warnHtmlMessage ? "warn" : "off";
      },
      set warnHtmlInMessage(val) {
        composer.warnHtmlMessage = val !== "off";
      },
      // escapeParameterHtml
      get escapeParameterHtml() {
        return composer.escapeParameter;
      },
      set escapeParameterHtml(val) {
        composer.escapeParameter = val;
      },
      // preserveDirectiveContent
      get preserveDirectiveContent() {
        warn(getWarnMessage(
          9
          /* NOT_SUPPORTED_PRESERVE_DIRECTIVE */
        ));
        return true;
      },
      set preserveDirectiveContent(val) {
        warn(getWarnMessage(
          9
          /* NOT_SUPPORTED_PRESERVE_DIRECTIVE */
        ));
      },
      // pluralizationRules
      get pluralizationRules() {
        return composer.pluralRules || {};
      },
      // for internal
      __composer: composer,
      // t
      t(...args) {
        const [arg1, arg2, arg3] = args;
        const options2 = {};
        let list2 = null;
        let named = null;
        if (!isString(arg1)) {
          throw createI18nError(
            15
            /* INVALID_ARGUMENT */
          );
        }
        const key = arg1;
        if (isString(arg2)) {
          options2.locale = arg2;
        } else if (isArray(arg2)) {
          list2 = arg2;
        } else if (isPlainObject(arg2)) {
          named = arg2;
        }
        if (isArray(arg3)) {
          list2 = arg3;
        } else if (isPlainObject(arg3)) {
          named = arg3;
        }
        return composer.t(key, list2 || named || {}, options2);
      },
      rt(...args) {
        return composer.rt(...args);
      },
      // tc
      tc(...args) {
        const [arg1, arg2, arg3] = args;
        const options2 = { plural: 1 };
        let list2 = null;
        let named = null;
        if (!isString(arg1)) {
          throw createI18nError(
            15
            /* INVALID_ARGUMENT */
          );
        }
        const key = arg1;
        if (isString(arg2)) {
          options2.locale = arg2;
        } else if (isNumber(arg2)) {
          options2.plural = arg2;
        } else if (isArray(arg2)) {
          list2 = arg2;
        } else if (isPlainObject(arg2)) {
          named = arg2;
        }
        if (isString(arg3)) {
          options2.locale = arg3;
        } else if (isArray(arg3)) {
          list2 = arg3;
        } else if (isPlainObject(arg3)) {
          named = arg3;
        }
        return composer.t(key, list2 || named || {}, options2);
      },
      // te
      te(key, locale) {
        return composer.te(key, locale);
      },
      // tm
      tm(key) {
        return composer.tm(key);
      },
      // getLocaleMessage
      getLocaleMessage(locale) {
        return composer.getLocaleMessage(locale);
      },
      // setLocaleMessage
      setLocaleMessage(locale, message2) {
        composer.setLocaleMessage(locale, message2);
      },
      // mergeLocaleMessage
      mergeLocaleMessage(locale, message2) {
        composer.mergeLocaleMessage(locale, message2);
      },
      // d
      d(...args) {
        return composer.d(...args);
      },
      // getDateTimeFormat
      getDateTimeFormat(locale) {
        return composer.getDateTimeFormat(locale);
      },
      // setDateTimeFormat
      setDateTimeFormat(locale, format2) {
        composer.setDateTimeFormat(locale, format2);
      },
      // mergeDateTimeFormat
      mergeDateTimeFormat(locale, format2) {
        composer.mergeDateTimeFormat(locale, format2);
      },
      // n
      n(...args) {
        return composer.n(...args);
      },
      // getNumberFormat
      getNumberFormat(locale) {
        return composer.getNumberFormat(locale);
      },
      // setNumberFormat
      setNumberFormat(locale, format2) {
        composer.setNumberFormat(locale, format2);
      },
      // mergeNumberFormat
      mergeNumberFormat(locale, format2) {
        composer.mergeNumberFormat(locale, format2);
      },
      // getChoiceIndex
      // eslint-disable-next-line @typescript-eslint/no-unused-vars
      getChoiceIndex(choice, choicesLength) {
        warn(getWarnMessage(
          10
          /* NOT_SUPPORTED_GET_CHOICE_INDEX */
        ));
        return -1;
      },
      // for internal
      __onComponentInstanceCreated(target) {
        const { componentInstanceCreatedListener } = options;
        if (componentInstanceCreatedListener) {
          componentInstanceCreatedListener(target, vueI18n);
        }
      }
    };
    {
      vueI18n.__enableEmitter = (emitter) => {
        const __composer = composer;
        __composer[EnableEmitter] && __composer[EnableEmitter](emitter);
      };
      vueI18n.__disableEmitter = () => {
        const __composer = composer;
        __composer[DisableEmitter] && __composer[DisableEmitter]();
      };
    }
    return vueI18n;
  }
  const baseFormatProps = {
    tag: {
      type: [String, Object]
    },
    locale: {
      type: String
    },
    scope: {
      type: String,
      validator: (val) => val === "parent" || val === "global",
      default: "parent"
    },
    i18n: {
      type: Object
    }
  };
  const Translation = {
    /* eslint-disable */
    name: "i18n-t",
    props: assign({
      keypath: {
        type: String,
        required: true
      },
      plural: {
        type: [Number, String],
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        validator: (val) => isNumber(val) || !isNaN(val)
      }
    }, baseFormatProps),
    /* eslint-enable */
    setup(props, context) {
      const { slots, attrs } = context;
      const i18n2 = props.i18n || useI18n({
        useScope: props.scope,
        __useComponent: true
      });
      const keys = Object.keys(slots).filter((key) => key !== "_");
      return () => {
        const options = {};
        if (props.locale) {
          options.locale = props.locale;
        }
        if (props.plural !== void 0) {
          options.plural = isString(props.plural) ? +props.plural : props.plural;
        }
        const arg = getInterpolateArg(context, keys);
        const children = i18n2[TransrateVNodeSymbol](props.keypath, arg, options);
        const assignedAttrs = assign({}, attrs);
        return isString(props.tag) ? vue.h(props.tag, assignedAttrs, children) : isObject$1(props.tag) ? vue.h(props.tag, assignedAttrs, children) : vue.h(vue.Fragment, assignedAttrs, children);
      };
    }
  };
  function getInterpolateArg({ slots }, keys) {
    if (keys.length === 1 && keys[0] === "default") {
      return slots.default ? slots.default() : [];
    } else {
      return keys.reduce((arg, key) => {
        const slot = slots[key];
        if (slot) {
          arg[key] = slot();
        }
        return arg;
      }, {});
    }
  }
  function renderFormatter(props, context, slotKeys, partFormatter) {
    const { slots, attrs } = context;
    return () => {
      const options = { part: true };
      let overrides = {};
      if (props.locale) {
        options.locale = props.locale;
      }
      if (isString(props.format)) {
        options.key = props.format;
      } else if (isObject$1(props.format)) {
        if (isString(props.format.key)) {
          options.key = props.format.key;
        }
        overrides = Object.keys(props.format).reduce((options2, prop) => {
          return slotKeys.includes(prop) ? assign({}, options2, { [prop]: props.format[prop] }) : options2;
        }, {});
      }
      const parts = partFormatter(...[props.value, options, overrides]);
      let children = [options.key];
      if (isArray(parts)) {
        children = parts.map((part, index) => {
          const slot = slots[part.type];
          return slot ? slot({ [part.type]: part.value, index, parts }) : [part.value];
        });
      } else if (isString(parts)) {
        children = [parts];
      }
      const assignedAttrs = assign({}, attrs);
      return isString(props.tag) ? vue.h(props.tag, assignedAttrs, children) : isObject$1(props.tag) ? vue.h(props.tag, assignedAttrs, children) : vue.h(vue.Fragment, assignedAttrs, children);
    };
  }
  const NUMBER_FORMAT_KEYS = [
    "localeMatcher",
    "style",
    "unit",
    "unitDisplay",
    "currency",
    "currencyDisplay",
    "useGrouping",
    "numberingSystem",
    "minimumIntegerDigits",
    "minimumFractionDigits",
    "maximumFractionDigits",
    "minimumSignificantDigits",
    "maximumSignificantDigits",
    "notation",
    "formatMatcher"
  ];
  const NumberFormat = {
    /* eslint-disable */
    name: "i18n-n",
    props: assign({
      value: {
        type: Number,
        required: true
      },
      format: {
        type: [String, Object]
      }
    }, baseFormatProps),
    /* eslint-enable */
    setup(props, context) {
      const i18n2 = props.i18n || useI18n({ useScope: "parent", __useComponent: true });
      return renderFormatter(props, context, NUMBER_FORMAT_KEYS, (...args) => (
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        i18n2[NumberPartsSymbol](...args)
      ));
    }
  };
  const DATETIME_FORMAT_KEYS = [
    "dateStyle",
    "timeStyle",
    "fractionalSecondDigits",
    "calendar",
    "dayPeriod",
    "numberingSystem",
    "localeMatcher",
    "timeZone",
    "hour12",
    "hourCycle",
    "formatMatcher",
    "weekday",
    "era",
    "year",
    "month",
    "day",
    "hour",
    "minute",
    "second",
    "timeZoneName"
  ];
  const DatetimeFormat = {
    /* eslint-disable */
    name: "i18n-d",
    props: assign({
      value: {
        type: [Number, Date],
        required: true
      },
      format: {
        type: [String, Object]
      }
    }, baseFormatProps),
    /* eslint-enable */
    setup(props, context) {
      const i18n2 = props.i18n || useI18n({ useScope: "parent", __useComponent: true });
      return renderFormatter(props, context, DATETIME_FORMAT_KEYS, (...args) => (
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        i18n2[DatetimePartsSymbol](...args)
      ));
    }
  };
  function getComposer$2(i18n2, instance) {
    const i18nInternal = i18n2;
    if (i18n2.mode === "composition") {
      return i18nInternal.__getInstance(instance) || i18n2.global;
    } else {
      const vueI18n = i18nInternal.__getInstance(instance);
      return vueI18n != null ? vueI18n.__composer : i18n2.global.__composer;
    }
  }
  function vTDirective(i18n2) {
    const bind = (el, { instance, value, modifiers }) => {
      if (!instance || !instance.$) {
        throw createI18nError(
          22
          /* UNEXPECTED_ERROR */
        );
      }
      const composer = getComposer$2(i18n2, instance.$);
      if (modifiers.preserve) {
        warn(getWarnMessage(
          7
          /* NOT_SUPPORTED_PRESERVE */
        ));
      }
      const parsedValue = parseValue(value);
      el.textContent = composer.t(...makeParams(parsedValue));
    };
    return {
      beforeMount: bind,
      beforeUpdate: bind
    };
  }
  function parseValue(value) {
    if (isString(value)) {
      return { path: value };
    } else if (isPlainObject(value)) {
      if (!("path" in value)) {
        throw createI18nError(19, "path");
      }
      return value;
    } else {
      throw createI18nError(
        20
        /* INVALID_VALUE */
      );
    }
  }
  function makeParams(value) {
    const { path, locale, args, choice, plural } = value;
    const options = {};
    const named = args || {};
    if (isString(locale)) {
      options.locale = locale;
    }
    if (isNumber(choice)) {
      options.plural = choice;
    }
    if (isNumber(plural)) {
      options.plural = plural;
    }
    return [path, named, options];
  }
  function apply(app2, i18n2, ...options) {
    const pluginOptions = isPlainObject(options[0]) ? options[0] : {};
    const useI18nComponentName = !!pluginOptions.useI18nComponentName;
    const globalInstall = isBoolean(pluginOptions.globalInstall) ? pluginOptions.globalInstall : true;
    if (globalInstall && useI18nComponentName) {
      warn(getWarnMessage(11, {
        name: Translation.name
      }));
    }
    if (globalInstall) {
      app2.component(!useI18nComponentName ? Translation.name : "i18n", Translation);
      app2.component(NumberFormat.name, NumberFormat);
      app2.component(DatetimeFormat.name, DatetimeFormat);
    }
    app2.directive("t", vTDirective(i18n2));
  }
  const VUE_I18N_COMPONENT_TYPES = "vue-i18n: composer properties";
  let devtoolsApi;
  async function enableDevTools(app2, i18n2) {
    return new Promise((resolve, reject) => {
      try {
        setupDevtoolsPlugin({
          id: "vue-devtools-plugin-vue-i18n",
          label: VueDevToolsLabels[
            "vue-devtools-plugin-vue-i18n"
            /* PLUGIN */
          ],
          packageName: "vue-i18n",
          homepage: "https://vue-i18n.intlify.dev",
          logo: "https://vue-i18n.intlify.dev/vue-i18n-devtools-logo.png",
          componentStateTypes: [VUE_I18N_COMPONENT_TYPES],
          app: app2
        }, (api) => {
          devtoolsApi = api;
          api.on.visitComponentTree(({ componentInstance, treeNode }) => {
            updateComponentTreeTags(componentInstance, treeNode, i18n2);
          });
          api.on.inspectComponent(({ componentInstance, instanceData }) => {
            if (componentInstance.vnode.el.__VUE_I18N__ && instanceData) {
              if (i18n2.mode === "legacy") {
                if (componentInstance.vnode.el.__VUE_I18N__ !== i18n2.global.__composer) {
                  inspectComposer(instanceData, componentInstance.vnode.el.__VUE_I18N__);
                }
              } else {
                inspectComposer(instanceData, componentInstance.vnode.el.__VUE_I18N__);
              }
            }
          });
          api.addInspector({
            id: "vue-i18n-resource-inspector",
            label: VueDevToolsLabels[
              "vue-i18n-resource-inspector"
              /* CUSTOM_INSPECTOR */
            ],
            icon: "language",
            treeFilterPlaceholder: VueDevToolsPlaceholders[
              "vue-i18n-resource-inspector"
              /* CUSTOM_INSPECTOR */
            ]
          });
          api.on.getInspectorTree((payload) => {
            if (payload.app === app2 && payload.inspectorId === "vue-i18n-resource-inspector") {
              registerScope(payload, i18n2);
            }
          });
          api.on.getInspectorState((payload) => {
            if (payload.app === app2 && payload.inspectorId === "vue-i18n-resource-inspector") {
              inspectScope(payload, i18n2);
            }
          });
          api.on.editInspectorState((payload) => {
            if (payload.app === app2 && payload.inspectorId === "vue-i18n-resource-inspector") {
              editScope(payload, i18n2);
            }
          });
          api.addTimelineLayer({
            id: "vue-i18n-timeline",
            label: VueDevToolsLabels[
              "vue-i18n-timeline"
              /* TIMELINE */
            ],
            color: VueDevToolsTimelineColors[
              "vue-i18n-timeline"
              /* TIMELINE */
            ]
          });
          resolve(true);
        });
      } catch (e) {
        console.error(e);
        reject(false);
      }
    });
  }
  function updateComponentTreeTags(instance, treeNode, i18n2) {
    const global2 = i18n2.mode === "composition" ? i18n2.global : i18n2.global.__composer;
    if (instance && instance.vnode.el.__VUE_I18N__) {
      if (instance.vnode.el.__VUE_I18N__ !== global2) {
        const label = instance.type.name || instance.type.displayName || instance.type.__file;
        const tag = {
          label: `i18n (${label} Scope)`,
          textColor: 0,
          backgroundColor: 16764185
        };
        treeNode.tags.push(tag);
      }
    }
  }
  function inspectComposer(instanceData, composer) {
    const type = VUE_I18N_COMPONENT_TYPES;
    instanceData.state.push({
      type,
      key: "locale",
      editable: true,
      value: composer.locale.value
    });
    instanceData.state.push({
      type,
      key: "availableLocales",
      editable: false,
      value: composer.availableLocales
    });
    instanceData.state.push({
      type,
      key: "fallbackLocale",
      editable: true,
      value: composer.fallbackLocale.value
    });
    instanceData.state.push({
      type,
      key: "inheritLocale",
      editable: true,
      value: composer.inheritLocale
    });
    instanceData.state.push({
      type,
      key: "messages",
      editable: false,
      value: getLocaleMessageValue(composer.messages.value)
    });
    instanceData.state.push({
      type,
      key: "datetimeFormats",
      editable: false,
      value: composer.datetimeFormats.value
    });
    instanceData.state.push({
      type,
      key: "numberFormats",
      editable: false,
      value: composer.numberFormats.value
    });
  }
  function getLocaleMessageValue(messages2) {
    const value = {};
    Object.keys(messages2).forEach((key) => {
      const v = messages2[key];
      if (isFunction(v) && "source" in v) {
        value[key] = getMessageFunctionDetails(v);
      } else if (isObject$1(v)) {
        value[key] = getLocaleMessageValue(v);
      } else {
        value[key] = v;
      }
    });
    return value;
  }
  const ESC = {
    "<": "&lt;",
    ">": "&gt;",
    '"': "&quot;",
    "&": "&amp;"
  };
  function escape$1(s) {
    return s.replace(/[<>"&]/g, escapeChar);
  }
  function escapeChar(a) {
    return ESC[a] || a;
  }
  function getMessageFunctionDetails(func) {
    const argString = func.source ? `("${escape$1(func.source)}")` : `(?)`;
    return {
      _custom: {
        type: "function",
        display: `<span>ƒ</span> ${argString}`
      }
    };
  }
  function registerScope(payload, i18n2) {
    payload.rootNodes.push({
      id: "global",
      label: "Global Scope"
    });
    const global2 = i18n2.mode === "composition" ? i18n2.global : i18n2.global.__composer;
    for (const [keyInstance, instance] of i18n2.__instances) {
      const composer = i18n2.mode === "composition" ? instance : instance.__composer;
      if (global2 === composer) {
        continue;
      }
      const label = keyInstance.type.name || keyInstance.type.displayName || keyInstance.type.__file;
      payload.rootNodes.push({
        id: composer.id.toString(),
        label: `${label} Scope`
      });
    }
  }
  function getComposer$1(nodeId, i18n2) {
    if (nodeId === "global") {
      return i18n2.mode === "composition" ? i18n2.global : i18n2.global.__composer;
    } else {
      const instance = Array.from(i18n2.__instances.values()).find((item) => item.id.toString() === nodeId);
      if (instance) {
        return i18n2.mode === "composition" ? instance : instance.__composer;
      } else {
        return null;
      }
    }
  }
  function inspectScope(payload, i18n2) {
    const composer = getComposer$1(payload.nodeId, i18n2);
    if (composer) {
      payload.state = makeScopeInspectState(composer);
    }
  }
  function makeScopeInspectState(composer) {
    const state = {};
    const localeType = "Locale related info";
    const localeStates = [
      {
        type: localeType,
        key: "locale",
        editable: true,
        value: composer.locale.value
      },
      {
        type: localeType,
        key: "fallbackLocale",
        editable: true,
        value: composer.fallbackLocale.value
      },
      {
        type: localeType,
        key: "availableLocales",
        editable: false,
        value: composer.availableLocales
      },
      {
        type: localeType,
        key: "inheritLocale",
        editable: true,
        value: composer.inheritLocale
      }
    ];
    state[localeType] = localeStates;
    const localeMessagesType = "Locale messages info";
    const localeMessagesStates = [
      {
        type: localeMessagesType,
        key: "messages",
        editable: false,
        value: getLocaleMessageValue(composer.messages.value)
      }
    ];
    state[localeMessagesType] = localeMessagesStates;
    const datetimeFormatsType = "Datetime formats info";
    const datetimeFormatsStates = [
      {
        type: datetimeFormatsType,
        key: "datetimeFormats",
        editable: false,
        value: composer.datetimeFormats.value
      }
    ];
    state[datetimeFormatsType] = datetimeFormatsStates;
    const numberFormatsType = "Datetime formats info";
    const numberFormatsStates = [
      {
        type: numberFormatsType,
        key: "numberFormats",
        editable: false,
        value: composer.numberFormats.value
      }
    ];
    state[numberFormatsType] = numberFormatsStates;
    return state;
  }
  function addTimelineEvent(event, payload) {
    if (devtoolsApi) {
      let groupId;
      if (payload && "groupId" in payload) {
        groupId = payload.groupId;
        delete payload.groupId;
      }
      devtoolsApi.addTimelineEvent({
        layerId: "vue-i18n-timeline",
        event: {
          title: event,
          groupId,
          time: Date.now(),
          meta: {},
          data: payload || {},
          logType: event === "compile-error" ? "error" : event === "fallback" || event === "missing" ? "warning" : "default"
        }
      });
    }
  }
  function editScope(payload, i18n2) {
    const composer = getComposer$1(payload.nodeId, i18n2);
    if (composer) {
      const [field] = payload.path;
      if (field === "locale" && isString(payload.state.value)) {
        composer.locale.value = payload.state.value;
      } else if (field === "fallbackLocale" && (isString(payload.state.value) || isArray(payload.state.value) || isObject$1(payload.state.value))) {
        composer.fallbackLocale.value = payload.state.value;
      } else if (field === "inheritLocale" && isBoolean(payload.state.value)) {
        composer.inheritLocale = payload.state.value;
      }
    }
  }
  function defineMixin(vuei18n, composer, i18n2) {
    return {
      beforeCreate() {
        const instance = vue.getCurrentInstance();
        if (!instance) {
          throw createI18nError(
            22
            /* UNEXPECTED_ERROR */
          );
        }
        const options = this.$options;
        if (options.i18n) {
          const optionsI18n = options.i18n;
          if (options.__i18n) {
            optionsI18n.__i18n = options.__i18n;
          }
          optionsI18n.__root = composer;
          if (this === this.$root) {
            this.$i18n = mergeToRoot(vuei18n, optionsI18n);
          } else {
            optionsI18n.__injectWithOption = true;
            this.$i18n = createVueI18n(optionsI18n);
          }
        } else if (options.__i18n) {
          if (this === this.$root) {
            this.$i18n = mergeToRoot(vuei18n, options);
          } else {
            this.$i18n = createVueI18n({
              __i18n: options.__i18n,
              __injectWithOption: true,
              __root: composer
            });
          }
        } else {
          this.$i18n = vuei18n;
        }
        vuei18n.__onComponentInstanceCreated(this.$i18n);
        i18n2.__setInstance(instance, this.$i18n);
        this.$t = (...args) => this.$i18n.t(...args);
        this.$rt = (...args) => this.$i18n.rt(...args);
        this.$tc = (...args) => this.$i18n.tc(...args);
        this.$te = (key, locale) => this.$i18n.te(key, locale);
        this.$d = (...args) => this.$i18n.d(...args);
        this.$n = (...args) => this.$i18n.n(...args);
        this.$tm = (key) => this.$i18n.tm(key);
      },
      mounted() {
        {
          this.$el.__VUE_I18N__ = this.$i18n.__composer;
          const emitter = this.__v_emitter = createEmitter();
          const _vueI18n = this.$i18n;
          _vueI18n.__enableEmitter && _vueI18n.__enableEmitter(emitter);
          emitter.on("*", addTimelineEvent);
        }
      },
      beforeUnmount() {
        const instance = vue.getCurrentInstance();
        if (!instance) {
          throw createI18nError(
            22
            /* UNEXPECTED_ERROR */
          );
        }
        {
          if (this.__v_emitter) {
            this.__v_emitter.off("*", addTimelineEvent);
            delete this.__v_emitter;
          }
          const _vueI18n = this.$i18n;
          _vueI18n.__disableEmitter && _vueI18n.__disableEmitter();
          delete this.$el.__VUE_I18N__;
        }
        delete this.$t;
        delete this.$rt;
        delete this.$tc;
        delete this.$te;
        delete this.$d;
        delete this.$n;
        delete this.$tm;
        i18n2.__deleteInstance(instance);
        delete this.$i18n;
      }
    };
  }
  function mergeToRoot(root, options) {
    root.locale = options.locale || root.locale;
    root.fallbackLocale = options.fallbackLocale || root.fallbackLocale;
    root.missing = options.missing || root.missing;
    root.silentTranslationWarn = options.silentTranslationWarn || root.silentFallbackWarn;
    root.silentFallbackWarn = options.silentFallbackWarn || root.silentFallbackWarn;
    root.formatFallbackMessages = options.formatFallbackMessages || root.formatFallbackMessages;
    root.postTranslation = options.postTranslation || root.postTranslation;
    root.warnHtmlInMessage = options.warnHtmlInMessage || root.warnHtmlInMessage;
    root.escapeParameterHtml = options.escapeParameterHtml || root.escapeParameterHtml;
    root.sync = options.sync || root.sync;
    root.__composer[SetPluralRulesSymbol](options.pluralizationRules || root.pluralizationRules);
    const messages2 = getLocaleMessages(root.locale, {
      messages: options.messages,
      __i18n: options.__i18n
    });
    Object.keys(messages2).forEach((locale) => root.mergeLocaleMessage(locale, messages2[locale]));
    if (options.datetimeFormats) {
      Object.keys(options.datetimeFormats).forEach((locale) => root.mergeDateTimeFormat(locale, options.datetimeFormats[locale]));
    }
    if (options.numberFormats) {
      Object.keys(options.numberFormats).forEach((locale) => root.mergeNumberFormat(locale, options.numberFormats[locale]));
    }
    return root;
  }
  function createI18n(options = {}) {
    const __legacyMode = isBoolean(options.legacy) ? options.legacy : true;
    const __globalInjection = !!options.globalInjection;
    const __instances = /* @__PURE__ */ new Map();
    const __global = __legacyMode ? createVueI18n(options) : createComposer(options);
    const symbol = makeSymbol("vue-i18n");
    const i18n2 = {
      // mode
      get mode() {
        return __legacyMode ? "legacy" : "composition";
      },
      // install plugin
      async install(app2, ...options2) {
        {
          app2.__VUE_I18N__ = i18n2;
        }
        app2.__VUE_I18N_SYMBOL__ = symbol;
        app2.provide(app2.__VUE_I18N_SYMBOL__, i18n2);
        if (!__legacyMode && __globalInjection) {
          injectGlobalFields(app2, i18n2.global);
        }
        {
          apply(app2, i18n2, ...options2);
        }
        if (__legacyMode) {
          app2.mixin(defineMixin(__global, __global.__composer, i18n2));
        }
        {
          const ret = await enableDevTools(app2, i18n2);
          if (!ret) {
            throw createI18nError(
              21
              /* CANNOT_SETUP_VUE_DEVTOOLS_PLUGIN */
            );
          }
          const emitter = createEmitter();
          if (__legacyMode) {
            const _vueI18n = __global;
            _vueI18n.__enableEmitter && _vueI18n.__enableEmitter(emitter);
          } else {
            const _composer = __global;
            _composer[EnableEmitter] && _composer[EnableEmitter](emitter);
          }
          emitter.on("*", addTimelineEvent);
        }
      },
      // global accessor
      get global() {
        return __global;
      },
      // @internal
      __instances,
      // @internal
      __getInstance(component) {
        return __instances.get(component) || null;
      },
      // @internal
      __setInstance(component, instance) {
        __instances.set(component, instance);
      },
      // @internal
      __deleteInstance(component) {
        __instances.delete(component);
      }
    };
    return i18n2;
  }
  function useI18n(options = {}) {
    const instance = vue.getCurrentInstance();
    if (instance == null) {
      throw createI18nError(
        16
        /* MUST_BE_CALL_SETUP_TOP */
      );
    }
    if (!instance.appContext.app.__VUE_I18N_SYMBOL__) {
      throw createI18nError(
        17
        /* NOT_INSLALLED */
      );
    }
    const i18n2 = vue.inject(instance.appContext.app.__VUE_I18N_SYMBOL__);
    if (!i18n2) {
      throw createI18nError(
        22
        /* UNEXPECTED_ERROR */
      );
    }
    const global2 = i18n2.mode === "composition" ? i18n2.global : i18n2.global.__composer;
    const scope = isEmptyObject(options) ? "__i18n" in instance.type ? "local" : "global" : !options.useScope ? "local" : options.useScope;
    if (scope === "global") {
      let messages2 = isObject$1(options.messages) ? options.messages : {};
      if ("__i18nGlobal" in instance.type) {
        messages2 = getLocaleMessages(global2.locale.value, {
          messages: messages2,
          __i18n: instance.type.__i18nGlobal
        });
      }
      const locales = Object.keys(messages2);
      if (locales.length) {
        locales.forEach((locale) => {
          global2.mergeLocaleMessage(locale, messages2[locale]);
        });
      }
      if (isObject$1(options.datetimeFormats)) {
        const locales2 = Object.keys(options.datetimeFormats);
        if (locales2.length) {
          locales2.forEach((locale) => {
            global2.mergeDateTimeFormat(locale, options.datetimeFormats[locale]);
          });
        }
      }
      if (isObject$1(options.numberFormats)) {
        const locales2 = Object.keys(options.numberFormats);
        if (locales2.length) {
          locales2.forEach((locale) => {
            global2.mergeNumberFormat(locale, options.numberFormats[locale]);
          });
        }
      }
      return global2;
    }
    if (scope === "parent") {
      let composer2 = getComposer(i18n2, instance, options.__useComponent);
      if (composer2 == null) {
        {
          warn(getWarnMessage(
            12
            /* NOT_FOUND_PARENT_SCOPE */
          ));
        }
        composer2 = global2;
      }
      return composer2;
    }
    if (i18n2.mode === "legacy") {
      throw createI18nError(
        18
        /* NOT_AVAILABLE_IN_LEGACY_MODE */
      );
    }
    const i18nInternal = i18n2;
    let composer = i18nInternal.__getInstance(instance);
    if (composer == null) {
      const type = instance.type;
      const composerOptions = assign({}, options);
      if (type.__i18n) {
        composerOptions.__i18n = type.__i18n;
      }
      if (global2) {
        composerOptions.__root = global2;
      }
      composer = createComposer(composerOptions);
      setupLifeCycle(i18nInternal, instance, composer);
      i18nInternal.__setInstance(instance, composer);
    }
    return composer;
  }
  function getComposer(i18n2, target, useComponent = false) {
    let composer = null;
    const root = target.root;
    let current = target.parent;
    while (current != null) {
      const i18nInternal = i18n2;
      if (i18n2.mode === "composition") {
        composer = i18nInternal.__getInstance(current);
      } else {
        const vueI18n = i18nInternal.__getInstance(current);
        if (vueI18n != null) {
          composer = vueI18n.__composer;
        }
        if (useComponent && composer && !composer[InejctWithOption]) {
          composer = null;
        }
      }
      if (composer != null) {
        break;
      }
      if (root === current) {
        break;
      }
      current = current.parent;
    }
    return composer;
  }
  function setupLifeCycle(i18n2, target, composer) {
    let emitter = null;
    vue.onMounted(() => {
      if (target.vnode.el) {
        target.vnode.el.__VUE_I18N__ = composer;
        emitter = createEmitter();
        const _composer = composer;
        _composer[EnableEmitter] && _composer[EnableEmitter](emitter);
        emitter.on("*", addTimelineEvent);
      }
    }, target);
    vue.onUnmounted(() => {
      if (target.vnode.el && target.vnode.el.__VUE_I18N__) {
        emitter && emitter.off("*", addTimelineEvent);
        const _composer = composer;
        _composer[DisableEmitter] && _composer[DisableEmitter]();
        delete target.vnode.el.__VUE_I18N__;
      }
      i18n2.__deleteInstance(target);
    }, target);
  }
  const globalExportProps = [
    "locale",
    "fallbackLocale",
    "availableLocales"
  ];
  const globalExportMethods = ["t", "rt", "d", "n", "tm"];
  function injectGlobalFields(app2, composer) {
    const i18n2 = /* @__PURE__ */ Object.create(null);
    globalExportProps.forEach((prop) => {
      const desc = Object.getOwnPropertyDescriptor(composer, prop);
      if (!desc) {
        throw createI18nError(
          22
          /* UNEXPECTED_ERROR */
        );
      }
      const wrap = vue.isRef(desc.value) ? {
        get() {
          return desc.value.value;
        },
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        set(val) {
          desc.value.value = val;
        }
      } : {
        get() {
          return desc.get && desc.get();
        }
      };
      Object.defineProperty(i18n2, prop, wrap);
    });
    app2.config.globalProperties.$i18n = i18n2;
    globalExportMethods.forEach((method) => {
      const desc = Object.getOwnPropertyDescriptor(composer, method);
      if (!desc || !desc.value) {
        throw createI18nError(
          22
          /* UNEXPECTED_ERROR */
        );
      }
      Object.defineProperty(app2.config.globalProperties, `$${method}`, desc);
    });
  }
  {
    initFeatureFlags();
  }
  {
    const target = getGlobalThis();
    target.__INTLIFY__ = true;
    setDevToolsHook(target.__INTLIFY_DEVTOOLS_GLOBAL_HOOK__);
  }
  const picker = {
    install(app2, options) {
      app2.config.globalProperties.$pickUsers = function(options2) {
        uni.navigateTo({
          url: "/pages/pick/PickUserPage",
          events: {
            pickedUsers: (users) => {
              options2.successCB && options2.successCB(users);
            }
          },
          success: (res) => {
            res.eventChannel.emit("pickOptions", {
              users: options2.users ? options2.users : store.state.contact.favContactList.concat(store.state.contact.friendList),
              initialCheckedUsers: options2.initialCheckedUsers,
              uncheckableUsers: options2.uncheckableUsers,
              showCategoryLabel: options2.showCategoryLabel !== false,
              confirmTitle: options2.confirmTitle ? options2.confirmTitle : "确定"
            });
          }
        });
      };
      app2.config.globalProperties.$pickUser = function(options2) {
        uni.navigateTo({
          url: "/pages/pick/PickSingleUserPage",
          events: {
            pickedUser: (user) => {
              options2.successCB && options2.successCB(user);
            }
          },
          success: (res) => {
            res.eventChannel.emit("pickOptions", {
              users: options2.users ? options2.users : store.state.contact.favContactList.concat(store.state.contact.friendList),
              showCategoryLabel: options2.showCategoryLabel !== false,
              confirmTitle: options2.confirmTitle ? options2.confirmTitle : "确定"
            });
          }
        });
      };
    }
  };
  const forward = {
    install(app2, options) {
      app2.config.globalProperties.$forward = function(options2) {
        uni.navigateTo({
          url: "/pages/conversation/message/forward/ForwardMessagePage",
          events: {
            // pickedUsers: users => {
            //     options.successCB && options.successCB(users);
            // }
          },
          success: (res) => {
            formatAppLog("log", "at common/forward.js:15", "navigate success", res);
            res.eventChannel.emit("forwardOptions", {
              forwardType: options2.forwardType,
              messages: options2.messages
            });
          },
          fail: (err) => {
            formatAppLog("log", "at common/forward.js:22", "navigate error", err);
          },
          complete: () => {
            formatAppLog("log", "at common/forward.js:25", "navigate complete");
          }
        });
      };
    }
  };
  const login$2 = {
    desc: "扫码登录野火IM",
    tip: "野火IM Web端需要配合您的手机客户端登录使用",
    warning: "不是使用微信扫码登录!!!",
    scan_qr_success: "扫码成功",
    confirm_login_tip: "请在手机上点击确认以登录",
    remember_me: "记住登录",
    cancel_login: "取消登录",
    login: "登录",
    switch_user: "切换用户",
    auto_login_tip: "自动登录中..."
  };
  const contact$2 = {
    new_friend: "新的朋友",
    group: "群聊",
    contact: "联系人",
    channel: "频道"
  };
  const friend_request$2 = {
    request: "好友请求",
    send_request_tip: "向{0}发送好球请求",
    accepted: "已添加",
    sent: "已发送",
    denied: "已拒绝",
    im: "我是",
    intro: "你好"
  };
  const group$2 = {
    name: "群名称{0}",
    chat: "进入群聊",
    fav: "保存到通讯录"
  };
  const message$2 = {
    send_message: "发消息",
    records: "聊天记录",
    unsupport_message_desc: "不支持该消息类型，请在手机上查看",
    receipt: "消息回执",
    receipt_detail: "消息回执信息",
    receipt_read_users: "已读人员",
    receipt_received_users: "已送达",
    receipt_unreceived_users: "未送达",
    sender: "消息发送者",
    content: "消息内容"
  };
  const conversation$2 = {
    forward_title: "分别发送给",
    picked_contact: "已选择联系人",
    create_group: "创建群聊",
    recent_conversation: "最近聊天",
    not_select_conversation: "未选择聊天",
    select_conversation_desc: "已选择{0}个聊天",
    forward_extra: "给朋友留言",
    forward_one_by_one: "逐条转发",
    forward_composite: "合并转发",
    user_message_records: "{0}的聊天记录",
    group_message_records: "群聊的聊天记录",
    drag_to_send_to: "拖拽到此发送给{0}",
    no_more_message: "没有更多消息",
    all_message_load: "已加载全部消息 :(",
    drag_to_send_limit_tip: "一次最多发送5个文件",
    not_support_send_folder: "不支持发送文件夹",
    group_name: "群名",
    group_announcement: "群公告",
    add_member: "添加成员",
    remove_member: "移除成员",
    quit_group: "退出群聊",
    click_to_edit_group_announcement: "点击编辑群公告",
    all_people: "所有人",
    sticky_top: "置顶",
    cancel_sticky_top: "取消置顶",
    enable_notification: "允许通知",
    disable_notification: "消息免打扰",
    mark_as_unread: "标记为未读",
    mark_as_read: "标记为已读"
  };
  const fav$2 = {
    fav: "收藏",
    all: "全部收藏",
    file: "文件",
    media: "相册",
    composite: "聊天记录",
    from: "来自",
    no_more: "没有更多收藏",
    all_fav_load: "已加载全部收藏 :("
  };
  const voip$2 = {
    desc: "音视频通话",
    not_answer: "对方未接听",
    ongoing: "通话中",
    duration: "通话时长"
  };
  const pick$2 = {
    pick_contact: "选择联系人",
    picked_contact: "已选择联系人"
  };
  const search$2 = {
    new_user: "新用户",
    view_all: "查看全部",
    message_history: "聊天记录",
    search_message_history: "搜索聊天记录..."
  };
  const file_record$2 = {
    no_more: "没有更多文件",
    all_file_load: "已加载全部文件 :("
  };
  const setting$2 = {
    setting: "设置",
    enable_notification: "开启通知",
    enable_notification_detail: "通知显示消息内容",
    close_window_to_exit: "关闭窗口时，直接退出",
    enable_minimize: "支持最小化",
    auto_login: "记住登录",
    exit_switch_user: "退出/切换账号",
    feedback: "发送反馈给我们",
    lang: "语言(重启生效)",
    zh_cn: "简体中文",
    zh_tw: "繁體中文",
    en: "English",
    sync_draft: "同步草稿"
  };
  const common$2 = {
    add: "添加",
    remove: "移除",
    send: "发送",
    contact: "联系人",
    confirm: "确认",
    cancel: "取消",
    alias: "备注",
    area: "地区",
    label: "标签",
    conversation: "聊天",
    sender: "发送者",
    all: "全部",
    mine: "我的",
    unknown: "未知",
    search: "搜索",
    back: "返回",
    create: "创建",
    none: "无",
    copy: "复制",
    paste: "粘贴",
    cut: "剪切",
    "delete": "删除",
    forward: "转发",
    fav: "收藏",
    quote: "引用",
    multi_select: "多选",
    recall: "撤回",
    open: "打开",
    open_dir: "打开目录",
    draft: "草稿",
    save: "存储",
    month_1: "一月",
    month_2: "二月",
    month_3: "三月",
    month_4: "四月",
    month_5: "五月",
    month_6: "六月",
    month_7: "七月",
    month_8: "八月",
    month_9: "九月",
    month_10: "十月",
    month_11: "十一月",
    month_12: "十二月",
    wfc_id: "野火号"
  };
  const misc$2 = {
    beijing: "北京",
    test_user: "测试用户",
    gen_qr_code: "二维码生成中",
    send_to_friend: "发送给朋友..."
  };
  const zhCNLang = {
    login: login$2,
    contact: contact$2,
    friend_request: friend_request$2,
    group: group$2,
    message: message$2,
    conversation: conversation$2,
    fav: fav$2,
    voip: voip$2,
    pick: pick$2,
    search: search$2,
    file_record: file_record$2,
    setting: setting$2,
    common: common$2,
    misc: misc$2
  };
  const login$1 = {
    desc: "掃碼登錄野火IM",
    tip: "野火IM Web端需要配合您的手機客戶端登錄使用",
    warning: "不是使用微信掃碼登錄!!!",
    scan_qr_success: "掃碼成功",
    confirm_login_tip: "請在手機上點擊確認以登錄",
    remember_me: "記住登錄",
    cancel_login: "取消登錄",
    login: "登錄",
    switch_user: "切換用戶",
    auto_login_tip: "自動登錄中..."
  };
  const contact$1 = {
    new_friend: "新的朋友",
    group: "群聊",
    contact: "聯系人",
    channel: "频道"
  };
  const friend_request$1 = {
    request: "好友請求",
    send_request_tip: "向{0}發送好球請求",
    accepted: "已添加",
    sent: "已發送",
    denied: "已拒絕",
    im: "我是",
    intro: "你好"
  };
  const group$1 = {
    name: "群名稱{0}",
    chat: "進入群聊",
    fav: "保存到通訊錄"
  };
  const message$1 = {
    send_message: "發消息",
    records: "聊天記錄",
    unsupport_message_desc: "不支持該消息類型，請在手機上查看",
    receipt: "消息回執",
    receipt_detail: "消息回執信息",
    receipt_read_users: "已讀人員",
    receipt_received_users: "已送達",
    receipt_unreceived_users: "未送達",
    sender: "消息發送者",
    content: "消息內容"
  };
  const conversation$1 = {
    forward_title: "分別發送給",
    picked_contact: "已選擇聯系人",
    create_group: "創建群聊",
    recent_conversation: "最近聊天",
    not_select_conversation: "未選擇聊天",
    select_conversation_desc: "已選擇{0}個聊天",
    forward_extra: "給朋友留言",
    forward_one_by_one: "逐條轉發",
    forward_composite: "合並轉發",
    user_message_records: "{0}的聊天記錄",
    group_message_records: "群聊的聊天記錄",
    drag_to_send_to: "拖拽到此發送給{0}",
    no_more_message: "沒有更多消息",
    all_message_load: "已加載全部消息 :(",
    drag_to_send_limit_tip: "一次最多發送5個文件",
    not_support_send_folder: "不支持發送文件夾",
    group_name: "群名",
    group_announcement: "群公告",
    add_member: "添加成員",
    remove_member: "移除成員",
    quit_group: "退出群聊",
    click_to_edit_group_announcement: "點擊編輯群公告",
    all_people: "所有人",
    sticky_top: "置頂",
    cancel_sticky_top: "取消置頂",
    enable_notification: "允許通知",
    disable_notification: "消息免打擾",
    mark_as_unread: "標記為未讀",
    mark_as_read: "標記為已讀"
  };
  const fav$1 = {
    fav: "收藏",
    all: "全部收藏",
    file: "文件",
    media: "相冊",
    composite: "聊天記錄",
    from: "來自",
    no_more: "沒有更多收藏",
    all_fav_load: "已加載全部收藏 :("
  };
  const voip$1 = {
    desc: "音視頻通話",
    not_answer: "對方未接聽",
    ongoing: "通話中",
    duration: "通話時長"
  };
  const pick$1 = {
    pick_contact: "選擇聯系人",
    picked_contact: "已選擇聯系人"
  };
  const search$1 = {
    new_user: "新用戶",
    view_all: "查看全部",
    message_history: "聊天記錄",
    search_message_history: "搜索聊天記錄..."
  };
  const file_record$1 = {
    no_more: "沒有更多文件",
    all_file_load: "已加載全部文件 :("
  };
  const setting$1 = {
    setting: "設置",
    enable_notification: "開啟通知",
    enable_notification_detail: "通知顯示消息內容",
    close_window_to_exit: "關閉窗口時，直接退出",
    enable_minimize: "支持最小化",
    auto_login: "記住登錄",
    exit_switch_user: "退出/切換賬號",
    feedback: "發送反饋給我們",
    lang: "語言(重啟生效)",
    zh_cn: "简体中文",
    zh_tw: "繁體中文",
    en: "English",
    sync_draft: "同步草稿"
  };
  const common$1 = {
    add: "添加",
    remove: "移除",
    send: "發送",
    contact: "聯系人",
    confirm: "確認",
    cancel: "取消",
    alias: "備註",
    area: "地區",
    label: "標簽",
    conversation: "聊天",
    sender: "發送者",
    all: "全部",
    mine: "我的",
    unknown: "未知",
    search: "搜索",
    back: "返回",
    create: "創建",
    none: "無",
    copy: "復製",
    paste: "粘貼",
    cut: "剪切",
    "delete": "刪除",
    forward: "轉發",
    fav: "收藏",
    quote: "引用",
    multi_select: "多選",
    recall: "撤回",
    open: "打開",
    open_dir: "打開目錄",
    draft: "草稿",
    save: "存儲",
    month_1: "一月",
    month_2: "二月",
    month_3: "三月",
    month_4: "四月",
    month_5: "五月",
    month_6: "六月",
    month_7: "七月",
    month_8: "八月",
    month_9: "九月",
    month_10: "十月",
    month_11: "十一月",
    month_12: "十二月",
    wfc_id: "野火號"
  };
  const misc$1 = {
    beijing: "北京",
    test_user: "測試用戶",
    gen_qr_code: "二維碼生成中",
    send_to_friend: "發送給朋友..."
  };
  const zhTWLang = {
    login: login$1,
    contact: contact$1,
    friend_request: friend_request$1,
    group: group$1,
    message: message$1,
    conversation: conversation$1,
    fav: fav$1,
    voip: voip$1,
    pick: pick$1,
    search: search$1,
    file_record: file_record$1,
    setting: setting$1,
    common: common$1,
    misc: misc$1
  };
  const login = {
    desc: "Scan the QR code to login Wildfire IM",
    tip: "Wildfire IM Web client needs to be used with your mobile",
    warning: "Don't use WeChat to scan the QR code!!!",
    scan_qr_success: "Scan code successfully",
    confirm_login_tip: "Please confirm the login on your mobile",
    remember_me: "Remember me",
    cancel_login: "Cancel Login",
    login: "Login",
    switch_user: "Switch User",
    auto_login_tip: "Automatically logging in..."
  };
  const contact = {
    new_friend: "New friend",
    group: "Group Chat",
    contact: "Contact",
    channel: "Channel"
  };
  const friend_request = {
    request: "Friend Request",
    send_request_tip: "Send friend request to {0}",
    accepted: "Accepted",
    sent: "Sent",
    denied: "Rejected",
    im: "I am",
    intro: "Hello"
  };
  const group = {
    name: "Group name {0}",
    chat: "Start group chat",
    fav: "Save to contact list"
  };
  const message = {
    send_message: "Send Message",
    records: "Chat Records",
    unsupport_message_desc: "This message type is not supported, please check it on your phone",
    receipt: "Message Receipt",
    receipt_detail: "Message Receipt Detail",
    receipt_read_users: "Read",
    receipt_received_users: "Delivered",
    receipt_unreceived_users: "Undelivered",
    sender: "Message Sender",
    content: "Message content"
  };
  const conversation = {
    forward_title: "Send separately",
    picked_contact: "Selected contact",
    create_group: "Create a group chat",
    recent_conversation: "Recent Chat",
    not_select_conversation: "Not select any chat",
    select_conversation_desc: "{0} chats selected",
    forward_extra: "Leave a message to friend",
    forward_one_by_one: "Forward one by one",
    forward_composite: "Merge Forward",
    user_message_records: "{0}’s chat records",
    group_message_records: "Group Chat Records",
    drag_to_send_to: "Drag here to send to {0}",
    no_more_message: "No more messages",
    all_message_load: "All messages have been loaded :(",
    drag_to_send_limit_tip: "Send up to 5 files at a time",
    not_support_send_folder: "Not support send folder",
    group_name: "Group name",
    group_announcement: "Group announcement",
    add_member: "Add member",
    remove_member: "Remove member",
    quit_group: "Quit group chat",
    click_to_edit_group_announcement: "click to edit group announcement",
    all_people: "Everyone",
    sticky_top: "sticky_top",
    cancel_sticky_top: "Cancel sticky top",
    enable_notification: "Allow notification",
    disable_notification: "Not disturb",
    mark_as_unread: "Mark as unread",
    mark_as_read: "Mark as read"
  };
  const fav = {
    fav: "Collection",
    all: "All Collection",
    file: "File",
    media: "Album",
    composite: "Chat Record",
    from: "From",
    no_more: "No more favorites",
    all_fav_load: "All favorites have been loaded :("
  };
  const voip = {
    desc: "Audio and Video Call",
    not_answer: "The other party did not answer",
    ongoing: "Calling",
    duration: "Call duration"
  };
  const pick = {
    pick_contact: "Select Contact",
    picked_contact: "Selected contact"
  };
  const search = {
    new_user: "New User",
    view_all: "View All",
    message_history: "Chat History",
    search_message_history: "Search chat history..."
  };
  const file_record = {
    no_more: "No more files",
    all_file_load: "All files have been loaded :("
  };
  const setting = {
    setting: "Settings",
    enable_notification: "Enable notification",
    enable_notification_detail: "Notification display message content",
    close_window_to_exit: "When closing the window, exit directly",
    auto_login: "Remember me",
    exit_switch_user: "Exit/Switch Account",
    feedback: "Send feedback to us",
    lang: "Language (valid after restart)",
    zh_cn: "简体中文",
    zh_tw: "繁體中文",
    en: "English",
    sync_draft: "Sync draft"
  };
  const common = {
    add: "Add",
    remove: "Remove",
    send: "Send",
    contact: "Contact",
    confirm: "Confirm",
    cancel: "Cancel",
    alias: "Remarks",
    area: "Area",
    label: "Label",
    conversation: "Chat",
    sender: "Sender",
    all: "All",
    mine: "Mine",
    unknown: "Unknown",
    search: "Search",
    back: "Back",
    create: "Create",
    none: "None",
    copy: "Copy",
    paste: "Paste",
    cut: "Cut",
    "delete": "Delete",
    forward: "forward",
    fav: "Collection",
    quote: "quote",
    multi_select: "Multiselect",
    recall: "Recall",
    open: "Open",
    open_dir: "Open Directory",
    draft: "Draft",
    save: "Save",
    month_1: "January",
    month_2: "February",
    month_3: "March Month",
    month_4: "April",
    month_5: "May",
    month_6: "June",
    month_7: "July",
    month_8: "August",
    month_9: "September",
    month_10: "October",
    month_11: "November",
    month_12: "December",
    wfc_id: "ID"
  };
  const misc = {
    beijing: "Beijing",
    test_user: "Test User",
    gen_qr_code: "Generating QR code",
    send_to_friend: "Send to Friend..."
  };
  const enLang = {
    login,
    contact,
    friend_request,
    group,
    message,
    conversation,
    fav,
    voip,
    pick,
    search,
    file_record,
    setting,
    common,
    misc
  };
  function mitt(n) {
    return { all: n = n || /* @__PURE__ */ new Map(), on: function(t2, e) {
      var i2 = n.get(t2);
      i2 ? i2.push(e) : n.set(t2, [e]);
    }, off: function(t2, e) {
      var i2 = n.get(t2);
      i2 && (e ? i2.splice(i2.indexOf(e) >>> 0, 1) : n.set(t2, []));
    }, emit: function(t2, e) {
      var i2 = n.get(t2);
      i2 && i2.slice().map(function(n2) {
        n2(e);
      }), (i2 = n.get("*")) && i2.slice().map(function(n2) {
        n2(t2, e);
      });
    } };
  }
  class TestCustomMessageContent extends MessageContent {
    constructor(content) {
      super(CustomMessageContentType.MESSAGE_CONTENT_TYPE_CUSTOM_MESSAGE_TEST);
      __publicField(this, "content");
      this.content = content;
    }
    // 会话列表显示对应会话时，会显示会话最后一条消息的摘要信息
    digest() {
      return this.content;
    }
    // 发送消息时，会进行 encode 操作，实际发送的是 payload
    encode() {
      let payload = super.encode();
      payload.searchableContent = this.content;
      return payload;
    }
    // 收到消息时，会执行 decode 操作，从 payload 解析到具体的消息内容，encode 和 decode 的操作要对应起来
    decode(payload) {
      super.decode(payload);
      this.content = payload.searchableContent;
    }
  }
  class TestCustomNotificationMessageContent extends NotificationMessageContent {
    constructor(tip) {
      super(CustomMessageContentType.MESSAGE_CONTENT_TYPE_CUSTOM_MESSAGE_TEST_NOTIFICATION);
      __publicField(this, "tip", "");
      this.tip = tip;
    }
    // 会话界面显示通知时，将显示本函数的返回值
    formatNotification() {
      return this.tip;
    }
    digest() {
      return this.tip;
    }
    encode() {
      let payload = super.encode();
      payload.content = this.tip;
      return payload;
    }
    decode(payload) {
      super.decode(payload);
      this.tip = payload.content;
    }
  }
  const _CustomMessageConfig = class _CustomMessageConfig {
    // 请勿修改
    static registerCustomMessages() {
      _CustomMessageConfig.CustomMessageContents.forEach((cmc) => {
        wfc.registerMessageContent(cmc.name, cmc.flag, cmc.type, cmc.contentClazz);
      });
    }
  };
  __publicField(_CustomMessageConfig, "CustomMessageContents", [
    {
      name: "testCustomMessage",
      // 消息名字
      flag: PersistFlag.Persist,
      // 消息的存储类型，根据消息是否需要存储选择
      type: CustomMessageContentType.MESSAGE_CONTENT_TYPE_CUSTOM_MESSAGE_TEST,
      // 消息类型
      contentClazz: TestCustomMessageContent
      // 消息类型定义
    },
    {
      name: "testCustomNotificationMessage",
      flag: PersistFlag.Persist,
      type: CustomMessageContentType.MESSAGE_CONTENT_TYPE_CUSTOM_MESSAGE_TEST_NOTIFICATION,
      contentClazz: TestCustomNotificationMessageContent
    }
    // 在此配置更多自定义消息
  ]);
  let CustomMessageConfig = _CustomMessageConfig;
  const app = vue.createVueApp(App);
  const pinia = createPinia();
  app.use(pinia);
  app.use(picker);
  app.use(forward);
  const i18n = createI18n({
    // 使用localStorage存储语言状态是为了保证页面刷新之后还是保持原来选择的语言状态
    locale: getItem("lang") ? getItem("lang") : "zh-CN",
    // 定义默认语言为中文
    allowComposition: true,
    messages: {
      "zh-CN": zhCNLang,
      "zh-TW": zhTWLang,
      "en": enLang
    }
  });
  app.use(i18n);
  app.config.globalProperties.$navigateToPage = (url, options) => {
    uni.navigateTo({
      url,
      success: (res) => {
        if (options) {
          res.eventChannel.emit("options", options);
        }
      },
      fail: (e) => {
        formatAppLog("log", "at main.js:54", "navigate to WebViewPage error", e);
      }
    });
  };
  app.config.globalProperties.$go2ConversationPage = () => {
    let pages = getCurrentPages();
    let cvRoute = "pages/conversation/ConversationPage";
    let delta = 0;
    let found = false;
    for (let i2 = pages.length - 1; i2 >= 0; i2--) {
      if (pages[i2].route === cvRoute) {
        found = true;
        break;
      } else {
        delta++;
      }
    }
    if (found) {
      uni.navigateBack({
        delta,
        fail: (err) => {
          formatAppLog("log", "at main.js:77", "nav back to conversationView err", err);
        }
      });
    } else {
      uni.navigateTo({
        url: "/pages/conversation/ConversationPage",
        success: () => {
          formatAppLog("log", "at main.js:84", "nav to conversationPage success");
        },
        fail: (err) => {
          formatAppLog("log", "at main.js:88", "nav to conversationPage err", err);
        }
      });
    }
  };
  app.config.globalProperties.$scrollToBottom = () => {
    setTimeout(() => {
      uni.pageScrollTo({
        scrollTop: 999999,
        duration: 10
      });
      app.$forceUpdate();
    }, 100);
  };
  app.config.globalProperties.$notify = (options) => {
    uni.showToast({
      title: options.text,
      icon: "none"
    });
  };
  const eventBus = mitt();
  eventBus.$on = eventBus.on;
  eventBus.$off = eventBus.off;
  eventBus.$emit = eventBus.emit;
  app.config.globalProperties.$eventBus = eventBus;
  app.config.globalProperties.$set = (obj, key, value) => obj[key] = value;
  wfc.init();
  formatAppLog("log", "at main.js:119", "xxxxxxxx proto init end");
  CustomMessageConfig.registerCustomMessages();
  store.init();
  app.store = store;
  app.use(store);
  function createApp() {
    return {
      app
    };
  }
  const { app: __app__, Vuex: __Vuex__, Pinia: __Pinia__ } = createApp();
  uni.Vuex = __Vuex__;
  uni.Pinia = __Pinia__;
  __app__.provide("__globalStyles", __uniConfig.styles);
  __app__._component.mpType = "app";
  __app__._component.render = () => {
  };
  __app__.mount("#app");
})(Vue);
